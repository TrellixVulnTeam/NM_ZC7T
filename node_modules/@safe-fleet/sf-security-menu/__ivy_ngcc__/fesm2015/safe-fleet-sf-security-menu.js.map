{"version":3,"file":"safe-fleet-sf-security-menu.js","sources":["../../../projects/sf-security-menu/src/lib/interfaces/IMenuConfig.ts","../../../projects/sf-security-menu/src/lib/services/security/security.service.ts","../../../projects/sf-security-menu/src/lib/services/sf-security-menu/sf-security-menu.service.ts","../../../projects/sf-security-menu/src/lib/sf-security-menu.component.ts","../../../projects/sf-security-menu/src/lib/sf-security-menu.module.ts","../../../projects/sf-security-menu/src/public-api.ts","../../../projects/sf-security-menu/src/safe-fleet-sf-security-menu.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAGM,MAAO,WAAY,SAAQ,UAAU,CAAA;AACzC,IAAA,WAAA,GAAA;AACE,QAAA,KAAK,EAAE,CAAC;AACZ,KAAG;AAEF,CAAA;AACD,MACa,kBAAkB,CAAA;AAI9B,CAAA;AAaK,MAAO,SAAU,SAAQ,QAAQ,CAAA;AACrC,IAAA,WAAA,GAAA;AACE,QAAA,KAAK,EAAE,CAAC;AACZ,KAAG;AACF,CAAA;AAEK,MAAO,MAAO,SAAQ,SAAS,CAAA;AACnC,IAAA,WAAA,GAAA;AACE,QAAA,KAAK,EAAE,CAAC;AACZ,KAAG;AACF,CAAA;AAEY,MAAA,aAAa,GAAQ,MAAA,CAAA,MAAA,CAAA,EAAA,EAAA,aAAa;AAAG;AAClD,MC/Ba,eAAe,CAAA;AAM1B,IAAA,WAAA,CAA6B,UAAsB,EAAA;AAAE,QAAxB,IAAU,CAAA,UAAA,GAAV,UAAU,CAAY;AAAC,KAAG;AAEhD,IAAA,sBAAsB,CAAC,gBAAwB,EAAE,gBAAwB,EAAE,OAAY,EAAA;AAC5F,QAAA,IAAI,CAAC,eAAe,GAAG,OAAO,CAAC;AAC/B,QAAA,IAAI,CAAC,gBAAgB,GAAG,gBAAgB,CAAC;AACzC,QAAA,IAAI,CAAC,gBAAgB,GAAG,gBAAgB,CAAC;AAC7C,KAAG;AACH,IACS,eAAe,GAAA;AACpB,QAAA,MAAM,GAAG,GAAG,CAAA,EAAG,IAAI,CAAC,gBAAgB,eAAe,CAAC;AACpD,QAAA,OAAO,IAAI,CAAC,UAAU,CAAC,GAAG,CAAiB,GAAG,EAAE;AACpD,YAAM,OAAO,EAAE,IAAI,CAAC,eAAe;AAC9B,SAAA,CAAC,CAAC;AACP,KAAG;AACH,IACS,cAAc,GAAA;AAAE,QACrB,OAAO,IAAI,CAAC,WAAW,CAAC;AAC5B,KAAG;AACH,IACS,OAAO,GAAA;AAAE,QACd,OAAO,IAAI,CAAC,eAAe,CAAC;AAChC,KAAG;AAEM,IAAA,sBAAsB,CAAC,YAAoB,EAAA;AAAE,QAClD,MAAM,GAAG,GAAG,CAAG,EAAA,IAAI,CAAC,gBAAgB,CAAA,0BAAA,EAA6B,YAAY,CAAA,CAAE,CAAC;AACpF,QAAI,OAAO,IAAI,CAAC,UAAU;AAC1B,aAAO,GAAG,CAAC,GAAG,EAAE;AAChB,YAAQ,OAAO,EAAE,IAAI,CAAC,eAAe;AACrC,SAAO,CAAC;AACR,aAAO,IAAI,CACH,GAAG,CAAC,CAAC,CAAC,MAAM,IAAI,CAAC,WAAW,GAAG,CAAC,CAAC,CAAC,EAClC,UAAU,CAAC,CAAC,KAAK,KAAI;AACnB,YAAA,MAAM,KAAK,CAAC;AACtB,SAAS,CAAC,CACH,CAAC;AACR,KAAG;AACH,IACS,kBAAkB,GAAA;AACvB,QAAA,MAAM,GAAG,GAAG,CAAA,EAAG,IAAI,CAAC,gBAAgB,OAAO,CAAC;AAChD,QAAI,OAAO,IAAI,CAAC,UAAU;AAC1B,aAAO,GAAG,CAAC,GAAG,EAAE;AAChB,YAAQ,OAAO,EAAE,IAAI,CAAC,eAAe;AACrC,SAAO,CAAC;AACR,aAAO,IAAI,CACH,GAAG,CAAC,CAAC,CAAC,MAAM,IAAI,CAAC,eAAe,GAAG,CAAC,CAAC,CAAC,EACtC,UAAU,CAAC,CAAC,KAAK,KAAI;AACnB,YAAA,MAAM,KAAK,CAAC;AACtB,SAAS,CAAC,CACH,CAAC;AACR,KAAG;AACH;sIAAC;AACD,uMAzDC;+BAHA,IAAA,EAAA,rCAGC;AAHD,EAAA,UAAU,EAAC,IAAA,EAAA,CAAA,EACV,vBAGU,YAVH,UAAU,EAAA;AAAC;WAOlB,UAAU,EAAE,MAAM,EACnB,aAAA,EAAA,EAAA;;;;;2EARqB;AAAC;AAAC,MCWX,qBAAqB,CAAA;AAAE,IAIlC,WAA6B,CAAA,aAA4B,EAAmB,eAAgC,EAAA;AAAE,QAAjF,IAAa,CAAA,aAAA,GAAb,aAAa,CAAe;AAAC,QAAkB,IAAe,CAAA,eAAA,GAAf,eAAe,CAAiB;AAH5G,QAAA,IAAA,CAAA,2BAA2B,GAA6B,IAAI,eAAe,CAAU,KAAK,CAAC,CAAC;AAE5F,QAAA,IAAA,CAAA,OAAO,GAAG,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC;AACvC,KAAkH;AAClH,IACS,aAAa,CAAC,MAAmB,EAAE,YAA2B,EAAA;AACnE,QAAA,IAAI,CAAC,eAAe,CAAC,sBAAsB,CAAC,YAAY,CAAC,gBAAgB,EAAE,YAAY,CAAC,gBAAgB,EAAE,YAAY,CAAC,OAAO,CAAC,CAAC;AAChI,QAAA,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;AAC7B,QAAI,IAAI,CAAC,aAAa,EAAE,CAAC;AACrB,QAAA,IAAI,CAAC,2BAA2B,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;AACjD,QAAI,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC,oBAAoB,CAAC,MAAM,CAAC,iBAAiB,CAAC,CAAC;AACjF,QAAI,MAAM,qBAAqB,GAAG,IAAI,CAAC,eAAe,CAAC,sBAAsB,CAAC,MAAM,CAAC,cAAc,CAAC,EAAE,CAAC,CAAC,IAAI,CACtG,UAAU,CAAC,CAAC,KAAK,KAAI;AACnB,YAAA,IAAI,KAAK,CAAC,MAAM,KAAK,GAAG,IAAI,MAAM,CAAC,eAAe,IAAI,MAAM,CAAC,iBAAiB,EAAE;AAC9E,gBAAA,IAAI,CAAC,2BAA2B,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;AAC7C,aAAA;AACD,YAAA,MAAM,KAAK,CAAC;AACpB,SAAO,CAAC,CACH,CAAC;AAEF,QAAA,MAAM,sBAAsB,GAAG,IAAI,CAAC,eAAe,CAAC,eAAe,EAAE,CAAC,IAAI,CACxE,GAAG,CAAC,CAAC,YAA4B,KAAK,IAAI,CAAC,gBAAgB,CAAC,MAAM,EAAE,YAAY,EAAE,YAAY,CAAC,CAAC,EAChG,UAAU,CAAC,CAAC,KAAK,KAAI;AACnB,YAAA,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;AACzB,YAAA,MAAM,KAAK,CAAC;AACpB,SAAO,CAAC,CACH,CAAC;AACN,QACI,MAAM,yBAAyB,GAAG,IAAI,CAAC,eAAe,CAAC,kBAAkB,EAAE,CAAC;AAC5E,QAAA,OAAO,sBAAsB,CAAC,IAAI,CAChC,QAAQ,CAAC,MAAM,qBAAqB,CAAC,EACrC,QAAQ,CAAC,MAAM,yBAAyB,CAAC,EACzC,UAAU,CAAC,MAAM,EAAE,CAAC,EAAE,CAAC,CAAC,CACzB,CAAC;AACN,KAAG;AAEM,IAAA,WAAW,CAAC,MAAmB,EAAA;AACpC,QAAA,IAAI,CAAC,aAAa,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;AAC7C,KAAG;AACH,IAAS,cAAc,GAAA;AACnB,QAAA,OAAO,IAAI,CAAC,eAAe,CAAC,cAAc,EAAE,CAAC;AACjD,KAAG;AACH,IACS,eAAe,GAAA;AACpB,QAAA,OAAO,IAAI,CAAC,eAAe,CAAC,OAAO,EAAE,CAAC;AAC1C,KAAG;AAEO,IAAA,gBAAgB,CAAC,MAAmB,EAAE,YAA4B,EAAE,YAA2B,EAAA;AACrG,QAAA,MAAM,CAAC,QAAQ,GAAG,EAAE,CAAC;AACzB,QAAI,MAAM,SAAS,GAAgB,EAAE,CAAC;AAClC,QAAA,YAAY,CAAC,OAAO,CAAC,CAAC,GAAG,KAAI;AAAE,YAC7B,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,kBAAkB,CAAC,GAAG,CAAC,CAAC,CAAC;AAC/C,SAAC,CAAC,CAAC;AACH,QAAA,MAAM,eAAe,GAAG,SAAS,CAAC,IAAI,CAAC,CAAC,GAAG,KAAK,GAAG,CAAC,IAAI,KAAK,YAAY,CAAC,mBAAmB,CAAC,CAAC;AAC/F,QAAA,IAAI,CAAC,eAAe,IAAI,eAAe,KAAK,IAAI,EAAE;AAChD,YAAA,MAAM,CAAC,QAAQ,GAAG,SAAS,CAAC;AAC5B,YAAA,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;AAC/B,YAAM,OAAO;AACR,SAAA;AACD,QAAA,MAAM,CAAC,cAAc,GAAG,eAAe,CAAC;AAC5C,QAAI,MAAM,CAAC,QAAQ,GAAG,SAAS,CAAC,MAAM,CAAC,CAAC,IAAI,KAAK,IAAI,CAAC,EAAE,KAAK,MAAM,CAAC,cAAc,CAAC,EAAE,CAAC,CAAC;AACnF,QAAA,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;AAC7B,KAAG;AAEO,IAAA,kBAAkB,CAAC,GAAiB,EAAA;AAAE,QAC5C,OAAO;AACX,YAAM,IAAI,EAAE,GAAG,CAAC,eAAe;AAC/B,YAAM,SAAS,EAAE,GAAG,CAAC,cAAc;AACnC,YAAM,QAAQ,EAAE,GAAG,CAAC,kBAAkB;AACtC,YAAM,EAAE,EAAE,GAAG,CAAC,eAAe;AACvB,YAAA,SAAS,EAAE,KAAK;AAChB,YAAA,MAAM,EAAE,KAAK;AACb,YAAA,QAAQ,EAAE,KAAK;AACf,YAAA,MAAM,EAAE,KAAK;AACnB,SAAK,CAAC;AACN,KAAG;AAEO,IAAA,oBAAoB,CAAC,WAA+B,EAAA;AAAE,QAC5D,OAAO;AACX,YAAM,eAAe,EAAE,WAAW,GAAG,WAAW,CAAC,eAAe,GAAG,EAAE;AACrE,YAAM,sBAAsB,EAAE,WAAW,GAAG,WAAW,CAAC,sBAAsB,GAAG,EAAE;AACnF,YAAM,gBAAgB,EAAE,WAAW,GAAG,WAAW,CAAC,gBAAgB,GAAG,EAAE;AACvE,SAA2B,CAAC;AAC5B,KAAG;AAEM,IAAA,iBAAiB,CAAC,eAAuB,EAAA;AAAE,QAChD,OAAO,IAAI,CAAC,eAAe,CAAC,sBAAsB,CAAC,eAAe,CAAC,CAAC;AACxE,KAAG;AACH,IACU,aAAa,GAAA;AAAE,QACrB,OAAO,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC,SAAS,KAAI;AACxD,YAAA,IAAI,SAAS,CAAC,IAAI,KAAK,aAAa,CAAC,mBAAmB,EAAE;AACxD,gBAAA,IAAI,CAAC,2BAA2B,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;AAC9C,aAAA;AACH,SAAC,CAAC,CAAC;AACP,KAAG;AACH;6LAAC;AACD,kQAlGC;qCAHA,IAAA,EAAA,3CAGC;AAHD,EAAA,UAAU,EAAC,IAAA,EAAA,CAAA,EACV,vBAGU,YAVH,aAAa,EAAA;UAOpB,UAAU,EAAE,MAAM,5BAPI,YAGf,eAAe,EAAA;AAKvB,AALwB;UAKxB,EAAA,EAAA;;;;;yGAL0B;AAAC;AAAC,MCMhB,uBAAuB,CAAA;AAAE,IASpC,WAAoB,CAAA,gBAAuC,EAAU,aAA4B,EAAA;AAAE,QAA/E,IAAgB,CAAA,gBAAA,GAAhB,gBAAgB,CAAuB;AAAC,QAAS,IAAa,CAAA,aAAA,GAAb,aAAa,CAAe;AAAC,QARjF,IAAc,CAAA,cAAA,GAAG,oBAAoB,CAAC;AACzD,QAAmB,IAAY,CAAA,YAAA,GAAG,EAAE,CAAC;AACrC,QAAE,IAAU,CAAA,UAAA,GAAU,EAAE,UAAU,EAAE,MAAM,EAAE,QAAQ,EAAE,QAAQ,EAAE,CAAC;AACjE,QAAE,IAAS,CAAA,SAAA,GAAG,GAAG,CAAC;AAClB,QAAE,IAAW,CAAA,WAAA,GAAW,EAAE,IAAI,EAAE,CAAC,IAAI,EAAE,GAAG,EAAE,CAAC,EAAE,CAAC;AAChD,QAAE,IAAwB,CAAA,wBAAA,GAAG,KAAK,CAAC;AACnC,KAEuG;AACvG,IACE,QAAQ,GAAA;AAAE,QACR,IAAI,CAAC,gBAAgB,CAAC,2BAA2B,CAAC,SAAS,CAAC,CAAC,eAAe,KAAI;AAC9E,YAAA,IAAI,eAAe,EAAE;AAC3B,gBAAQ,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC,gBAAgB,CAAC,iBAAiB,CAAC;AACzE,gBAAQ,IAAI,CAAC,sBAAsB,EAAE,CAAC;AAC/B,aAAA;AAAM,iBAAA;AACb,gBAAQ,IAAI,CAAC,6BAA6B,EAAE,CAAC;AACtC,aAAA;AACH,SAAC,CAAC,CAAC;AACP,KAAG;AACH,IACE,sBAAsB,GAAA;AACpB,QAAA,IAAI,CAAC,wBAAwB,GAAG,IAAI,CAAC;AACrC,QAAA,IAAI,CAAC,aAAa,CAAC,aAAa,CAAC,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,SAAS,CAAC,MAAK;AAAE,YACnF,IAAI,CAAC,uBAAuB,EAAE,CAAC;AACjC,SAAC,CAAC,CAAC;AACP,KAAG;AACH,IAEE,QAAQ,GAAA;AAAE,QACR,IAAI,CAAC,uBAAuB,EAAE,CAAC;AACnC,KAAG;AACH,IACE,uBAAuB,GAAA;AAAE,QACvB,IAAI,IAAI,CAAC,wBAAwB,EAAE;AACvC,YAAM,MAAM,IAAI,GAAG,QAAQ,CAAC,aAAa,CAAC,gBAAgB,CAAC,CAAC;AACtD,YAAA,IAAI,CAAC,oBAAoB,GAAG,IAAI,IAAI,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC;AACzF,YAAM,IAAI,IAAI,CAAC,oBAAoB,EAAE;AACrC,gBAAQ,MAAM,QAAQ,GAAG,IAAI,CAAC,oBAAoB,CAAC,qBAAqB,EAAE,CAAC;AAC3E,gBAAQ,MAAM,GAAG,GAAG,QAAQ,CAAC,GAAG,GAAG,QAAQ,CAAC,MAAM,GAAG,CAAC,CAAC;AAC/C,gBAAA,MAAM,IAAI,GAAG,QAAQ,CAAC,IAAI,GAAG,QAAQ,CAAC,KAAK,GAAG,IAAI,CAAC,YAAY,CAAC;AACxE,gBAAQ,IAAI,CAAC,WAAW,GAAG,EAAE,IAAI,EAAE,GAAG,EAAE,CAAC;AACzC,gBAAQ,IAAI,CAAC,oBAAoB,CAAC,SAAS,CAAC,GAAG,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC;AAC9D,aAAA;AAAM,iBAAA;AACL,gBAAA,IAAI,CAAC,wBAAwB,GAAG,KAAK,CAAC;AACvC,aAAA;AACF,SAAA;AACL,KAAG;AACH,IACE,6BAA6B,GAAA;AAC3B,QAAA,IAAI,CAAC,wBAAwB,GAAG,KAAK,CAAC;AAC1C,QAAI,IAAI,IAAI,CAAC,oBAAoB,EAAE;AACnC,YAAM,IAAI,CAAC,oBAAoB,CAAC,SAAS,CAAC,MAAM,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC;AACjE,SAAA;AACL,KAAG;AACH;uCA7DC,IAAA,EAAA,IAAA,EAAA,SAAS,EAAC,IAAA,EAAA,CAAA,EACT,gBAAA,QAAQ,EAAE,kBAAkB,kBAC5B,QAAgD,EAAA;;;uJAAA;;;;;;;;;wHAEjD,aAAA,EAAA,EAAA,isBACA;AAAC;AAAiD,YAP1C,qBAAqB,EAAA;AAAE,YAFvB,aAAa,EAAA;AAAC;AAAG;AAsCvB,IAAA,QAAA,EAAA,CAAA,EAAA,IAAA,EAAA,YAAY,EAAC,IAAA,EAAA,CAAA,eAAe,EAAE,CAAC,QAAQ,CAAC,EAAA,EAAA,CAAA;AAAC;;;;;;;;;;;oBAC3C;AAAC;AAAC,MC5BU,oBAAoB,CAAA;AAAE;oCALlC,IAAA,EAAA,IAAA,EAAA,QAAQ,EAAC,IAAA,EAAA,CAAA,kBACR,YAAY,EAAE,CAAC;KAAuB,CAAC,kBACvC,OAAO,EAAE,CAAC,YAAY,EAAE,YAAY,EAAE,gBAAgB,EAAE,WAAW,EAAE;OAAa,CAAC,kBACnF,OAAO,EAAE,CAAC,uBAAuB,CAAC,EACnC,aAAA,EAAA,EAAA;;;;;;;;;sWACA;AAAC;ACbF;AACA;AACG;AAED;ACJF;AACA;AACG;AAED;AAAC;AAE4I","sourcesContent":["import { MenuEvent } from '@progress/kendo-angular-menu';\nimport { MenuConfig, MenuEventType, MenuItem } from '@safe-fleet/sf-menu';\n\nexport class IMenuConfig extends MenuConfig {\n  constructor() {\n    super();\n  }\n  unauthorizedPopup: IUnauthorizedPopup;\n}\n\nexport class IUnauthorizedPopup {\n  popupMessageText!: string;\n  popupMessageActionText!: string;\n  popupButtonText!: string;\n}\n\nexport interface ISecurityInfo {\n  settingsEndpoint: string;\n  securityEndpoint: string;\n  headers: IHeaders;\n  selectedApplication: string;\n}\n\nexport interface IHeaders {\n  'X-Tenant-Id': string;\n  Authorization: string;\n}\nexport class IMenuItem extends MenuItem {\n  constructor() {\n    super();\n  }\n}\n\nexport class IEvent extends MenuEvent {\n  constructor() {\n    super();\n  }\n}\n\nexport const EventTypeEnum = { ...MenuEventType };\n","import { HttpClient } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { catchError, map } from 'rxjs/operators';\nimport { IApplication } from '../../interfaces/IApplication';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class SecurityService {\n  private securityEndpoint: string;\n  private settingsEndpoint: string;\n  private securityHeaders: any;\n  private permissions: any;\n  private applicationInfo: any;\n  constructor(private readonly httpClient: HttpClient) {}\n\n  public setSecurityInformation(securityEndpoint: string, settingsEndpoint: string, headers: any) {\n    this.securityHeaders = headers;\n    this.securityEndpoint = securityEndpoint;\n    this.settingsEndpoint = settingsEndpoint;\n  }\n\n  public getApplications(): Observable<IApplication[]> {\n    const url = `${this.securityEndpoint}/applications`;\n    return this.httpClient.get<IApplication[]>(url, {\n      headers: this.securityHeaders,\n    });\n  }\n\n  public getPermissions() {\n    return this.permissions;\n  }\n\n  public getInfo() {\n    return this.applicationInfo;\n  }\n\n  public getSecurityPermissions(resourceName: string): Observable<any> {\n    const url = `${this.securityEndpoint}/permissions?resourceName=${resourceName}`;\n    return this.httpClient\n      .get(url, {\n        headers: this.securityHeaders,\n      })\n      .pipe(\n        map((x) => (this.permissions = x)),\n        catchError((error) => {\n          throw error;\n        })\n      );\n  }\n\n  public getApplicationInfo(): Observable<any> {\n    const url = `${this.settingsEndpoint}/info`;\n    return this.httpClient\n      .get(url, {\n        headers: this.securityHeaders,\n      })\n      .pipe(\n        map((x) => (this.applicationInfo = x)),\n        catchError((error) => {\n          throw error;\n        })\n      );\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { BehaviorSubject, Observable, of } from 'rxjs';\nimport { SfMenuService } from '@safe-fleet/sf-menu';\nimport { IApplication } from '../../interfaces/IApplication';\nimport { EventTypeEnum, IMenuConfig, IMenuItem, ISecurityInfo, IUnauthorizedPopup } from '../../interfaces/IMenuConfig';\nimport { SecurityService } from '../security/security.service';\nimport { catchError, map, mergeMap } from 'rxjs/operators';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class SfSecurityMenuService {\n  infoMessageVisibilityChange: BehaviorSubject<boolean> = new BehaviorSubject<boolean>(false);\n  unauthorizedPopup: IUnauthorizedPopup;\n  events$ = this.sfMenuService.events$;\n  constructor(private readonly sfMenuService: SfMenuService, private readonly securityService: SecurityService) {}\n\n  public configureMenu(config: IMenuConfig, securityInfo: ISecurityInfo): Observable<any> {\n    this.securityService.setSecurityInformation(securityInfo.securityEndpoint, securityInfo.settingsEndpoint, securityInfo.headers);\n    this.refreshMenu(config);\n    this.onMenuChanges();\n    this.infoMessageVisibilityChange.next(false);\n    this.unauthorizedPopup = this.getUnauthorizedPopup(config.unauthorizedPopup);\n    const permissionsObservable = this.securityService.getSecurityPermissions(config.currentProduct.id).pipe(\n      catchError((error) => {\n        if (error.status === 403 && config.multipleTenants && config.unauthorizedPopup) {\n          this.infoMessageVisibilityChange.next(true);\n        }\n        throw error;\n      })\n    );\n\n    const applicationsObservable = this.securityService.getApplications().pipe(\n      map((applications: IApplication[]) => this.mapConfiguration(config, applications, securityInfo)),\n      catchError((error) => {\n        this.refreshMenu(config);\n        throw error;\n      })\n    );\n\n    const applicationInfoObservable = this.securityService.getApplicationInfo();\n    return applicationsObservable.pipe(\n      mergeMap(() => permissionsObservable),\n      mergeMap(() => applicationInfoObservable),\n      catchError(() => of(''))\n    );\n  }\n\n  public refreshMenu(config: IMenuConfig) {\n    this.sfMenuService.setMenuConfig(config);\n  }\n  public getPermissions() {\n    return this.securityService.getPermissions();\n  }\n\n  public getSettingsInfo() {\n    return this.securityService.getInfo();\n  }\n\n  private mapConfiguration(config: IMenuConfig, applications: IApplication[], securityInfo: ISecurityInfo) {\n    config.products = [];\n    const menuItems: IMenuItem[] = [];\n    applications.forEach((app) => {\n      menuItems.push(this.mapMenuApplication(app));\n    });\n    const selectedProduct = menuItems.find((app) => app.text === securityInfo.selectedApplication);\n    if (!selectedProduct || selectedProduct === null) {\n      config.products = menuItems;\n      this.refreshMenu(config);\n      return;\n    }\n    config.currentProduct = selectedProduct;\n    config.products = menuItems.filter((item) => item.id !== config.currentProduct.id);\n    this.refreshMenu(config);\n  }\n\n  private mapMenuApplication(app: IApplication) {\n    return {\n      text: app.applicationName,\n      routeHref: app.applicationUrl,\n      iconPath: app.applicationIconUrl,\n      id: app.applicationName,\n      newWindow: false,\n      active: false,\n      expanded: false,\n      newTab: false,\n    };\n  }\n\n  private getUnauthorizedPopup(popupConfig: IUnauthorizedPopup): IUnauthorizedPopup {\n    return {\n      popupButtonText: popupConfig ? popupConfig.popupButtonText : '',\n      popupMessageActionText: popupConfig ? popupConfig.popupMessageActionText : '',\n      popupMessageText: popupConfig ? popupConfig.popupMessageText : '',\n    } as IUnauthorizedPopup;\n  }\n\n  public reloadPermissions(applicationName: string): Observable<any> {\n    return this.securityService.getSecurityPermissions(applicationName);\n  }\n\n  private onMenuChanges() {\n    return this.sfMenuService.events$.subscribe((menuEvent) => {\n      if (menuEvent.type === EventTypeEnum.OpenTenantListClick) {\n        this.infoMessageVisibilityChange.next(false);\n      }\n    });\n  }\n}\n","import { Component, HostListener, OnInit } from '@angular/core';\nimport { Align, Offset } from '@progress/kendo-angular-popup';\nimport { SfMenuService } from '@safe-fleet/sf-menu';\nimport { debounceTime } from 'rxjs/operators';\nimport { SfSecurityMenuService } from './services/sf-security-menu/sf-security-menu.service';\nimport { IUnauthorizedPopup } from './interfaces/IMenuConfig';\n@Component({\n  selector: 'sf-security-menu',\n  templateUrl: './sf-security-menu.component.html',\n  styleUrls: ['./sf-security-menu.component.scss'],\n})\nexport class SfSecurityMenuComponent implements OnInit {\n  private readonly highlightClass = 'highlight-org-menu';\n  private readonly paddingWidth = 10;\n  popupAlign: Align = { horizontal: 'left', vertical: 'center' };\n  delayTime = 300;\n  offsetPopup: Offset = { left: -1000, top: 0 };\n  showOrganizationMsgPopup = false;\n  organizationItemMenu: HTMLElement;\n  unauthorizedPopup: IUnauthorizedPopup;\n  constructor(private sfSecMenuService: SfSecurityMenuService, private sfMenuService: SfMenuService) {}\n\n  ngOnInit() {\n    this.sfSecMenuService.infoMessageVisibilityChange.subscribe((showInfoMessage) => {\n      if (showInfoMessage) {\n        this.unauthorizedPopup = this.sfSecMenuService.unauthorizedPopup;\n        this.onMenuCollapseOrExpand();\n      } else {\n        this.closeShowOrganizationMsgPopup();\n      }\n    });\n  }\n\n  onMenuCollapseOrExpand() {\n    this.showOrganizationMsgPopup = true;\n    this.sfMenuService.menuCollapse$.pipe(debounceTime(this.delayTime)).subscribe(() => {\n      this.getOrganizationPosition();\n    });\n  }\n\n  @HostListener('window:resize', ['$event'])\n  onResize() {\n    this.getOrganizationPosition();\n  }\n\n  getOrganizationPosition() {\n    if (this.showOrganizationMsgPopup) {\n      const elem = document.querySelector('.sf-fleet-list');\n      this.organizationItemMenu = elem && elem.parentElement ? elem.parentElement : null;\n      if (this.organizationItemMenu) {\n        const bounding = this.organizationItemMenu.getBoundingClientRect();\n        const top = bounding.top + bounding.height / 2;\n        const left = bounding.left + bounding.width + this.paddingWidth;\n        this.offsetPopup = { left, top };\n        this.organizationItemMenu.classList.add(this.highlightClass);\n      } else {\n        this.showOrganizationMsgPopup = false;\n      }\n    }\n  }\n\n  closeShowOrganizationMsgPopup() {\n    this.showOrganizationMsgPopup = false;\n    if (this.organizationItemMenu) {\n      this.organizationItemMenu.classList.remove(this.highlightClass);\n    }\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { SfSecurityMenuComponent } from './sf-security-menu.component';\nimport { SfMenuModule } from '@safe-fleet/sf-menu';\nimport { HttpClientModule } from '@angular/common/http';\nimport { PopupModule } from '@progress/kendo-angular-popup';\nimport { CommonModule } from '@angular/common';\nimport { ButtonsModule } from '@progress/kendo-angular-buttons';\n\n@NgModule({\n  declarations: [SfSecurityMenuComponent],\n  imports: [CommonModule, SfMenuModule, HttpClientModule, PopupModule, ButtonsModule],\n  exports: [SfSecurityMenuComponent],\n})\nexport class SfSecurityMenuModule {}\n","/*\n * Public API Surface of sf-security-menu\n */\n\nexport * from './lib/services/sf-security-menu/sf-security-menu.service';\nexport * from './lib/interfaces/IMenuConfig';\nexport * from './lib/interfaces/IApplication';\nexport * from './lib/sf-security-menu.component';\nexport * from './lib/sf-security-menu.module';\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n\nexport {SecurityService as ɵa} from './lib/services/security/security.service';"]}