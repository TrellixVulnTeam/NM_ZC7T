/**-----------------------------------------------------------------------------------------
* Copyright Â© 2021 Progress Software Corporation. All rights reserved.
* Licensed under commercial license. See LICENSE.md in the project root for more information
*-------------------------------------------------------------------------------------------*/
import * as tslib_1 from "tslib";
import { Component, ContentChild, EventEmitter, HostBinding, Input, isDevMode, Output } from '@angular/core';
import { LocalizationService, L10N_PREFIX } from '@progress/kendo-angular-l10n';
import { Subscription } from 'rxjs';
import { validatePackage } from '@progress/kendo-licensing';
import { packageMetadata } from '../package-metadata';
import { ERRORS } from '../constants';
import { PopoverTitleTemplateDirective } from './template-directives/title-template.directive';
import { PopoverBodyTemplateDirective } from './template-directives/body-template.directive';
import { PopoverActionsTemplateDirective } from './template-directives/actions-template.directive';
/**
 * Represents the [Kendo UI Popover component for Angular]({% slug overview_popover %}).
 * Used to display additional information that is related to a target element.
 *
 * @example
 * ```ts-no-run
 * <kendo-popover>
 *    <ng-template kendoPopoverTitleTemplate>Foo Title</ng-template>
 *    <ng-template kendoPopoverBodyTemplate>Foo Body</ng-template>
 *    <ng-template kendoPopoverActionsTemplate>Foo Actions</ng-template>
 * </kendo-popover>
 * ```
 */
var PopoverComponent = /** @class */ (function () {
    function PopoverComponent(localization) {
        this.localization = localization;
        /**
         * Specifies the position of the Popover in relation to its anchor element. [See example]({% slug positioning_popover %})
         *
         * The possible options are:
         * `top`
         * `bottom`
         * `right` (Default)
         * `left`
         */
        this.position = 'right';
        /**
         * Determines whether a callout will be rendered along the Popover. [See example]({% slug callout_popover %})
         *
         * @default true
         */
        this.callout = true;
        /**
         * Enables and configures the Popover animation. [See example]({% slug animations_popover %})
         *
         * The possible options are:
         *
         * * `boolean`&mdash;Enables the default animation
         * * `PopoverAnimation`&mdash;A configuration object which allows setting the `direction`, `duration` and `type` of the animation.
         *
         * @default false
         */
        this.animation = false;
        /**
         * @hidden
         * Determines the visibility of the Popover.
         */
        this.visible = false;
        /**
         * Fires before the Popover is about to be shown ([see example]({% slug events_popover %})).
         * The event is preventable. If canceled, the Popover will not be displayed. [See example]({% slug events_popover %})
         */
        this.show = new EventEmitter();
        /**
         * Fires after the Popover has been shown and the animation has ended. [See example]({% slug events_popover %})
         */
        this.shown = new EventEmitter();
        /**
         * Fires when the Popover is about to be hidden ([see example]({% slug events_popover %})).
         * The event is preventable. If canceled, the Popover will remain visible.
         */
        this.hide = new EventEmitter();
        /**
         * Fires after the Popover has been hidden and the animation has ended. [See example]({% slug events_popover %})
         */
        this.hidden = new EventEmitter();
        this._offset = 6;
        this._width = 'auto';
        this._height = 'auto';
        this.subs = new Subscription();
        /**
         * @hidden
         */
        this._templateData = function () { return null; };
        validatePackage(packageMetadata);
    }
    Object.defineProperty(PopoverComponent.prototype, "offset", {
        get: function () {
            var calloutBuffer = 14;
            return this.callout
                ? calloutBuffer + this._offset
                : this._offset;
        },
        /**
         * Specifies the distance from the Popover to its anchor element in pixels.
         *
         * @default `6`
         */
        set: function (value) {
            this._offset = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(PopoverComponent.prototype, "width", {
        get: function () {
            return this._width;
        },
        /**
         * Determines the width of the popover. Numeric values are treated as pixels.
         * @default 'auto'
         */
        set: function (value) {
            this._width = typeof value === 'number' ? value + "px" : value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(PopoverComponent.prototype, "height", {
        get: function () {
            return this._height;
        },
        /**
         * Determines the height of the popover. Numeric values are treated as pixels.
         * @default 'auto'
         */
        set: function (value) {
            this._height = typeof value === 'number' ? value + "px" : value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(PopoverComponent.prototype, "templateData", {
        get: function () {
            return this._templateData;
        },
        /**
         * Defines a callback function which returns custom data passed to the Popover templates.
         * It exposes the current anchor element as an argument. [See example]({% slug templates_popover %}#toc-popoverdatacallback)
         */
        set: function (fn) {
            if (isDevMode && typeof fn !== 'function') {
                throw new Error(ERRORS.templateData + " " + JSON.stringify(fn) + ".");
            }
            this._templateData = fn;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(PopoverComponent.prototype, "isHidden", {
        /**
         * @hidden
         */
        get: function () {
            return !this.visible;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(PopoverComponent.prototype, "hasAttributeHidden", {
        /**
         * @hidden
         */
        get: function () {
            return !this.visible;
        },
        enumerable: true,
        configurable: true
    });
    PopoverComponent.prototype.ngOnInit = function () {
        var _this = this;
        this.subs.add(this.localization.changes.subscribe(function (_a) {
            var rtl = _a.rtl;
            _this.direction = rtl ? 'rtl' : 'ltr';
        }));
    };
    PopoverComponent.prototype.ngOnDestroy = function () {
        this.subs.unsubscribe();
    };
    /**
     * @hidden
     */
    PopoverComponent.prototype.getCalloutPosition = function () {
        switch (this.position) {
            case 'top': return { 'k-callout-s': true };
            case 'bottom': return { 'k-callout-n': true };
            case 'left': return { 'k-callout-e': true };
            case 'right': return { 'k-callout-w': true };
            default: return { 'k-callout-s': true };
        }
    };
    tslib_1.__decorate([
        Input(),
        tslib_1.__metadata("design:type", String)
    ], PopoverComponent.prototype, "position", void 0);
    tslib_1.__decorate([
        Input(),
        tslib_1.__metadata("design:type", Number),
        tslib_1.__metadata("design:paramtypes", [Number])
    ], PopoverComponent.prototype, "offset", null);
    tslib_1.__decorate([
        HostBinding('style.width'),
        Input(),
        tslib_1.__metadata("design:type", Object),
        tslib_1.__metadata("design:paramtypes", [Object])
    ], PopoverComponent.prototype, "width", null);
    tslib_1.__decorate([
        HostBinding('style.height'),
        Input(),
        tslib_1.__metadata("design:type", Object),
        tslib_1.__metadata("design:paramtypes", [Object])
    ], PopoverComponent.prototype, "height", null);
    tslib_1.__decorate([
        HostBinding('attr.dir'),
        tslib_1.__metadata("design:type", String)
    ], PopoverComponent.prototype, "direction", void 0);
    tslib_1.__decorate([
        Input(),
        tslib_1.__metadata("design:type", String)
    ], PopoverComponent.prototype, "title", void 0);
    tslib_1.__decorate([
        Input(),
        tslib_1.__metadata("design:type", String)
    ], PopoverComponent.prototype, "subtitle", void 0);
    tslib_1.__decorate([
        Input(),
        tslib_1.__metadata("design:type", String)
    ], PopoverComponent.prototype, "body", void 0);
    tslib_1.__decorate([
        Input(),
        tslib_1.__metadata("design:type", Boolean)
    ], PopoverComponent.prototype, "callout", void 0);
    tslib_1.__decorate([
        Input(),
        tslib_1.__metadata("design:type", Object)
    ], PopoverComponent.prototype, "animation", void 0);
    tslib_1.__decorate([
        Input(),
        tslib_1.__metadata("design:type", Function),
        tslib_1.__metadata("design:paramtypes", [Function])
    ], PopoverComponent.prototype, "templateData", null);
    tslib_1.__decorate([
        HostBinding('class.k-hidden'),
        tslib_1.__metadata("design:type", Boolean),
        tslib_1.__metadata("design:paramtypes", [])
    ], PopoverComponent.prototype, "isHidden", null);
    tslib_1.__decorate([
        HostBinding('attr.aria-hidden'),
        tslib_1.__metadata("design:type", Boolean),
        tslib_1.__metadata("design:paramtypes", [])
    ], PopoverComponent.prototype, "hasAttributeHidden", null);
    tslib_1.__decorate([
        Output(),
        tslib_1.__metadata("design:type", EventEmitter)
    ], PopoverComponent.prototype, "show", void 0);
    tslib_1.__decorate([
        Output(),
        tslib_1.__metadata("design:type", EventEmitter)
    ], PopoverComponent.prototype, "shown", void 0);
    tslib_1.__decorate([
        Output(),
        tslib_1.__metadata("design:type", EventEmitter)
    ], PopoverComponent.prototype, "hide", void 0);
    tslib_1.__decorate([
        Output(),
        tslib_1.__metadata("design:type", EventEmitter)
    ], PopoverComponent.prototype, "hidden", void 0);
    tslib_1.__decorate([
        ContentChild(PopoverTitleTemplateDirective, { static: false }),
        tslib_1.__metadata("design:type", PopoverTitleTemplateDirective)
    ], PopoverComponent.prototype, "titleTemplate", void 0);
    tslib_1.__decorate([
        ContentChild(PopoverBodyTemplateDirective, { static: false }),
        tslib_1.__metadata("design:type", PopoverBodyTemplateDirective)
    ], PopoverComponent.prototype, "bodyTemplate", void 0);
    tslib_1.__decorate([
        ContentChild(PopoverActionsTemplateDirective, { static: false }),
        tslib_1.__metadata("design:type", PopoverActionsTemplateDirective)
    ], PopoverComponent.prototype, "actionsTemplate", void 0);
    PopoverComponent = tslib_1.__decorate([
        Component({
            selector: 'kendo-popover',
            providers: [
                LocalizationService,
                {
                    provide: L10N_PREFIX,
                    useValue: 'kendo.popover'
                }
            ],
            template: "\n    <div *ngIf=\"visible\" role=\"tooltip\" class=\"k-popover\" [ngStyle]=\"{'width.px': width, 'height.px': height}\">\n        <div class=\"k-popover-callout\" [ngClass]=\"getCalloutPosition()\" *ngIf=\"callout\"></div>\n\n        <div *ngIf=\"titleTemplate || title\" class=\"k-popover-header\">\n            <ng-template *ngIf=\"titleTemplate\"\n                [ngTemplateOutlet]=\"titleTemplate?.templateRef\"\n                [ngTemplateOutletContext]=\"{ $implicit: anchor, data: contextData }\">\n            </ng-template>\n            <ng-container *ngIf=\"title && !titleTemplate\">\n                {{ title }}\n            </ng-container>\n        </div>\n\n        <div *ngIf=\"bodyTemplate || body\" class=\"k-popover-body\">\n            <ng-template *ngIf=\"bodyTemplate\"\n                [ngTemplateOutlet]=\"bodyTemplate?.templateRef\"\n                [ngTemplateOutletContext]=\"{ $implicit: anchor, data: contextData }\">\n            </ng-template>\n            <ng-container *ngIf=\"body && !bodyTemplate\">\n                {{ body }}\n            </ng-container>\n        </div>\n\n        <div *ngIf=\"actionsTemplate\" class=\"k-popover-actions k-actions k-hstack k-justify-content-between\">\n            <ng-template *ngIf=\"actionsTemplate\"\n                [ngTemplateOutlet]=\"actionsTemplate?.templateRef\"\n                [ngTemplateOutletContext]=\"{ $implicit: anchor, data: contextData }\">\n            </ng-template>\n        </div>\n    </div>\n    "
        }),
        tslib_1.__metadata("design:paramtypes", [LocalizationService])
    ], PopoverComponent);
    return PopoverComponent;
}());
export { PopoverComponent };
