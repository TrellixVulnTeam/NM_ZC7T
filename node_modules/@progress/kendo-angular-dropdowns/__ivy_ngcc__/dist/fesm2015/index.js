/**-----------------------------------------------------------------------------------------
* Copyright © 2021 Progress Software Corporation. All rights reserved.
* Licensed under commercial license. See LICENSE.md in the project root for more information
*-------------------------------------------------------------------------------------------*/
import { __decorate, __metadata, __param } from 'tslib';
import { EventEmitter, Input, Output, ViewChild, ElementRef, HostBinding, Component, Renderer2, Directive, TemplateRef, Injectable, ViewChildren, QueryList, ChangeDetectorRef, NgZone, InjectionToken, forwardRef, isDevMode, ContentChild, ViewContainerRef, Optional, Inject, HostListener, KeyValueDiffers, ContentChildren, ChangeDetectionStrategy, NgModule } from '@angular/core';
import { isDocumentAvailable, Keys, isChanged, hasObservers, KendoInput, anyChanged, guid, ResizeSensorModule, EventsModule } from '@progress/kendo-angular-common';
import { NG_VALUE_ACCESSOR, FormsModule } from '@angular/forms';
import { validatePackage } from '@progress/kendo-licensing';
import { getter, pointers, touchEnabled } from '@progress/kendo-common';
import { LocalizationService, L10N_PREFIX, ComponentMessages } from '@progress/kendo-angular-l10n';
import { merge, fromEvent, Subject, Subscription, of, interval } from 'rxjs';
import { PopupService, PopupModule } from '@progress/kendo-angular-popup';
import * as ɵngcc0 from '@angular/core';
import * as ɵngcc1 from '@progress/kendo-angular-l10n';
import * as ɵngcc2 from '@progress/kendo-angular-common';
import * as ɵngcc3 from '@angular/common';
import * as ɵngcc4 from '@progress/kendo-angular-popup';
import * as ɵngcc5 from '@angular/forms';
import * as ɵngcc6 from '@progress/kendo-angular-treeview';

const _c0 = ["input"];
const _c1 = function (a0, a1) { return { focus: a0, blur: a1 }; };
const _c2 = ["content"];
const _c3 = ["list"];
const _c4 = ["virtualContainer"];
function ListComponent_div_0_1_ng_template_0_Template(rf, ctx) { }
const _c5 = function (a0, a1) { return { templateRef: a0, $implicit: a1 }; };
function ListComponent_div_0_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵtemplate(0, ListComponent_div_0_1_ng_template_0_Template, 0, 0, "ng-template", 10);
} if (rf & 2) {
    const ctx_r7 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵproperty("templateContext", ɵngcc0.ɵɵpureFunction2(1, _c5, ctx_r7.fixedGroupTemplate.templateRef, ctx_r7.currentGroup));
} }
function ListComponent_div_0_ng_template_2_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "span");
    ɵngcc0.ɵɵtext(1);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r8 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵclassMap(ctx_r8.listGroupStickyHeaderTextClass);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵtextInterpolate(ctx_r8.currentGroup);
} }
const _c6 = function (a0, a1, a2) { return { "height.px": a0, "minHeight.px": a1, "boxSizing": a2 }; };
function ListComponent_div_0_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "div", 8);
    ɵngcc0.ɵɵtemplate(1, ListComponent_div_0_1_Template, 1, 4, null, 5);
    ɵngcc0.ɵɵtemplate(2, ListComponent_div_0_ng_template_2_Template, 2, 3, "ng-template", 9);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r0 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵclassMap(ctx_r0.listGroupStickyHeaderClass);
    ɵngcc0.ɵɵproperty("ngStyle", ɵngcc0.ɵɵpureFunction3(5, _c6, ctx_r0.virtual == null ? null : ctx_r0.virtual.itemHeight, ctx_r0.virtual == null ? null : ctx_r0.virtual.itemHeight, ctx_r0.virtual ? "border-box" : "inherit"));
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r0.fixedGroupTemplate);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", !ctx_r0.fixedGroupTemplate);
} }
function ListComponent_5_ng_template_0_input_1_Template(rf, ctx) { if (rf & 1) {
    const _r18 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementStart(0, "input", 14);
    ɵngcc0.ɵɵlistener("change", function ListComponent_5_ng_template_0_input_1_Template_input_change_0_listener($event) { ɵngcc0.ɵɵrestoreView(_r18); const itemIndex_r12 = ɵngcc0.ɵɵnextContext().index; const ctx_r16 = ɵngcc0.ɵɵnextContext(2); return ctx_r16.onCheckedChange($event, itemIndex_r12); });
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const itemIndex_r12 = ɵngcc0.ɵɵnextContext().index;
    const ctx_r13 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵproperty("ngClass", ctx_r13.checkboxClasses)("checked", ctx_r13.isChecked(itemIndex_r12));
} }
function ListComponent_5_ng_template_0_2_ng_template_0_Template(rf, ctx) { }
function ListComponent_5_ng_template_0_2_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵtemplate(0, ListComponent_5_ng_template_0_2_ng_template_0_Template, 0, 0, "ng-template", 10);
} if (rf & 2) {
    const dataItem_r11 = ɵngcc0.ɵɵnextContext().$implicit;
    const ctx_r14 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵproperty("templateContext", ɵngcc0.ɵɵpureFunction2(1, _c5, ctx_r14.template.templateRef, dataItem_r11));
} }
function ListComponent_5_ng_template_0_ng_template_3_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "span", 15);
    ɵngcc0.ɵɵtext(1);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const dataItem_r11 = ɵngcc0.ɵɵnextContext().$implicit;
    const ctx_r15 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵtextInterpolate(ctx_r15.getText(dataItem_r11));
} }
const _c7 = function (a0, a1) { return { "k-disabled": a0, "k-table-alt-row": a1 }; };
function ListComponent_5_ng_template_0_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "li", 12);
    ɵngcc0.ɵɵtemplate(1, ListComponent_5_ng_template_0_input_1_Template, 1, 2, "input", 13);
    ɵngcc0.ɵɵtemplate(2, ListComponent_5_ng_template_0_2_Template, 1, 4, null, 5);
    ɵngcc0.ɵɵtemplate(3, ListComponent_5_ng_template_0_ng_template_3_Template, 2, 1, "ng-template", 9);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const dataItem_r11 = ctx.$implicit;
    const itemIndex_r12 = ctx.index;
    const ctx_r10 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵclassMap(ctx_r10.listItemClass);
    ɵngcc0.ɵɵproperty("checkboxes", ctx_r10.checkboxes)("height", ctx_r10.virtual == null ? null : ctx_r10.virtual.itemHeight)("index", itemIndex_r12 + ctx_r10.startFrom)("multipleSelection", ctx_r10.multipleSelection)("ngClass", ɵngcc0.ɵɵpureFunction2(12, _c7, ctx_r10.isDisabled(itemIndex_r12), ctx_r10.isAltRow(itemIndex_r12)));
    ɵngcc0.ɵɵattribute("id", ctx_r10.optionPrefix + "-" + ctx_r10.getValue(dataItem_r11))("tabIndex", -1);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r10.checkboxes.enabled);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r10.template);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", !ctx_r10.template);
} }
function ListComponent_5_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵtemplate(0, ListComponent_5_ng_template_0_Template, 4, 15, "ng-template", 11);
} if (rf & 2) {
    const ctx_r3 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵproperty("ngForOf", ctx_r3.data);
} }
function ListComponent_6_ng_template_0_li_0_2_ng_template_0_Template(rf, ctx) { }
function ListComponent_6_ng_template_0_li_0_2_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵtemplate(0, ListComponent_6_ng_template_0_li_0_2_ng_template_0_Template, 0, 0, "ng-template", 10);
} if (rf & 2) {
    const dataItem_r24 = ɵngcc0.ɵɵnextContext(2).$implicit;
    const ctx_r28 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵproperty("templateContext", ɵngcc0.ɵɵpureFunction2(1, _c5, ctx_r28.groupTemplate.templateRef, dataItem_r24.value));
} }
function ListComponent_6_ng_template_0_li_0_ng_template_3_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵtext(0);
} if (rf & 2) {
    const dataItem_r24 = ɵngcc0.ɵɵnextContext(2).$implicit;
    ɵngcc0.ɵɵtextInterpolate(dataItem_r24.value);
} }
function ListComponent_6_ng_template_0_li_0_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "li", 18)(1, "span");
    ɵngcc0.ɵɵtemplate(2, ListComponent_6_ng_template_0_li_0_2_Template, 1, 4, null, 5);
    ɵngcc0.ɵɵtemplate(3, ListComponent_6_ng_template_0_li_0_ng_template_3_Template, 1, 1, "ng-template", 9);
    ɵngcc0.ɵɵelementEnd()();
} if (rf & 2) {
    const ctx_r33 = ɵngcc0.ɵɵnextContext();
    const itemIndex_r25 = ctx_r33.index;
    const dataItem_r24 = ctx_r33.$implicit;
    const ctx_r26 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵclassMap(ctx_r26.listGroupItemClass);
    ɵngcc0.ɵɵclassProp("k-table-alt-row", ctx_r26.isAltRow(itemIndex_r25 - 1));
    ɵngcc0.ɵɵproperty("ngStyle", ɵngcc0.ɵɵpureFunction3(12, _c6, ctx_r26.virtual == null ? null : ctx_r26.virtual.itemHeight, ctx_r26.virtual == null ? null : ctx_r26.virtual.itemHeight, ctx_r26.virtual ? "border-box" : "inherit"));
    ɵngcc0.ɵɵattribute("group-index", dataItem_r24.index)("id", ctx_r26.optionPrefix + "-" + ctx_r26.getValue(dataItem_r24.value))("tabIndex", -1);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵclassMap(ctx_r26.listGroupItemTextClass);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r26.groupTemplate);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", !ctx_r26.groupTemplate);
} }
function ListComponent_6_ng_template_0_li_1_1_ng_template_0_Template(rf, ctx) { }
function ListComponent_6_ng_template_0_li_1_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵtemplate(0, ListComponent_6_ng_template_0_li_1_1_ng_template_0_Template, 0, 0, "ng-template", 10);
} if (rf & 2) {
    const dataItem_r24 = ɵngcc0.ɵɵnextContext(2).$implicit;
    const ctx_r34 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵproperty("templateContext", ɵngcc0.ɵɵpureFunction2(1, _c5, ctx_r34.template.templateRef, dataItem_r24.value));
} }
function ListComponent_6_ng_template_0_li_1_ng_template_2_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "span", 15);
    ɵngcc0.ɵɵtext(1);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const dataItem_r24 = ɵngcc0.ɵɵnextContext(2).$implicit;
    const ctx_r35 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵtextInterpolate(ctx_r35.getText(dataItem_r24.value));
} }
function ListComponent_6_ng_template_0_li_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "li", 19);
    ɵngcc0.ɵɵtemplate(1, ListComponent_6_ng_template_0_li_1_1_Template, 1, 4, null, 5);
    ɵngcc0.ɵɵtemplate(2, ListComponent_6_ng_template_0_li_1_ng_template_2_Template, 2, 1, "ng-template", 9);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r39 = ɵngcc0.ɵɵnextContext();
    const dataItem_r24 = ctx_r39.$implicit;
    const itemIndex_r25 = ctx_r39.index;
    const ctx_r27 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵclassMap(ctx_r27.listItemClass);
    ɵngcc0.ɵɵproperty("height", ctx_r27.virtual == null ? null : ctx_r27.virtual.itemHeight)("index", dataItem_r24.offsetIndex)("multipleSelection", ctx_r27.multipleSelection)("ngClass", ɵngcc0.ɵɵpureFunction2(11, _c7, ctx_r27.isDisabled(dataItem_r24.offsetIndex), ctx_r27.isAltRow(itemIndex_r25 - 1)));
    ɵngcc0.ɵɵattribute("absolute-index", dataItem_r24.index)("id", ctx_r27.optionPrefix + "-" + ctx_r27.getValue(dataItem_r24.value))("tabIndex", -1);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r27.template);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", !ctx_r27.template);
} }
function ListComponent_6_ng_template_0_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵtemplate(0, ListComponent_6_ng_template_0_li_0_Template, 4, 16, "li", 16);
    ɵngcc0.ɵɵtemplate(1, ListComponent_6_ng_template_0_li_1_Template, 3, 14, "li", 17);
} if (rf & 2) {
    const dataItem_r24 = ctx.$implicit;
    ɵngcc0.ɵɵproperty("ngIf", dataItem_r24.header && dataItem_r24.index > 0);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", !dataItem_r24.header);
} }
function ListComponent_6_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵtemplate(0, ListComponent_6_ng_template_0_Template, 2, 2, "ng-template", 11);
} if (rf & 2) {
    const ctx_r4 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵproperty("ngForOf", ctx_r4.data);
} }
function ListComponent_kendo_resize_sensor_7_Template(rf, ctx) { if (rf & 1) {
    const _r41 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementStart(0, "kendo-resize-sensor", 20);
    ɵngcc0.ɵɵlistener("resize", function ListComponent_kendo_resize_sensor_7_Template_kendo_resize_sensor_resize_0_listener() { ɵngcc0.ɵɵrestoreView(_r41); const ctx_r40 = ɵngcc0.ɵɵnextContext(); return ctx_r40.listResize.emit(); });
    ɵngcc0.ɵɵelementEnd();
} }
function ListComponent_div_8_Template(rf, ctx) { if (rf & 1) {
    const _r44 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementStart(0, "div", 21, 22)(2, "div")(3, "kendo-resize-sensor", 20);
    ɵngcc0.ɵɵlistener("resize", function ListComponent_div_8_Template_kendo_resize_sensor_resize_3_listener() { ɵngcc0.ɵɵrestoreView(_r44); const ctx_r43 = ɵngcc0.ɵɵnextContext(); return ctx_r43.listResize.emit(); });
    ɵngcc0.ɵɵelementEnd()()();
} if (rf & 2) {
    const ctx_r6 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵadvance(2);
    ɵngcc0.ɵɵstyleProp("height", ctx_r6.scrollHeight, "px");
} }
const _c8 = ["container"];
const _c9 = ["popupTemplate"];
const _c10 = ["optionsList"];
function AutoCompleteComponent_span_3_Template(rf, ctx) { if (rf & 1) {
    const _r8 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementStart(0, "span", 8);
    ɵngcc0.ɵɵlistener("click", function AutoCompleteComponent_span_3_Template_span_click_0_listener($event) { ɵngcc0.ɵɵrestoreView(_r8); const ctx_r7 = ɵngcc0.ɵɵnextContext(); return ctx_r7.clearValue($event); })("mousedown", function AutoCompleteComponent_span_3_Template_span_mousedown_0_listener($event) { return $event.preventDefault(); });
    ɵngcc0.ɵɵelement(1, "span", 9);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r1 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵstyleProp("visibility", ctx_r1.clearButtonVisiblity);
    ɵngcc0.ɵɵattribute("title", ctx_r1.messageFor("clearTitle"));
} }
function AutoCompleteComponent_span_4_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelement(0, "span", 10);
} }
function AutoCompleteComponent_ng_template_5_0_ng_template_0_Template(rf, ctx) { }
const _c15 = function (a0) { return { templateRef: a0 }; };
function AutoCompleteComponent_ng_template_5_0_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵtemplate(0, AutoCompleteComponent_ng_template_5_0_ng_template_0_Template, 0, 0, "ng-template", 15);
} if (rf & 2) {
    const ctx_r10 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵproperty("templateContext", ɵngcc0.ɵɵpureFunction1(1, _c15, ctx_r10.headerTemplate.templateRef));
} }
function AutoCompleteComponent_ng_template_5_div_3_ng_template_1_Template(rf, ctx) { }
function AutoCompleteComponent_ng_template_5_div_3_ng_template_2_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "div");
    ɵngcc0.ɵɵtext(1);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r16 = ɵngcc0.ɵɵnextContext(3);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵtextInterpolate(ctx_r16.messageFor("noDataText"));
} }
function AutoCompleteComponent_ng_template_5_div_3_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "div", 16);
    ɵngcc0.ɵɵtemplate(1, AutoCompleteComponent_ng_template_5_div_3_ng_template_1_Template, 0, 0, "ng-template", 17);
    ɵngcc0.ɵɵtemplate(2, AutoCompleteComponent_ng_template_5_div_3_ng_template_2_Template, 2, 1, "ng-template", 6);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r12 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r12.noDataTemplate)("templateContext", ɵngcc0.ɵɵpureFunction1(3, _c15, ctx_r12.noDataTemplate == null ? null : ctx_r12.noDataTemplate.templateRef));
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", !ctx_r12.noDataTemplate);
} }
function AutoCompleteComponent_ng_template_5_4_ng_template_0_Template(rf, ctx) { }
function AutoCompleteComponent_ng_template_5_4_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵtemplate(0, AutoCompleteComponent_ng_template_5_4_ng_template_0_Template, 0, 0, "ng-template", 15);
} if (rf & 2) {
    const ctx_r13 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵproperty("templateContext", ɵngcc0.ɵɵpureFunction1(1, _c15, ctx_r13.footerTemplate.templateRef));
} }
function AutoCompleteComponent_ng_template_5_Template(rf, ctx) { if (rf & 1) {
    const _r19 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵtemplate(0, AutoCompleteComponent_ng_template_5_0_Template, 1, 3, null, 11);
    ɵngcc0.ɵɵelementStart(1, "kendo-list", 12, 13);
    ɵngcc0.ɵɵlistener("pageChange", function AutoCompleteComponent_ng_template_5_Template_kendo_list_pageChange_1_listener($event) { ɵngcc0.ɵɵrestoreView(_r19); const ctx_r18 = ɵngcc0.ɵɵnextContext(); return ctx_r18.pageChange($event); });
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵtemplate(3, AutoCompleteComponent_ng_template_5_div_3_Template, 3, 5, "div", 14);
    ɵngcc0.ɵɵtemplate(4, AutoCompleteComponent_ng_template_5_4_Template, 1, 3, null, 11);
} if (rf & 2) {
    const ctx_r4 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵproperty("ngIf", ctx_r4.headerTemplate);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("size", ctx_r4.size)("rounded", ctx_r4.rounded)("id", ctx_r4.listBoxId)("optionPrefix", ctx_r4.optionPrefix)("data", ctx_r4.data)("textField", ctx_r4.valueField)("valueField", ctx_r4.valueField)("template", ctx_r4.template)("groupTemplate", ctx_r4.groupTemplate)("fixedGroupTemplate", ctx_r4.fixedGroupTemplate)("height", ctx_r4.listHeight)("show", ctx_r4.isOpen)("virtual", ctx_r4.virtual);
    ɵngcc0.ɵɵadvance(2);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r4.data.length === 0);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r4.footerTemplate);
} }
function AutoCompleteComponent_ng_template_7_Template(rf, ctx) { if (rf & 1) {
    const _r21 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementStart(0, "kendo-resize-sensor", 18);
    ɵngcc0.ɵɵlistener("resize", function AutoCompleteComponent_ng_template_7_Template_kendo_resize_sensor_resize_0_listener() { ɵngcc0.ɵɵrestoreView(_r21); const ctx_r20 = ɵngcc0.ɵɵnextContext(); return ctx_r20.onResize(); });
    ɵngcc0.ɵɵelementEnd();
} }
const _c16 = ["select"];
const _c23 = function (a0) { return { mousedown: a0 }; };
function ComboBoxComponent_span_3_Template(rf, ctx) { if (rf & 1) {
    const _r8 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementStart(0, "span", 10);
    ɵngcc0.ɵɵlistener("click", function ComboBoxComponent_span_3_Template_span_click_0_listener($event) { ɵngcc0.ɵɵrestoreView(_r8); const ctx_r7 = ɵngcc0.ɵɵnextContext(); return ctx_r7.clearValue($event); });
    ɵngcc0.ɵɵelement(1, "span", 11);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r1 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵstyleProp("visibility", ctx_r1.clearButtonVisiblity);
    ɵngcc0.ɵɵproperty("kendoEventsOutsideAngular", ɵngcc0.ɵɵpureFunction1(4, _c23, ctx_r1.preventEventDefault));
    ɵngcc0.ɵɵattribute("title", ctx_r1.messageFor("clearTitle"));
} }
function ComboBoxComponent_ng_template_7_0_ng_template_0_Template(rf, ctx) { }
function ComboBoxComponent_ng_template_7_0_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵtemplate(0, ComboBoxComponent_ng_template_7_0_ng_template_0_Template, 0, 0, "ng-template", 16);
} if (rf & 2) {
    const ctx_r9 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵproperty("templateContext", ɵngcc0.ɵɵpureFunction1(1, _c15, ctx_r9.headerTemplate.templateRef));
} }
function ComboBoxComponent_ng_template_7_div_3_ng_template_1_Template(rf, ctx) { }
function ComboBoxComponent_ng_template_7_div_3_ng_template_2_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "div");
    ɵngcc0.ɵɵtext(1);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r15 = ɵngcc0.ɵɵnextContext(3);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵtextInterpolate(ctx_r15.messageFor("noDataText"));
} }
function ComboBoxComponent_ng_template_7_div_3_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "div", 17);
    ɵngcc0.ɵɵtemplate(1, ComboBoxComponent_ng_template_7_div_3_ng_template_1_Template, 0, 0, "ng-template", 18);
    ɵngcc0.ɵɵtemplate(2, ComboBoxComponent_ng_template_7_div_3_ng_template_2_Template, 2, 1, "ng-template", 8);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r11 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r11.noDataTemplate)("templateContext", ɵngcc0.ɵɵpureFunction1(3, _c15, ctx_r11.noDataTemplate ? ctx_r11.noDataTemplate.templateRef : undefined));
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", !ctx_r11.noDataTemplate);
} }
function ComboBoxComponent_ng_template_7_4_ng_template_0_Template(rf, ctx) { }
function ComboBoxComponent_ng_template_7_4_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵtemplate(0, ComboBoxComponent_ng_template_7_4_ng_template_0_Template, 0, 0, "ng-template", 16);
} if (rf & 2) {
    const ctx_r12 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵproperty("templateContext", ɵngcc0.ɵɵpureFunction1(1, _c15, ctx_r12.footerTemplate.templateRef));
} }
function ComboBoxComponent_ng_template_7_Template(rf, ctx) { if (rf & 1) {
    const _r18 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵtemplate(0, ComboBoxComponent_ng_template_7_0_Template, 1, 3, null, 12);
    ɵngcc0.ɵɵelementStart(1, "kendo-list", 13, 14);
    ɵngcc0.ɵɵlistener("pageChange", function ComboBoxComponent_ng_template_7_Template_kendo_list_pageChange_1_listener($event) { ɵngcc0.ɵɵrestoreView(_r18); const ctx_r17 = ɵngcc0.ɵɵnextContext(); return ctx_r17.pageChange($event); });
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵtemplate(3, ComboBoxComponent_ng_template_7_div_3_Template, 3, 5, "div", 15);
    ɵngcc0.ɵɵtemplate(4, ComboBoxComponent_ng_template_7_4_Template, 1, 3, null, 12);
} if (rf & 2) {
    const ctx_r4 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵproperty("ngIf", ctx_r4.headerTemplate);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("size", ctx_r4.size)("rounded", ctx_r4.rounded)("id", ctx_r4.listBoxId)("optionPrefix", ctx_r4.optionPrefix)("data", ctx_r4.data)("textField", ctx_r4.textField)("valueField", ctx_r4.valueField)("template", ctx_r4.template)("groupTemplate", ctx_r4.groupTemplate)("fixedGroupTemplate", ctx_r4.fixedGroupTemplate)("height", ctx_r4.listHeight)("show", ctx_r4.isOpen)("virtual", ctx_r4.virtual);
    ɵngcc0.ɵɵadvance(2);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r4.data.length === 0);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r4.footerTemplate);
} }
function ComboBoxComponent_ng_template_9_Template(rf, ctx) { if (rf & 1) {
    const _r20 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementStart(0, "kendo-resize-sensor", 19);
    ɵngcc0.ɵɵlistener("resize", function ComboBoxComponent_ng_template_9_Template_kendo_resize_sensor_resize_0_listener() { ɵngcc0.ɵɵrestoreView(_r20); const ctx_r19 = ɵngcc0.ɵɵnextContext(); return ctx_r19.onResize(); });
    ɵngcc0.ɵɵelementEnd();
} }
function DropDownListComponent_3_ng_template_0_Template(rf, ctx) { }
function DropDownListComponent_3_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵtemplate(0, DropDownListComponent_3_ng_template_0_Template, 0, 0, "ng-template", 9);
} if (rf & 2) {
    const ctx_r0 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵproperty("templateContext", ɵngcc0.ɵɵpureFunction2(1, _c5, ctx_r0.valueTemplate.templateRef, ctx_r0.dataItem));
} }
function DropDownListComponent_ng_template_4_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵtext(0);
} if (rf & 2) {
    const ctx_r1 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵtextInterpolate(ctx_r1.getText());
} }
function DropDownListComponent_ng_template_7_ng_template_0_Template(rf, ctx) { if (rf & 1) {
    const _r16 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementStart(0, "div", 13);
    ɵngcc0.ɵɵlistener("click", function DropDownListComponent_ng_template_7_ng_template_0_Template_div_click_0_listener($event) { return $event.stopImmediatePropagation(); });
    ɵngcc0.ɵɵelementStart(1, "span", 14);
    ɵngcc0.ɵɵelement(2, "span", 15);
    ɵngcc0.ɵɵelementStart(3, "input", 16);
    ɵngcc0.ɵɵlistener("ngModelChange", function DropDownListComponent_ng_template_7_ng_template_0_Template_input_ngModelChange_3_listener($event) { ɵngcc0.ɵɵrestoreView(_r16); const ctx_r15 = ɵngcc0.ɵɵnextContext(2); return ctx_r15.filterText = $event; })("keydown", function DropDownListComponent_ng_template_7_ng_template_0_Template_input_keydown_3_listener($event) { ɵngcc0.ɵɵrestoreView(_r16); const ctx_r17 = ɵngcc0.ɵɵnextContext(2); return ctx_r17.keydown($event); })("input", function DropDownListComponent_ng_template_7_ng_template_0_Template_input_input_3_listener($event) { ɵngcc0.ɵɵrestoreView(_r16); const ctx_r18 = ɵngcc0.ɵɵnextContext(2); return ctx_r18.handleFilter($event); })("focus", function DropDownListComponent_ng_template_7_ng_template_0_Template_input_focus_3_listener() { ɵngcc0.ɵɵrestoreView(_r16); const ctx_r19 = ɵngcc0.ɵɵnextContext(2); return ctx_r19.onFilterFocus(); })("blur", function DropDownListComponent_ng_template_7_ng_template_0_Template_input_blur_3_listener() { ɵngcc0.ɵɵrestoreView(_r16); const ctx_r20 = ɵngcc0.ɵɵnextContext(2); return ctx_r20.blurFilterInput(); });
    ɵngcc0.ɵɵelementEnd()()();
} if (rf & 2) {
    const ctx_r7 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngClass", ctx_r7.filterInputClasses);
    ɵngcc0.ɵɵadvance(2);
    ɵngcc0.ɵɵproperty("filterInput", ctx_r7.isFocused && !ctx_r7.touchEnabled)("dir", ctx_r7.direction)("ngModel", ctx_r7.filterText);
    ɵngcc0.ɵɵattribute("aria-owns", ctx_r7.ariaOwns)("aria-activedescendant", ctx_r7.ariaActivedescendant)("aria-label", ctx_r7.noDataLabel);
} }
const _c28 = function (a0) { return { "k-disabled": a0 }; };
function DropDownListComponent_ng_template_7_ng_template_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "div", 17)(1, "div", 18);
    ɵngcc0.ɵɵtext(2);
    ɵngcc0.ɵɵelementEnd()();
} if (rf & 2) {
    const ctx_r8 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵproperty("ngClass", ctx_r8.optionLabelSizeClass);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngClass", ɵngcc0.ɵɵpureFunction1(4, _c28, ctx_r8.isDisabledDefaultItem))("index", -1);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵtextInterpolate1(" ", ctx_r8.getDefaultItemText(), " ");
} }
function DropDownListComponent_ng_template_7_ng_template_2_ng_template_2_Template(rf, ctx) { }
function DropDownListComponent_ng_template_7_ng_template_2_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "div", 17)(1, "div", 18);
    ɵngcc0.ɵɵtemplate(2, DropDownListComponent_ng_template_7_ng_template_2_ng_template_2_Template, 0, 0, "ng-template", 9);
    ɵngcc0.ɵɵelementEnd()();
} if (rf & 2) {
    const ctx_r9 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵproperty("ngClass", ctx_r9.optionLabelSizeClass);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngClass", ɵngcc0.ɵɵpureFunction1(4, _c28, ctx_r9.isDisabledDefaultItem))("index", -1);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("templateContext", ɵngcc0.ɵɵpureFunction2(6, _c5, ctx_r9.itemTemplate.templateRef, ctx_r9.defaultItem));
} }
function DropDownListComponent_ng_template_7_3_ng_template_0_Template(rf, ctx) { }
function DropDownListComponent_ng_template_7_3_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵtemplate(0, DropDownListComponent_ng_template_7_3_ng_template_0_Template, 0, 0, "ng-template", 9);
} if (rf & 2) {
    const ctx_r10 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵproperty("templateContext", ɵngcc0.ɵɵpureFunction1(1, _c15, ctx_r10.headerTemplate.templateRef));
} }
function DropDownListComponent_ng_template_7_div_6_ng_template_1_Template(rf, ctx) { }
function DropDownListComponent_ng_template_7_div_6_ng_template_2_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "div");
    ɵngcc0.ɵɵtext(1);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r24 = ɵngcc0.ɵɵnextContext(3);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵtextInterpolate(ctx_r24.messageFor("noDataText"));
} }
function DropDownListComponent_ng_template_7_div_6_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "div", 19);
    ɵngcc0.ɵɵtemplate(1, DropDownListComponent_ng_template_7_div_6_ng_template_1_Template, 0, 0, "ng-template", 20);
    ɵngcc0.ɵɵtemplate(2, DropDownListComponent_ng_template_7_div_6_ng_template_2_Template, 2, 1, "ng-template", 4);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r12 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r12.noDataTemplate)("templateContext", ɵngcc0.ɵɵpureFunction1(3, _c15, ctx_r12.noDataTemplate ? ctx_r12.noDataTemplate.templateRef : undefined));
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", !ctx_r12.noDataTemplate);
} }
function DropDownListComponent_ng_template_7_7_ng_template_0_Template(rf, ctx) { }
function DropDownListComponent_ng_template_7_7_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵtemplate(0, DropDownListComponent_ng_template_7_7_ng_template_0_Template, 0, 0, "ng-template", 9);
} if (rf & 2) {
    const ctx_r13 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵproperty("templateContext", ɵngcc0.ɵɵpureFunction1(1, _c15, ctx_r13.footerTemplate.templateRef));
} }
function DropDownListComponent_ng_template_7_Template(rf, ctx) { if (rf & 1) {
    const _r27 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵtemplate(0, DropDownListComponent_ng_template_7_ng_template_0_Template, 4, 7, "ng-template", 4);
    ɵngcc0.ɵɵtemplate(1, DropDownListComponent_ng_template_7_ng_template_1_Template, 3, 6, "ng-template", 4);
    ɵngcc0.ɵɵtemplate(2, DropDownListComponent_ng_template_7_ng_template_2_Template, 3, 9, "ng-template", 4);
    ɵngcc0.ɵɵtemplate(3, DropDownListComponent_ng_template_7_3_Template, 1, 3, null, 3);
    ɵngcc0.ɵɵelementStart(4, "kendo-list", 10, 11);
    ɵngcc0.ɵɵlistener("pageChange", function DropDownListComponent_ng_template_7_Template_kendo_list_pageChange_4_listener($event) { ɵngcc0.ɵɵrestoreView(_r27); const ctx_r26 = ɵngcc0.ɵɵnextContext(); return ctx_r26.pageChange($event); });
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵtemplate(6, DropDownListComponent_ng_template_7_div_6_Template, 3, 5, "div", 12);
    ɵngcc0.ɵɵtemplate(7, DropDownListComponent_ng_template_7_7_Template, 1, 3, null, 3);
} if (rf & 2) {
    const ctx_r3 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵproperty("ngIf", ctx_r3.filterable);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r3.defaultItem && !ctx_r3.itemTemplate);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r3.defaultItem && ctx_r3.itemTemplate);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r3.headerTemplate);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("size", ctx_r3.size)("rounded", ctx_r3.rounded)("id", ctx_r3.listBoxId)("optionPrefix", ctx_r3.optionPrefix)("data", ctx_r3.data)("textField", ctx_r3.textField)("valueField", ctx_r3.valueField)("template", ctx_r3.itemTemplate)("groupTemplate", ctx_r3.groupTemplate)("fixedGroupTemplate", ctx_r3.fixedGroupTemplate)("height", ctx_r3.listHeight)("show", ctx_r3.isOpen)("virtual", ctx_r3.virtual);
    ɵngcc0.ɵɵadvance(2);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r3.data.length === 0);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r3.footerTemplate);
} }
function DropDownListComponent_ng_template_9_Template(rf, ctx) { if (rf & 1) {
    const _r29 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementStart(0, "kendo-resize-sensor", 21);
    ɵngcc0.ɵɵlistener("resize", function DropDownListComponent_ng_template_9_Template_kendo_resize_sensor_resize_0_listener() { ɵngcc0.ɵɵrestoreView(_r29); const ctx_r28 = ɵngcc0.ɵɵnextContext(); return ctx_r28.onResize(); });
    ɵngcc0.ɵɵelementEnd();
} }
function MultiSelectComponent_span_4_Template(rf, ctx) { if (rf & 1) {
    const _r8 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementStart(0, "span", 9);
    ɵngcc0.ɵɵlistener("mousedown", function MultiSelectComponent_span_4_Template_span_mousedown_0_listener($event) { ɵngcc0.ɵɵrestoreView(_r8); const ctx_r7 = ɵngcc0.ɵɵnextContext(); return ctx_r7.clearAll($event); });
    ɵngcc0.ɵɵelement(1, "span", 10);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r1 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵstyleProp("visibility", ctx_r1.clearButtonVisiblity);
    ɵngcc0.ɵɵattribute("title", ctx_r1.messageFor("clearTitle"));
} }
function MultiSelectComponent_span_5_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelement(0, "span", 11);
} }
function MultiSelectComponent_ng_template_6_0_ng_template_0_Template(rf, ctx) { }
function MultiSelectComponent_ng_template_6_0_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵtemplate(0, MultiSelectComponent_ng_template_6_0_ng_template_0_Template, 0, 0, "ng-template", 17);
} if (rf & 2) {
    const ctx_r9 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵproperty("templateContext", ɵngcc0.ɵɵpureFunction1(1, _c15, ctx_r9.headerTemplate.templateRef));
} }
function MultiSelectComponent_ng_template_6_div_1_2_ng_template_0_Template(rf, ctx) { }
function MultiSelectComponent_ng_template_6_div_1_2_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵtemplate(0, MultiSelectComponent_ng_template_6_div_1_2_ng_template_0_Template, 0, 0, "ng-template", 17);
} if (rf & 2) {
    const ctx_r15 = ɵngcc0.ɵɵnextContext(3);
    ɵngcc0.ɵɵproperty("templateContext", ɵngcc0.ɵɵpureFunction2(1, _c5, ctx_r15.customItemTemplate.templateRef, ctx_r15.text));
} }
function MultiSelectComponent_ng_template_6_div_1_ng_template_3_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵtext(0);
} if (rf & 2) {
    const ctx_r17 = ɵngcc0.ɵɵnextContext(3);
    ɵngcc0.ɵɵtextInterpolate(ctx_r17.text);
} }
function MultiSelectComponent_ng_template_6_div_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "div", 18)(1, "div", 19);
    ɵngcc0.ɵɵtemplate(2, MultiSelectComponent_ng_template_6_div_1_2_Template, 1, 4, null, 20);
    ɵngcc0.ɵɵtemplate(3, MultiSelectComponent_ng_template_6_div_1_ng_template_3_Template, 1, 1, "ng-template", null, 21, ɵngcc0.ɵɵtemplateRefExtractor);
    ɵngcc0.ɵɵelement(5, "span", 22);
    ɵngcc0.ɵɵelementEnd()();
} if (rf & 2) {
    const _r16 = ɵngcc0.ɵɵreference(4);
    const ctx_r10 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵproperty("ngClass", ctx_r10.customItemSizeClass);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("multipleSelection", true)("index", -1);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r10.customItemTemplate)("ngIfElse", _r16);
} }
function MultiSelectComponent_ng_template_6_div_4_ng_template_1_Template(rf, ctx) { }
function MultiSelectComponent_ng_template_6_div_4_ng_template_2_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "div");
    ɵngcc0.ɵɵtext(1);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r20 = ɵngcc0.ɵɵnextContext(3);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵtextInterpolate(ctx_r20.messageFor("noDataText"));
} }
function MultiSelectComponent_ng_template_6_div_4_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "div", 23);
    ɵngcc0.ɵɵtemplate(1, MultiSelectComponent_ng_template_6_div_4_ng_template_1_Template, 0, 0, "ng-template", 24);
    ɵngcc0.ɵɵtemplate(2, MultiSelectComponent_ng_template_6_div_4_ng_template_2_Template, 2, 1, "ng-template", 7);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r12 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r12.noDataTemplate)("templateContext", ɵngcc0.ɵɵpureFunction1(3, _c15, ctx_r12.noDataTemplate ? ctx_r12.noDataTemplate.templateRef : undefined));
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", !ctx_r12.noDataTemplate);
} }
function MultiSelectComponent_ng_template_6_5_ng_template_0_Template(rf, ctx) { }
function MultiSelectComponent_ng_template_6_5_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵtemplate(0, MultiSelectComponent_ng_template_6_5_ng_template_0_Template, 0, 0, "ng-template", 17);
} if (rf & 2) {
    const ctx_r13 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵproperty("templateContext", ɵngcc0.ɵɵpureFunction1(1, _c15, ctx_r13.footerTemplate.templateRef));
} }
function MultiSelectComponent_ng_template_6_Template(rf, ctx) { if (rf & 1) {
    const _r23 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵtemplate(0, MultiSelectComponent_ng_template_6_0_Template, 1, 3, null, 12);
    ɵngcc0.ɵɵtemplate(1, MultiSelectComponent_ng_template_6_div_1_Template, 6, 5, "div", 13);
    ɵngcc0.ɵɵelementStart(2, "kendo-list", 14, 15);
    ɵngcc0.ɵɵlistener("pageChange", function MultiSelectComponent_ng_template_6_Template_kendo_list_pageChange_2_listener($event) { ɵngcc0.ɵɵrestoreView(_r23); const ctx_r22 = ɵngcc0.ɵɵnextContext(); return ctx_r22.pageChange($event); });
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵtemplate(4, MultiSelectComponent_ng_template_6_div_4_Template, 3, 5, "div", 16);
    ɵngcc0.ɵɵtemplate(5, MultiSelectComponent_ng_template_6_5_Template, 1, 3, null, 12);
} if (rf & 2) {
    const ctx_r4 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵproperty("ngIf", ctx_r4.headerTemplate);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r4.allowCustom && ctx_r4.text);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("size", ctx_r4.size)("rounded", ctx_r4.rounded)("id", ctx_r4.listBoxId)("optionPrefix", ctx_r4.optionPrefix)("data", ctx_r4.data)("textField", ctx_r4.textField)("valueField", ctx_r4.valueField)("height", ctx_r4.listHeight)("template", ctx_r4.template)("groupTemplate", ctx_r4.groupTemplate)("fixedGroupTemplate", ctx_r4.fixedGroupTemplate)("show", ctx_r4.isOpen)("multipleSelection", true)("virtual", ctx_r4.virtual)("checkboxes", ctx_r4.checkboxes);
    ɵngcc0.ɵɵadvance(2);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r4.data.length === 0);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r4.footerTemplate);
} }
function MultiSelectComponent_ng_template_8_Template(rf, ctx) { if (rf & 1) {
    const _r25 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementStart(0, "kendo-resize-sensor", 25);
    ɵngcc0.ɵɵlistener("resize", function MultiSelectComponent_ng_template_8_Template_kendo_resize_sensor_resize_0_listener() { ɵngcc0.ɵɵrestoreView(_r25); const ctx_r24 = ɵngcc0.ɵɵnextContext(); return ctx_r24.onResize(); });
    ɵngcc0.ɵɵelementEnd();
} }
const _c33 = ["header"];
function MultiColumnComboBoxComponent_span_3_Template(rf, ctx) { if (rf & 1) {
    const _r8 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementStart(0, "span", 10);
    ɵngcc0.ɵɵlistener("click", function MultiColumnComboBoxComponent_span_3_Template_span_click_0_listener($event) { ɵngcc0.ɵɵrestoreView(_r8); const ctx_r7 = ɵngcc0.ɵɵnextContext(); return ctx_r7.clearValue($event); });
    ɵngcc0.ɵɵelement(1, "span", 11);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r1 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵstyleProp("visibility", ctx_r1.clearButtonVisiblity);
    ɵngcc0.ɵɵproperty("kendoEventsOutsideAngular", ɵngcc0.ɵɵpureFunction1(4, _c23, ctx_r1.preventEventDefault));
    ɵngcc0.ɵɵattribute("title", ctx_r1.messageFor("clearTitle"));
} }
function MultiColumnComboBoxComponent_ng_template_7_0_ng_template_0_Template(rf, ctx) { }
function MultiColumnComboBoxComponent_ng_template_7_0_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵtemplate(0, MultiColumnComboBoxComponent_ng_template_7_0_ng_template_0_Template, 0, 0, "ng-template", 25);
} if (rf & 2) {
    const ctx_r9 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵproperty("templateContext", ɵngcc0.ɵɵpureFunction1(1, _c15, ctx_r9.headerTemplate == null ? null : ctx_r9.headerTemplate.templateRef));
} }
function MultiColumnComboBoxComponent_ng_template_7_ng_container_7_col_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelement(0, "col");
} if (rf & 2) {
    const column_r19 = ɵngcc0.ɵɵnextContext().$implicit;
    ɵngcc0.ɵɵstyleProp("width", column_r19.width, "px");
} }
function MultiColumnComboBoxComponent_ng_template_7_ng_container_7_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵtemplate(1, MultiColumnComboBoxComponent_ng_template_7_ng_container_7_col_1_Template, 1, 2, "col", 26);
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const column_r19 = ctx.$implicit;
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", !column_r19.hidden && column_r19.matchesMedia);
} }
function MultiColumnComboBoxComponent_ng_template_7_ng_container_10_th_1_ng_container_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵtext(1);
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const column_r22 = ɵngcc0.ɵɵnextContext(2).$implicit;
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵtextInterpolate1(" ", column_r22.title || column_r22.field, " ");
} }
function MultiColumnComboBoxComponent_ng_template_7_ng_container_10_th_1_2_ng_template_0_Template(rf, ctx) { }
const _c38 = function (a0, a1, a2) { return { templateRef: a0, $implicit: a1, column: a2 }; };
function MultiColumnComboBoxComponent_ng_template_7_ng_container_10_th_1_2_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵtemplate(0, MultiColumnComboBoxComponent_ng_template_7_ng_container_10_th_1_2_ng_template_0_Template, 0, 0, "ng-template", 25);
} if (rf & 2) {
    const column_r22 = ɵngcc0.ɵɵnextContext(2).$implicit;
    ɵngcc0.ɵɵproperty("templateContext", ɵngcc0.ɵɵpureFunction3(1, _c38, column_r22.headerTemplate == null ? null : column_r22.headerTemplate.templateRef, column_r22, column_r22));
} }
function MultiColumnComboBoxComponent_ng_template_7_ng_container_10_th_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "th", 28);
    ɵngcc0.ɵɵtemplate(1, MultiColumnComboBoxComponent_ng_template_7_ng_container_10_th_1_ng_container_1_Template, 2, 1, "ng-container", 12);
    ɵngcc0.ɵɵtemplate(2, MultiColumnComboBoxComponent_ng_template_7_ng_container_10_th_1_2_Template, 1, 5, null, 12);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const column_r22 = ɵngcc0.ɵɵnextContext().$implicit;
    ɵngcc0.ɵɵproperty("ngStyle", column_r22.headerStyle)("ngClass", column_r22.headerClass);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", !column_r22.headerTemplate);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", column_r22.headerTemplate);
} }
function MultiColumnComboBoxComponent_ng_template_7_ng_container_10_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵtemplate(1, MultiColumnComboBoxComponent_ng_template_7_ng_container_10_th_1_Template, 3, 4, "th", 27);
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const column_r22 = ctx.$implicit;
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", !column_r22.hidden && column_r22.matchesMedia);
} }
function MultiColumnComboBoxComponent_ng_template_7_ng_template_11_ng_container_0_span_1_ng_container_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵtext(1);
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const column_r32 = ɵngcc0.ɵɵnextContext(2).$implicit;
    const dataItem_r30 = ɵngcc0.ɵɵnextContext().$implicit;
    const ctx_r34 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵtextInterpolate1(" ", ctx_r34.textFrom(dataItem_r30, column_r32.field), " ");
} }
function MultiColumnComboBoxComponent_ng_template_7_ng_template_11_ng_container_0_span_1_2_ng_template_0_Template(rf, ctx) { }
const _c39 = function (a0, a1, a2, a3) { return { templateRef: a0, $implicit: a1, dataItem: a2, column: a3 }; };
function MultiColumnComboBoxComponent_ng_template_7_ng_template_11_ng_container_0_span_1_2_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵtemplate(0, MultiColumnComboBoxComponent_ng_template_7_ng_template_11_ng_container_0_span_1_2_ng_template_0_Template, 0, 0, "ng-template", 25);
} if (rf & 2) {
    const column_r32 = ɵngcc0.ɵɵnextContext(2).$implicit;
    const dataItem_r30 = ɵngcc0.ɵɵnextContext().$implicit;
    ɵngcc0.ɵɵproperty("templateContext", ɵngcc0.ɵɵpureFunction4(1, _c39, column_r32.cellTemplate == null ? null : column_r32.cellTemplate.templateRef, dataItem_r30, dataItem_r30, column_r32));
} }
function MultiColumnComboBoxComponent_ng_template_7_ng_template_11_ng_container_0_span_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "span", 30);
    ɵngcc0.ɵɵtemplate(1, MultiColumnComboBoxComponent_ng_template_7_ng_template_11_ng_container_0_span_1_ng_container_1_Template, 2, 1, "ng-container", 12);
    ɵngcc0.ɵɵtemplate(2, MultiColumnComboBoxComponent_ng_template_7_ng_template_11_ng_container_0_span_1_2_Template, 1, 6, null, 12);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const column_r32 = ɵngcc0.ɵɵnextContext().$implicit;
    ɵngcc0.ɵɵstyleProp("width", column_r32.width, "px");
    ɵngcc0.ɵɵproperty("ngClass", column_r32.class)("ngStyle", column_r32.style);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", !column_r32.cellTemplate);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", column_r32.cellTemplate);
} }
function MultiColumnComboBoxComponent_ng_template_7_ng_template_11_ng_container_0_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵtemplate(1, MultiColumnComboBoxComponent_ng_template_7_ng_template_11_ng_container_0_span_1_Template, 3, 6, "span", 29);
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const column_r32 = ctx.$implicit;
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", !column_r32.hidden && column_r32.matchesMedia);
} }
function MultiColumnComboBoxComponent_ng_template_7_ng_template_11_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵtemplate(0, MultiColumnComboBoxComponent_ng_template_7_ng_template_11_ng_container_0_Template, 2, 1, "ng-container", 18);
} if (rf & 2) {
    const ctx_r14 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵproperty("ngForOf", ctx_r14.columns);
} }
function MultiColumnComboBoxComponent_ng_template_7_div_15_ng_template_1_Template(rf, ctx) { }
function MultiColumnComboBoxComponent_ng_template_7_div_15_ng_template_2_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "div");
    ɵngcc0.ɵɵtext(1);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r43 = ɵngcc0.ɵɵnextContext(3);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵtextInterpolate(ctx_r43.messageFor("noDataText"));
} }
function MultiColumnComboBoxComponent_ng_template_7_div_15_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "div", 31);
    ɵngcc0.ɵɵtemplate(1, MultiColumnComboBoxComponent_ng_template_7_div_15_ng_template_1_Template, 0, 0, "ng-template", 32);
    ɵngcc0.ɵɵtemplate(2, MultiColumnComboBoxComponent_ng_template_7_div_15_ng_template_2_Template, 2, 1, "ng-template", 33);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r16 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r16.noDataTemplate)("templateContext", ɵngcc0.ɵɵpureFunction1(3, _c15, ctx_r16.noDataTemplate == null ? null : ctx_r16.noDataTemplate.templateRef));
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", !ctx_r16.noDataTemplate);
} }
function MultiColumnComboBoxComponent_ng_template_7_ng_container_16_ng_template_6_Template(rf, ctx) { }
function MultiColumnComboBoxComponent_ng_template_7_ng_container_16_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵelementStart(1, "div", 34)(2, "table", 35)(3, "tfoot", 36)(4, "tr", 20)(5, "td", 37);
    ɵngcc0.ɵɵtemplate(6, MultiColumnComboBoxComponent_ng_template_7_ng_container_16_ng_template_6_Template, 0, 0, "ng-template", 25);
    ɵngcc0.ɵɵelementEnd()()()()();
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r17 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵadvance(6);
    ɵngcc0.ɵɵproperty("templateContext", ɵngcc0.ɵɵpureFunction1(1, _c15, ctx_r17.footerTemplate.templateRef));
} }
function MultiColumnComboBoxComponent_ng_template_7_Template(rf, ctx) { if (rf & 1) {
    const _r46 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵtemplate(0, MultiColumnComboBoxComponent_ng_template_7_0_Template, 1, 3, null, 12);
    ɵngcc0.ɵɵelementStart(1, "div", 13)(2, "div", 14, 15)(4, "div", 16)(5, "table", 17)(6, "colgroup");
    ɵngcc0.ɵɵtemplate(7, MultiColumnComboBoxComponent_ng_template_7_ng_container_7_Template, 2, 1, "ng-container", 18);
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementStart(8, "thead", 19)(9, "tr", 20);
    ɵngcc0.ɵɵtemplate(10, MultiColumnComboBoxComponent_ng_template_7_ng_container_10_Template, 2, 1, "ng-container", 18);
    ɵngcc0.ɵɵelementEnd()()()()();
    ɵngcc0.ɵɵtemplate(11, MultiColumnComboBoxComponent_ng_template_7_ng_template_11_Template, 1, 1, "ng-template", null, 21, ɵngcc0.ɵɵtemplateRefExtractor);
    ɵngcc0.ɵɵelementStart(13, "kendo-list", 22, 23);
    ɵngcc0.ɵɵlistener("pageChange", function MultiColumnComboBoxComponent_ng_template_7_Template_kendo_list_pageChange_13_listener($event) { ɵngcc0.ɵɵrestoreView(_r46); const ctx_r45 = ɵngcc0.ɵɵnextContext(); return ctx_r45.pageChange($event); })("listResize", function MultiColumnComboBoxComponent_ng_template_7_Template_kendo_list_listResize_13_listener() { ɵngcc0.ɵɵrestoreView(_r46); const _r10 = ɵngcc0.ɵɵreference(3); const ctx_r47 = ɵngcc0.ɵɵnextContext(); return ctx_r47.updateHeaderPadding(_r10); });
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵtemplate(15, MultiColumnComboBoxComponent_ng_template_7_div_15_Template, 3, 5, "div", 24);
    ɵngcc0.ɵɵtemplate(16, MultiColumnComboBoxComponent_ng_template_7_ng_container_16_Template, 7, 3, "ng-container", 12);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const _r13 = ɵngcc0.ɵɵreference(12);
    const ctx_r4 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵproperty("ngIf", ctx_r4.headerTemplate);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngClass", ctx_r4.tableSizeClass);
    ɵngcc0.ɵɵadvance(6);
    ɵngcc0.ɵɵproperty("ngForOf", ctx_r4.columns);
    ɵngcc0.ɵɵadvance(3);
    ɵngcc0.ɵɵproperty("ngForOf", ctx_r4.columns);
    ɵngcc0.ɵɵadvance(3);
    ɵngcc0.ɵɵproperty("id", ctx_r4.listBoxId)("optionPrefix", ctx_r4.optionPrefix)("data", ctx_r4.data)("textField", ctx_r4.textField)("valueField", ctx_r4.valueField)("template", ɵngcc0.ɵɵpureFunction1(18, _c15, _r13))("groupTemplate", ctx_r4.groupTemplate)("fixedGroupTemplate", ctx_r4.fixedGroupTemplate)("height", ctx_r4.listHeight)("show", ctx_r4.isOpen)("virtual", ctx_r4.virtual)("type", "dropdowngrid");
    ɵngcc0.ɵɵadvance(2);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r4.data.length === 0);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r4.footerTemplate);
} }
function MultiColumnComboBoxComponent_kendo_resize_sensor_9_Template(rf, ctx) { if (rf & 1) {
    const _r49 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementStart(0, "kendo-resize-sensor", 38);
    ɵngcc0.ɵɵlistener("resize", function MultiColumnComboBoxComponent_kendo_resize_sensor_9_Template_kendo_resize_sensor_resize_0_listener() { ɵngcc0.ɵɵrestoreView(_r49); const ctx_r48 = ɵngcc0.ɵɵnextContext(); return ctx_r48.onResize(); });
    ɵngcc0.ɵɵelementEnd();
} }
const _c40 = ["treeview"];
const _c41 = ["filterInput"];
function DropDownTreeComponent_3_ng_template_0_Template(rf, ctx) { }
function DropDownTreeComponent_3_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵtemplate(0, DropDownTreeComponent_3_ng_template_0_Template, 0, 0, "ng-template", 10);
} if (rf & 2) {
    const ctx_r0 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵproperty("templateContext", ɵngcc0.ɵɵpureFunction2(1, _c5, ctx_r0.valueTemplate.templateRef, ctx_r0.dataItem));
} }
function DropDownTreeComponent_ng_template_4_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵtext(0);
} if (rf & 2) {
    const ctx_r1 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵtextInterpolate1(" ", ctx_r1.text || ctx_r1.placeholder, " ");
} }
function DropDownTreeComponent_span_5_Template(rf, ctx) { if (rf & 1) {
    const _r8 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementStart(0, "span", 11);
    ɵngcc0.ɵɵlistener("click", function DropDownTreeComponent_span_5_Template_span_click_0_listener($event) { ɵngcc0.ɵɵrestoreView(_r8); const ctx_r7 = ɵngcc0.ɵɵnextContext(); return ctx_r7.clearValue($event); });
    ɵngcc0.ɵɵelement(1, "span", 12);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r2 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵstyleProp("visibility", ctx_r2.clearButtonVisiblity);
    ɵngcc0.ɵɵattribute("title", ctx_r2.messageFor("clearTitle"));
} }
const _c48 = function (a0) { return { blur: a0 }; };
function DropDownTreeComponent_ng_template_8_span_0_Template(rf, ctx) { if (rf & 1) {
    const _r16 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementStart(0, "span", 16)(1, "span", 17)(2, "span", 18);
    ɵngcc0.ɵɵelement(3, "span", 19);
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementStart(4, "input", 20, 21);
    ɵngcc0.ɵɵlistener("input", function DropDownTreeComponent_ng_template_8_span_0_Template_input_input_4_listener($event) { ɵngcc0.ɵɵrestoreView(_r16); const ctx_r15 = ɵngcc0.ɵɵnextContext(2); return ctx_r15.handleFilterInputChange($event.target.value); })("keydown.arrowdown", function DropDownTreeComponent_ng_template_8_span_0_Template_input_keydown_arrowdown_4_listener($event) { ɵngcc0.ɵɵrestoreView(_r16); const ctx_r17 = ɵngcc0.ɵɵnextContext(2); return ctx_r17.handleKeydown($event); })("keydown.alt.arrowup", function DropDownTreeComponent_ng_template_8_span_0_Template_input_keydown_alt_arrowup_4_listener($event) { ɵngcc0.ɵɵrestoreView(_r16); const ctx_r18 = ɵngcc0.ɵɵnextContext(2); return ctx_r18.handleKeydown($event); })("ngModelChange", function DropDownTreeComponent_ng_template_8_span_0_Template_input_ngModelChange_4_listener($event) { ɵngcc0.ɵɵrestoreView(_r16); const ctx_r19 = ɵngcc0.ɵɵnextContext(2); return ctx_r19.filter = $event; });
    ɵngcc0.ɵɵelementEnd()()();
} if (rf & 2) {
    const ctx_r9 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngClass", ctx_r9.filterInputClasses);
    ɵngcc0.ɵɵadvance(3);
    ɵngcc0.ɵɵproperty("filterInput", ctx_r9.filterable && !ctx_r9.touchEnabled)("ngModel", ctx_r9.filter)("kendoEventsOutsideAngular", ɵngcc0.ɵɵpureFunction1(5, _c48, ctx_r9.handleBlur))("scope", ctx_r9);
} }
function DropDownTreeComponent_ng_template_8_1_ng_template_0_Template(rf, ctx) { }
function DropDownTreeComponent_ng_template_8_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵtemplate(0, DropDownTreeComponent_ng_template_8_1_ng_template_0_Template, 0, 0, "ng-template", 10);
} if (rf & 2) {
    const ctx_r10 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵproperty("templateContext", ɵngcc0.ɵɵpureFunction1(1, _c15, ctx_r10.headerTemplate == null ? null : ctx_r10.headerTemplate.templateRef));
} }
function DropDownTreeComponent_ng_template_8_kendo_treeview_2_Template(rf, ctx) { if (rf & 1) {
    const _r23 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementStart(0, "kendo-treeview", 22, 23);
    ɵngcc0.ɵɵlistener("selectedKeysChange", function DropDownTreeComponent_ng_template_8_kendo_treeview_2_Template_kendo_treeview_selectedKeysChange_0_listener($event) { ɵngcc0.ɵɵrestoreView(_r23); const ctx_r22 = ɵngcc0.ɵɵnextContext(2); return ctx_r22.selectedKeys = $event; })("focusout", function DropDownTreeComponent_ng_template_8_kendo_treeview_2_Template_kendo_treeview_focusout_0_listener($event) { ɵngcc0.ɵɵrestoreView(_r23); const ctx_r24 = ɵngcc0.ɵɵnextContext(2); return ctx_r24.handleBlur($event); })("keydown", function DropDownTreeComponent_ng_template_8_kendo_treeview_2_Template_kendo_treeview_keydown_0_listener($event) { ɵngcc0.ɵɵrestoreView(_r23); const ctx_r25 = ɵngcc0.ɵɵnextContext(2); return ctx_r25.handleKeydown($event); })("selectionChange", function DropDownTreeComponent_ng_template_8_kendo_treeview_2_Template_kendo_treeview_selectionChange_0_listener($event) { ɵngcc0.ɵɵrestoreView(_r23); const ctx_r26 = ɵngcc0.ɵɵnextContext(2); return ctx_r26.onSelectionChange($event); })("expand", function DropDownTreeComponent_ng_template_8_kendo_treeview_2_Template_kendo_treeview_expand_0_listener($event) { ɵngcc0.ɵɵrestoreView(_r23); const ctx_r27 = ɵngcc0.ɵɵnextContext(2); return ctx_r27.nodeExpand.emit($event); })("collapse", function DropDownTreeComponent_ng_template_8_kendo_treeview_2_Template_kendo_treeview_collapse_0_listener($event) { ɵngcc0.ɵɵrestoreView(_r23); const ctx_r28 = ɵngcc0.ɵɵnextContext(2); return ctx_r28.nodeCollapse.emit($event); });
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r11 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵstyleProp("max-height", ctx_r11.listHeight, "px");
    ɵngcc0.ɵɵproperty("size", ctx_r11.size)("nodes", ctx_r11.data)("animate", false)("selectedKeys", ctx_r11.selectedKeys)("selectBy", ctx_r11.selectBy)("textField", ctx_r11.textField)("children", ctx_r11.children)("hasChildren", ctx_r11.hasChildren)("loadOnDemand", ctx_r11.loadOnDemand)("isExpanded", ctx_r11.isNodeExpanded)("isDisabled", ctx_r11.itemDisabled)("nodeTemplate", ctx_r11.nodeTemplate)("filter", ctx_r11.filter)("isVisible", ctx_r11.isNodeVisible);
} }
function DropDownTreeComponent_ng_template_8_3_ng_template_0_Template(rf, ctx) { }
function DropDownTreeComponent_ng_template_8_3_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵtemplate(0, DropDownTreeComponent_ng_template_8_3_ng_template_0_Template, 0, 0, "ng-template", 10);
} if (rf & 2) {
    const ctx_r12 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵproperty("templateContext", ɵngcc0.ɵɵpureFunction1(1, _c15, ctx_r12.footerTemplate == null ? null : ctx_r12.footerTemplate.templateRef));
} }
function DropDownTreeComponent_ng_template_8_div_4_ng_template_1_Template(rf, ctx) { }
function DropDownTreeComponent_ng_template_8_div_4_ng_template_2_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "div");
    ɵngcc0.ɵɵtext(1);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r31 = ɵngcc0.ɵɵnextContext(3);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵtextInterpolate(ctx_r31.messageFor("noDataText"));
} }
function DropDownTreeComponent_ng_template_8_div_4_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "div", 24);
    ɵngcc0.ɵɵtemplate(1, DropDownTreeComponent_ng_template_8_div_4_ng_template_1_Template, 0, 0, "ng-template", 25);
    ɵngcc0.ɵɵtemplate(2, DropDownTreeComponent_ng_template_8_div_4_ng_template_2_Template, 2, 1, "ng-template", 4);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r13 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r13.noDataTemplate)("templateContext", ɵngcc0.ɵɵpureFunction1(3, _c15, ctx_r13.noDataTemplate == null ? null : ctx_r13.noDataTemplate.templateRef));
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", !ctx_r13.noDataTemplate);
} }
function DropDownTreeComponent_ng_template_8_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵtemplate(0, DropDownTreeComponent_ng_template_8_span_0_Template, 6, 7, "span", 13);
    ɵngcc0.ɵɵtemplate(1, DropDownTreeComponent_ng_template_8_1_Template, 1, 3, null, 3);
    ɵngcc0.ɵɵtemplate(2, DropDownTreeComponent_ng_template_8_kendo_treeview_2_Template, 2, 16, "kendo-treeview", 14);
    ɵngcc0.ɵɵtemplate(3, DropDownTreeComponent_ng_template_8_3_Template, 1, 3, null, 3);
    ɵngcc0.ɵɵtemplate(4, DropDownTreeComponent_ng_template_8_div_4_Template, 3, 5, "div", 15);
} if (rf & 2) {
    const ctx_r4 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵproperty("ngIf", ctx_r4.filterable);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r4.headerTemplate);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r4.data.length !== 0 && !ctx_r4.allNodesHidden);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r4.footerTemplate);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r4.data.length === 0 || ctx_r4.allNodesHidden);
} }
const _c49 = ["checkAllInput"];
function MultiSelectTreeComponent_span_2_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "span", 7)(1, "span", 8);
    ɵngcc0.ɵɵtext(2);
    ɵngcc0.ɵɵelementEnd()();
} if (rf & 2) {
    const ctx_r0 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵadvance(2);
    ɵngcc0.ɵɵtextInterpolate(ctx_r0.placeholder);
} }
function MultiSelectTreeComponent_span_3_Template(rf, ctx) { if (rf & 1) {
    const _r7 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementStart(0, "span", 9);
    ɵngcc0.ɵɵlistener("click", function MultiSelectTreeComponent_span_3_Template_span_click_0_listener($event) { ɵngcc0.ɵɵrestoreView(_r7); const ctx_r6 = ɵngcc0.ɵɵnextContext(); return ctx_r6.clearAll($event); });
    ɵngcc0.ɵɵelement(1, "span", 10);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r1 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵattribute("title", ctx_r1.messageFor("clearTitle"));
} }
function MultiSelectTreeComponent_span_4_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelement(0, "span", 11);
} }
function MultiSelectTreeComponent_ng_template_5_span_0_Template(rf, ctx) { if (rf & 1) {
    const _r16 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementStart(0, "span", 18)(1, "span", 19)(2, "span", 20);
    ɵngcc0.ɵɵelement(3, "span", 21);
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementStart(4, "input", 22, 23);
    ɵngcc0.ɵɵlistener("input", function MultiSelectTreeComponent_ng_template_5_span_0_Template_input_input_4_listener($event) { ɵngcc0.ɵɵrestoreView(_r16); const ctx_r15 = ɵngcc0.ɵɵnextContext(2); return ctx_r15.handleFilterInputChange($event.target.value); })("keydown", function MultiSelectTreeComponent_ng_template_5_span_0_Template_input_keydown_4_listener($event) { ɵngcc0.ɵɵrestoreView(_r16); const ctx_r17 = ɵngcc0.ɵɵnextContext(2); return ctx_r17.handleKeydown($event); })("ngModelChange", function MultiSelectTreeComponent_ng_template_5_span_0_Template_input_ngModelChange_4_listener($event) { ɵngcc0.ɵɵrestoreView(_r16); const ctx_r18 = ɵngcc0.ɵɵnextContext(2); return ctx_r18.filter = $event; });
    ɵngcc0.ɵɵelementEnd()()();
} if (rf & 2) {
    const ctx_r8 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngClass", ctx_r8.filterInputClasses);
    ɵngcc0.ɵɵadvance(3);
    ɵngcc0.ɵɵproperty("filterInput", ctx_r8.filterable && !ctx_r8.touchEnabled)("ngModel", ctx_r8.filter)("kendoEventsOutsideAngular", ɵngcc0.ɵɵpureFunction1(5, _c48, ctx_r8.handleBlur))("scope", ctx_r8);
} }
function MultiSelectTreeComponent_ng_template_5_1_ng_template_0_Template(rf, ctx) { }
function MultiSelectTreeComponent_ng_template_5_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵtemplate(0, MultiSelectTreeComponent_ng_template_5_1_ng_template_0_Template, 0, 0, "ng-template", 24);
} if (rf & 2) {
    const ctx_r9 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵproperty("templateContext", ɵngcc0.ɵɵpureFunction1(1, _c15, ctx_r9.headerTemplate == null ? null : ctx_r9.headerTemplate.templateRef));
} }
function MultiSelectTreeComponent_ng_template_5_div_2_Template(rf, ctx) { if (rf & 1) {
    const _r22 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementStart(0, "div", 25)(1, "input", 26, 27);
    ɵngcc0.ɵɵlistener("checkedItemsChange", function MultiSelectTreeComponent_ng_template_5_div_2_Template_input_checkedItemsChange_1_listener($event) { ɵngcc0.ɵɵrestoreView(_r22); const ctx_r21 = ɵngcc0.ɵɵnextContext(2); return ctx_r21.handleCheckedItemsChange($event); })("keydown", function MultiSelectTreeComponent_ng_template_5_div_2_Template_input_keydown_1_listener($event) { ɵngcc0.ɵɵrestoreView(_r22); const ctx_r23 = ɵngcc0.ɵɵnextContext(2); return ctx_r23.handleKeydown($event); });
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementStart(3, "span", 28);
    ɵngcc0.ɵɵlistener("click", function MultiSelectTreeComponent_ng_template_5_div_2_Template_span_click_3_listener() { ɵngcc0.ɵɵrestoreView(_r22); const ctx_r24 = ɵngcc0.ɵɵnextContext(2); return ctx_r24.toggleCheckAll(); })("mousedown", function MultiSelectTreeComponent_ng_template_5_div_2_Template_span_mousedown_3_listener($event) { return $event.preventDefault(); });
    ɵngcc0.ɵɵtext(4);
    ɵngcc0.ɵɵelementEnd()();
} if (rf & 2) {
    ɵngcc0.ɵɵnextContext();
    const _r11 = ɵngcc0.ɵɵreference(4);
    const ctx_r10 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("checkAll", !ctx_r10.filterable && !ctx_r10.touchEnabled)("ngClass", ctx_r10.checkAllCheckboxClasses)("treeview", _r11)("checkedItems", ctx_r10.checkedItems)("valueField", ctx_r10.valueField)("lastAction", ctx_r10.lastAction)("kendoEventsOutsideAngular", ɵngcc0.ɵɵpureFunction1(9, _c48, ctx_r10.handleBlur))("scope", ctx_r10);
    ɵngcc0.ɵɵadvance(3);
    ɵngcc0.ɵɵtextInterpolate1(" ", ctx_r10.messageFor("checkAllText"), " ");
} }
function MultiSelectTreeComponent_ng_template_5_5_ng_template_0_Template(rf, ctx) { }
function MultiSelectTreeComponent_ng_template_5_5_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵtemplate(0, MultiSelectTreeComponent_ng_template_5_5_ng_template_0_Template, 0, 0, "ng-template", 24);
} if (rf & 2) {
    const ctx_r12 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵproperty("templateContext", ɵngcc0.ɵɵpureFunction1(1, _c15, ctx_r12.footerTemplate == null ? null : ctx_r12.footerTemplate.templateRef));
} }
function MultiSelectTreeComponent_ng_template_5_div_6_ng_template_1_Template(rf, ctx) { }
function MultiSelectTreeComponent_ng_template_5_div_6_ng_template_2_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "div");
    ɵngcc0.ɵɵtext(1);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r28 = ɵngcc0.ɵɵnextContext(3);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵtextInterpolate(ctx_r28.messageFor("noDataText"));
} }
function MultiSelectTreeComponent_ng_template_5_div_6_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "div", 29);
    ɵngcc0.ɵɵtemplate(1, MultiSelectTreeComponent_ng_template_5_div_6_ng_template_1_Template, 0, 0, "ng-template", 30);
    ɵngcc0.ɵɵtemplate(2, MultiSelectTreeComponent_ng_template_5_div_6_ng_template_2_Template, 2, 1, "ng-template", 31);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r13 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r13.noDataTemplate)("templateContext", ɵngcc0.ɵɵpureFunction1(3, _c15, ctx_r13.noDataTemplate == null ? null : ctx_r13.noDataTemplate.templateRef));
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", !ctx_r13.noDataTemplate);
} }
const _c56 = function (a0) { return { focusout: a0 }; };
function MultiSelectTreeComponent_ng_template_5_Template(rf, ctx) { if (rf & 1) {
    const _r30 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵtemplate(0, MultiSelectTreeComponent_ng_template_5_span_0_Template, 6, 7, "span", 12);
    ɵngcc0.ɵɵtemplate(1, MultiSelectTreeComponent_ng_template_5_1_Template, 1, 3, null, 13);
    ɵngcc0.ɵɵtemplate(2, MultiSelectTreeComponent_ng_template_5_div_2_Template, 5, 11, "div", 14);
    ɵngcc0.ɵɵelementStart(3, "kendo-treeview", 15, 16);
    ɵngcc0.ɵɵlistener("keydown", function MultiSelectTreeComponent_ng_template_5_Template_kendo_treeview_keydown_3_listener($event) { ɵngcc0.ɵɵrestoreView(_r30); const ctx_r29 = ɵngcc0.ɵɵnextContext(); return ctx_r29.handleKeydown($event); })("nodeClick", function MultiSelectTreeComponent_ng_template_5_Template_kendo_treeview_nodeClick_3_listener($event) { ɵngcc0.ɵɵrestoreView(_r30); const ctx_r31 = ɵngcc0.ɵɵnextContext(); return ctx_r31.handleNodeClick($event); })("expand", function MultiSelectTreeComponent_ng_template_5_Template_kendo_treeview_expand_3_listener($event) { ɵngcc0.ɵɵrestoreView(_r30); const ctx_r32 = ɵngcc0.ɵɵnextContext(); return ctx_r32.nodeExpand.emit($event); })("collapse", function MultiSelectTreeComponent_ng_template_5_Template_kendo_treeview_collapse_3_listener($event) { ɵngcc0.ɵɵrestoreView(_r30); const ctx_r33 = ɵngcc0.ɵɵnextContext(); return ctx_r33.nodeCollapse.emit($event); })("checkedItemsChange", function MultiSelectTreeComponent_ng_template_5_Template_kendo_treeview_checkedItemsChange_3_listener($event) { ɵngcc0.ɵɵrestoreView(_r30); const ctx_r34 = ɵngcc0.ɵɵnextContext(); return ctx_r34.handleCheckedItemsChange($event); });
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵtemplate(5, MultiSelectTreeComponent_ng_template_5_5_Template, 1, 3, null, 13);
    ɵngcc0.ɵɵtemplate(6, MultiSelectTreeComponent_ng_template_5_div_6_Template, 3, 5, "div", 17);
} if (rf & 2) {
    const ctx_r4 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵproperty("ngIf", ctx_r4.filterable);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r4.headerTemplate);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r4.checkAll);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵstyleProp("max-height", ctx_r4.listHeight, "px");
    ɵngcc0.ɵɵproperty("size", ctx_r4.size)("nodes", ctx_r4.data)("animate", false)("checkable", ctx_r4.checkableSettings)("checkedItems", ctx_r4.checkedItems)("valueField", ctx_r4.valueField)("textField", ctx_r4.textField)("children", ctx_r4.children)("hasChildren", ctx_r4.hasChildren)("isExpanded", ctx_r4.isNodeExpanded)("isDisabled", ctx_r4.itemDisabled)("nodeTemplate", ctx_r4.nodeTemplate)("loadOnDemand", ctx_r4.loadOnDemand)("filter", ctx_r4.filter)("isVisible", ctx_r4.isNodeVisible)("kendoEventsOutsideAngular", ɵngcc0.ɵɵpureFunction1(24, _c56, ctx_r4.handleBlur))("scope", ctx_r4);
    ɵngcc0.ɵɵadvance(2);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r4.footerTemplate);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", (ctx_r4.data == null ? null : ctx_r4.data.length) === 0 || ctx_r4.allNodesHidden);
} }
function TagListComponent_div_0_2_ng_template_0_Template(rf, ctx) { }
function TagListComponent_div_0_2_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵtemplate(0, TagListComponent_div_0_2_ng_template_0_Template, 0, 0, "ng-template");
} }
function TagListComponent_div_0_ng_template_3_1_ng_template_0_Template(rf, ctx) { }
function TagListComponent_div_0_ng_template_3_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵtemplate(0, TagListComponent_div_0_ng_template_3_1_ng_template_0_Template, 0, 0, "ng-template", 12);
} if (rf & 2) {
    const tag_r1 = ɵngcc0.ɵɵnextContext(2).$implicit;
    const ctx_r9 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵproperty("templateContext", ɵngcc0.ɵɵpureFunction2(1, _c5, ctx_r9.groupTemplate.templateRef, tag_r1));
} }
function TagListComponent_div_0_ng_template_3_ng_template_2_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵtext(0);
} if (rf & 2) {
    const tag_r1 = ɵngcc0.ɵɵnextContext(2).$implicit;
    ɵngcc0.ɵɵtextInterpolate2("", tag_r1.length, " ", tag_r1.length === 1 ? "item" : "items", " selected");
} }
function TagListComponent_div_0_ng_template_3_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "span", 9);
    ɵngcc0.ɵɵtemplate(1, TagListComponent_div_0_ng_template_3_1_Template, 1, 4, null, 10);
    ɵngcc0.ɵɵtemplate(2, TagListComponent_div_0_ng_template_3_ng_template_2_Template, 1, 2, "ng-template", 11);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r5 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r5.groupTemplate);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", !ctx_r5.groupTemplate);
} }
function TagListComponent_div_0_ng_template_5_1_ng_template_0_Template(rf, ctx) { }
function TagListComponent_div_0_ng_template_5_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵtemplate(0, TagListComponent_div_0_ng_template_5_1_ng_template_0_Template, 0, 0, "ng-template", 12);
} if (rf & 2) {
    const tag_r1 = ɵngcc0.ɵɵnextContext(2).$implicit;
    const ctx_r14 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵproperty("templateContext", ɵngcc0.ɵɵpureFunction2(1, _c5, ctx_r14.template.templateRef, tag_r1));
} }
function TagListComponent_div_0_ng_template_5_ng_template_2_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵtext(0);
} if (rf & 2) {
    const ctx_r18 = ɵngcc0.ɵɵnextContext(2);
    const tag_r1 = ctx_r18.$implicit;
    const index_r2 = ctx_r18.index;
    const ctx_r15 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵtextInterpolate(ctx_r15.tagProp(tag_r1, ctx_r15.textField, index_r2));
} }
function TagListComponent_div_0_ng_template_5_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "span", 9);
    ɵngcc0.ɵɵtemplate(1, TagListComponent_div_0_ng_template_5_1_Template, 1, 4, null, 10);
    ɵngcc0.ɵɵtemplate(2, TagListComponent_div_0_ng_template_5_ng_template_2_Template, 1, 1, "ng-template", 11);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r7 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r7.template);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", !ctx_r7.template);
} }
const _c57 = function (a0, a1, a2, a3, a4, a5, a6, a7, a8, a9, a10, a11) { return { "k-focus": a0, "k-disabled": a1, "k-chip-sm": a2, "k-chip-md": a3, "k-chip-lg": a4, "k-rounded-sm": a5, "k-rounded-md": a6, "k-rounded-lg": a7, "k-rounded-full": a8, "k-chip-solid k-chip-solid-base": a9, "k-chip-flat k-chip-flat-base": a10, "k-chip-outline k-chip-outline-base": a11 }; };
function TagListComponent_div_0_Template(rf, ctx) { if (rf & 1) {
    const _r20 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementStart(0, "div", 1)(1, "span", 2);
    ɵngcc0.ɵɵtemplate(2, TagListComponent_div_0_2_Template, 1, 0, null, 3);
    ɵngcc0.ɵɵtemplate(3, TagListComponent_div_0_ng_template_3_Template, 3, 2, "ng-template", null, 4, ɵngcc0.ɵɵtemplateRefExtractor);
    ɵngcc0.ɵɵtemplate(5, TagListComponent_div_0_ng_template_5_Template, 3, 2, "ng-template", null, 5, ɵngcc0.ɵɵtemplateRefExtractor);
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementStart(7, "span", 6)(8, "span", 7)(9, "span", 8);
    ɵngcc0.ɵɵlistener("mousedown", function TagListComponent_div_0_Template_span_mousedown_9_listener($event) { const restoredCtx = ɵngcc0.ɵɵrestoreView(_r20); const tag_r1 = restoredCtx.$implicit; const index_r2 = restoredCtx.index; const ctx_r19 = ɵngcc0.ɵɵnextContext(); return ctx_r19.deleteTag($event, tag_r1, index_r2); });
    ɵngcc0.ɵɵelementEnd()()()();
} if (rf & 2) {
    const tag_r1 = ctx.$implicit;
    const index_r2 = ctx.index;
    const _r4 = ɵngcc0.ɵɵreference(4);
    const _r6 = ɵngcc0.ɵɵreference(6);
    const ctx_r0 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵproperty("ngClass", ɵngcc0.ɵɵpureFunctionV(7, _c57, [index_r2 === ctx_r0.focused, ctx_r0.isTagDisabled(tag_r1, index_r2), ctx_r0.size === "small", ctx_r0.size === "medium", ctx_r0.size === "large", ctx_r0.rounded === "small", ctx_r0.rounded === "medium", ctx_r0.rounded === "large", ctx_r0.rounded === "full", ctx_r0.fillMode === "solid", ctx_r0.fillMode === "flat", ctx_r0.fillMode === "outline"]));
    ɵngcc0.ɵɵattribute("id", ctx_r0.itemId(tag_r1, index_r2))("aria-hidden", ctx_r0.tagAriaHidden(index_r2));
    ɵngcc0.ɵɵadvance(2);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r0.isGroupTag(tag_r1))("ngIfThen", _r4)("ngIfElse", _r6);
    ɵngcc0.ɵɵadvance(6);
    ɵngcc0.ɵɵattribute("aria-hidden", index_r2 !== ctx_r0.focused);
} }
const _c58 = ["*"];
export { PopupComponent } from '@progress/kendo-angular-popup';
import { map, switchMap, take, auditTime, tap, filter, partition, throttleTime, catchError, skipWhile, concatMap, takeUntil } from 'rxjs/operators';
import { TreeViewComponent, DataBoundComponent, ExpandableComponent, FlatDataBindingDirective, HierarchyBindingDirective, ExpandDirective, TreeViewModule } from '@progress/kendo-angular-treeview';
import { CommonModule } from '@angular/common';

/**
 * @hidden
 */
const packageMetadata = {
    name: '@progress/kendo-angular-dropdowns',
    productName: 'Kendo UI for Angular',
    productCodes: ['KENDOUIANGULAR', 'KENDOUICOMPLETE'],
    publishDate: 1646640638,
    version: '',
    licensingDocsUrl: 'https://www.telerik.com/kendo-angular-ui/my-license/?utm_medium=product&utm_source=kendoangular&utm_campaign=kendo-ui-angular-purchase-license-keys-warning'
};

/* tslint:disable:no-bitwise */
/**
 * @hidden
 */
const isPresent = (value) => value !== null && value !== undefined;
/**
 * @hidden
 */
const isNumber = (value) => !isNaN(value);
/**
 * @hidden
 */
const guid$1 = () => {
    let id = "";
    let i;
    let random;
    for (i = 0; i < 32; i++) {
        random = Math.random() * 16 | 0;
        if (i === 8 || i === 12 || i === 16 || i === 20) {
            id += "-";
        }
        id += (i === 12 ? 4 : (i === 16 ? (random & 3 | 8) : random)).toString(16);
    }
    return id;
};
/**
 * @hidden
 */
const combineStr = (begin, end) => {
    return begin.concat(end.substr(end.toLowerCase().indexOf(begin.toLowerCase()) + begin.length));
};
/**
 * @hidden
 */
const isArray = (value) => Array.isArray(value);
/**
 * @hidden
 */
const isObject = (value) => isPresent(value) && typeof value === 'object';
/**
 * @hidden
 */
const isEmptyString = (value) => typeof value === 'string' && value.length === 0;
/**
 * @hidden
 */
const resolveValuesInArray = (values, data = [], valueField) => values
    .map(value => {
    return data.find(item => getter$1(item, valueField) === value);
})
    .filter(value => value !== undefined);
/**
 * @hidden
 */
const validateComplexValues = (values, valueField) => isArray(values) && values.filter(item => {
    return isObject(item) && isPresent(getter$1(item, valueField));
});
/**
 * @hidden
 */
const resolveAllValues = (value, data, valueField) => {
    const customValues = validateComplexValues(value, valueField) || [];
    const resolvedValues = resolveValuesInArray(value, data, valueField) || [];
    return resolvedValues.concat(customValues);
};
/**
 * @hidden
 */
const isObjectArray = (values) => {
    return isArray(values) && values.every(item => isObject(item));
};
/**
 * @hidden
 */
const selectedIndices = (values, data, valueField) => {
    const extractedValues = data.map(item => {
        return isPresent(item) && isPresent(getter$1(item, valueField)) ? getter$1(item, valueField) : item;
    });
    return values.reduce((arr, item) => {
        const value = isPresent(item) && isPresent(getter$1(item, valueField)) ? getter$1(item, valueField) : item;
        const index = extractedValues.indexOf(value);
        if (index !== -1) {
            arr.push(index);
        }
        return arr;
    }, []);
};
/**
 * @hidden
 */
const getter$1 = (dataItem, field) => {
    if (!isPresent(dataItem)) {
        return null;
    }
    if (!isPresent(field) || !isObject(dataItem)) {
        return dataItem;
    }
    // creates a field accessor supporting nested fields processing
    const valueFrom = getter(field);
    return valueFrom(dataItem);
};
/**
 * @hidden
 */
const sameCharsOnly = (word, character) => {
    for (let idx = 0; idx < word.length; idx++) {
        if (word.charAt(idx) !== character) {
            return false;
        }
    }
    return true;
};
/**
 * @hidden
 */
const shuffleData = (data, splitIndex, defaultItem) => {
    let result = data;
    if (defaultItem) {
        result = [defaultItem].concat(result);
    }
    return result.slice(splitIndex).concat(result.slice(0, splitIndex));
};
/**
 * @hidden
 */
const matchText = (text, word, ignoreCase) => {
    if (!isPresent(text)) {
        return false;
    }
    let temp = String(text);
    if (ignoreCase) {
        temp = temp.toLowerCase();
    }
    return temp.indexOf(word) === 0;
};
/**
 * @hidden
 *
 * Checks whether the passed object has all of the listed properties.
 */
const hasProps = (obj, props) => {
    if (!isPresent(obj)) {
        return false;
    }
    return props.every(prop => obj.hasOwnProperty(prop));
};
/**
 * @hidden
 *
 * Checks whether an element is untouched by looking for the ng-untouched css class
 */
const isUntouched = (element) => element.className.includes('ng-untouched');
/**
 * @hidden
 */
const noop = (_) => { };
/**
 * IE element `matches` polyfill.
 * https://developer.mozilla.org/en-US/docs/Web/API/Element/matches
 */
const matches = (element, selector) => {
    const matcher = element.matches || element.msMatchesSelector || element.webkitMatchesSelector;
    if (!matcher) {
        return false;
    }
    return matcher.call(element, selector);
};
/**
 * @hidden
 *
 * IE element `closest` polyfill.
 * https://developer.mozilla.org/en-US/docs/Web/API/Element/closest
 */
const closest = (element, selector) => {
    let parent = element;
    while (parent !== null && parent.nodeType === 1) {
        if (matches(parent, selector)) {
            return parent;
        }
        parent = parent.parentElement || parent.parentNode;
    }
    return null;
};
/**
 * @hidden
 *
 * Parses a provided value to its type 'number' representation.
 * If the parsed value (via Number(value)) is NaN, the provided default value is returned.
 * Uses 0 as default value if a second param is not provided.
 */
const parseNumber = (num, defaultValue = 0) => {
    const normalizedValue = Number(num);
    return isNaN(normalizedValue) ? defaultValue : normalizedValue;
};
/**
 * @hidden
 *
 * Checks whether the passed target element is inside the provided host or popupRef.
 */
const inDropDown = (host, target, popupRef) => {
    return host.nativeElement.contains(target) || (popupRef && popupRef.popupElement.contains(target));
};
/**
 * @hidden
 *
 * Calculates the hierarchical level of an item, based on the provided index.
 * The result level is zero-based (starts from 0).
 */
const getHierarchicalItemLevel = (index) => {
    return (index || '').split('_').length - 1;
};
/**
 * @hidden
 *
 * Retrieves all descendant nodes' lookups which are currently registered in the provided lookup item as a flat array.
 */
const fetchDescendentNodes = (lookup, filterExpression) => {
    if (!isPresent(lookup) || lookup.children.length === 0) {
        return [];
    }
    let descendants = lookup.children;
    if (isPresent(filterExpression)) {
        descendants = descendants.filter(descendent => filterExpression(descendent.item));
    }
    descendants.forEach(child => descendants = descendants.concat(fetchDescendentNodes(child, filterExpression)));
    return descendants;
};
/**
 * @hidden
 *
 * Retrieves the correct value based on the item's level and the provided value field/s.
 * Used in the MultiSelectTree component.
 */
const valueFrom = ({ dataItem, index, level }, valueField) => {
    const fields = Array.isArray(valueField) ? valueField : [valueField];
    // either use the explicitly provided value level, or infer it from the item index
    const valueLevel = isPresent(level) ? level : getHierarchicalItemLevel(index);
    // fall-back to the last available one, if the current node is in a deeper level
    const normalizedLevel = Math.min(valueLevel, fields.length - 1);
    const field = fields[normalizedLevel];
    return getter(field)(dataItem);
};
/**
 * @hidden
 * Returns the size class based on the component and size input.
 */
const getSizeClass = (component, size) => {
    const SIZE_CLASSES = {
        'small': `k-${component}-sm`,
        'medium': `k-${component}-md`,
        'large': `k-${component}-lg`
    };
    return SIZE_CLASSES[size];
};
/**
 * @hidden
 * Returns the rounded class based on the rounded input.
 */
const getRoundedClass = (rounded) => {
    const ROUNDED_CLASSES = {
        'small': 'k-rounded-sm',
        'medium': 'k-rounded-md',
        'large': 'k-rounded-lg',
        'full': 'k-rounded-full'
    };
    return ROUNDED_CLASSES[rounded];
};
/**
 * @hidden
 * Return the fillMode class based on the component and fillMode input.
 */
const getFillModeClass = (component, fillMode) => {
    const FILLMODE_CLASSES = {
        'solid': `k-${component}-solid`,
        'flat': `k-${component}-flat`,
        'outline': `k-${component}-outline`
    };
    return FILLMODE_CLASSES[fillMode];
};

/* tslint:disable:member-ordering */
/**
 * @hidden
 */
let SearchBarComponent = class SearchBarComponent {
    constructor(localization, renderer) {
        this.localization = localization;
        this.valueChange = new EventEmitter();
        this.onBlur = new EventEmitter();
        this.onFocus = new EventEmitter();
        this.onClick = new EventEmitter();
        this.onNavigate = new EventEmitter();
        this.searchBarClass = true;
        this._userInput = "";
        this._previousValue = "";
        this._placeholder = "";
        this.direction = localization.rtl ? 'rtl' : 'ltr';
        this.renderer = renderer;
    }
    get userInput() {
        return this._userInput;
    }
    set userInput(userInput) {
        this._userInput = userInput || "";
    }
    get value() {
        return this.input.nativeElement.value;
    }
    set placeholder(text) {
        this._placeholder = text || '';
        this.setInputSize();
    }
    get placeholder() {
        return this._placeholder;
    }
    get ariaExpanded() {
        return this.role === 'combobox' ? this.popupOpen : null;
    }
    ngOnInit() {
        this.localizationChangeSubscription = this.localization
            .changes.subscribe(({ rtl }) => this.direction = rtl ? 'rtl' : 'ltr');
    }
    ngOnChanges(changes) {
        let previousUserInput;
        if (this.input && (changes.userInput || changes.suggestedText)) {
            if (changes.userInput && changes.userInput.previousValue) {
                if (this._previousValue === changes.userInput.previousValue) {
                    previousUserInput = this._previousValue;
                }
                else {
                    previousUserInput = changes.userInput.currentValue || "";
                }
            }
            else {
                previousUserInput = this._previousValue;
            }
            const caretIndex = this.input.nativeElement.selectionStart;
            const caretAtEnd = previousUserInput.length === caretIndex;
            this.writeInputValue(this.suggestedText ? combineStr(this.userInput, this.suggestedText) : this.userInput);
            if (this.suggestedText) {
                this.setInputSelection(this.userInput.length, this.suggestedText.length);
            }
            else if (caretAtEnd) {
                this.setInputSelection(this.userInput.length, this.userInput.length);
            }
            else {
                this.setInputSelection(caretIndex, caretIndex);
            }
            this._previousValue = this.userInput;
        }
    }
    ngOnDestroy() {
        if (this.localizationChangeSubscription) {
            this.localizationChangeSubscription.unsubscribe();
        }
    }
    writeInputValue(text) {
        if (isDocumentAvailable()) {
            this.renderer.setProperty(this.input.nativeElement, 'value', text);
        }
    }
    setInputSelection(start, end) {
        if (isDocumentAvailable() && this.input.nativeElement === document.activeElement) {
            try {
                this.input.nativeElement.setSelectionRange(start, end);
            }
            catch (e) {
                //Make sure that the element is in the DOM before you invoke its methods
            }
        }
    }
    handleInput(event) {
        const value = event.target.value;
        if (value !== this.userInput) {
            this._previousValue = value;
            this.valueChange.emit(value);
        }
    }
    handleFocus(event) {
        this.onFocus.emit(event);
    }
    handleBlur(event) {
        this.onBlur.emit(event);
    }
    handleKeydown(event) {
        const keyCode = event.keyCode;
        const keys = [Keys.ArrowUp, Keys.ArrowDown, Keys.ArrowLeft, Keys.ArrowRight, Keys.Enter,
            Keys.Escape, Keys.Delete, Keys.Backspace, Keys.Home, Keys.End];
        if (keys.indexOf(keyCode) > -1) {
            this.onNavigate.emit(event);
        }
    }
    focus() {
        if (isDocumentAvailable()) {
            this.input.nativeElement.focus();
        }
    }
    blur() {
        if (isDocumentAvailable()) {
            this.input.nativeElement.blur();
        }
    }
    setInputSize() {
        const lengthOf = x => x ? x.length : 0;
        const input = this.input.nativeElement;
        const placeholderLength = lengthOf(this.placeholder);
        const textLength = lengthOf(this.value);
        const size = Math.max(placeholderLength, textLength, 1);
        this.renderer.setAttribute(input, 'size', size.toString());
    }
};
SearchBarComponent.ɵfac = function SearchBarComponent_Factory(t) { return new (t || SearchBarComponent)(ɵngcc0.ɵɵdirectiveInject(ɵngcc1.LocalizationService), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.Renderer2)); };
SearchBarComponent.ɵcmp = /*@__PURE__*/ ɵngcc0.ɵɵdefineComponent({ type: SearchBarComponent, selectors: [["kendo-searchbar"]], viewQuery: function SearchBarComponent_Query(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵviewQuery(_c0, 7);
    } if (rf & 2) {
        let _t;
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.input = _t.first);
    } }, hostVars: 2, hostBindings: function SearchBarComponent_HostBindings(rf, ctx) { if (rf & 2) {
        ɵngcc0.ɵɵclassProp("k-searchbar", ctx.searchBarClass);
    } }, inputs: { userInput: "userInput", placeholder: "placeholder", id: "id", listId: "listId", tagListId: "tagListId", activeDescendant: "activeDescendant", noDataLabel: "noDataLabel", disabled: "disabled", readonly: "readonly", tabIndex: "tabIndex", popupOpen: "popupOpen", role: "role", suggestedText: "suggestedText" }, outputs: { valueChange: "valueChange", onBlur: "onBlur", onFocus: "onFocus", onClick: "onClick", onNavigate: "onNavigate" }, features: [ɵngcc0.ɵɵNgOnChangesFeature], decls: 2, vars: 21, consts: [["autocomplete", "off", "aria-haspopup", "listbox", 3, "id", "disabled", "readonly", "placeholder", "kendoEventsOutsideAngular", "scope", "input", "keydown"], ["input", ""]], template: function SearchBarComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵelementStart(0, "input", 0, 1);
        ɵngcc0.ɵɵlistener("input", function SearchBarComponent_Template_input_input_0_listener($event) { return ctx.handleInput($event); })("keydown", function SearchBarComponent_Template_input_keydown_0_listener($event) { return ctx.handleKeydown($event); });
        ɵngcc0.ɵɵelementEnd();
    } if (rf & 2) {
        ɵngcc0.ɵɵclassMap("k-input-inner");
        ɵngcc0.ɵɵproperty("id", ctx.id)("disabled", ctx.disabled)("readonly", ctx.readonly)("placeholder", ctx.placeholder)("kendoEventsOutsideAngular", ɵngcc0.ɵɵpureFunction2(18, _c1, ctx.handleFocus, ctx.handleBlur))("scope", ctx);
        ɵngcc0.ɵɵattribute("tabIndex", ctx.tabIndex)("dir", ctx.direction)("role", ctx.role)("aria-disabled", ctx.disabled)("aria-readonly", ctx.readonly)("aria-expanded", ctx.ariaExpanded)("aria-owns", ctx.listId)("aria-describedby", ctx.tagListId)("aria-activedescendant", ctx.activeDescendant)("aria-label", ctx.noDataLabel);
    } }, directives: [ɵngcc2.EventsOutsideAngularDirective], encapsulation: 2 });
__decorate([
    Input(),
    __metadata("design:type", String)
], SearchBarComponent.prototype, "id", void 0);
__decorate([
    Input(),
    __metadata("design:type", String)
], SearchBarComponent.prototype, "listId", void 0);
__decorate([
    Input(),
    __metadata("design:type", String)
], SearchBarComponent.prototype, "tagListId", void 0);
__decorate([
    Input(),
    __metadata("design:type", String)
], SearchBarComponent.prototype, "activeDescendant", void 0);
__decorate([
    Input(),
    __metadata("design:type", String)
], SearchBarComponent.prototype, "noDataLabel", void 0);
__decorate([
    Input(),
    __metadata("design:type", Boolean)
], SearchBarComponent.prototype, "disabled", void 0);
__decorate([
    Input(),
    __metadata("design:type", Boolean)
], SearchBarComponent.prototype, "readonly", void 0);
__decorate([
    Input(),
    __metadata("design:type", Number)
], SearchBarComponent.prototype, "tabIndex", void 0);
__decorate([
    Input(),
    __metadata("design:type", Boolean)
], SearchBarComponent.prototype, "popupOpen", void 0);
__decorate([
    Input(),
    __metadata("design:type", String)
], SearchBarComponent.prototype, "role", void 0);
__decorate([
    Input(),
    __metadata("design:type", String),
    __metadata("design:paramtypes", [String])
], SearchBarComponent.prototype, "userInput", null);
__decorate([
    Input(),
    __metadata("design:type", String)
], SearchBarComponent.prototype, "suggestedText", void 0);
__decorate([
    Output(),
    __metadata("design:type", EventEmitter)
], SearchBarComponent.prototype, "valueChange", void 0);
__decorate([
    Output(),
    __metadata("design:type", EventEmitter)
], SearchBarComponent.prototype, "onBlur", void 0);
__decorate([
    Output(),
    __metadata("design:type", EventEmitter)
], SearchBarComponent.prototype, "onFocus", void 0);
__decorate([
    Output(),
    __metadata("design:type", EventEmitter)
], SearchBarComponent.prototype, "onClick", void 0);
__decorate([
    Output(),
    __metadata("design:type", EventEmitter)
], SearchBarComponent.prototype, "onNavigate", void 0);
__decorate([
    ViewChild('input', { static: true }),
    __metadata("design:type", ElementRef)
], SearchBarComponent.prototype, "input", void 0);
__decorate([
    HostBinding('class.k-searchbar'),
    __metadata("design:type", Boolean)
], SearchBarComponent.prototype, "searchBarClass", void 0);
__decorate([
    Input(),
    __metadata("design:type", String),
    __metadata("design:paramtypes", [String])
], SearchBarComponent.prototype, "placeholder", null);
SearchBarComponent = __decorate([ __metadata("design:paramtypes", [LocalizationService,
        Renderer2])
], SearchBarComponent);

/**
 * Renders the list item content. To define the item template, nest an `<ng-template>` tag
 * with the `kendo<ComponentName>ItemTemplate` directive inside the component tag. The template context is
 * set to the current component. To get a reference to the current data item, use the `let-dataItem` directive.
 *
 * - [Using `ItemTemplate` with the AutoComplete]({% slug templates_autocomplete %}#toc-item-template)
 * - [Using `ItemTemplate` with the ComboBox]({% slug templates_combobox %}#toc-item-template)
 * - [Using `ItemTemplate` with the DropDownList]({% slug templates_ddl %}#toc-item-template)
 * - [Using `ItemTemplate` with the MultiSelect]({% slug templates_multiselect %}#toc-item-template)
 *
 * @example
 * ```ts
 * _@Component({
 * selector: 'my-app',
 * template: `
 *  <kendo-combobox [data]="listItems">
 *    <ng-template kendoComboBoxItemTemplate let-dataItem>
 *      <span>{{dataItem}} option</span>
 *    </ng-template>
 *  </kendo-combobox>
 * `
 * })
 * class AppComponent {
 *   public listItems: Array<string> = ["Item 1", "Item 2", "Item 3", "Item 4"];
 * }
 * ```
 */
let ItemTemplateDirective = class ItemTemplateDirective {
    constructor(templateRef) {
        this.templateRef = templateRef;
    }
};
ItemTemplateDirective.ɵfac = function ItemTemplateDirective_Factory(t) { return new (t || ItemTemplateDirective)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.TemplateRef)); };
ItemTemplateDirective.ɵdir = /*@__PURE__*/ ɵngcc0.ɵɵdefineDirective({ type: ItemTemplateDirective, selectors: [["", "kendoDropDownListItemTemplate", ""], ["", "kendoComboBoxItemTemplate", ""], ["", "kendoAutoCompleteItemTemplate", ""], ["", "kendoMultiSelectItemTemplate", ""]] });
ItemTemplateDirective = __decorate([ __metadata("design:paramtypes", [TemplateRef])
], ItemTemplateDirective);

/**
 * Renders the header content of the list. To define the header template, nest an `<ng-template>` tag
 * with the `kendo<ComponentName>HeaderTemplate` directive inside the component tag.
 *
 * - [Using `HeaderTemplate` with the AutoComplete]({% slug templates_autocomplete %}#toc-header-template)
 * - [Using `HeaderTemplate` with the ComboBox]({% slug templates_combobox %}#toc-header-template)
 * - [Using `HeaderTemplate` with the MultiColumnComboBox]({% slug templates_multicolumncombobox %}#toc-header-template)
 * - [Using `HeaderTemplate` with the DropDownList]({% slug templates_ddl %}#toc-header-template)
 * - [Using `HeaderTemplate` with the DropDownTree]({% slug templates_ddt %}#toc-header-template)
 * - [Using `HeaderTemplate` with the MultiSelect]({% slug templates_multiselect %}#toc-header-template)
 *
 * @example
 * ```ts
 * _@Component({
 * selector: 'my-app',
 * template: `
 *  <kendo-combobox [data]="listItems">
 *    <ng-template kendoComboBoxHeaderTemplate>
 *      <h4>Header template</h4>
 *    </ng-template>
 *  </kendo-combobox>
 * `
 * })
 * class AppComponent {
 *   public listItems: Array<string> = ["Item 1", "Item 2", "Item 3", "Item 4"];
 * }
 * ```
 */
let HeaderTemplateDirective = class HeaderTemplateDirective {
    constructor(templateRef) {
        this.templateRef = templateRef;
    }
};
HeaderTemplateDirective.ɵfac = function HeaderTemplateDirective_Factory(t) { return new (t || HeaderTemplateDirective)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.TemplateRef)); };
HeaderTemplateDirective.ɵdir = /*@__PURE__*/ ɵngcc0.ɵɵdefineDirective({ type: HeaderTemplateDirective, selectors: [["", "kendoDropDownListHeaderTemplate", ""], ["", "kendoComboBoxHeaderTemplate", ""], ["", "kendoDropDownTreeHeaderTemplate", ""], ["", "kendoMultiColumnComboBoxHeaderTemplate", ""], ["", "kendoAutoCompleteHeaderTemplate", ""], ["", "kendoMultiSelectHeaderTemplate", ""], ["", "kendoMultiSelectTreeHeaderTemplate", ""]] });
HeaderTemplateDirective = __decorate([ __metadata("design:paramtypes", [TemplateRef])
], HeaderTemplateDirective);

/**
 * Renders the footer content of the list. To define the footer template, nest an `<ng-template>` tag
 * with the `kendo<ComponentName>FooterTemplate` directive inside the component tag.
 *
 * - [Using `FooterTemplate` with the AutoComplete]({% slug templates_autocomplete %}#toc-footer-template)
 * - [Using `FooterTemplate` with the ComboBox]({% slug templates_combobox %}#toc-footer-template)
 * - [Using `FooterTemplate` with the MultiColumnComboBox]({% slug templates_multicolumncombobox %}#toc-footer-template)
 * - [Using `FooterTemplate` with the DropDownList]({% slug templates_ddl %}#toc-footer-template)
 * - [Using `FooterTemplate` with the DropDownTree]({% slug templates_ddt %}#toc-footer-template)
 * - [Using `FooterTemplate` with the MultiSelect]({% slug templates_multiselect %}#toc-footer-template)
 *
 * @example
 * ```ts
 * _@Component({
 * selector: 'my-app',
 * template: `
 *  <kendo-combobox [data]="listItems">
 *    <ng-template kendoComboBoxFooterTemplate>
 *      <h4>Footer template</h4>
 *    </ng-template>
 *  </kendo-combobox>
 * `
 * })
 * class AppComponent {
 *   public listItems: Array<string> = ["Item 1", "Item 2", "Item 3", "Item 4"];
 * }
 * ```
 */
let FooterTemplateDirective = class FooterTemplateDirective {
    constructor(templateRef) {
        this.templateRef = templateRef;
    }
};
FooterTemplateDirective.ɵfac = function FooterTemplateDirective_Factory(t) { return new (t || FooterTemplateDirective)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.TemplateRef)); };
FooterTemplateDirective.ɵdir = /*@__PURE__*/ ɵngcc0.ɵɵdefineDirective({ type: FooterTemplateDirective, selectors: [["", "kendoDropDownListFooterTemplate", ""], ["", "kendoComboBoxFooterTemplate", ""], ["", "kendoDropDownTreeFooterTemplate", ""], ["", "kendoMultiColumnComboBoxFooterTemplate", ""], ["", "kendoAutoCompleteFooterTemplate", ""], ["", "kendoMultiSelectFooterTemplate", ""], ["", "kendoMultiSelectTreeFooterTemplate", ""]] });
FooterTemplateDirective = __decorate([ __metadata("design:paramtypes", [TemplateRef])
], FooterTemplateDirective);

/**
 * Renders the group header content. To define the group template, nest an `<ng-template>` tag
 * with the `kendo<ComponentName>GroupTemplate` directive inside the component tag. The template context is
 * set to the current component. To get a reference to the current data item, use the `let-groupName` directive.
 *
 * - [Using `GroupTemplate` with the AutoComplete]({% slug templates_autocomplete %}#toc-group-template)
 * - [Using `GroupTemplate` with the ComboBox]({% slug templates_combobox %}#toc-group-template)
 * - [Using `GroupTemplate` with the MultiColumnComboBox]({% slug templates_multicolumncombobox %}#toc-group-template)
 * - [Using `GroupTemplate` with the DropDownList]({% slug templates_ddl %}#toc-group-template)
 * - [Using `GroupTemplate` with the MultiSelect]({% slug templates_multiselect %}#toc-group-template)
 *
 * @example
 * ```ts
 * import { groupBy } from '@progress/kendo-data-query';
 * _@Component({
 * selector: 'my-app',
 * template: `
 *  <kendo-combobox [data]="groupedData" textField="name" valueField="name">
 *    <ng-template kendoComboBoxGroupTemplate let-groupName>
 *      <span>Food type: {{groupName}} option</span>
 *    </ng-template>
 *  </kendo-combobox>
 * `
 * })
 * class AppComponent {
 *   public data = [
 *       { name: "Pork", category: "Food", subcategory: "Meat" },
 *       { name: "Pepper", category: "Food", subcategory: "Vegetables" },
 *       { name: "Beef", category: "Food", subcategory: "Meat" }
 *   ];
 *   public groupedData = groupBy(this.data, [{field: "subcategory"}]);
 * }
 * ```
 */
let GroupTemplateDirective = class GroupTemplateDirective {
    constructor(templateRef) {
        this.templateRef = templateRef;
    }
};
GroupTemplateDirective.ɵfac = function GroupTemplateDirective_Factory(t) { return new (t || GroupTemplateDirective)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.TemplateRef)); };
GroupTemplateDirective.ɵdir = /*@__PURE__*/ ɵngcc0.ɵɵdefineDirective({ type: GroupTemplateDirective, selectors: [["", "kendoDropDownListGroupTemplate", ""], ["", "kendoComboBoxGroupTemplate", ""], ["", "kendoMultiColumnComboBoxGroupTemplate", ""], ["", "kendoAutoCompleteGroupTemplate", ""], ["", "kendoMultiSelectGroupTemplate", ""]] });
GroupTemplateDirective = __decorate([ __metadata("design:paramtypes", [TemplateRef])
], GroupTemplateDirective);

/**
 * Renders the fixed group header content. To define the fixed group template, nest an `<ng-template>` tag
 * with the `kendo<ComponentName>FixedGroupTemplate` directive inside the component tag. The template context is
 * set to the current component. To get a reference to the current data item, use the `let-groupName` directive.
 *
 * - [Using `FixedGroupTemplate` with the AutoComplete]({% slug templates_autocomplete %}#toc-fixed-group-template)
 * - [Using `FixedGroupTemplate` with the ComboBox]({% slug templates_combobox %}#toc-fixed-group-template)
 * - [Using `FixedGroupTemplate` with the MultiColumnComboBox]({% slug templates_multicolumncombobox %}#toc-fixed-group-template)
 * - [Using `FixedGroupTemplate` with the DropDownList]({% slug templates_ddl %}#toc-fixed-group-template)
 * - [Using `FixedGroupTemplate` with the MultiSelect]({% slug templates_multiselect %}#toc-fixed-group-template)
 *
 * @example
 * ```ts
 * import { groupBy } from '@progress/kendo-data-query';
 * _@Component({
 * selector: 'my-app',
 * template: `
 *  <kendo-combobox [data]="groupedData" textField="name" valueField="name">
 *    <ng-template kendoComboBoxFixedGroupTemplate let-groupName>
 *      <span>Food type: {{groupName}} option</span>
 *    </ng-template>
 *  </kendo-combobox>
 * `
 * })
 * class AppComponent {
 *   public data = [
 *       { name: "Pork", category: "Food", subcategory: "Meat" },
 *       { name: "Pepper", category: "Food", subcategory: "Vegetables" },
 *       { name: "Beef", category: "Food", subcategory: "Meat" }
 *   ];
 *   public groupedData = groupBy(this.data, [{field: "subcategory"}]);
 * }
 * ```
 */
let FixedGroupTemplateDirective = class FixedGroupTemplateDirective {
    constructor(templateRef) {
        this.templateRef = templateRef;
    }
};
FixedGroupTemplateDirective.ɵfac = function FixedGroupTemplateDirective_Factory(t) { return new (t || FixedGroupTemplateDirective)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.TemplateRef)); };
FixedGroupTemplateDirective.ɵdir = /*@__PURE__*/ ɵngcc0.ɵɵdefineDirective({ type: FixedGroupTemplateDirective, selectors: [["", "kendoDropDownListFixedGroupTemplate", ""], ["", "kendoComboBoxFixedGroupTemplate", ""], ["", "kendoMultiColumnComboBoxFixedGroupTemplate", ""], ["", "kendoAutoCompleteFixedGroupTemplate", ""], ["", "kendoMultiSelectFixedGroupTemplate", ""]] });
FixedGroupTemplateDirective = __decorate([ __metadata("design:paramtypes", [TemplateRef])
], FixedGroupTemplateDirective);

/**
 * @hidden
 */
let SelectionService = class SelectionService {
    /**
     * @hidden
     */
    constructor() {
        this.onSelect = new EventEmitter();
        this.onChange = new EventEmitter();
        this.onFocus = new EventEmitter();
        this.total = 0;
        this.selectedIndices = [];
    }
    getTotal() {
        return this.total;
    }
    isSelected(index) {
        return isPresent(this.selectedIndices.find(current => current === index));
    }
    isFocused(index) {
        return index === this.focused;
    }
    focus(index) {
        if (this.isFocused(index)) {
            return;
        }
        this.focused = index;
        this.onFocus.emit(index);
    }
    select(index) {
        if (this.isSelected(index)) {
            return;
        }
        this.selectedIndices = [index];
        this.focused = index;
        this.onSelect.emit({
            indices: [index],
            newSelection: isPresent(index)
        });
    }
    add(index) {
        if (this.isSelected(index)) {
            return;
        }
        this.selectedIndices.push(index);
        this.focused = index;
        this.onChange.emit({
            added: index,
            indices: this.selectedIndices.slice()
        });
    }
    unselect(index) {
        if (!this.isSelected(index)) {
            return;
        }
        const position = this.selectedIndices.indexOf(index);
        this.selectedIndices.splice(position, 1);
        this.focused = index;
        this.onChange.emit({
            indices: this.selectedIndices.slice(),
            removed: index
        });
    }
    change(index) {
        const newSelection = isPresent(index) && !this.isSelected(index);
        this.selectedIndices = [index];
        this.focused = index;
        this.onChange.emit({
            indices: [index],
            newSelection: newSelection
        });
    }
    resetSelection(index) {
        this.selectedIndices = index instanceof Array ? index : [index];
        this.focused = this.selectedIndices[this.selectedIndices.length - 1];
    }
    get selected() {
        return this.selectedIndices.slice();
    }
    get focused() {
        return this.focusedIndex;
    }
    set focused(index) {
        if (this.focusedIndex !== index) {
            this.focusedIndex = index;
            this.onFocus.emit(index);
        }
    }
};
SelectionService.ɵfac = function SelectionService_Factory(t) { return new (t || SelectionService)(); };
SelectionService.ɵprov = /*@__PURE__*/ ɵngcc0.ɵɵdefineInjectable({ token: SelectionService, factory: function (t) { return SelectionService.ɵfac(t); } });

/**
 * @hidden
 */
var NavigationAction;
(function (NavigationAction) {
    NavigationAction[NavigationAction["Undefined"] = 0] = "Undefined";
    NavigationAction[NavigationAction["Open"] = 1] = "Open";
    NavigationAction[NavigationAction["Close"] = 2] = "Close";
    NavigationAction[NavigationAction["Enter"] = 3] = "Enter";
    NavigationAction[NavigationAction["Tab"] = 4] = "Tab";
    NavigationAction[NavigationAction["Esc"] = 5] = "Esc";
    NavigationAction[NavigationAction["Delete"] = 6] = "Delete";
    NavigationAction[NavigationAction["Backspace"] = 7] = "Backspace";
    NavigationAction[NavigationAction["Home"] = 8] = "Home";
    NavigationAction[NavigationAction["End"] = 9] = "End";
    NavigationAction[NavigationAction["Up"] = 10] = "Up";
    NavigationAction[NavigationAction["Down"] = 11] = "Down";
    NavigationAction[NavigationAction["Left"] = 12] = "Left";
    NavigationAction[NavigationAction["Right"] = 13] = "Right";
})(NavigationAction || (NavigationAction = {}));

/**
 * @hidden
 */
let DataService = class DataService {
    /**
     * @hidden
     */
    constructor() {
        this.grouped = false;
        this.groupIndices = [];
    }
    set data(data) {
        this._data = data;
        this.grouped = this.isGrouped(data);
        if (this.grouped) {
            this.groupIndices = this.getGroupIndices(data);
            this._flatData = this.flatten(data);
        }
    }
    get data() {
        if (this.grouped) {
            return this._flatData;
        }
        return this._data;
    }
    /**
     * @hidden
     * Used to get the actual items count, i.e. excluding the header items in case of grouping.
     */
    get itemsCount() {
        if (!isPresent(this.data) || this.data.length === 0) {
            return 0;
        }
        const items = this.grouped ? this._flatData.filter(item => !item.header) : this.data;
        return items.length;
    }
    /**
     * @hidden
     * Used to determine if the component received grouped data.
     */
    isGrouped(data) {
        // GroupResult { aggregates: AggregateResult, field: string, items: object[], value: any }
        // https://www.telerik.com/kendo-angular-ui/components/dataquery/api/GroupResult/
        return (isPresent(data) && data.length !== 0) && isPresent(data[0]) && hasProps(data[0], ['aggregates', 'field', 'items', 'value']);
    }
    /**
     * @hidden
     * Used to calculate the last item index of each group.
     */
    getGroupIndices(data) {
        let groupIndices = [];
        for (let i = 0; i <= data.length - 1; i++) {
            groupIndices[i] = (groupIndices[i - 1] || 0) + data[i].items.length;
        }
        return groupIndices;
    }
    /**
     * @hidden
     * Used to get a flat array containing all items matching certain criteria.
     */
    filter(predicate) {
        let result = [];
        if (this.isGrouped(this.data)) {
            for (let i = 0; i <= this.groupIndices.length - 1; i++) {
                const matches = this.data[i].items.filter(predicate);
                if (matches) {
                    result = result.concat(matches);
                }
            }
        }
        else {
            result = this.data.filter(predicate);
        }
        return result;
    }
    /**
     * @hidden
     * Used to get the index of a given data item.
     */
    indexOf(item, startFrom = 0) {
        let predicate = (element) => {
            return element === item;
        };
        if (this.grouped) {
            predicate = (element) => {
                return element.value === item;
            };
        }
        return this.findIndex(predicate, startFrom);
    }
    /**
     * @hidden
     * Used to get the index of a data item based on an expression.
     */
    findIndex(predicate, startFrom = 0) {
        let index = -1;
        if (this.grouped) {
            const data = this._flatData.filter(item => !item.header && item.offsetIndex >= startFrom);
            index = data.findIndex(predicate);
            index = data[index] ? data[index].offsetIndex : -1;
        }
        else {
            const data = this.data.slice(startFrom);
            const itemIndex = data.findIndex(predicate);
            index = itemIndex !== -1 ? itemIndex + startFrom : -1;
        }
        return index;
    }
    /**
     * @hidden
     * Used to get the closest group header prior to an item index.
     */
    closestGroup(index) {
        for (let i = index; i >= 0; i--) {
            if (this._flatData[i].header) {
                return this._flatData[i];
            }
        }
    }
    /**
     * @hidden
     * Used to get the first item matching the criteria.
     */
    find(predicate) {
        const index = this.findIndex(predicate);
        return this.itemAt(index);
    }
    /**
     * @hidden
     * Used to get the true index in a flattened data array.
     */
    flatIndex(index) {
        if (this.itemsCount === 0) {
            return -1;
        }
        if (this.grouped) {
            const match = this._flatData.find((item) => !item.header && item.offsetIndex === index);
            if (match) {
                return match.index;
            }
        }
        else {
            return index;
        }
        return -1;
    }
    /**
     * @hidden
     * Used to get the item at the provided index.
     */
    itemAt(index) {
        let dataItem;
        if (this.itemsCount === 0) {
            return dataItem;
        }
        if (this.grouped) {
            const match = this._flatData.find((item) => !item.header && item.offsetIndex === index);
            if (match) {
                dataItem = match.value;
            }
        }
        else {
            dataItem = this.data[index];
        }
        return dataItem;
    }
    /**
     * @hidden
     * Used to get the group at the provided index.
     */
    groupAt(index) {
        if (this.itemsCount === 0 || !this.isGrouped) {
            return;
        }
        return this._flatData.find((item) => item.header && item.index === index);
    }
    /**
     * @hidden
     * Used to get the field by which the data is grouped.
     */
    groupField() {
        if (this.itemsCount === 0 || !this.isGrouped) {
            return null;
        }
        return this._data[0].field;
    }
    /**
     * @hidden
     * Used to get the group to which a dataItem belongs.
     */
    itemGroup(item) {
        if (!item || this.itemsCount === 0 || !this.isGrouped) {
            return;
        }
        const fieldName = this.groupField();
        if (fieldName) {
            return getter$1(item, fieldName);
        }
    }
    flatten(data, group = undefined, offset = 0, groupIndex = 0) {
        let flat = [];
        if (isPresent(group)) {
            flat.push({
                header: true,
                index: groupIndex + offset,
                offsetIndex: groupIndex,
                value: group
            });
        }
        for (let i = 0; i < data.length; i++) {
            let result = [];
            if (data[i].items) {
                result = this.flatten(data[i].items, data[i].value, offset, i);
                offset = offset + data[i].items.length;
            }
            else {
                result.push({
                    header: false,
                    index: groupIndex + offset + i + 1,
                    offsetIndex: offset + i,
                    value: data[i]
                });
            }
            flat = flat.concat(result);
        }
        return flat;
    }
};
DataService.ɵfac = function DataService_Factory(t) { return new (t || DataService)(); };
DataService.ɵprov = /*@__PURE__*/ ɵngcc0.ɵɵdefineInjectable({ token: DataService, factory: function (t) { return DataService.ɵfac(t); } });

/**
 * @hidden
 */
let DisabledItemsService = class DisabledItemsService {
    constructor(dataService) {
        this.dataService = dataService;
        this.itemDisabled = null;
    }
    isIndexDisabled(index) {
        if (this.itemDisabled) {
            const item = this.dataService.itemAt(index);
            if (isPresent(item)) {
                return this.itemDisabled({ dataItem: item, index });
            }
            else if (isPresent(this.defaultItem)) {
                return this.itemDisabled({ dataItem: this.defaultItem, index: -1 });
            }
        }
    }
    isItemDisabled(item) {
        if (this.itemDisabled) {
            const index = this.dataService.indexOf(item);
            if (index !== -1) {
                return this.itemDisabled({ dataItem: item, index });
            }
            else if (isPresent(this.defaultItem)) {
                return this.itemDisabled({ dataItem: this.defaultItem, index: -1 });
            }
        }
    }
};
DisabledItemsService.ɵfac = function DisabledItemsService_Factory(t) { return new (t || DisabledItemsService)(ɵngcc0.ɵɵinject(DataService)); };
DisabledItemsService.ɵprov = /*@__PURE__*/ ɵngcc0.ɵɵdefineInjectable({ token: DisabledItemsService, factory: function (t) { return DisabledItemsService.ɵfac(t); } });
DisabledItemsService = __decorate([ __metadata("design:paramtypes", [DataService])
], DisabledItemsService);

const MIN_INDEX = 0;
/**
 * @hidden
 */
class NavigationEvent {
    /**
     * The index of the item to which the user navigated.
     */
    constructor(index, originalEvent) {
        this.index = index;
        this.originalEvent = originalEvent;
    }
}
/**
 * @hidden
 */
let NavigationService = class NavigationService {
    constructor(disabledItemsService, selectionService) {
        this.disabledItemsService = disabledItemsService;
        this.selectionService = selectionService;
        this.open = new EventEmitter();
        this.close = new EventEmitter();
        this.enter = new EventEmitter();
        this.tab = new EventEmitter();
        this.esc = new EventEmitter();
        this.up = new EventEmitter();
        this.right = new EventEmitter();
        this.down = new EventEmitter();
        this.left = new EventEmitter();
        this.delete = new EventEmitter();
        this.backspace = new EventEmitter();
        this.home = new EventEmitter();
        this.end = new EventEmitter();
    }
    process(args) {
        const keyCode = args.originalEvent.keyCode;
        const altKey = args.originalEvent.altKey;
        let index;
        let action = NavigationAction.Undefined;
        if (altKey && keyCode === Keys.ArrowDown) {
            action = NavigationAction.Open;
        }
        else if (altKey && keyCode === Keys.ArrowUp) {
            action = NavigationAction.Close;
        }
        else if (keyCode === Keys.Enter) {
            action = NavigationAction.Enter;
        }
        else if (keyCode === Keys.Escape) {
            action = NavigationAction.Esc;
        }
        else if (keyCode === Keys.Tab) {
            action = NavigationAction.Tab;
        }
        else if (keyCode === Keys.ArrowUp) {
            index = this.next({ current: args.current, start: args.min, end: args.max, step: -1 });
            action = NavigationAction.Up;
        }
        else if (keyCode === Keys.ArrowLeft) {
            index = this.next({ current: args.current, start: args.min, end: args.max, step: -1 });
            action = NavigationAction.Left;
        }
        else if (keyCode === Keys.ArrowDown) {
            index = this.next({ current: args.current, start: args.min, end: args.max, step: 1 });
            action = NavigationAction.Down;
        }
        else if (keyCode === Keys.ArrowRight) {
            index = this.next({ current: args.current, start: args.min, end: args.max, step: 1 });
            action = NavigationAction.Right;
        }
        else if (keyCode === Keys.Home) {
            index = this.isDisabled(MIN_INDEX) ? args.current : MIN_INDEX;
            action = NavigationAction.Home;
        }
        else if (keyCode === Keys.End) {
            index = this.isDisabled(args.max) ? args.current : args.max;
            action = NavigationAction.End;
        }
        else if (keyCode === Keys.Delete) {
            action = NavigationAction.Delete;
        }
        else if (keyCode === Keys.Backspace) {
            action = NavigationAction.Backspace;
        }
        const eventData = new NavigationEvent(index, args.originalEvent);
        if (action !== NavigationAction.Undefined) {
            this[NavigationAction[action].toLowerCase()].emit(eventData);
        }
        return action;
    }
    next(args) {
        const { current, start, end, step } = args;
        const nextIndex = !isPresent(current) ? start : this.clampIndex(current + step, start, end);
        const firstFocusableIndex = this.firstFocusableIndex(nextIndex, start, end, step);
        if (isPresent(firstFocusableIndex)) {
            return firstFocusableIndex;
        }
        if (this.selectionService.isSelected(current) && current >= start) {
            return current;
        }
        const inversedStep = -1 * step;
        return this.firstFocusableIndex(nextIndex, start, end, inversedStep);
    }
    clampIndex(index, min, max) {
        if (!isPresent(index) || index < min) {
            return min;
        }
        if (index > max) {
            return max;
        }
        return index;
    }
    firstFocusableIndex(startIndex, min, max, step) {
        while (min <= startIndex && startIndex <= max) {
            if (!this.isDisabled(startIndex)) {
                return startIndex;
            }
            startIndex += step;
        }
        return undefined;
    }
    isDisabled(index) {
        if (this.disabledItemsService) {
            return this.disabledItemsService.isIndexDisabled(index);
        }
    }
};
NavigationService.ɵfac = function NavigationService_Factory(t) { return new (t || NavigationService)(ɵngcc0.ɵɵinject(DisabledItemsService), ɵngcc0.ɵɵinject(SelectionService)); };
NavigationService.ɵprov = /*@__PURE__*/ ɵngcc0.ɵɵdefineInjectable({ token: NavigationService, factory: function (t) { return NavigationService.ɵfac(t); } });
NavigationService = __decorate([ __metadata("design:paramtypes", [DisabledItemsService,
        SelectionService])
], NavigationService);

/**
 * Renders content when no data is available. To define the no-data template, nest a `<ng-template>` tag
 * with the `kendo<ComponentName>NoDataTemplate` directive inside the component tag.
 *
 * - [Using `NoDataTemplate` with the AutoComplete]({% slug templates_autocomplete %}#toc-no-data-template)
 * - [Using `NoDataTemplate` with the ComboBox]({% slug templates_combobox %}#toc-no-data-template)
 * - [Using `NoDataTemplate` with the MultiColumnComboBox]({% slug templates_multicolumncombobox %}#toc-no-data-template)
 * - [Using `NoDataTemplate` with the DropDownList]({% slug templates_ddl %}#toc-no-data-template)
 * - [Using `NoDataTemplate` with the DropDownTree]({% slug templates_ddt %}#toc-no-data-template)
 * - [Using `NoDataTemplate` with the MultiSelect]({% slug templates_multiselect %}#toc-no-data-template)
 *
 * @example
 * ```ts
 * _@Component({
 * selector: 'my-app',
 * template: `
 *  <kendo-combobox [data]="listItems">
 *    <ng-template kendoComboBoxNoDataTemplate>
 *      <h4>No data!</h4>
 *    </ng-template>
 *  </kendo-combobox>
 * `
 * })
 * class AppComponent {
 *   public listItems: Array<string> = [];
 * }
 * ```
 */
let NoDataTemplateDirective = class NoDataTemplateDirective {
    constructor(templateRef) {
        this.templateRef = templateRef;
    }
};
NoDataTemplateDirective.ɵfac = function NoDataTemplateDirective_Factory(t) { return new (t || NoDataTemplateDirective)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.TemplateRef)); };
NoDataTemplateDirective.ɵdir = /*@__PURE__*/ ɵngcc0.ɵɵdefineDirective({ type: NoDataTemplateDirective, selectors: [["", "kendoDropDownListNoDataTemplate", ""], ["", "kendoDropDownTreeNoDataTemplate", ""], ["", "kendoComboBoxNoDataTemplate", ""], ["", "kendoMultiColumnComboBoxNoDataTemplate", ""], ["", "kendoAutoCompleteNoDataTemplate", ""], ["", "kendoMultiSelectNoDataTemplate", ""], ["", "kendoMultiSelectTreeNoDataTemplate", ""]] });
NoDataTemplateDirective = __decorate([ __metadata("design:paramtypes", [TemplateRef])
], NoDataTemplateDirective);

/**
 * @hidden
 */
class PreventableEvent {
    constructor() {
        this.prevented = false;
    }
    /**
     * Prevents the default action for a specified event.
     * In this way, the source component suppresses the built-in behavior that follows the event.
     */
    preventDefault() {
        this.prevented = true;
    }
    /**
     * If the event is prevented by any of its subscribers, returns `true`.
     *
     * @returns `true` if the default action was prevented. Otherwise, returns `false`.
     */
    isDefaultPrevented() {
        return this.prevented;
    }
}

/**
 * Defines the mandatory properties of the `kendoDropDownFilter` directive
 * so that `kendoDropDownFilter` can be used with any of the DropDowns components
 * which implement the `FilterableDropDownComponentBase` class.
 *
 * @hidden
 */
class FilterableComponent {
}

/**
 * @hidden
 */
let ListItemDirective = class ListItemDirective {
    constructor(element) {
        this.element = element;
    }
};
ListItemDirective.ɵfac = function ListItemDirective_Factory(t) { return new (t || ListItemDirective)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ElementRef)); };
ListItemDirective.ɵdir = /*@__PURE__*/ ɵngcc0.ɵɵdefineDirective({ type: ListItemDirective, selectors: [["li", "role", "option"], ["li", "role", "group"]] });
ListItemDirective = __decorate([ __metadata("design:paramtypes", [ElementRef])
], ListItemDirective);

/**
 * @hidden
 */
let ListComponent = class ListComponent {
    /* tslint:disable:member-ordering */
    constructor(dataService, wrapper, selectionService, disabledItemsService, cdr, zone, renderer) {
        this.dataService = dataService;
        this.wrapper = wrapper;
        this.selectionService = selectionService;
        this.disabledItemsService = disabledItemsService;
        this.cdr = cdr;
        this.zone = zone;
        this.renderer = renderer;
        this.selected = [];
        this.focused = -1;
        this.show = true;
        this.multipleSelection = false;
        this.type = 'list';
        this.checkboxes = { enabled: false };
        this.rounded = 'medium';
        this.onClick = new EventEmitter();
        this.pageChange = new EventEmitter();
        this.listResize = new EventEmitter();
        this.startFrom = 0;
        this.lastLoaded = 0;
        this.lastScrollTop = 0;
        this.scrollToFocused = false;
        this._size = 'medium';
        this.selectSubscription = merge(this.selectionService.onSelect.pipe(map((args) => args.indices[0])), this.selectionService.onFocus)
            .pipe(
        // handle only the very last onSelect/onFocus emission
        switchMap(event => this.zone.onStable.pipe(take(1), map(() => event))))
            .subscribe(this.scrollToItem.bind(this));
        this.prepareClasses();
    }
    set data(data) {
        this._data = data[0] && data[0].header ? data.slice(0) : data;
    }
    get data() {
        return this._data;
    }
    set size(size) {
        if (this.type === 'list') {
            this.renderer.removeClass(this.wrapper.nativeElement, getSizeClass('list', this.size));
            if (size) {
                this.renderer.addClass(this.wrapper.nativeElement, getSizeClass('list', size));
            }
            this._size = size;
        }
    }
    get size() {
        return this._size;
    }
    get pageSize() {
        if (this.virtual.pageSize) {
            return this.virtual.pageSize;
        }
        let size = Math.round(this.height / this.virtual.itemHeight);
        return size;
    }
    get scrollHeight() {
        return (this.dataService.grouped ? this.virtual.total - 1 : this.virtual.total) * this.virtual.itemHeight;
    }
    get overflowY() {
        if (isPresent(this.virtual)) {
            const overflow = this.hasVirtualScrollbar() ? 'scroll' : 'hidden';
            return overflow;
        }
    }
    /**
     * @hidden
     */
    get checkboxClasses() {
        return `${this.size ? getSizeClass('checkbox', this.size) : ''} ${this.rounded ? getRoundedClass(this.rounded) : ''}`;
    }
    ngOnChanges(changes) {
        if (isChanged('data', changes, false)) {
            if (this.lastLoaded <= 0) {
                this.lastLoaded = this.data.length - 1;
                this.scrollToFocused = !changes.data.isFirstChange();
            }
            this.setOverflow();
        }
        if (isChanged('virtual', changes, false)) {
            this.setOverflow();
        }
        if (isChanged('type', changes, false)) {
            this.prepareClasses();
        }
    }
    ngAfterViewInit() {
        this.setComponentClasses();
        this.zone.runOutsideAngular(() => {
            this.scrollSubscription = fromEvent(this.content.nativeElement, "scroll").pipe(auditTime(100), tap(this.prefetchData.bind(this)), tap(this.findCurrentGroup.bind(this))).subscribe(() => {
                this.lastScrollTop = this.content.nativeElement.scrollTop;
            });
        });
        this.setOverflow();
    }
    ngAfterViewChecked() {
        if (this.virtual) {
            this.positionItems();
        }
        if (this.items && this.scrollToFocused) {
            this.scrollToFocused = false;
            const scrollTarget = this.items.length && this.selectionService.focused === -1 ? 0 : this.selectionService.focused;
            this.scrollToItem(scrollTarget);
        }
        if (this.dataService.grouped) {
            this.findCurrentGroup();
        }
    }
    ngOnDestroy() {
        this.selectSubscription.unsubscribe();
        if (this.scrollSubscription) {
            this.scrollSubscription.unsubscribe();
        }
    }
    onCheckedChange(e, index) {
        const isChecked = e.target['checked'];
        if (isChecked && !this.selectionService.isSelected(index)) {
            this.selectionService.add(index);
        }
        if (!isChecked && this.selectionService.isSelected(index)) {
            this.selectionService.unselect(index);
        }
    }
    prepareClasses() {
        if (this.type === 'list') {
            this.listContentClass = 'k-list-content';
            this.listClass = 'k-list-ul';
            this.listItemClass = 'k-list-item';
            this.listVirtualClass = 'k-virtual-list';
            this.listGroupStickyHeaderClass = 'k-list-group-sticky-header';
            this.listGroupStickyHeaderTextClass = 'k-list-header-text';
            this.listGroupItemClass = 'k-list-group-item';
            this.listGroupItemTextClass = 'k-list-item-text';
        }
        else {
            this.listContentClass = 'k-table-body k-table-scroller';
            this.listClass = 'k-table k-table-list';
            this.listItemClass = 'k-table-row';
            this.listVirtualClass = 'k-virtual-table';
            this.listGroupStickyHeaderClass = 'k-table-group-sticky-header';
            this.listGroupStickyHeaderTextClass = 'k-table-th';
            this.listGroupItemClass = 'k-table-group-row';
            this.listGroupItemTextClass = 'k-table-th';
        }
    }
    isChecked(index) {
        const normalizedIndex = this.virtual ? index + this.virtual.skip : index;
        return this.selectionService.isSelected(normalizedIndex);
    }
    firstVisibleItem() {
        const content = this.content.nativeElement;
        const rect = content.getBoundingClientRect();
        // IE9 hack
        const disabled = Array.prototype.slice.call(content.querySelectorAll(".k-disabled"));
        // This is a workaround for finding elements with pointer-events: none;
        disabled.forEach((el) => this.renderer.setStyle(el, "pointer-events", "auto"));
        const item = document.elementFromPoint(rect.left + 1, rect.top + 1);
        disabled.forEach((el) => this.renderer.setStyle(el, "pointer-events", "none"));
        // return the closest `li` item to cover the custom template scenario
        return closest(item, 'li');
    }
    findCurrentGroup() {
        if (!this.dataService.grouped) {
            this.currentGroup = undefined;
            return;
        }
        const item = this.firstVisibleItem();
        if (item) {
            let index;
            if (item.getAttribute("role") === "group") {
                index = parseInt(item.getAttribute("group-index"), 10);
                this.currentGroup = this.dataService.groupAt(index).value;
            }
            else {
                index = parseInt(item.getAttribute("index"), 10);
                this.currentGroup = this.dataService.itemGroup(this.dataService.itemAt(index));
            }
        }
        else {
            this.currentGroup = undefined;
        }
        this.cdr.detectChanges();
    }
    prefetchData() {
        if (!this.virtual) {
            return;
        }
        const visibleItems = Math.trunc(this.content.nativeElement.clientHeight / this.virtual.itemHeight);
        const offsetY = this.content.nativeElement.scrollTop;
        const start = Math.trunc(offsetY / this.virtual.itemHeight);
        const down = offsetY > this.lastScrollTop;
        const nextPage = (start + visibleItems >= this.lastLoaded) && this.lastLoaded < this.virtual.total - 1;
        const leftOver = this.pageSize - (this.lastLoaded - this.startFrom);
        const prevPage = this.lastLoaded - this.pageSize + visibleItems >= start - leftOver;
        if (down && nextPage) {
            this.changePage(start);
        }
        if (!down && prevPage) {
            this.changePage(start - this.pageSize + visibleItems + 1);
        }
    }
    changePage(start) {
        this.zone.run(() => {
            let end = this.pageSize + start;
            if (end > this.virtual.total) {
                start--;
                end = this.virtual.total;
            }
            if (start < 0) {
                start = 0;
            }
            this.startFrom = start;
            this.lastLoaded = end;
            this.pageChange.emit({ skip: start, take: this.pageSize });
        });
    }
    index(groupIndex, itemIndex) {
        return groupIndex > 0 ? (this.dataService.groupIndices[groupIndex - 1] + itemIndex) : itemIndex;
    }
    getText(dataItem) {
        return getter$1(dataItem, this.textField);
    }
    getValue(dataItem) {
        return getter$1(dataItem, this.valueField);
    }
    isDisabled(index) {
        if (isPresent(this.virtual)) {
            index += this.virtual.skip;
        }
        return this.disabledItemsService.isIndexDisabled(index);
    }
    isAltRow(index) {
        return this.type === 'dropdowngrid' && index % 2 !== 0;
    }
    scrollToItem(index) {
        let flatIndex = index;
        if (this.dataService.grouped) {
            // takes into account the group header items
            flatIndex = this.dataService.flatIndex(index);
            /* The first group header item is not rendered in the list (see template), so subtract 1 when calulating the flat index.
               With virtualization enabled, the first group header could be in a previous page, in which case don't subtract anything. */
            const groupHeaderOffset = this.firstGroupHeaderInTargetedPage(flatIndex) ? -1 : 0;
            flatIndex += groupHeaderOffset;
        }
        if (this.virtual && flatIndex > -1) {
            this.scrollToIndex(flatIndex);
            return;
        }
        const items = this.items.toArray();
        if (isPresent(items[flatIndex]) && flatIndex !== -1) {
            this.scroll(items[flatIndex].element);
        }
    }
    scrollToIndex(index) {
        let content = this.content.nativeElement;
        let contentScrollTop = content.scrollTop;
        const itemOffsetTop = index * this.virtual.itemHeight;
        const itemOffsetHeight = this.virtual.itemHeight;
        const contentOffsetHeight = content.clientHeight;
        const bottomDistance = itemOffsetTop + itemOffsetHeight;
        if (contentScrollTop > itemOffsetTop) {
            contentScrollTop = itemOffsetTop;
        }
        else if (bottomDistance > (contentScrollTop + contentOffsetHeight)) {
            contentScrollTop = (bottomDistance - contentOffsetHeight);
        }
        content.scrollTop = contentScrollTop;
    }
    scroll(item) {
        if (!item) {
            return;
        }
        const nativeElement = item.nativeElement;
        let content = this.content.nativeElement, itemOffsetTop = nativeElement.offsetTop, itemOffsetHeight = nativeElement.offsetHeight, contentScrollTop = content.scrollTop, contentOffsetHeight = content.clientHeight, bottomDistance = itemOffsetTop + itemOffsetHeight;
        if (contentScrollTop > itemOffsetTop) {
            contentScrollTop = itemOffsetTop;
        }
        else if (bottomDistance > (contentScrollTop + contentOffsetHeight)) {
            contentScrollTop = (bottomDistance - contentOffsetHeight);
        }
        content.scrollTop = contentScrollTop;
    }
    /**
     * Indicates whether a scrollbar is currently rendered in the list.
     */
    hasScrollbar() {
        if (!(isPresent(this.items) && this.items.length && isPresent(this.list) && isPresent(this.content))) {
            return false;
        }
        const hasVirtualScroll = isPresent(this.virtual) && this.hasVirtualScrollbar();
        return hasVirtualScroll || this.list.nativeElement.scrollHeight > this.content.nativeElement.offsetHeight;
    }
    /**
     * Sets the list's content overflow (hides/shows scrollbar)
     */
    setOverflow() {
        if (this.virtual) {
            const overflow = this.hasVirtualScrollbar() ? 'scroll' : 'hidden';
            this.renderer.setStyle(this.content.nativeElement, 'overflow-y', overflow);
        }
    }
    /**
     * Indicates whether the scrollbar should be visible in virtual mode.
     */
    hasVirtualScrollbar() {
        const contentOffsetHeight = this.content.nativeElement.offsetHeight;
        const virtualOffsetHeight = this.virtualContainer && this.virtualContainer.nativeElement.offsetHeight;
        return this.virtualContainer && virtualOffsetHeight > contentOffsetHeight;
    }
    positionItems() {
        this.items.forEach((item, index) => {
            const offsetY = (index + this.startFrom) * this.virtual.itemHeight;
            this.renderer.setStyle(item.element.nativeElement, "transform", `translateY(${offsetY}px`);
        });
    }
    /**
     * Indicates whether the first group header from the data set is in the targeted virtual page.
     */
    firstGroupHeaderInTargetedPage(itemIndex) {
        if (!isPresent(this.virtual)) {
            return true;
        }
        return this.virtual.skip === 0 && (this.virtual.pageSize > itemIndex);
    }
    setComponentClasses() {
        if (this.type === 'list') {
            this.renderer.addClass(this.wrapper.nativeElement, 'k-list');
            if (this.size) {
                this.renderer.addClass(this.wrapper.nativeElement, getSizeClass('list', this.size));
            }
        }
        if (isPresent(this.virtual)) {
            this.renderer.addClass(this.wrapper.nativeElement, this.listVirtualClass);
        }
    }
};
ListComponent.ɵfac = function ListComponent_Factory(t) { return new (t || ListComponent)(ɵngcc0.ɵɵdirectiveInject(DataService), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ElementRef), ɵngcc0.ɵɵdirectiveInject(SelectionService), ɵngcc0.ɵɵdirectiveInject(DisabledItemsService), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ChangeDetectorRef), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.NgZone), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.Renderer2)); };
ListComponent.ɵcmp = /*@__PURE__*/ ɵngcc0.ɵɵdefineComponent({ type: ListComponent, selectors: [["kendo-list"]], viewQuery: function ListComponent_Query(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵviewQuery(_c2, 7);
        ɵngcc0.ɵɵviewQuery(_c3, 7);
        ɵngcc0.ɵɵviewQuery(_c4, 5);
        ɵngcc0.ɵɵviewQuery(ListItemDirective, 5);
    } if (rf & 2) {
        let _t;
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.content = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.list = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.virtualContainer = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.items = _t);
    } }, inputs: { selected: "selected", focused: "focused", show: "show", multipleSelection: "multipleSelection", type: "type", checkboxes: "checkboxes", rounded: "rounded", data: "data", size: "size", textField: "textField", valueField: "valueField", height: "height", template: "template", groupTemplate: "groupTemplate", fixedGroupTemplate: "fixedGroupTemplate", id: "id", optionPrefix: "optionPrefix", virtual: "virtual" }, outputs: { onClick: "onClick", pageChange: "pageChange", listResize: "listResize" }, features: [ɵngcc0.ɵɵNgOnChangesFeature], decls: 9, vars: 15, consts: [[3, "class", "ngStyle", 4, "ngIf"], ["unselectable", "on"], ["content", ""], ["role", "listbox"], ["list", ""], [4, "ngIf"], [3, "resize", 4, "ngIf"], ["class", "k-height-container", "role", "presentation", 4, "ngIf"], [3, "ngStyle"], [3, "ngIf"], [3, "templateContext"], ["ngFor", "", 3, "ngForOf"], ["role", "option", "kendoDropDownsSelectable", "", 3, "checkboxes", "height", "index", "multipleSelection", "ngClass"], ["type", "checkbox", "class", "k-checkbox", 3, "ngClass", "checked", "change", 4, "ngIf"], ["type", "checkbox", 1, "k-checkbox", 3, "ngClass", "checked", "change"], [1, "k-list-item-text"], ["role", "group", 3, "class", "k-table-alt-row", "ngStyle", 4, "ngIf"], ["role", "option", "kendoDropDownsSelectable", "", 3, "height", "index", "multipleSelection", "class", "ngClass", 4, "ngIf"], ["role", "group", 3, "ngStyle"], ["role", "option", "kendoDropDownsSelectable", "", 3, "height", "index", "multipleSelection", "ngClass"], [3, "resize"], ["role", "presentation", 1, "k-height-container"], ["virtualContainer", ""]], template: function ListComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵtemplate(0, ListComponent_div_0_Template, 3, 9, "div", 0);
        ɵngcc0.ɵɵelementStart(1, "div", 1, 2)(3, "ul", 3, 4);
        ɵngcc0.ɵɵtemplate(5, ListComponent_5_Template, 1, 1, null, 5);
        ɵngcc0.ɵɵtemplate(6, ListComponent_6_Template, 1, 1, null, 5);
        ɵngcc0.ɵɵtemplate(7, ListComponent_kendo_resize_sensor_7_Template, 1, 0, "kendo-resize-sensor", 6);
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵtemplate(8, ListComponent_div_8_Template, 4, 2, "div", 7);
        ɵngcc0.ɵɵelementEnd();
    } if (rf & 2) {
        ɵngcc0.ɵɵproperty("ngIf", ctx.dataService.grouped);
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵclassMap(ctx.listContentClass);
        ɵngcc0.ɵɵstyleProp("overscroll-behavior", "none")("max-height", ctx.height, "px");
        ɵngcc0.ɵɵadvance(2);
        ɵngcc0.ɵɵclassMap(ctx.listClass);
        ɵngcc0.ɵɵattribute("id", ctx.id)("aria-hidden", !ctx.show);
        ɵngcc0.ɵɵadvance(2);
        ɵngcc0.ɵɵproperty("ngIf", !ctx.dataService.grouped && ctx.show);
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngIf", ctx.dataService.grouped);
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngIf", !ctx.virtual);
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngIf", ctx.virtual);
    } }, directives: function () { return [ɵngcc3.NgIf, ɵngcc3.NgStyle, TemplateContextDirective, ɵngcc3.NgForOf, ListItemDirective, SelectableDirective, ɵngcc3.NgClass, ɵngcc2.ResizeSensorComponent]; }, encapsulation: 2 });
__decorate([
    Input(),
    __metadata("design:type", Array)
], ListComponent.prototype, "selected", void 0);
__decorate([
    Input(),
    __metadata("design:type", Number)
], ListComponent.prototype, "focused", void 0);
__decorate([
    Input(),
    __metadata("design:type", String)
], ListComponent.prototype, "textField", void 0);
__decorate([
    Input(),
    __metadata("design:type", String)
], ListComponent.prototype, "valueField", void 0);
__decorate([
    Input(),
    __metadata("design:type", Number)
], ListComponent.prototype, "height", void 0);
__decorate([
    Input(),
    __metadata("design:type", ItemTemplateDirective)
], ListComponent.prototype, "template", void 0);
__decorate([
    Input(),
    __metadata("design:type", GroupTemplateDirective)
], ListComponent.prototype, "groupTemplate", void 0);
__decorate([
    Input(),
    __metadata("design:type", FixedGroupTemplateDirective)
], ListComponent.prototype, "fixedGroupTemplate", void 0);
__decorate([
    Input(),
    __metadata("design:type", Boolean)
], ListComponent.prototype, "show", void 0);
__decorate([
    Input(),
    __metadata("design:type", String)
], ListComponent.prototype, "id", void 0);
__decorate([
    Input(),
    __metadata("design:type", String)
], ListComponent.prototype, "optionPrefix", void 0);
__decorate([
    Input(),
    __metadata("design:type", Boolean)
], ListComponent.prototype, "multipleSelection", void 0);
__decorate([
    Input(),
    __metadata("design:type", Object)
], ListComponent.prototype, "virtual", void 0);
__decorate([
    Input(),
    __metadata("design:type", String)
], ListComponent.prototype, "type", void 0);
__decorate([
    Input(),
    __metadata("design:type", Object)
], ListComponent.prototype, "checkboxes", void 0);
__decorate([
    Input(),
    __metadata("design:type", Array),
    __metadata("design:paramtypes", [Array])
], ListComponent.prototype, "data", null);
__decorate([
    Input(),
    __metadata("design:type", String),
    __metadata("design:paramtypes", [String])
], ListComponent.prototype, "size", null);
__decorate([
    Input(),
    __metadata("design:type", String)
], ListComponent.prototype, "rounded", void 0);
__decorate([
    Output(),
    __metadata("design:type", EventEmitter)
], ListComponent.prototype, "onClick", void 0);
__decorate([
    Output(),
    __metadata("design:type", EventEmitter)
], ListComponent.prototype, "pageChange", void 0);
__decorate([
    Output(),
    __metadata("design:type", EventEmitter)
], ListComponent.prototype, "listResize", void 0);
__decorate([
    ViewChildren(ListItemDirective),
    __metadata("design:type", QueryList)
], ListComponent.prototype, "items", void 0);
__decorate([
    ViewChild('content', { static: true }),
    __metadata("design:type", ElementRef)
], ListComponent.prototype, "content", void 0);
__decorate([
    ViewChild('list', { static: true }),
    __metadata("design:type", ElementRef)
], ListComponent.prototype, "list", void 0);
__decorate([
    ViewChild('virtualContainer', { static: false }),
    __metadata("design:type", ElementRef)
], ListComponent.prototype, "virtualContainer", void 0);
ListComponent = __decorate([ __metadata("design:paramtypes", [DataService,
        ElementRef,
        SelectionService,
        DisabledItemsService,
        ChangeDetectorRef,
        NgZone,
        Renderer2])
], ListComponent);

/**
 * @hidden
 */
const DEFAULTS = {
    pageSize: 50,
    itemHeight: 28
};
/**
 * @hidden
 */
const normalizeVirtualizationSettings = (settings, defaultOverrides) => {
    const defaults = Object.assign({}, DEFAULTS, defaultOverrides);
    if (settings === true) {
        return defaults;
    }
    if (!settings) {
        return null;
    }
    return Object.assign({ pageSize: DEFAULTS.pageSize }, settings);
};

/**
 * @hidden
 */
const TOUCH_ENABLED = new InjectionToken('dropdowns-touch-enabled');

/* tslint:disable:member-ordering */
var AutoCompleteComponent_1;
const NO_VALUE = "";
/**
 * @hidden
 */
const AUTOCOMPLETE_VALUE_ACCESSOR = {
    multi: true,
    provide: NG_VALUE_ACCESSOR,
    useExisting: forwardRef(() => AutoCompleteComponent)
};
/**
 * Represents the [Kendo UI AutoComplete component for Angular]({% slug overview_autocomplete %}).
 *
 * @example
 * ```ts
 * _@Component({
 * selector: 'my-app',
 * template: `
 *  <kendo-autocomplete
 *      [data]="listItems"
 *      [placeholder]="placeholder"
 *  >
 * `
 * })
 * class AppComponent {
 *   public placeholder: string = 'Type "it" for suggestions';
 *   public listItems: Array<string> = ["Item 1", "Item 2", "Item 3", "Item 4"];
 * }
 * ```
 */
let AutoCompleteComponent = AutoCompleteComponent_1 = class AutoCompleteComponent {
    constructor(localization, dataService, popupService, selectionService, navigationService, disabledItemsService, _zone, cdr, renderer, hostElement, touchEnabled$$1) {
        this.localization = localization;
        this.dataService = dataService;
        this.popupService = popupService;
        this.selectionService = selectionService;
        this.navigationService = navigationService;
        this.disabledItemsService = disabledItemsService;
        this._zone = _zone;
        this.cdr = cdr;
        this.renderer = renderer;
        this.hostElement = hostElement;
        this.touchEnabled = touchEnabled$$1;
        /**
         * Defines whether the first match from the suggestions list will be automatically focused.
         * By default, `highlightFirst` is set to `true`.
         */
        this.highlightFirst = true;
        /**
         * @hidden
         */
        this.focusableId = `k-${guid$1()}`;
        /**
         * The hint which is displayed when the component is empty.
         */
        this.placeholder = "";
        /**
         * Sets the height of the suggestions list. By default, `listHeight` is 200px.
         *
         * > The `listHeight` property affects only the list of suggestions and not the whole popup container.
         * > To set the height of the popup container, use `popupSettings.height`.
         */
        this.listHeight = 200;
        /**
         * @hidden
         *
         * If set to `true`, renders a button on hovering over the component.
         * Clicking this button resets the value of the component to `undefined` and triggers the `change` event.
         */
        this.clearButton = true;
        /**
         * Sets the disabled state of the component.
         */
        this.disabled = false;
        /**
         * Sets the read-only state of the component.
         */
        this.readonly = false;
        /**
         * Specifies the [`tabindex`](https://developer.mozilla.org/en-US/docs/Web/HTML/Global_attributes/tabindex) of the component.
         */
        this.tabindex = 0;
        /**
         * Enables the [filtering]({% slug filtering_autocomplete %}) functionality.
         * If set to `true`, the component emits the `filterChange` event.
         */
        this.filterable = false;
        /**
         * Fires each time the value is changed&mdash;
         * when the component is blurred or the value is cleared through the **Clear** button
         * ([see example]({% slug overview_autocomplete %}#toc-events)).
         * When the value of the component is programmatically changed to `ngModel` or `formControl`
         * through its API or form binding, the `valueChange` event is not triggered because it
         * might cause a mix-up with the built-in `valueChange` mechanisms of the `ngModel` or `formControl` bindings.
         */
        this.valueChange = new EventEmitter();
        /**
         * Fires each time the user types in the input field.
         * You can filter the source based on the passed filtration value
         * ([see example]({% slug overview_autocomplete %}#toc-events)).
         */
        this.filterChange = new EventEmitter();
        /**
         * Fires each time the popup is about to open.
         * This event is preventable. If you cancel it, the popup will remain closed.
         */
        this.open = new EventEmitter();
        /**
         * Fires after the popup has been opened.
         */
        this.opened = new EventEmitter();
        /**
         * Fires each time the popup is about to close.
         * This event is preventable. If you cancel it, the popup will remain open.
         */
        this.close = new EventEmitter();
        /**
         * Fires after the popup has been closed.
         */
        this.closed = new EventEmitter();
        /**
         * Fires each time the user focuses the AutoComplete.
         */
        this.onFocus = new EventEmitter();
        /**
         * Fires each time the AutoComplete gets blurred.
         */
        this.onBlur = new EventEmitter();
        this.widgetClasses = true;
        this.listBoxId = guid$1();
        this.optionPrefix = guid$1();
        this.onChangeCallback = noop;
        this.onTouchedCallback = noop;
        this.popupMouseDownHandler = (event) => event.preventDefault();
        this._popupSettings = { animate: true };
        this._open = false;
        this._value = "";
        this.valueChangeSubject = new Subject();
        this._isFocused = false;
        this._size = 'medium';
        this._rounded = 'medium';
        this._fillMode = 'solid';
        validatePackage(packageMetadata);
        this.direction = localization.rtl ? 'rtl' : 'ltr';
        this.wrapper = this.hostElement.nativeElement;
        this.data = [];
        this.subscribeEvents();
        this.subscribeTouchEvents();
        this.selectionService.resetSelection([-1]);
    }
    get width() {
        let wrapperOffsetWidth = 0;
        if (isDocumentAvailable()) {
            wrapperOffsetWidth = this.wrapper.offsetWidth;
        }
        const width = this.popupSettings.width || wrapperOffsetWidth;
        const minWidth = isNaN(wrapperOffsetWidth) ? wrapperOffsetWidth : `${wrapperOffsetWidth}px`;
        const maxWidth = isNaN(width) ? width : `${width}px`;
        return { min: minWidth, max: maxWidth };
    }
    get height() {
        const popupHeight = this.popupSettings.height;
        return isPresent(popupHeight) ? `${popupHeight}px` : 'auto';
    }
    get listContainerClasses() {
        const containerClasses = ['k-list-container', 'k-reset'];
        if (this.popupSettings.popupClass) {
            containerClasses.push(this.popupSettings.popupClass);
        }
        return containerClasses;
    }
    get suggestion() {
        if (!this.text || !this.suggestedText) {
            this.suggestedText = undefined;
            return;
        }
        const hasMatch = this.suggestedText.toLowerCase().startsWith(this.text.toLowerCase());
        const shouldSuggest = this.suggest && !this.backspacePressed;
        if (shouldSuggest && hasMatch) {
            return this.suggestedText;
        }
    }
    get appendTo() {
        const { appendTo } = this.popupSettings;
        if (!appendTo || appendTo === 'root') {
            return undefined;
        }
        return appendTo === 'component' ? this.container : appendTo;
    }
    get clearButtonVisiblity() {
        if (this.touchEnabled) {
            return 'visible';
        }
    }
    /**
     * Toggles the visibility of the popup.
     * If you use the `toggle` method to open or close the popup, the `open` and `close` events will not be fired.
     *
     * @param open - The state of the popup.
     */
    toggle(open) {
        Promise.resolve(null).then(() => {
            const shouldOpen = isPresent(open) ? open : !this._open;
            this._toggle(shouldOpen);
        });
    }
    /**
     * Returns the current open state of the popup.
     */
    get isOpen() {
        return this._open;
    }
    /**
     * @hidden
     */
    togglePopup(open) {
        const isDisabled = this.disabled || this.readonly;
        const sameState = this.isOpen === open;
        if (isDisabled || sameState) {
            return;
        }
        const isDefaultPrevented = this.triggerPopupEvents(open);
        if (!isDefaultPrevented) {
            this._toggle(open);
        }
    }
    get activeDescendant() {
        if (!this.isOpen || !isPresent(this.selectionService.focused) || this.selectionService.focused === -1) {
            return null;
        }
        const dataItem = this.dataService.itemAt(this.selectionService.focused);
        return this.optionPrefix + "-" + getter$1(dataItem, this.valueField);
    }
    get noDataLabel() {
        if (this.data.length === 0) {
            return this.messageFor('noDataText');
        }
    }
    /**
     * Sets the data of the AutoComplete.
     *
     * > The data has to be provided in an array-like list.
     */
    set data(data) {
        this.dataService.data = data || [];
        if (this.virtual) {
            this.virtual.skip = 0;
        }
        if (this.filterable) {
            this.selectionService.focused = this.isOpen && this.data.length && this.highlightFirst ? this.firstFocusableIndex(0) : -1;
        }
        if (this.suggest && this.dataService.itemsCount > 0) {
            this.suggestedText = getter$1(this.dataService.itemAt(0), this.valueField);
        }
    }
    get data() {
        const virtual = this.virtual;
        if (virtual) {
            const start = virtual.skip || 0;
            const end = start + virtual.pageSize;
            // Use length instead of itemsCount because of the grouping.
            virtual.total = this.dataService.data.length;
            return this.dataService.data.slice(start, end);
        }
        return this.dataService.data;
    }
    /**
     * Sets the value of the AutoComplete.
     */
    set value(newValue) {
        this.verifySettings(newValue);
        this._value = newValue || NO_VALUE;
        this.text = this.value;
        this.cdr.markForCheck();
    }
    get value() {
        return this._value || NO_VALUE;
    }
    /**
     * Configures the popup of the AutoComplete.
     *
     * The available options are:
     * - `animate: Boolean`&mdash;Controls the popup animation. By default, the open and close animations are enabled.
     * - `width: Number | String`&mdash;Sets the width of the popup container. By default, the width of the host element is used. If set to `auto`, the component automatically adjusts the width of the popup and no item labels are wrapped. The `auto` mode is not supported when virtual scrolling is enabled.
     * - `height: Number`&mdash;Sets the height of the popup container.
     * - `popupClass: String`&mdash;Specifies a list of CSS classes that are used to style the popup.
     * - `appendTo: "root" | "component" | ViewContainerRef`&mdash;Specifies the component to which the popup will be appended.
     */
    set popupSettings(settings) {
        this._popupSettings = Object.assign({ animate: true }, settings);
    }
    get popupSettings() {
        return this._popupSettings;
    }
    /**
     * Defines a Boolean function that is executed for each data item in the component
     * ([see examples]({% slug disableditems_autocomplete %})).
     * Determines whether the item will be disabled.
     */
    set itemDisabled(fn) {
        if (typeof fn !== 'function') {
            throw new Error(`itemDisabled must be a function, but received ${JSON.stringify(fn)}.`);
        }
        this.disabledItemsService.itemDisabled = fn;
    }
    /**
     * @hidden
     */
    set tabIndex(tabIndex) {
        this.tabindex = tabIndex;
    }
    get tabIndex() {
        return this.tabindex;
    }
    /**
     * Enables the [virtualization]({% slug virtualization_autocomplete %}) functionality.
     */
    set virtual(settings) {
        this._virtualSettings = normalizeVirtualizationSettings(settings);
    }
    get virtual() {
        return this._virtualSettings;
    }
    /**
     * Sets the size of the component.
     *
     * The possible values are:
     * * `'small'`
     * * `'medium'` (default)
     * * `'large'`
     * * `null`
     *
     */
    set size(size) {
        this.renderer.removeClass(this.wrapper, getSizeClass('input', this.size));
        if (size) {
            this.renderer.addClass(this.wrapper, getSizeClass('input', size));
        }
        this._size = size;
    }
    get size() {
        return this._size;
    }
    /**
     * Sets the border radius of the component.
     *
     * The possible values are:
     * * `'small'`
     * * `'medium'` (default)
     * * `'large'`
     * * `'full'`
     * * `null`
     *
     */
    set rounded(rounded) {
        this.renderer.removeClass(this.wrapper, getRoundedClass(this.rounded));
        if (rounded) {
            this.renderer.addClass(this.wrapper, getRoundedClass(rounded));
        }
        this._rounded = rounded;
    }
    get rounded() {
        return this._rounded;
    }
    /**
     * Sets the fillMode of the component.
     *
     * The possible values are:
     * * `'flat'`
     * * `'solid'` (default)
     * * `'outline'`
     * * `null`
     *
     */
    set fillMode(fillMode) {
        this.renderer.removeClass(this.wrapper, getFillModeClass('input', this.fillMode));
        if (fillMode) {
            this.renderer.addClass(this.wrapper, getFillModeClass('input', fillMode));
        }
        this._fillMode = fillMode;
    }
    get fillMode() {
        return this._fillMode;
    }
    get isFocused() {
        return this._isFocused;
    }
    set isFocused(isFocused) {
        this.renderer[isFocused ? 'addClass' : 'removeClass'](this.wrapper, "k-focus");
        this._isFocused = isFocused;
    }
    get isDisabled() {
        return this.disabled;
    }
    get isLoading() {
        return this.loading;
    }
    get dir() {
        return this.direction;
    }
    ngOnInit() {
        this.renderer.removeAttribute(this.wrapper, "tabindex");
        this.localizationChangeSubscription = this.localization
            .changes
            .subscribe(({ rtl }) => {
            this.direction = rtl ? 'rtl' : 'ltr';
            this.cdr.detectChanges();
        });
        this.setComponentClasses();
    }
    ngOnDestroy() {
        this.destroyPopup();
        this.unsubscribeEvents();
        if (this.localizationChangeSubscription) {
            this.localizationChangeSubscription.unsubscribe();
        }
    }
    ngOnChanges(changes) {
        const virtual = this.virtual;
        const requestInitialData = virtual && changes.data && changes.data.isFirstChange();
        if (requestInitialData) {
            this.pageChange({ skip: 0, take: virtual.pageSize });
        }
    }
    /**
     * Resets the value of the AutoComplete.
     * If you use the `reset` method to clear the value of the component,
     * the model will not update automatically and the `selectionChange` and `valueChange` events will not be fired.
     */
    reset() {
        this.value = NO_VALUE;
    }
    /**
     * @hidden
     */
    messageFor(key) {
        return this.localization.get(key);
    }
    /**
     * @hidden
     */
    clearValue(event) {
        event.stopImmediatePropagation();
        this.focus();
        this.change(NO_VALUE);
        if (this.filterable) {
            this.filterChange.emit('');
        }
        this.selectionService.resetSelection([]);
    }
    /**
     * @hidden
     */
    writeValue(value) {
        this.value = value;
    }
    /**
     * @hidden
     */
    registerOnChange(fn) {
        this.onChangeCallback = fn;
    }
    /**
     * @hidden
     */
    registerOnTouched(fn) {
        this.onTouchedCallback = fn;
    }
    /**
     * @hidden
     */
    setDisabledState(isDisabled) {
        this.disabled = isDisabled;
    }
    /**
     * Focuses a specific item of the AutoComplete based on a provided index.
     * If null or invalid index is provided the focus will be removed.
     */
    focusItemAt(index) {
        const isInRange = index >= 0 && index < this.data.length;
        if (isPresent(index) && isInRange && !this.disabledItemsService.isIndexDisabled(index)) {
            this.selectionService.focus(index);
        }
        else {
            this.selectionService.focus(-1);
        }
    }
    /**
     * Focuses the AutoComplete.
     */
    focus() {
        if (!this.disabled) {
            this.searchbar.focus();
        }
    }
    /**
     * Blurs the AutoComplete.
     */
    blur() {
        if (!this.disabled) {
            this.searchbar.blur();
        }
    }
    /**
     * @hidden
     */
    onResize() {
        if (this._open) {
            const popupWrapper = this.popupRef.popupElement;
            const { min, max } = this.width;
            popupWrapper.style.minWidth = min;
            popupWrapper.style.width = max;
        }
    }
    emitChange(value) {
        this.onChangeCallback(value);
        this.valueChange.emit(value);
    }
    verifySettings(newValue) {
        if (!isDevMode()) {
            return;
        }
        if (isPresent(newValue) && typeof newValue !== "string") {
            throw new Error("Expected value of type string. See https://www.telerik.com/kendo-angular-ui/components/dropdowns/autocomplete/value-binding/");
        }
    }
    search(text, startFrom = 0) {
        let index;
        if (text.length && this.dataService.itemsCount) {
            index = this.dataService.findIndex(this.findIndexPredicate(text), startFrom);
        }
        else {
            index = -1;
        }
        if (this.disabledItemsService.isIndexDisabled(index)) {
            if (index + 1 < this.dataService.itemsCount) {
                this.search(text, index + 1);
            }
            else {
                this.selectionService.focus(-1);
            }
        }
        else {
            this.selectionService.focus(index);
            if (this.suggest) {
                this.suggestedText = getter$1(this.dataService.itemAt(index), this.valueField);
            }
        }
    }
    navigate(index) {
        if (!this.isOpen) {
            return;
        }
        this.selectionService.focus(index);
    }
    /**
     * @hidden
     */
    handleNavigate(event) {
        const focused = isNaN(this.selectionService.focused) ? this.firstFocusableIndex(0) : this.selectionService.focused;
        if (this.disabled || this.readonly || isNaN(focused)) {
            return;
        }
        const action = this.navigationService.process({
            current: focused,
            max: this.dataService.itemsCount - 1,
            min: 0,
            originalEvent: event
        });
        if (action !== NavigationAction.Undefined &&
            action !== NavigationAction.Backspace &&
            action !== NavigationAction.Delete &&
            action !== NavigationAction.Home &&
            action !== NavigationAction.End &&
            action !== NavigationAction.Left &&
            action !== NavigationAction.Right &&
            ((action === NavigationAction.Enter && this.isOpen) || action !== NavigationAction.Enter)) {
            event.preventDefault();
        }
    }
    handleEnter(event) {
        const focused = this.selectionService.focused;
        let value;
        if (this.isOpen) {
            event.originalEvent.preventDefault();
        }
        if (focused >= 0) {
            value = getter$1(this.dataService.itemAt(focused), this.valueField);
        }
        else {
            const match = this.suggest && this.suggestedText && this.data.length &&
                getter$1(this.dataService.itemAt(0), this.valueField).toLowerCase() === this.searchbar.value.toLowerCase();
            if (this.isOpen && match) {
                value = this.suggestedText;
            }
            else {
                value = this.searchbar.value;
            }
        }
        this.change(value);
    }
    handleEscape() {
        this.togglePopup(false);
        this.selectionService.focused = -1;
        this.suggestedText = null;
    }
    /**
     * @hidden
     */
    searchBarChange(text) {
        const currentTextLength = isPresent(this.text) ? this.text.length : 0;
        this.backspacePressed = (text.length < currentTextLength) ? true : false;
        this.text = text;
        this.togglePopup(text.length > 0);
        if (!this.highlightFirst) {
            this.selectionService.focused = -1;
        }
        if (this.filterable) {
            this.filterChange.emit(text);
        }
        else if (this.highlightFirst) {
            this.search(text);
        }
    }
    /**
     * @hidden
     */
    handleFocus() {
        this.isFocused = true;
        if (hasObservers(this.onFocus)) {
            this._zone.run(() => {
                this.onFocus.emit();
            });
        }
    }
    /**
     * @hidden
     */
    handleBlur() {
        const focused = this.filterable ? this.selectionService.focused : -1;
        this.searchbar.input.nativeElement.scrollLeft = 0; // Firefox doesn't auto-scroll to the left on blur like other browsers
        let dataItem;
        let text;
        if (focused !== -1) {
            dataItem = this.dataService.itemAt(focused);
            text = getter$1(dataItem, this.valueField) || "";
        }
        else {
            text = this.searchbar.value;
        }
        const exactMatch = text === this.searchbar.value;
        const insensitiveMatch = text.toLowerCase() === this.searchbar.value.toLowerCase();
        if (!exactMatch && insensitiveMatch) {
            this.selectionService.resetSelection([]);
        }
        this.isFocused = false;
        const valueHasChanged = this.value !== this.text;
        const runInZone = hasObservers(this.onBlur) || hasObservers(this.close) || isUntouched(this.wrapper) || valueHasChanged;
        if (runInZone) {
            this._zone.run(() => {
                if (valueHasChanged) {
                    this.change(this.searchbar.value);
                }
                this.onBlur.emit();
                this.onTouchedCallback();
                this.togglePopup(false);
            });
        }
        else {
            this.togglePopup(false);
        }
    }
    /**
     * @hidden
     */
    pageChange(event) {
        const virtual = this.virtual;
        virtual.skip = event.skip;
    }
    change(value) {
        this.togglePopup(false);
        this.valueChangeSubject.next(value);
    }
    subscribeEvents() {
        if (!isDocumentAvailable()) {
            return;
        }
        this.valueChangeSubscription = this.valueChangeSubject
            .subscribe(value => {
            const hasChange = this.value !== value;
            this.value = value;
            this.text = value;
            // emit change after assigning `this.value` => allows the user to modify the component value on `valueChange`
            if (hasChange) {
                this.emitChange(value);
            }
        });
        this.changeSubscription = this.selectionService.onChange.subscribe(this.handleItemChange.bind(this));
        this.focusSubscription = this.selectionService.onFocus.subscribe(this.handleItemFocus.bind(this));
        this.navigationSubscription = merge(this.navigationService.up, this.navigationService.down).subscribe((event) => this.navigate(event.index));
        this.closeSubscription = this.navigationService.close.subscribe(() => this.togglePopup(false));
        this.enterSubscription = this.navigationService.enter.subscribe(this.handleEnter.bind(this));
        this.escSubscription = this.navigationService.esc.subscribe(this.handleEscape.bind(this));
    }
    subscribeTouchEvents() {
        if (!isDocumentAvailable() || !this.touchEnabled) {
            return;
        }
        this._zone.runOutsideAngular(() => 
        // Roll up AutoComplete on iOS when tapped outside
        this.touchstartDisposeHandler = this.renderer.listen(document, 'touchstart', (e) => {
            const target = e.target;
            if (this.isFocused && !inDropDown(this.hostElement, target, this.popupRef)) {
                this._zone.run(() => this.blur());
            }
        }));
    }
    unsubscribeEvents() {
        if (!isDocumentAvailable()) {
            return;
        }
        this.changeSubscription.unsubscribe();
        this.navigationSubscription.unsubscribe();
        this.closeSubscription.unsubscribe();
        this.enterSubscription.unsubscribe();
        this.escSubscription.unsubscribe();
        this.valueChangeSubscription.unsubscribe();
        this.focusSubscription.unsubscribe();
        if (this.touchstartDisposeHandler) {
            this.touchstartDisposeHandler();
        }
    }
    handleItemChange(event) {
        const index = event.indices.length ? event.indices[0] : undefined;
        this.selectionService.resetSelection([-1]);
        if (!isPresent(index)) {
            return;
        }
        let text = getter$1(this.dataService.itemAt(index), this.valueField);
        this.change(text);
    }
    handleItemFocus(_event) {
        const focused = this.selectionService.focused;
        const shouldSuggest = Boolean(this.suggest && this.data && this.data.length && focused >= 0);
        if (shouldSuggest) {
            this.suggestedText = getter$1(this.dataService.itemAt(focused), this.valueField);
        }
    }
    createPopup() {
        if (this.virtual) {
            this.virtual.skip = 0;
        }
        const horizontalAlign = this.direction === "rtl" ? "right" : "left";
        const anchorPosition = { horizontal: horizontalAlign, vertical: "bottom" };
        const popupPosition = { horizontal: horizontalAlign, vertical: "top" };
        this.popupRef = this.popupService.open({
            anchor: this.wrapper,
            animate: this.popupSettings.animate,
            appendTo: this.appendTo,
            content: this.popupTemplate,
            popupClass: this.listContainerClasses,
            positionMode: 'absolute',
            popupAlign: popupPosition,
            anchorAlign: anchorPosition
        });
        const popupWrapper = this.popupRef.popupElement;
        const { min, max } = this.width;
        popupWrapper.addEventListener('mousedown', this.popupMouseDownHandler);
        popupWrapper.style.minWidth = min;
        popupWrapper.style.width = max;
        popupWrapper.style.height = this.height;
        popupWrapper.setAttribute("dir", this.direction);
        this.popupRef.popupOpen.subscribe(() => {
            this.cdr.detectChanges();
            this.optionsList.scrollToItem(this.selectionService.focused);
            this.opened.emit();
        });
        this.popupRef.popupClose.subscribe(() => {
            this.closed.emit();
        });
        this.popupRef.popupAnchorViewportLeave.subscribe(() => this.togglePopup(false));
    }
    destroyPopup() {
        if (this.popupRef) {
            this.popupRef.popupElement
                .removeEventListener('mousedown', this.popupMouseDownHandler);
            this.popupRef.close();
            this.popupRef = null;
        }
    }
    _toggle(open) {
        this._open = open;
        this.destroyPopup();
        if (this._open) {
            this.createPopup();
        }
    }
    triggerPopupEvents(open) {
        const eventArgs = new PreventableEvent();
        if (open) {
            this.open.emit(eventArgs);
        }
        else {
            this.close.emit(eventArgs);
        }
        return eventArgs.isDefaultPrevented();
    }
    firstFocusableIndex(index) {
        const maxIndex = this.data.length - 1;
        if (this.disabledItemsService.isIndexDisabled(index)) {
            return (index < maxIndex) ? this.firstFocusableIndex(index + 1) : undefined;
        }
        else {
            return index;
        }
    }
    findIndexPredicate(text) {
        if (this.dataService.grouped) {
            return (item) => {
                let itemText = getter$1(item.value, this.valueField);
                itemText = !isPresent(itemText) ? "" : itemText.toString().toLowerCase();
                return itemText.startsWith(text.toLowerCase());
            };
        }
        else {
            return (item) => {
                let itemText = getter$1(item, this.valueField);
                itemText = !isPresent(itemText) ? "" : itemText.toString().toLowerCase();
                return itemText.startsWith(text.toLowerCase());
            };
        }
    }
    setComponentClasses() {
        if (this.size) {
            this.renderer.addClass(this.wrapper, getSizeClass('input', this.size));
        }
        if (this.rounded) {
            this.renderer.addClass(this.wrapper, getRoundedClass(this.rounded));
        }
        if (this.fillMode) {
            this.renderer.addClass(this.wrapper, getFillModeClass('input', this.fillMode));
        }
    }
};
AutoCompleteComponent.ɵfac = function AutoCompleteComponent_Factory(t) { return new (t || AutoCompleteComponent)(ɵngcc0.ɵɵdirectiveInject(ɵngcc1.LocalizationService), ɵngcc0.ɵɵdirectiveInject(DataService), ɵngcc0.ɵɵdirectiveInject(ɵngcc4.PopupService), ɵngcc0.ɵɵdirectiveInject(SelectionService), ɵngcc0.ɵɵdirectiveInject(NavigationService), ɵngcc0.ɵɵdirectiveInject(DisabledItemsService), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.NgZone), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ChangeDetectorRef), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.Renderer2), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ElementRef), ɵngcc0.ɵɵdirectiveInject(TOUCH_ENABLED, 8)); };
AutoCompleteComponent.ɵcmp = /*@__PURE__*/ ɵngcc0.ɵɵdefineComponent({ type: AutoCompleteComponent, selectors: [["kendo-autocomplete"]], contentQueries: function AutoCompleteComponent_ContentQueries(rf, ctx, dirIndex) { if (rf & 1) {
        ɵngcc0.ɵɵcontentQuery(dirIndex, ItemTemplateDirective, 5);
        ɵngcc0.ɵɵcontentQuery(dirIndex, HeaderTemplateDirective, 5);
        ɵngcc0.ɵɵcontentQuery(dirIndex, FooterTemplateDirective, 5);
        ɵngcc0.ɵɵcontentQuery(dirIndex, NoDataTemplateDirective, 5);
        ɵngcc0.ɵɵcontentQuery(dirIndex, GroupTemplateDirective, 5);
        ɵngcc0.ɵɵcontentQuery(dirIndex, FixedGroupTemplateDirective, 5);
    } if (rf & 2) {
        let _t;
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.template = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.headerTemplate = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.footerTemplate = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.noDataTemplate = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.groupTemplate = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.fixedGroupTemplate = _t.first);
    } }, viewQuery: function AutoCompleteComponent_Query(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵviewQuery(_c8, 7, ViewContainerRef);
        ɵngcc0.ɵɵviewQuery(_c9, 7);
        ɵngcc0.ɵɵviewQuery(SearchBarComponent, 7);
        ɵngcc0.ɵɵviewQuery(_c10, 5);
    } if (rf & 2) {
        let _t;
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.container = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.popupTemplate = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.searchbar = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.optionsList = _t.first);
    } }, hostVars: 9, hostBindings: function AutoCompleteComponent_HostBindings(rf, ctx) { if (rf & 2) {
        ɵngcc0.ɵɵattribute("dir", ctx.dir);
        ɵngcc0.ɵɵclassProp("k-autocomplete", ctx.widgetClasses)("k-input", ctx.widgetClasses)("k-disabled", ctx.isDisabled)("k-loading", ctx.isLoading);
    } }, inputs: { highlightFirst: "highlightFirst", focusableId: "focusableId", placeholder: "placeholder", listHeight: "listHeight", clearButton: "clearButton", disabled: "disabled", readonly: "readonly", tabindex: "tabindex", filterable: "filterable", data: "data", value: "value", popupSettings: "popupSettings", itemDisabled: "itemDisabled", tabIndex: "tabIndex", virtual: "virtual", size: "size", rounded: "rounded", fillMode: "fillMode", valueField: "valueField", loading: "loading", suggest: "suggest" }, outputs: { valueChange: "valueChange", filterChange: "filterChange", open: "open", opened: "opened", close: "close", closed: "closed", onFocus: "focus", onBlur: "blur" }, exportAs: ["kendoAutoComplete"], features: [ɵngcc0.ɵɵProvidersFeature([
            AUTOCOMPLETE_VALUE_ACCESSOR,
            DataService,
            SelectionService,
            NavigationService,
            DisabledItemsService,
            LocalizationService,
            {
                provide: L10N_PREFIX,
                useValue: 'kendo.autocomplete'
            },
            {
                provide: FilterableComponent,
                useExisting: forwardRef(() => AutoCompleteComponent_1)
            },
            {
                provide: KendoInput,
                useExisting: forwardRef(() => AutoCompleteComponent_1)
            }
        ]), ɵngcc0.ɵɵNgOnChangesFeature], decls: 10, vars: 15, consts: function () { let i18n_11; if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
        /**
         * @desc The text displayed in the popup when there are no items
         * @meaning kendo.autocomplete.noDataText
         */
        const MSG_EXTERNAL_2690656529626907484$$DIST_FESM2015_INDEX_JS_12 = goog.getMsg("NO DATA FOUND");
        i18n_11 = MSG_EXTERNAL_2690656529626907484$$DIST_FESM2015_INDEX_JS_12;
    }
    else {
        i18n_11 = $localize `:kendo.autocomplete.noDataText|The text displayed in the popup when there are no items␟4e9993e088a293543eb0c2801343518c115b6f20␟2690656529626907484:NO DATA FOUND`;
    } let i18n_13; if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
        /**
         * @desc The title of the clear button
         * @meaning kendo.autocomplete.clearTitle
         */
        const MSG_EXTERNAL_4821453594854847070$$DIST_FESM2015_INDEX_JS_14 = goog.getMsg("clear");
        i18n_13 = MSG_EXTERNAL_4821453594854847070$$DIST_FESM2015_INDEX_JS_14;
    }
    else {
        i18n_13 = $localize `:kendo.autocomplete.clearTitle|The title of the clear button␟7cf49cc2d50eebd29f8d61564512383caaaac7a6␟4821453594854847070:clear`;
    } return [["kendoAutoCompleteLocalizedMessages", "", "noDataText", i18n_11, "clearTitle", i18n_13], [3, "role", "id", "listId", "activeDescendant", "noDataLabel", "userInput", "suggestedText", "disabled", "readonly", "tabIndex", "popupOpen", "placeholder", "onNavigate", "valueChange", "onBlur", "onFocus"], ["searchbar", ""], ["class", "k-clear-value", "role", "button", "tabindex", "-1", 3, "visibility", "click", "mousedown", 4, "ngIf"], ["class", "k-icon k-i-loading", 4, "ngIf"], ["popupTemplate", ""], [3, "ngIf"], ["container", ""], ["role", "button", "tabindex", "-1", 1, "k-clear-value", 3, "click", "mousedown"], [1, "k-icon", "k-i-x"], [1, "k-icon", "k-i-loading"], [4, "ngIf"], [3, "size", "rounded", "id", "optionPrefix", "data", "textField", "valueField", "template", "groupTemplate", "fixedGroupTemplate", "height", "show", "virtual", "pageChange"], ["optionsList", ""], ["class", "k-no-data", 4, "ngIf"], [3, "templateContext"], [1, "k-no-data"], [3, "ngIf", "templateContext"], [3, "resize"]]; }, template: function AutoCompleteComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵelementContainer(0, 0);
        ɵngcc0.ɵɵelementStart(1, "kendo-searchbar", 1, 2);
        ɵngcc0.ɵɵlistener("onNavigate", function AutoCompleteComponent_Template_kendo_searchbar_onNavigate_1_listener($event) { return ctx.handleNavigate($event); })("valueChange", function AutoCompleteComponent_Template_kendo_searchbar_valueChange_1_listener($event) { return ctx.searchBarChange($event); })("onBlur", function AutoCompleteComponent_Template_kendo_searchbar_onBlur_1_listener() { return ctx.handleBlur(); })("onFocus", function AutoCompleteComponent_Template_kendo_searchbar_onFocus_1_listener() { return ctx.handleFocus(); });
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵtemplate(3, AutoCompleteComponent_span_3_Template, 2, 3, "span", 3);
        ɵngcc0.ɵɵtemplate(4, AutoCompleteComponent_span_4_Template, 1, 0, "span", 4);
        ɵngcc0.ɵɵtemplate(5, AutoCompleteComponent_ng_template_5_Template, 5, 16, "ng-template", null, 5, ɵngcc0.ɵɵtemplateRefExtractor);
        ɵngcc0.ɵɵtemplate(7, AutoCompleteComponent_ng_template_7_Template, 1, 0, "ng-template", 6);
        ɵngcc0.ɵɵelementContainer(8, null, 7);
    } if (rf & 2) {
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("role", "combobox")("id", ctx.focusableId)("listId", ctx.listBoxId)("activeDescendant", ctx.activeDescendant)("noDataLabel", ctx.noDataLabel)("userInput", ctx.text)("suggestedText", ctx.suggestion)("disabled", ctx.disabled)("readonly", ctx.readonly)("tabIndex", ctx.tabIndex)("popupOpen", ctx.isOpen)("placeholder", ctx.placeholder);
        ɵngcc0.ɵɵadvance(2);
        ɵngcc0.ɵɵproperty("ngIf", !ctx.loading && !ctx.readonly && (ctx.clearButton && (ctx.text == null ? null : ctx.text.length)));
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngIf", ctx.loading);
        ɵngcc0.ɵɵadvance(3);
        ɵngcc0.ɵɵproperty("ngIf", ctx.isOpen);
    } }, directives: function () { return [LocalizedMessagesDirective, SearchBarComponent, ɵngcc3.NgIf, TemplateContextDirective, ListComponent, ɵngcc2.ResizeSensorComponent]; }, encapsulation: 2 });
__decorate([
    Input(),
    __metadata("design:type", Boolean)
], AutoCompleteComponent.prototype, "highlightFirst", void 0);
__decorate([
    Input(),
    __metadata("design:type", String)
], AutoCompleteComponent.prototype, "focusableId", void 0);
__decorate([
    Input(),
    __metadata("design:type", Object),
    __metadata("design:paramtypes", [Object])
], AutoCompleteComponent.prototype, "data", null);
__decorate([
    Input(),
    __metadata("design:type", String),
    __metadata("design:paramtypes", [String])
], AutoCompleteComponent.prototype, "value", null);
__decorate([
    Input(),
    __metadata("design:type", String)
], AutoCompleteComponent.prototype, "valueField", void 0);
__decorate([
    Input(),
    __metadata("design:type", String)
], AutoCompleteComponent.prototype, "placeholder", void 0);
__decorate([
    Input(),
    __metadata("design:type", Object),
    __metadata("design:paramtypes", [Object])
], AutoCompleteComponent.prototype, "popupSettings", null);
__decorate([
    Input(),
    __metadata("design:type", Number)
], AutoCompleteComponent.prototype, "listHeight", void 0);
__decorate([
    Input(),
    __metadata("design:type", Boolean)
], AutoCompleteComponent.prototype, "loading", void 0);
__decorate([
    Input(),
    __metadata("design:type", Boolean)
], AutoCompleteComponent.prototype, "clearButton", void 0);
__decorate([
    Input(),
    __metadata("design:type", Boolean)
], AutoCompleteComponent.prototype, "suggest", void 0);
__decorate([
    Input(),
    __metadata("design:type", Boolean)
], AutoCompleteComponent.prototype, "disabled", void 0);
__decorate([
    Input(),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [Function])
], AutoCompleteComponent.prototype, "itemDisabled", null);
__decorate([
    Input(),
    __metadata("design:type", Boolean)
], AutoCompleteComponent.prototype, "readonly", void 0);
__decorate([
    Input(),
    __metadata("design:type", Number)
], AutoCompleteComponent.prototype, "tabindex", void 0);
__decorate([
    Input("tabIndex"),
    __metadata("design:type", Number),
    __metadata("design:paramtypes", [Number])
], AutoCompleteComponent.prototype, "tabIndex", null);
__decorate([
    Input(),
    __metadata("design:type", Boolean)
], AutoCompleteComponent.prototype, "filterable", void 0);
__decorate([
    Input(),
    __metadata("design:type", Object),
    __metadata("design:paramtypes", [Object])
], AutoCompleteComponent.prototype, "virtual", null);
__decorate([
    Input(),
    __metadata("design:type", String),
    __metadata("design:paramtypes", [String])
], AutoCompleteComponent.prototype, "size", null);
__decorate([
    Input(),
    __metadata("design:type", String),
    __metadata("design:paramtypes", [String])
], AutoCompleteComponent.prototype, "rounded", null);
__decorate([
    Input(),
    __metadata("design:type", String),
    __metadata("design:paramtypes", [String])
], AutoCompleteComponent.prototype, "fillMode", null);
__decorate([
    Output(),
    __metadata("design:type", EventEmitter)
], AutoCompleteComponent.prototype, "valueChange", void 0);
__decorate([
    Output(),
    __metadata("design:type", EventEmitter)
], AutoCompleteComponent.prototype, "filterChange", void 0);
__decorate([
    Output(),
    __metadata("design:type", EventEmitter)
], AutoCompleteComponent.prototype, "open", void 0);
__decorate([
    Output(),
    __metadata("design:type", EventEmitter)
], AutoCompleteComponent.prototype, "opened", void 0);
__decorate([
    Output(),
    __metadata("design:type", EventEmitter)
], AutoCompleteComponent.prototype, "close", void 0);
__decorate([
    Output(),
    __metadata("design:type", EventEmitter)
], AutoCompleteComponent.prototype, "closed", void 0);
__decorate([
    Output('focus'),
    __metadata("design:type", EventEmitter)
], AutoCompleteComponent.prototype, "onFocus", void 0);
__decorate([
    Output('blur'),
    __metadata("design:type", EventEmitter)
], AutoCompleteComponent.prototype, "onBlur", void 0);
__decorate([
    ContentChild(ItemTemplateDirective, { static: false }),
    __metadata("design:type", ItemTemplateDirective)
], AutoCompleteComponent.prototype, "template", void 0);
__decorate([
    ContentChild(HeaderTemplateDirective, { static: false }),
    __metadata("design:type", HeaderTemplateDirective)
], AutoCompleteComponent.prototype, "headerTemplate", void 0);
__decorate([
    ContentChild(FooterTemplateDirective, { static: false }),
    __metadata("design:type", FooterTemplateDirective)
], AutoCompleteComponent.prototype, "footerTemplate", void 0);
__decorate([
    ContentChild(NoDataTemplateDirective, { static: false }),
    __metadata("design:type", NoDataTemplateDirective)
], AutoCompleteComponent.prototype, "noDataTemplate", void 0);
__decorate([
    ContentChild(GroupTemplateDirective, { static: false }),
    __metadata("design:type", GroupTemplateDirective)
], AutoCompleteComponent.prototype, "groupTemplate", void 0);
__decorate([
    ContentChild(FixedGroupTemplateDirective, { static: false }),
    __metadata("design:type", FixedGroupTemplateDirective)
], AutoCompleteComponent.prototype, "fixedGroupTemplate", void 0);
__decorate([
    ViewChild('container', { read: ViewContainerRef, static: true }),
    __metadata("design:type", ViewContainerRef)
], AutoCompleteComponent.prototype, "container", void 0);
__decorate([
    ViewChild('popupTemplate', { static: true }),
    __metadata("design:type", TemplateRef)
], AutoCompleteComponent.prototype, "popupTemplate", void 0);
__decorate([
    ViewChild(SearchBarComponent, { static: true }),
    __metadata("design:type", SearchBarComponent)
], AutoCompleteComponent.prototype, "searchbar", void 0);
__decorate([
    ViewChild('optionsList', { static: false }),
    __metadata("design:type", ListComponent)
], AutoCompleteComponent.prototype, "optionsList", void 0);
__decorate([
    HostBinding('class.k-autocomplete'),
    HostBinding('class.k-input'),
    __metadata("design:type", Boolean)
], AutoCompleteComponent.prototype, "widgetClasses", void 0);
__decorate([
    HostBinding('class.k-disabled'),
    __metadata("design:type", Boolean),
    __metadata("design:paramtypes", [])
], AutoCompleteComponent.prototype, "isDisabled", null);
__decorate([
    HostBinding('class.k-loading'),
    __metadata("design:type", Boolean),
    __metadata("design:paramtypes", [])
], AutoCompleteComponent.prototype, "isLoading", null);
__decorate([
    HostBinding('attr.dir'),
    __metadata("design:type", Object),
    __metadata("design:paramtypes", [])
], AutoCompleteComponent.prototype, "dir", null);
AutoCompleteComponent = AutoCompleteComponent_1 = __decorate([ __param(10, Optional()), __param(10, Inject(TOUCH_ENABLED)),
    __metadata("design:paramtypes", [LocalizationService,
        DataService,
        PopupService,
        SelectionService,
        NavigationService,
        DisabledItemsService,
        NgZone,
        ChangeDetectorRef,
        Renderer2,
        ElementRef, Boolean])
], AutoCompleteComponent);

/* tslint:disable:variable-name */
/**
 * @hidden
 */
const MultiselectMessages = {
    'array': 'Expected values of array type. See http://www.telerik.com/kendo-angular-ui/components/dropdowns/multiselect/#value-selection',
    'object': 'Expected values of Object type. See http://www.telerik.com/kendo-angular-ui/components/dropdowns/multiselect/#value-selection',
    'primitive': 'Expected values of primitive type. See http://www.telerik.com/kendo-angular-ui/components/dropdowns/multiselect/#value-selection',
    'textAndValue': 'Expected textField and valueField options to be set. See http://www.telerik.com/kendo-angular-ui/components/dropdowns/multiselect/#toc-bind-to-arrays-of-complex-data'
};
/**
 * @hidden
 */
const MultiSelectTreeMessages = {
    'array': 'Expected values of array type. See http://www.telerik.com/kendo-angular-ui/components/dropdowns/multiselecttree/#value-selection',
    'primitive': 'Expected values of primitive type. See http://www.telerik.com/kendo-angular-ui/components/dropdowns/multiselecttree/value-binding/#toc-primitive-values',
    'object': 'Expected values of type Object. See http://www.telerik.com/kendo-angular-ui/components/dropdowns/multiselecttree/value-binding/#toc-object-values',
    'dataItems': 'Expected dataItems of type Object[] to be set. See https://www.telerik.com/kendo-angular-ui/components/dropdowns/api/MultiSelectTreeComponent/#toc-dataitems',
    'dataItemsLength': 'Expected dataItems length to match the number of provided values. See https://www.telerik.com/kendo-angular-ui/components/dropdowns/api/MultiSelectTreeComponent/#toc-dataitems',
    'textAndValue': 'Expected textField and valueField options to be set. See https://www.telerik.com/kendo-angular-ui/components/dropdowns/multiselecttree/value-binding',
    'valueDepth': 'Expected valueDepth of type number[] to be set. See https://www.telerik.com/kendo-angular-ui-develop/components/dropdowns/api/MultiSelectTreeComponent/#toc-valuedepth',
    'valueDepthLength': 'Expected valueDepth length to match the number of provided values. See https://www.telerik.com/kendo-angular-ui-develop/components/dropdowns/api/MultiSelectTreeComponent/#toc-valuedepth'
};
/**
 * @hidden
 */
const ComboBoxMessages = {
    'object': 'Expected value of type Object. See http://www.telerik.com/kendo-angular-ui/components/dropdowns/combobox/#toc-value-selection',
    'primitive': 'Expected value of primitive type. See http://www.telerik.com/kendo-angular-ui/components/dropdowns/combobox/#toc-value-selection',
    'textAndValue': 'Expected textField and valueField options to be set. See http://www.telerik.com/kendo-angular-ui/components/dropdowns/combobox/#toc-bind-to-arrays-of-complex-data',
    'noItemHeight': 'Expected virtual.itemHeight of type number.'
};
/**
 * @hidden
 */
const MultiColumnComboBoxMessages = {
    'data': 'Provided data must consist only of objects. See https://www.telerik.com/kendo-angular-ui/components/dropdowns/multicolumncombobox/data-binding/',
    'textAndValue': 'Expected textField and valueField options to be set. See https://www.telerik.com/kendo-angular-ui/components/dropdowns/multicolumncombobox/data-binding/#toc-fields-configuration'
};
/**
 * @hidden
 */
const DropDownListMessages = {
    'defaultItem': 'defaultItem and data items must be of same type. See http://www.telerik.com/kendo-angular-ui/components/dropdowns/api/DropDownListComponent/#toc-defaultitem',
    'object': 'Expected value of type Object. See http://www.telerik.com/kendo-angular-ui/components/dropdowns/dropdownlist/#toc-value-selection',
    'primitive': 'Expected value of primitive type. See http://www.telerik.com/kendo-angular-ui/components/dropdowns/dropdownlist/#toc-value-selection',
    'textAndValue': 'Expected textField and valueField options to be set. See http://www.telerik.com/kendo-angular-ui/components/dropdowns/dropdownlist/#toc-bind-to-arrays-of-complex-data'
};
/**
 * @hidden
 */
const DropDownTreeMessages = {
    'primitive': 'Expected value of primitive type. See http://www.telerik.com/kendo-angular-ui/components/dropdowns/dropdowntree/value-binding/#toc-primitive-values',
    'object': 'Expected value of type Object. See http://www.telerik.com/kendo-angular-ui/components/dropdowns/dropdowntree/value-binding/#toc-object-values',
    'dataItem': 'Expected dataItem of type Object to be set. See https://www.telerik.com/kendo-angular-ui/components/dropdowns/api/DropDownTreeComponent/#toc-dataitem',
    'textAndValue': 'Expected textField and valueField options to be set. See https://www.telerik.com/kendo-angular-ui/components/dropdowns/dropdowntree/value-binding',
    'valueDepth': 'Expected valueDepth to be set. See https://www.telerik.com/kendo-angular-ui-develop/components/dropdowns/api/DropDownTreeComponent/#toc-valuedepth'
};

/* tslint:disable:member-ordering */
var ComboBoxComponent_1;
/**
 * @hidden
 */
const COMBOBOX_VALUE_ACCESSOR = {
    multi: true,
    provide: NG_VALUE_ACCESSOR,
    useExisting: forwardRef(() => ComboBoxComponent)
};
/**
 * Represents the [Kendo UI ComboBox component for Angular]({% slug overview_combobox %}).
 *
 * @example
 * ```ts
 * _@Component({
 * selector: 'my-app',
 * template: `
 *  <kendo-combobox [data]="listItems">
 *  </kendo-combobox>
 * `
 * })
 * class AppComponent {
 *   public listItems: Array<string> = ["Item 1", "Item 2", "Item 3", "Item 4"];
 * }
 * ```
 */
let ComboBoxComponent = ComboBoxComponent_1 = class ComboBoxComponent {
    constructor(wrapper, localization, popupService, selectionService, navigationService, disabledItemsService, dataService, zone, cdr, renderer, touchEnabled$$1) {
        this.wrapper = wrapper;
        this.localization = localization;
        this.popupService = popupService;
        this.selectionService = selectionService;
        this.navigationService = navigationService;
        this.disabledItemsService = disabledItemsService;
        this.dataService = dataService;
        this.zone = zone;
        this.cdr = cdr;
        this.renderer = renderer;
        this.touchEnabled = touchEnabled$$1;
        this.selected = [];
        /**
         * @hidden
         */
        this.focusableId = `k-${guid$1()}`;
        /**
         * Specifies whether the ComboBox allows user-defined values that are not present in the dataset
         * ([more information and examples]({% slug custom_values_combobox %})).
         * Defaults to `false`.
         */
        this.allowCustom = false;
        /**
         * A user-defined callback which returns normalized custom values.
         * Typically used when the data items are different from type `string`.
         * @param { Any } value - The custom value defined by the user.
         * @returns { Any }
         *
         * @example
         * ```ts
         * import { map } from 'rxjs/operators';
         *
         * _@Component({
         * selector: 'my-app',
         * template: `
         *   <kendo-combobox
         *       [allowCustom]="true"
         *       [data]="listItems"
         *       textField="text"
         *       valueField="value"
         *       [valueNormalizer]="valueNormalizer"
         *       (valueChange)="onValueChange($event)"
         *   >
         *   </kendo-combobox>
         * `
         * })
         *
         * class AppComponent {
         *   public listItems: Array<{ text: string, value: number }> = [
         *       { text: "Small", value: 1 },
         *       { text: "Medium", value: 2 },
         *       { text: "Large", value: 3 }
         *   ];
         *
         *   public onValueChange(value) {
         *       console.log("valueChange : ", value);
         *   }
         *
         *   public valueNormalizer = (text$: Observable<string>) => text$.pipe(map((text: string) => {
         *      return { ProductID: null, ProductName: text };
         *   }));
         *
         * }
         * ```
         */
        this.valueNormalizer = (text) => text.pipe(map((userInput) => userInput));
        /**
         * The hint that is displayed when the component is empty.
         *
         */
        this.placeholder = "";
        /**
         * Sets the height of the suggestions list. By default, `listHeight` is 200px.
         *
         * > The `listHeight` property affects only the list of suggestions and not the whole popup container.
         * > To set the height of the popup container, use `popupSettings.height`.
         */
        this.listHeight = 200;
        /**
         * Enables the auto-completion of the text based on the first data item.
         */
        this.suggest = false;
        /**
         * If set to `true`, renders a button on hovering over the component.
         * Clicking this button resets the value of the component to `undefined` and triggers the `change` event.
         */
        this.clearButton = true;
        /**
         * Sets the disabled state of the component.
         */
        this.disabled = false;
        /**
         * Sets the read-only state of the component.
         */
        this.readonly = false;
        /**
         * Specifies the [`tabindex`](https://developer.mozilla.org/en-US/docs/Web/HTML/Global_attributes/tabindex) of the component.
         */
        this.tabindex = 0;
        /**
         * Enables the [filtering]({% slug filtering_combobox %}) functionality.
         * If set to `true`, the component emits the `filterChange` event.
         */
        this.filterable = false;
        /**
         * Fires each time the value is changed&mdash;
         * when the component is blurred or the value is cleared through the **Clear** button
         * ([see example]({% slug overview_combobox %}#toc-events)).
         * When the value of the component is programmatically changed to `ngModel` or `formControl`
         * through its API or form binding, the `valueChange` event is not triggered because it
         * might cause a mix-up with the built-in `valueChange` mechanisms of the `ngModel` or `formControl` bindings.
         */
        this.valueChange = new EventEmitter();
        /**
         * Fires each time an item selection is changed
         * ([see example]({% slug overview_combobox %}#toc-events)).
         */
        this.selectionChange = new EventEmitter();
        /**
         * Fires each time the user types in the input field.
         * You can filter the source based on the passed filtration value
         * ([see example]({% slug overview_combobox %}#toc-events)).
         */
        this.filterChange = new EventEmitter();
        /**
         * Fires each time the popup is about to open.
         * This event is preventable. If you cancel it, the popup will remain closed.
         */
        this.open = new EventEmitter();
        /**
         * Fires after the popup has been opened.
         */
        this.opened = new EventEmitter();
        /**
         * Fires each time the popup is about to close.
         * This event is preventable. If you cancel it, the popup will remain open.
         */
        this.close = new EventEmitter();
        /**
         * Fires after the popup has been closed.
         */
        this.closed = new EventEmitter();
        /**
         * Fires each time the user focuses the ComboBox.
         */
        this.onFocus = new EventEmitter();
        /**
         * Fires each time the ComboBox gets blurred.
         */
        this.onBlur = new EventEmitter();
        this.widgetClasses = true;
        this._isFocused = false;
        this.listBoxId = guid$1();
        this.optionPrefix = guid$1();
        this.onChangeCallback = (_) => { };
        this.onTouchedCallback = (_) => { };
        /**
         * Used for the default virtualization settings config.
         */
        this.defaultVirtualItemHeight = 28;
        /**
         * Used for the default virtualization settings config.
         */
        this.defaultVirtualPageSize = 50;
        this._filtering = false;
        this._text = '';
        this.filterText = '';
        this._open = false;
        this._popupSettings = { animate: true };
        this.popupMouseDownHandler = (event) => event.preventDefault();
        this.customValueSubject = new Subject();
        this.valueSubject = new Subject();
        this.clearValueSubject = new Subject();
        this.subs = new Subscription();
        this._size = 'medium';
        this._rounded = 'medium';
        this._fillMode = 'solid';
        validatePackage(packageMetadata);
        this.direction = localization.rtl ? 'rtl' : 'ltr';
        this.data = [];
    }
    set text(text) {
        this._text = isPresent(text) ? text.toString() : "";
    }
    get text() {
        return this._text;
    }
    /**
     * @hidden
     */
    togglePopup(open) {
        const isDisabled = this.disabled || this.readonly;
        const sameState = this.isOpen === open;
        if (isDisabled || sameState) {
            return;
        }
        const isDefaultPrevented = this.triggerPopupEvents(open);
        if (!isDefaultPrevented) {
            this._toggle(open);
        }
    }
    get activeDescendant() {
        if (!this.isOpen || !isPresent(this.selectionService.focused) || this.selectionService.focused === -1) {
            return null;
        }
        const dataItem = this.dataService.itemAt(this.selectionService.focused);
        return this.optionPrefix + "-" + (dataItem ? getter$1(dataItem, this.valueField) : "");
    }
    get noDataLabel() {
        if (this.data.length === 0) {
            return this.messageFor('noDataText');
        }
    }
    get appendTo() {
        const { appendTo } = this.popupSettings;
        if (!appendTo || appendTo === 'root') {
            return undefined;
        }
        return appendTo === 'component' ? this.container : appendTo;
    }
    /**
     * Sets the data of the ComboBox.
     *
     * > The data has to be provided in an array-like list.
     */
    set data(data) {
        this.dataService.data = data || [];
        if (this.virtual) {
            this.virtual.skip = 0;
        }
        this.setState();
        if (this._filtering) {
            const queryAndDataPresent = this.text.length > 0 && this.dataService.itemsCount > 0;
            const index = queryAndDataPresent ? this.firstFocusableIndex(0) : -1;
            this.selectionService.focused = index;
        }
        if (this.suggest && this.dataService.itemsCount && this.text) {
            this.suggestedText = getter$1(this.dataService.itemAt(0), this.textField);
        }
    }
    get data() {
        const virtual = this.virtual;
        if (virtual) {
            const start = virtual.skip || 0;
            const end = start + virtual.pageSize;
            // Use length instead of itemsCount because of the grouping.
            virtual.total = this.dataService.data.length;
            return this.dataService.data.slice(start, end);
        }
        return this.dataService.data;
    }
    /**
     * Sets the value of the ComboBox.
     * It can either be of the primitive (string, numbers) or of the complex (objects) type.
     * To define the type, use the `valuePrimitive` option.
     *
     * > All selected values which are not present in the dataset are considered custom values.
     * > When the `Enter` key is pressed or the component loses focus, custom values get dismissed unless `allowCustom` is set to `true`.
     */
    set value(newValue) {
        this._value = newValue;
        this.setState();
        this.cdr.markForCheck();
    }
    get value() {
        return this._value;
    }
    /**
     * Specifies the type of the selected value.
     * If set to `true`, the selected value has to be of the primitive type
     * ([more information and example]({% slug valuebinding_combobox %}#toc-primitive-values-from-object-fields)).
     */
    set valuePrimitive(isPrimitive) {
        this._valuePrimitive = isPrimitive;
    }
    get valuePrimitive() {
        if (!isPresent(this._valuePrimitive)) {
            return !isPresent(this.valueField);
        }
        return this._valuePrimitive;
    }
    /**
     * Configures the popup of the ComboBox.
     *
     * The available options are:
     * - `animate: Boolean`&mdash;Controls the popup animation. By default, the open and close animations are enabled.
     * - `width: Number | String`&mdash;Sets the width of the popup container. By default, the width of the host element is used. If set to `auto`, the component automatically adjusts the width of the popup and no item labels are wrapped. The `auto` mode is not supported when virtual scrolling is enabled.
     * - `height: Number`&mdash;Sets the height of the popup container.
     * - `popupClass: String`&mdash;Specifies a list of CSS classes that are used to style the popup.
     * - `appendTo: "root" | "component" | ViewContainerRef`&mdash;Specifies the component to which the popup will be appended.
     */
    set popupSettings(settings) {
        this._popupSettings = Object.assign({ animate: true }, settings);
    }
    get popupSettings() {
        return this._popupSettings;
    }
    /**
     * Defines a Boolean function that is executed for each data item in the component
     * ([see examples]({% slug disableditems_combobox %})). Determines whether the item will be disabled.
     */
    set itemDisabled(fn) {
        if (typeof fn !== 'function') {
            throw new Error(`itemDisabled must be a function, but received ${JSON.stringify(fn)}.`);
        }
        this.disabledItemsService.itemDisabled = fn;
    }
    /**
     * @hidden
     */
    set tabIndex(tabIndex) {
        this.tabindex = tabIndex;
    }
    get tabIndex() {
        return this.tabindex;
    }
    /**
     * Enables the [virtualization]({% slug virtualization_combobox %}) functionality.
     */
    set virtual(settings) {
        this._virtualSettings = normalizeVirtualizationSettings(settings, {
            itemHeight: this.defaultVirtualItemHeight,
            pageSize: this.defaultVirtualPageSize
        });
    }
    get virtual() {
        return this._virtualSettings;
    }
    /**
     * Sets the size of the component.
     *
     * The possible values are:
     * * `'small'`
     * * `'medium'` (default)
     * * `'large'`
     * * `null`
     *
     */
    set size(size) {
        this.renderer.removeClass(this.wrapper.nativeElement, getSizeClass('input', this.size));
        if (size) {
            this.renderer.addClass(this.wrapper.nativeElement, getSizeClass('input', size));
        }
        this._size = size;
    }
    get size() {
        return this._size;
    }
    /**
     * Sets the border radius of the component.
     *
     * The possible values are:
     * * `'small'`
     * * `'medium'` (default)
     * * `'large'`
     * * `'full'`
     * * `null`
     *
     */
    set rounded(rounded) {
        this.renderer.removeClass(this.wrapper.nativeElement, getRoundedClass(this.rounded));
        if (rounded) {
            this.renderer.addClass(this.wrapper.nativeElement, getRoundedClass(rounded));
        }
        this._rounded = rounded;
    }
    get rounded() {
        return this._rounded;
    }
    /**
     * Sets the fillMode of the component.
     *
     * The possible values are:
     * * `'flat'`
     * * `'solid'` (default)
     * * `'outline'`
     * * `null`
     *
     */
    set fillMode(fillMode) {
        this.renderer.removeClass(this.wrapper.nativeElement, getFillModeClass('input', this.fillMode));
        if (fillMode) {
            this.renderer.addClass(this.wrapper.nativeElement, getFillModeClass('input', fillMode));
        }
        this._fillMode = fillMode;
    }
    get fillMode() {
        return this._fillMode;
    }
    get isDisabled() {
        return this.disabled;
    }
    get isLoading() {
        return this.loading;
    }
    get dir() {
        return this.direction;
    }
    get isFocused() {
        return this._isFocused;
    }
    set isFocused(value) {
        this.renderer[value ? 'addClass' : 'removeClass'](this.wrapper.nativeElement, "k-focus");
        this._isFocused = value;
    }
    get clearButtonVisiblity() {
        if (this.touchEnabled) {
            return 'visible';
        }
    }
    get popupWidth() {
        let wrapperOffsetWidth = 0;
        if (isDocumentAvailable()) {
            wrapperOffsetWidth = this.wrapper.nativeElement.offsetWidth;
        }
        const width = this.popupSettings.width || wrapperOffsetWidth;
        const minWidth = isNaN(wrapperOffsetWidth) ? wrapperOffsetWidth : `${wrapperOffsetWidth}px`;
        const maxWidth = isNaN(width) ? width : `${width}px`;
        return { min: minWidth, max: maxWidth };
    }
    get popupHeight() {
        const popupHeight = this.popupSettings.height;
        return isPresent(popupHeight) ? `${popupHeight}px` : 'auto';
    }
    ngOnInit() {
        this.renderer.removeAttribute(this.wrapper.nativeElement, 'tabindex');
        this.attachStreams();
        this.createValueStream();
        this.subscribeTouchEvents();
        this.attachSelectClickHandler();
        this.setComponentClasses();
    }
    createValueStream() {
        const valueStream = this.valueSubject.pipe(filter((candidate) => {
            const current = getter$1(this.value, this.valueField);
            const newValue = getter$1(candidate, this.valueField);
            let newText = getter$1(candidate, this.textField);
            if (!isPresent(this.value) && !isPresent(newValue)) {
                return false;
            }
            if (isPresent(newText)) {
                newText = newText.toString();
            }
            if (current === newValue && this.text === newText) {
                this.clearFilter();
                return false;
            }
            else {
                return true;
            }
        }), map((candidate) => {
            const newValue = getter$1(candidate, this.valueField);
            const newText = getter$1(candidate, this.textField);
            return {
                dataItem: candidate,
                text: newText,
                value: this.valuePrimitive ? newValue : candidate
            };
        }));
        const customValueStreams = partition(() => this.allowCustom)(this.customValueSubject.pipe(throttleTime(300)));
        const allowCustomValueStream = customValueStreams[0].pipe(tap(() => {
            this.loading = true;
            this.disabled = true;
            this.cdr.detectChanges();
        }), filter(() => {
            const hasChange = this.text !== getter$1(this.value, this.valueField);
            this.loading = hasChange;
            this.disabled = hasChange;
            if (!hasChange) {
                this.clearFilter();
            }
            return hasChange;
        }), this.valueNormalizer, map((normalizedValue) => {
            return {
                custom: true,
                dataItem: normalizedValue,
                text: this.text,
                value: normalizedValue
            };
        }));
        const disableCustomValueStream = customValueStreams[1].pipe(map(() => {
            return {
                custom: true,
                dataItem: undefined,
                text: undefined,
                value: undefined
            };
        }));
        const clearValueStream = this.clearValueSubject.pipe(map(() => ({
            dataItem: undefined,
            text: undefined,
            value: undefined
        })));
        if (this.valueSubscription) {
            this.valueSubscription.unsubscribe();
        }
        const merged = merge(valueStream, allowCustomValueStream, disableCustomValueStream, clearValueStream);
        this.valueSubscription = merged.pipe(catchError(() => {
            const selectionChanged = getter$1(this.dataItem, this.valueField) !== undefined;
            this.dataItem = undefined;
            this.value = undefined;
            this.text = undefined;
            this.loading = false;
            this.disabled = false;
            if (selectionChanged) {
                this.selectionChange.emit(undefined);
            }
            this.emitValueChange();
            this.createValueStream();
            return of(null);
        }))
            .subscribe((state) => {
            const selectionChanged = getter$1(this.dataItem, this.valueField) !== getter$1(state.dataItem, this.valueField);
            this.dataItem = state.dataItem;
            this.value = state.value;
            this.text = state.text;
            this.loading = false;
            this.disabled = false;
            this.clearFilter();
            if (state.custom) {
                this.selectionService.focused = -1;
            }
            if (selectionChanged) {
                const selectionArgs = state.custom ? undefined : this.dataItem;
                this.selectionChange.emit(selectionArgs);
            }
            this.emitValueChange();
        });
    }
    attachStreams() {
        if (!isDocumentAvailable()) {
            return;
        }
        this.subs.add(this.localization
            .changes.subscribe(({ rtl }) => {
            this.direction = rtl ? 'rtl' : 'ltr';
            this.cdr.detectChanges();
        }));
        this.subs.add(merge(this.navigationService.up, this.navigationService.down, this.navigationService.home, this.navigationService.end)
            .pipe(filter((event) => isPresent(event.index)))
            .subscribe((event) => this.navigate(event.index)));
        this.subs.add(this.navigationService.open.subscribe(this.handleNavigationOpen.bind(this)));
        this.subs.add(this.navigationService.close.subscribe(() => this.togglePopup(false)));
        this.subs.add(this.navigationService.esc.subscribe(this.handleEscape.bind(this)));
        this.subs.add(this.navigationService.enter.pipe(tap((event) => {
            if (this.isOpen) {
                event.originalEvent.preventDefault();
            }
        }))
            .subscribe(this.handleEnter.bind(this)));
        this.subs.add(merge(this.selectionService.onChange, this.selectionService.onSelect.pipe(filter(_ => !this.isOpen)))
            .pipe(tap(_ => {
            this._filtering = false;
            this.togglePopup(false);
        }), map((event) => this.dataService.itemAt(event.indices[0])))
            .subscribe(dataItem => {
            this.change(dataItem);
        }));
        this.subs.add(this.selectionService.onSelect.pipe(filter(_ => this.isOpen), tap(_ => this._filtering = false), map((event) => this.dataService.itemAt(event.indices[0])))
            .subscribe(dataItem => {
            const selectionChanged = getter$1(dataItem, this.valueField) !== getter$1(this.dataItem, this.valueField);
            this.updateState({ dataItem });
            if (selectionChanged) {
                this.selectionChange.emit(dataItem);
            }
        }));
    }
    ngOnDestroy() {
        this.destroyPopup();
        this.subs.unsubscribe();
        if (isPresent(this.valueSubscription)) {
            this.valueSubscription.unsubscribe();
        }
        if (this.touchstartDisposeHandler) {
            this.touchstartDisposeHandler();
        }
        if (this.selectClickDisposeHandler) {
            this.selectClickDisposeHandler();
        }
    }
    ngOnChanges(changes) {
        const virtual = this.virtual;
        const requestInitialData = virtual && changes.data && changes.data.isFirstChange();
        if (requestInitialData) {
            this.pageChange({ skip: 0, take: virtual.pageSize });
        }
        if (isChanged('valueNormalizer', changes)) {
            this.createValueStream();
        }
        if (anyChanged(['textField', 'valueField', 'valuePrimitive'], changes, false)) {
            this.setState();
        }
    }
    ngAfterContentChecked() {
        this.verifySettings();
    }
    /**
     * Focuses a specific item of the ComboBox based on a provided index.
     * If null or invalid index is provided the focus will be removed.
     */
    focusItemAt(index) {
        const isInRange = index >= 0 && index < this.data.length;
        if (isPresent(index) && isInRange && !this.disabledItemsService.isIndexDisabled(index)) {
            this.selectionService.focus(index);
        }
        else {
            this.selectionService.focus(-1);
        }
    }
    /**
     * Focuses the ComboBox.
     */
    focus() {
        if (!this.disabled) {
            this.searchbar.focus();
        }
    }
    /**
     * Blurs the ComboBox.
     */
    blur() {
        if (!this.disabled) {
            this.searchbar.blur();
        }
    }
    /**
     * Toggles the visibility of the popup. If you use the `toggle` method to open or close the popup,
     * the `open` and `close` events will not be fired.
     *
     * @param open - The state of the popup.
     */
    toggle(open) {
        Promise.resolve(null).then(() => {
            const shouldOpen = isPresent(open) ? open : !this._open;
            this._toggle(shouldOpen);
            this.cdr.markForCheck();
        });
    }
    /**
     * Returns the current open state of the popup.
     */
    get isOpen() {
        return this._open;
    }
    /**
     * Resets the value of the ComboBox.
     * If you use the `reset` method to clear the value of the component,
     * the model will not update automatically and the `selectionChange` and `valueChange` events will not be fired.
     */
    reset() {
        this.value = undefined;
        this.clearState();
        this.resetSelection();
    }
    /**
     * @hidden
     *
     * Used by the TextBoxContainer to determine if the floating label
     * should be rendered in the input when the component is not focused.
     */
    isEmpty() {
        const textEmpty = !isPresent(this.text) || isEmptyString(this.text);
        const valueEmpty = !isPresent(this.value) || isEmptyString(this.value);
        return textEmpty && valueEmpty;
    }
    /**
     * @hidden
     */
    messageFor(key) {
        return this.localization.get(key);
    }
    /**
     * @hidden
     */
    clearValue(event) {
        event.stopImmediatePropagation();
        this.focus();
        this._filtering = true;
        this._previousDataItem = undefined;
        this.selectionService.resetSelection([]);
        this.clearValueSubject.next();
        this._filtering = false;
    }
    /**
     * @hidden
     */
    writeValue(value) {
        this.value = value === null ? undefined : value;
    }
    /**
     * @hidden
     */
    registerOnChange(fn) {
        this.onChangeCallback = fn;
    }
    /**
     * @hidden
     */
    registerOnTouched(fn) {
        this.onTouchedCallback = fn;
    }
    /**
     * @hidden
     */
    setDisabledState(isDisabled) {
        this.disabled = isDisabled;
    }
    /**
     * @hidden
     */
    get buttonClasses() {
        return this.loading ? 'k-i-loading' : this.iconClass || 'k-i-arrow-s';
    }
    /**
     * @hidden
     */
    get selectButtonClasses() {
        return `${this.size ? getSizeClass('button', this.size) : ''} ${this.fillMode ? 'k-button-' + this.fillMode : ''} ${this.fillMode ? 'k-button-' + this.fillMode + '-base' : ''}
        `;
    }
    /**
     * @hidden
     */
    onResize() {
        if (this.isOpen) {
            const popupWrapper = this.popupRef.popupElement;
            const { min, max } = this.popupWidth;
            popupWrapper.style.minWidth = min;
            popupWrapper.style.width = max;
        }
    }
    verifySettings() {
        if (!isDevMode()) {
            return;
        }
        if (this.valuePrimitive === true && isPresent(this.value) && typeof this.value === "object") {
            throw new Error(ComboBoxMessages.primitive);
        }
        if (this.valuePrimitive === false && isPresent(this.value) && typeof this.value !== "object") {
            throw new Error(ComboBoxMessages.object);
        }
        const valueOrText = !isPresent(this.valueField) !== !isPresent(this.textField);
        if (valueOrText) {
            throw new Error(ComboBoxMessages.textAndValue);
        }
        if (this.virtual && isNaN(this.virtual.itemHeight)) {
            throw new Error(ComboBoxMessages.noItemHeight);
        }
    }
    setState() {
        // Filtering in process, do nothing.
        if (this._filtering) {
            return;
        }
        const value = this.value;
        const valueField = this.valueField;
        const resolved = this.findDataItem({ valueField, value });
        if (isPresent(resolved.index) && resolved.index !== -1) {
            this.updateState({ dataItem: resolved.dataItem, confirm: true });
            this.resetSelection(resolved.index);
        }
        else if (isPresent(value) && this.allowCustom) {
            this.updateState({ dataItem: value });
            this.resetSelection(-1);
        }
        else if (this._previousDataItem && this.value) {
            this.updateState({ dataItem: this._previousDataItem });
            this.resetSelection();
        }
        else {
            this.clearState();
            this.resetSelection(-1);
        }
    }
    updateState({ dataItem, confirm = false }) {
        this.dataItem = dataItem;
        this.text = getter$1(dataItem, this.textField);
        if (confirm) {
            this._previousDataItem = dataItem;
        }
    }
    clearState() {
        this.text = undefined;
        this.dataItem = undefined;
    }
    resetSelection(index) {
        const clear = !isPresent(index) || index < 0;
        this.selectionService.resetSelection(clear ? [] : [index]);
        this.selectionService.focused = index;
    }
    firstFocusableIndex(index) {
        const maxIndex = this.data.length - 1;
        if (this.disabledItemsService.isIndexDisabled(index)) {
            return (index < maxIndex) ? this.firstFocusableIndex(index + 1) : undefined;
        }
        else {
            return index;
        }
    }
    findIndexPredicate(text) {
        if (this.dataService.grouped) {
            return (item) => {
                let itemText = getter$1(item.value, this.textField);
                itemText = !isPresent(itemText) ? "" : itemText.toString().toLowerCase();
                return itemText.startsWith(text.toLowerCase());
            };
        }
        else {
            return (item) => {
                let itemText = getter$1(item, this.textField);
                itemText = !isPresent(itemText) ? "" : itemText.toString().toLowerCase();
                return itemText.startsWith(text.toLowerCase());
            };
        }
    }
    findDataItem({ valueField, value }) {
        const result = {
            dataItem: null,
            index: -1
        };
        const comparer = (element) => {
            const dataItem = this.dataService.grouped ? element.value : element;
            return getter$1(dataItem, valueField) === getter$1(value, valueField);
        };
        const index = this.dataService.findIndex(comparer);
        result.dataItem = this.dataService.itemAt(index);
        result.index = index;
        return result;
    }
    search(text, startFrom = 0) {
        let index;
        if (text.length && this.dataService.itemsCount) {
            index = this.dataService.findIndex(this.findIndexPredicate(text), startFrom);
        }
        else {
            index = -1;
        }
        if (this.disabledItemsService.isIndexDisabled(index)) {
            if (index + 1 < this.dataService.itemsCount) {
                this.search(text, index + 1);
            }
            else {
                this.selectionService.focus(-1);
            }
        }
        else {
            this.selectionService.focus(index);
            if (this.suggest) {
                this.suggestedText = getter$1(this.dataService.itemAt(index), this.textField);
            }
        }
    }
    /**
     * @hidden
     */
    getSuggestion() {
        const hasSelected = !!this.selectionService.selected.length;
        const shouldSuggest = this.suggest && !this.backspacePressed && this.suggestedText && this.text;
        if (!hasSelected && shouldSuggest && this.suggestedText.toLowerCase().startsWith(this.text.toLowerCase())) {
            return this.suggestedText;
        }
        else {
            this.suggestedText = undefined;
        }
    }
    navigate(index) {
        if (this.dataService.itemsCount === 0) {
            return;
        }
        this.text = getter$1(this.dataService.itemAt(index), this.textField);
        this.selectionService.select(index);
    }
    /**
     * @hidden
     */
    handleNavigate(event) {
        const hasSelected = isPresent(this.selectionService.selected[0]);
        const focused = isNaN(this.selectionService.focused) ? this.firstFocusableIndex(0) : this.selectionService.focused;
        let offset = 0;
        if (this.disabled || this.readonly) {
            return;
        }
        if (event.keyCode === Keys.Home || event.keyCode === Keys.End) {
            return;
        }
        if (!hasSelected) {
            if (event.keyCode === Keys.ArrowDown) {
                offset = -1;
            }
            else if (event.keyCode === Keys.ArrowUp) {
                offset = 1;
            }
        }
        const action = this.navigationService.process({
            current: offset + focused,
            max: this.dataService.itemsCount - 1,
            min: 0,
            originalEvent: event
        });
        if (action !== NavigationAction.Undefined &&
            action !== NavigationAction.Left &&
            action !== NavigationAction.Right &&
            action !== NavigationAction.Backspace &&
            action !== NavigationAction.Delete &&
            ((action === NavigationAction.Enter && this.isOpen) || action !== NavigationAction.Enter)) {
            event.preventDefault();
        }
    }
    handleEnter() {
        const text = this.text;
        const focused = this.selectionService.focused;
        const hasFocused = isPresent(focused) && focused !== -1;
        const previousText = getter$1(this._previousDataItem, this.textField) || "";
        const focusedItemText = getter$1(this.dataService.itemAt(focused), this.textField);
        const textHasChanged = text !== previousText;
        this.togglePopup(false);
        this._filtering = false;
        if (this.allowCustom && textHasChanged) {
            if (text === focusedItemText || this.useSuggestion()) {
                this.selectionService.change(focused);
            }
            else {
                this.change(text, true);
            }
        }
        if (!this.allowCustom) {
            if (hasFocused) {
                this.selectionService.change(focused);
            }
            else if (textHasChanged) {
                this.change(text, true);
            }
        }
    }
    /**
     * @hidden
     */
    handleBlur() {
        this._filtering = false;
        this.searchbar.input.nativeElement.scrollLeft = 0; // Firefox doesn't auto-scroll to the left on blur like other browsers
        this.isFocused = false;
        const unresolvedSelection = getter$1(this.dataItem, this.valueField) !== getter$1(this.value, this.valueField);
        const currentText = this.searchbar.value;
        const textHasChanged = currentText !== (getter$1(this.dataItem, this.textField) || '');
        const valueHasChanged = unresolvedSelection || textHasChanged;
        const runInZone = valueHasChanged || hasObservers(this.onBlur) || hasObservers(this.close) || isUntouched(this.wrapper.nativeElement);
        if (runInZone) {
            this.zone.run(() => {
                if (valueHasChanged) {
                    const lowerCaseMatch = isPresent(this.focusedItemText) && this.focusedItemText.toLowerCase() === currentText.toLowerCase();
                    if (lowerCaseMatch || unresolvedSelection) {
                        this.selectionService.change(this.selectionService.focused);
                    }
                    else {
                        this.change(currentText, true);
                    }
                }
                this.onBlur.emit();
                this.onTouchedCallback();
                this.togglePopup(false);
            });
        }
        else {
            this.togglePopup(false);
        }
    }
    /**
     * @hidden
     */
    handleEscape() {
        this.togglePopup(false);
        // clear the focus only if the focused item is not selected
        const hasSelected = this.selectionService.selected.length > 0;
        if (!hasSelected) {
            this.suggestedText = null;
            this.selectionService.focused = -1;
        }
    }
    /**
     * @hidden
     */
    handleNavigationOpen() {
        this.restoreItemFocus();
        this.togglePopup(true);
    }
    /**
     * @hidden
     */
    searchBarChange(text) {
        const currentTextLength = this.text ? this.text.length : 0;
        this.backspacePressed = (text.length < currentTextLength) ? true : false;
        this.text = text;
        // Reset the selection prior to filter. If a match is present, it will be resolved. If a match is not present, it is not needed.
        this.selectionService.resetSelection([]);
        this.togglePopup(true);
        this._filtering = true;
        if (this.filterable && this.filterText !== text) {
            this.filterText = text;
            this.filterChange.emit(text);
        }
        else {
            this.search(text);
        }
    }
    /**
     * @hidden
     */
    handleFocus() {
        this.isFocused = true;
        if (hasObservers(this.onFocus)) {
            this.zone.run(() => this.onFocus.emit());
        }
    }
    /**
     * @hidden
     */
    pageChange(event) {
        const virtual = this.virtual;
        virtual.skip = event.skip;
    }
    change(candidate, isCustom = false) {
        if (isCustom) {
            this.customValueSubject.next(candidate);
        }
        else {
            this.valueSubject.next(candidate);
        }
    }
    emitValueChange() {
        this.onChangeCallback(this.value);
        this.valueChange.emit(this.value);
        this._previousDataItem = this.dataItem;
    }
    /**
     * @hidden
     */
    selectClick() {
        if (!this.touchEnabled) {
            this.searchbar.focus();
        }
        if (!this.isOpen) {
            this.restoreItemFocus();
        }
        this.togglePopup(!this.isOpen);
    }
    get listContainerClasses() {
        return ['k-list-container', 'k-reset'].concat(this.popupSettings.popupClass || []);
    }
    /**
     * @hidden
     */
    preventEventDefault(event) {
        event.preventDefault();
    }
    get focusedItemText() {
        const focused = this.selectionService.focused;
        if (!isPresent(focused) || focused === -1) {
            return null;
        }
        const itemText = getter$1(this.dataService.itemAt(focused), this.textField);
        return !isPresent(itemText) ? "" : itemText.toString();
    }
    /**
     * Focuses the first match when there's text in the input field, but no focused item.
     */
    restoreItemFocus() {
        const hasFocus = isPresent(this.selectionService.focused) && this.selectionService.focused > -1;
        if (!hasFocus && this.text && this.dataService.itemsCount) {
            if (this.filterable) {
                this.selectionService.focused = this.firstFocusableIndex(0);
            }
            else {
                this.search(this.text);
            }
        }
    }
    useSuggestion() {
        if (!(this.suggest && isPresent(this.searchbar.value))) {
            return false;
        }
        const focusedDataItem = this.dataService.itemAt(this.selectionService.focused);
        const focusedItemText = getter$1(focusedDataItem, this.textField);
        if (!isPresent(focusedItemText)) {
            return false;
        }
        return this.searchbar.value.toLowerCase() === focusedItemText.toLowerCase();
    }
    destroyPopup() {
        if (this.popupRef) {
            this.popupRef.popupElement
                .removeEventListener('mousedown', this.popupMouseDownHandler);
            this.popupRef.close();
            this.popupRef = null;
        }
    }
    createPopup() {
        if (this.virtual) {
            this.virtual.skip = 0;
        }
        const horizontalAlign = this.direction === "rtl" ? "right" : "left";
        const anchorPosition = { horizontal: horizontalAlign, vertical: "bottom" };
        const popupPosition = { horizontal: horizontalAlign, vertical: "top" };
        this.popupRef = this.popupService.open({
            anchor: this.wrapper,
            animate: this.popupSettings.animate,
            appendTo: this.appendTo,
            content: this.popupTemplate,
            popupClass: this.listContainerClasses,
            positionMode: 'absolute',
            anchorAlign: anchorPosition,
            popupAlign: popupPosition
        });
        const popupWrapper = this.popupRef.popupElement;
        const { min, max } = this.popupWidth;
        popupWrapper.addEventListener('mousedown', this.popupMouseDownHandler);
        popupWrapper.style.minWidth = min;
        popupWrapper.style.width = max;
        popupWrapper.style.height = this.popupHeight;
        popupWrapper.setAttribute("dir", this.direction);
        this.popupRef.popupOpen.subscribe(() => {
            this.cdr.detectChanges();
            this.optionsList.scrollToItem(this.selectionService.focused);
            this.opened.emit();
        });
        this.popupRef.popupClose.subscribe(() => {
            this.closed.emit();
        });
        this.popupRef.popupAnchorViewportLeave.subscribe(() => this.togglePopup(false));
    }
    _toggle(open) {
        this._open = open;
        this.destroyPopup();
        if (this._open) {
            this.createPopup();
        }
    }
    triggerPopupEvents(open) {
        const eventArgs = new PreventableEvent();
        if (open) {
            this.open.emit(eventArgs);
        }
        else {
            this.close.emit(eventArgs);
        }
        return eventArgs.isDefaultPrevented();
    }
    clearFilter() {
        if (!(this.filterable && this.filterText)) {
            return;
        }
        this.filterText = '';
        this.filterChange.emit(this.filterText);
    }
    subscribeTouchEvents() {
        if (!isDocumentAvailable() || !this.touchEnabled) {
            return;
        }
        this.zone.runOutsideAngular(() => 
        // Roll up ComboBox on iOS when tapped outside
        this.touchstartDisposeHandler = this.renderer.listen(document, 'touchstart', (e) => {
            const target = e.target;
            const isInDropDown = inDropDown(this.wrapper, target, this.popupRef);
            if (this.isFocused && !isInDropDown) {
                // Close popup and mobile keyboard if searchbar is focused
                this.zone.run(() => this.blur());
            }
            else if (this.isOpen && !isInDropDown) {
                // Close popup if the popup is opened via the select click
                this.zone.run(() => this.togglePopup(false));
            }
        }));
    }
    attachSelectClickHandler() {
        const selectElement = this.select.nativeElement;
        const event = pointers ? 'pointerdown' : 'click';
        this.selectClickDisposeHandler = this.renderer.listen(selectElement, event, this.selectClick.bind(this));
    }
    setComponentClasses() {
        if (this.size) {
            this.renderer.addClass(this.wrapper.nativeElement, getSizeClass('input', this.size));
        }
        if (this.rounded) {
            this.renderer.addClass(this.wrapper.nativeElement, getRoundedClass(this.rounded));
        }
        if (this.fillMode) {
            this.renderer.addClass(this.wrapper.nativeElement, getFillModeClass('input', this.fillMode));
        }
    }
};
ComboBoxComponent.ɵfac = function ComboBoxComponent_Factory(t) { return new (t || ComboBoxComponent)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ElementRef), ɵngcc0.ɵɵdirectiveInject(ɵngcc1.LocalizationService), ɵngcc0.ɵɵdirectiveInject(ɵngcc4.PopupService), ɵngcc0.ɵɵdirectiveInject(SelectionService), ɵngcc0.ɵɵdirectiveInject(NavigationService), ɵngcc0.ɵɵdirectiveInject(DisabledItemsService), ɵngcc0.ɵɵdirectiveInject(DataService), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.NgZone), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ChangeDetectorRef), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.Renderer2), ɵngcc0.ɵɵdirectiveInject(TOUCH_ENABLED, 8)); };
ComboBoxComponent.ɵcmp = /*@__PURE__*/ ɵngcc0.ɵɵdefineComponent({ type: ComboBoxComponent, selectors: [["kendo-combobox"]], contentQueries: function ComboBoxComponent_ContentQueries(rf, ctx, dirIndex) { if (rf & 1) {
        ɵngcc0.ɵɵcontentQuery(dirIndex, ItemTemplateDirective, 5);
        ɵngcc0.ɵɵcontentQuery(dirIndex, HeaderTemplateDirective, 5);
        ɵngcc0.ɵɵcontentQuery(dirIndex, FooterTemplateDirective, 5);
        ɵngcc0.ɵɵcontentQuery(dirIndex, NoDataTemplateDirective, 5);
        ɵngcc0.ɵɵcontentQuery(dirIndex, GroupTemplateDirective, 5);
        ɵngcc0.ɵɵcontentQuery(dirIndex, FixedGroupTemplateDirective, 5);
    } if (rf & 2) {
        let _t;
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.template = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.headerTemplate = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.footerTemplate = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.noDataTemplate = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.groupTemplate = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.fixedGroupTemplate = _t.first);
    } }, viewQuery: function ComboBoxComponent_Query(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵviewQuery(_c8, 7, ViewContainerRef);
        ɵngcc0.ɵɵviewQuery(_c9, 7);
        ɵngcc0.ɵɵviewQuery(SearchBarComponent, 7);
        ɵngcc0.ɵɵviewQuery(_c10, 5);
        ɵngcc0.ɵɵviewQuery(_c16, 7);
    } if (rf & 2) {
        let _t;
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.container = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.popupTemplate = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.searchbar = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.optionsList = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.select = _t.first);
    } }, hostVars: 9, hostBindings: function ComboBoxComponent_HostBindings(rf, ctx) { if (rf & 2) {
        ɵngcc0.ɵɵattribute("dir", ctx.dir);
        ɵngcc0.ɵɵclassProp("k-combobox", ctx.widgetClasses)("k-input", ctx.widgetClasses)("k-disabled", ctx.isDisabled)("k-loading", ctx.isLoading);
    } }, inputs: { focusableId: "focusableId", allowCustom: "allowCustom", valueNormalizer: "valueNormalizer", placeholder: "placeholder", listHeight: "listHeight", suggest: "suggest", clearButton: "clearButton", disabled: "disabled", readonly: "readonly", tabindex: "tabindex", filterable: "filterable", data: "data", value: "value", valuePrimitive: "valuePrimitive", popupSettings: "popupSettings", itemDisabled: "itemDisabled", tabIndex: "tabIndex", virtual: "virtual", size: "size", rounded: "rounded", fillMode: "fillMode", loading: "loading", textField: "textField", valueField: "valueField", iconClass: "iconClass" }, outputs: { valueChange: "valueChange", selectionChange: "selectionChange", filterChange: "filterChange", open: "open", opened: "opened", close: "close", closed: "closed", onFocus: "focus", onBlur: "blur" }, exportAs: ["kendoComboBox"], features: [ɵngcc0.ɵɵProvidersFeature([
            COMBOBOX_VALUE_ACCESSOR,
            DataService,
            SelectionService,
            NavigationService,
            DisabledItemsService,
            LocalizationService,
            {
                provide: L10N_PREFIX,
                useValue: 'kendo.combobox'
            },
            {
                provide: FilterableComponent, useExisting: forwardRef(() => ComboBoxComponent_1)
            },
            {
                provide: KendoInput, useExisting: forwardRef(() => ComboBoxComponent_1)
            }
        ]), ɵngcc0.ɵɵNgOnChangesFeature], decls: 12, vars: 20, consts: function () { let i18n_17; if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
        /**
         * @desc The text displayed in the popup when there are no items
         * @meaning kendo.combobox.noDataText
         */
        const MSG_EXTERNAL_7708502966028483300$$DIST_FESM2015_INDEX_JS_18 = goog.getMsg("NO DATA FOUND");
        i18n_17 = MSG_EXTERNAL_7708502966028483300$$DIST_FESM2015_INDEX_JS_18;
    }
    else {
        i18n_17 = $localize `:kendo.combobox.noDataText|The text displayed in the popup when there are no items␟2b6e00c74a6d9c98c03a6274d0224e9bd457ff89␟7708502966028483300:NO DATA FOUND`;
    } let i18n_19; if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
        /**
         * @desc The title of the clear button
         * @meaning kendo.combobox.clearTitle
         */
        const MSG_EXTERNAL_2025597431468961462$$DIST_FESM2015_INDEX_JS_20 = goog.getMsg("clear");
        i18n_19 = MSG_EXTERNAL_2025597431468961462$$DIST_FESM2015_INDEX_JS_20;
    }
    else {
        i18n_19 = $localize `:kendo.combobox.clearTitle|The title of the clear button␟069e8fae80677e3e785861123bef446b3ff41ab4␟2025597431468961462:clear`;
    } let i18n_21; if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
        /**
         * @desc The text set as aria-label on the select button
         * @meaning kendo.combobox.selectButtonText
         */
        const MSG_EXTERNAL_2552188253943233918$$DIST_FESM2015_INDEX_JS_22 = goog.getMsg("Select");
        i18n_21 = MSG_EXTERNAL_2552188253943233918$$DIST_FESM2015_INDEX_JS_22;
    }
    else {
        i18n_21 = $localize `:kendo.combobox.selectButtonText|The text set as aria-label on the select button␟8cc898221b1419e23c0888a06dd1e174b78d32a4␟2552188253943233918:Select`;
    } return [["kendoComboBoxLocalizedMessages", "", "noDataText", i18n_17, "clearTitle", i18n_19, "selectButtonText", i18n_21], [3, "role", "id", "listId", "activeDescendant", "noDataLabel", "userInput", "suggestedText", "disabled", "readonly", "tabIndex", "popupOpen", "placeholder", "onNavigate", "valueChange", "onBlur", "onFocus"], ["searchbar", ""], ["class", "k-clear-value", "aria-hidden", "true", 3, "visibility", "kendoEventsOutsideAngular", "click", 4, "ngIf"], ["unselectable", "on", "type", "button", 1, "k-input-button", "k-button", "k-icon-button", 3, "ngClass", "kendoEventsOutsideAngular"], ["select", ""], [1, "k-button-icon", "k-icon", 3, "ngClass"], ["popupTemplate", ""], [3, "ngIf"], ["container", ""], ["aria-hidden", "true", 1, "k-clear-value", 3, "kendoEventsOutsideAngular", "click"], [1, "k-icon", "k-i-x"], [4, "ngIf"], [3, "size", "rounded", "id", "optionPrefix", "data", "textField", "valueField", "template", "groupTemplate", "fixedGroupTemplate", "height", "show", "virtual", "pageChange"], ["optionsList", ""], ["class", "k-no-data", 4, "ngIf"], [3, "templateContext"], [1, "k-no-data"], [3, "ngIf", "templateContext"], [3, "resize"]]; }, template: function ComboBoxComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵelementContainer(0, 0);
        ɵngcc0.ɵɵelementStart(1, "kendo-searchbar", 1, 2);
        ɵngcc0.ɵɵlistener("onNavigate", function ComboBoxComponent_Template_kendo_searchbar_onNavigate_1_listener($event) { return ctx.handleNavigate($event); })("valueChange", function ComboBoxComponent_Template_kendo_searchbar_valueChange_1_listener($event) { return ctx.searchBarChange($event); })("onBlur", function ComboBoxComponent_Template_kendo_searchbar_onBlur_1_listener() { return ctx.handleBlur(); })("onFocus", function ComboBoxComponent_Template_kendo_searchbar_onFocus_1_listener() { return ctx.handleFocus(); });
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵtemplate(3, ComboBoxComponent_span_3_Template, 2, 6, "span", 3);
        ɵngcc0.ɵɵelementStart(4, "button", 4, 5);
        ɵngcc0.ɵɵelement(6, "span", 6);
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵtemplate(7, ComboBoxComponent_ng_template_7_Template, 5, 16, "ng-template", null, 7, ɵngcc0.ɵɵtemplateRefExtractor);
        ɵngcc0.ɵɵtemplate(9, ComboBoxComponent_ng_template_9_Template, 1, 0, "ng-template", 8);
        ɵngcc0.ɵɵelementContainer(10, null, 9);
    } if (rf & 2) {
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("role", "combobox")("id", ctx.focusableId)("listId", ctx.listBoxId)("activeDescendant", ctx.activeDescendant)("noDataLabel", ctx.noDataLabel)("userInput", ctx.text)("suggestedText", ctx.getSuggestion())("disabled", ctx.disabled)("readonly", ctx.readonly)("tabIndex", ctx.tabIndex)("popupOpen", ctx.isOpen)("placeholder", ctx.placeholder);
        ɵngcc0.ɵɵadvance(2);
        ɵngcc0.ɵɵproperty("ngIf", ctx.clearButton && !ctx.loading && !ctx.disabled && !ctx.readonly && (ctx.text == null ? null : ctx.text.length));
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngClass", ctx.selectButtonClasses)("kendoEventsOutsideAngular", ɵngcc0.ɵɵpureFunction1(18, _c23, ctx.preventEventDefault));
        ɵngcc0.ɵɵattribute("aria-label", ctx.messageFor("selectButtonText"));
        ɵngcc0.ɵɵadvance(2);
        ɵngcc0.ɵɵproperty("ngClass", ctx.buttonClasses);
        ɵngcc0.ɵɵadvance(3);
        ɵngcc0.ɵɵproperty("ngIf", ctx.isOpen);
    } }, directives: function () { return [LocalizedMessagesDirective, SearchBarComponent, ɵngcc3.NgIf, ɵngcc2.EventsOutsideAngularDirective, ɵngcc3.NgClass, TemplateContextDirective, ListComponent, ɵngcc2.ResizeSensorComponent]; }, encapsulation: 2 });
__decorate([
    Input(),
    __metadata("design:type", String)
], ComboBoxComponent.prototype, "focusableId", void 0);
__decorate([
    Input(),
    __metadata("design:type", Boolean)
], ComboBoxComponent.prototype, "allowCustom", void 0);
__decorate([
    Input(),
    __metadata("design:type", Object),
    __metadata("design:paramtypes", [Object])
], ComboBoxComponent.prototype, "data", null);
__decorate([
    Input(),
    __metadata("design:type", Object),
    __metadata("design:paramtypes", [Object])
], ComboBoxComponent.prototype, "value", null);
__decorate([
    Input(),
    __metadata("design:type", String)
], ComboBoxComponent.prototype, "textField", void 0);
__decorate([
    Input(),
    __metadata("design:type", String)
], ComboBoxComponent.prototype, "valueField", void 0);
__decorate([
    Input(),
    __metadata("design:type", Boolean),
    __metadata("design:paramtypes", [Boolean])
], ComboBoxComponent.prototype, "valuePrimitive", null);
__decorate([
    Input(),
    __metadata("design:type", Function)
], ComboBoxComponent.prototype, "valueNormalizer", void 0);
__decorate([
    Input(),
    __metadata("design:type", String)
], ComboBoxComponent.prototype, "placeholder", void 0);
__decorate([
    Input(),
    __metadata("design:type", Object),
    __metadata("design:paramtypes", [Object])
], ComboBoxComponent.prototype, "popupSettings", null);
__decorate([
    Input(),
    __metadata("design:type", Number)
], ComboBoxComponent.prototype, "listHeight", void 0);
__decorate([
    Input(),
    __metadata("design:type", String)
], ComboBoxComponent.prototype, "iconClass", void 0);
__decorate([
    Input(),
    __metadata("design:type", Boolean)
], ComboBoxComponent.prototype, "loading", void 0);
__decorate([
    Input(),
    __metadata("design:type", Boolean)
], ComboBoxComponent.prototype, "suggest", void 0);
__decorate([
    Input(),
    __metadata("design:type", Boolean)
], ComboBoxComponent.prototype, "clearButton", void 0);
__decorate([
    Input(),
    __metadata("design:type", Boolean)
], ComboBoxComponent.prototype, "disabled", void 0);
__decorate([
    Input(),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [Function])
], ComboBoxComponent.prototype, "itemDisabled", null);
__decorate([
    Input(),
    __metadata("design:type", Boolean)
], ComboBoxComponent.prototype, "readonly", void 0);
__decorate([
    Input(),
    __metadata("design:type", Number)
], ComboBoxComponent.prototype, "tabindex", void 0);
__decorate([
    Input("tabIndex"),
    __metadata("design:type", Number),
    __metadata("design:paramtypes", [Number])
], ComboBoxComponent.prototype, "tabIndex", null);
__decorate([
    Input(),
    __metadata("design:type", Boolean)
], ComboBoxComponent.prototype, "filterable", void 0);
__decorate([
    Input(),
    __metadata("design:type", Object),
    __metadata("design:paramtypes", [Object])
], ComboBoxComponent.prototype, "virtual", null);
__decorate([
    Input(),
    __metadata("design:type", String),
    __metadata("design:paramtypes", [String])
], ComboBoxComponent.prototype, "size", null);
__decorate([
    Input(),
    __metadata("design:type", String),
    __metadata("design:paramtypes", [String])
], ComboBoxComponent.prototype, "rounded", null);
__decorate([
    Input(),
    __metadata("design:type", String),
    __metadata("design:paramtypes", [String])
], ComboBoxComponent.prototype, "fillMode", null);
__decorate([
    Output(),
    __metadata("design:type", EventEmitter)
], ComboBoxComponent.prototype, "valueChange", void 0);
__decorate([
    Output(),
    __metadata("design:type", EventEmitter)
], ComboBoxComponent.prototype, "selectionChange", void 0);
__decorate([
    Output(),
    __metadata("design:type", EventEmitter)
], ComboBoxComponent.prototype, "filterChange", void 0);
__decorate([
    Output(),
    __metadata("design:type", EventEmitter)
], ComboBoxComponent.prototype, "open", void 0);
__decorate([
    Output(),
    __metadata("design:type", EventEmitter)
], ComboBoxComponent.prototype, "opened", void 0);
__decorate([
    Output(),
    __metadata("design:type", EventEmitter)
], ComboBoxComponent.prototype, "close", void 0);
__decorate([
    Output(),
    __metadata("design:type", EventEmitter)
], ComboBoxComponent.prototype, "closed", void 0);
__decorate([
    Output('focus'),
    __metadata("design:type", EventEmitter)
], ComboBoxComponent.prototype, "onFocus", void 0);
__decorate([
    Output('blur'),
    __metadata("design:type", EventEmitter)
], ComboBoxComponent.prototype, "onBlur", void 0);
__decorate([
    ContentChild(ItemTemplateDirective, { static: false }),
    __metadata("design:type", ItemTemplateDirective)
], ComboBoxComponent.prototype, "template", void 0);
__decorate([
    ContentChild(HeaderTemplateDirective, { static: false }),
    __metadata("design:type", HeaderTemplateDirective)
], ComboBoxComponent.prototype, "headerTemplate", void 0);
__decorate([
    ContentChild(FooterTemplateDirective, { static: false }),
    __metadata("design:type", FooterTemplateDirective)
], ComboBoxComponent.prototype, "footerTemplate", void 0);
__decorate([
    ContentChild(NoDataTemplateDirective, { static: false }),
    __metadata("design:type", NoDataTemplateDirective)
], ComboBoxComponent.prototype, "noDataTemplate", void 0);
__decorate([
    ContentChild(GroupTemplateDirective, { static: false }),
    __metadata("design:type", GroupTemplateDirective)
], ComboBoxComponent.prototype, "groupTemplate", void 0);
__decorate([
    ContentChild(FixedGroupTemplateDirective, { static: false }),
    __metadata("design:type", FixedGroupTemplateDirective)
], ComboBoxComponent.prototype, "fixedGroupTemplate", void 0);
__decorate([
    ViewChild('container', { read: ViewContainerRef, static: true }),
    __metadata("design:type", ViewContainerRef)
], ComboBoxComponent.prototype, "container", void 0);
__decorate([
    ViewChild('popupTemplate', { static: true }),
    __metadata("design:type", TemplateRef)
], ComboBoxComponent.prototype, "popupTemplate", void 0);
__decorate([
    ViewChild(SearchBarComponent, { static: true }),
    __metadata("design:type", SearchBarComponent)
], ComboBoxComponent.prototype, "searchbar", void 0);
__decorate([
    ViewChild('optionsList', { static: false }),
    __metadata("design:type", ListComponent)
], ComboBoxComponent.prototype, "optionsList", void 0);
__decorate([
    ViewChild('select', { static: true }),
    __metadata("design:type", ElementRef)
], ComboBoxComponent.prototype, "select", void 0);
__decorate([
    HostBinding('class.k-combobox'),
    HostBinding('class.k-input'),
    __metadata("design:type", Boolean)
], ComboBoxComponent.prototype, "widgetClasses", void 0);
__decorate([
    HostBinding('class.k-disabled'),
    __metadata("design:type", Boolean),
    __metadata("design:paramtypes", [])
], ComboBoxComponent.prototype, "isDisabled", null);
__decorate([
    HostBinding('class.k-loading'),
    __metadata("design:type", Boolean),
    __metadata("design:paramtypes", [])
], ComboBoxComponent.prototype, "isLoading", null);
__decorate([
    HostBinding('attr.dir'),
    __metadata("design:type", Object),
    __metadata("design:paramtypes", [])
], ComboBoxComponent.prototype, "dir", null);
ComboBoxComponent = ComboBoxComponent_1 = __decorate([ __param(10, Optional()), __param(10, Inject(TOUCH_ENABLED)),
    __metadata("design:paramtypes", [ElementRef,
        LocalizationService,
        PopupService,
        SelectionService,
        NavigationService,
        DisabledItemsService,
        DataService,
        NgZone,
        ChangeDetectorRef,
        Renderer2, Boolean])
], ComboBoxComponent);

/**
 * Renders the selected value of the dropdown. To define the header template, nest an `<ng-template>` tag
 * with the `kendo<ComponentName>ValueTemplate` directive inside the component tag.
 *
 * The template context is set to the current component.
 * To get a reference to the current data item, use the `let-dataItem` directive.
 *
 * > The `ValueTemplate` directive can only be used with the DropDownList and DropDownTree components.
 *
 * - [Using `ValueTemplate` with the DropDownList]({% slug templates_ddl %}#toc-value-template)
 * - [Using `ValueTemplate` with the DropDownTree]({% slug templates_ddt %}#toc-value-template)
 *
 * @example
 * ```ts
 * _@Component({
 * selector: 'my-app',
 * template: `
 *  <kendo-dropdownlist [data]="listItems">
 *    <ng-template kendoDropDownListValueTemplate let-dataItem>
 *      <span>{{dataItem}} option</span>
 *    </ng-template>
 *  </kendo-dropdownlist>
 * `
 * })
 * class AppComponent {
 *   public listItems: Array<string> = ["Item 1", "Item 2", "Item 3", "Item 4"];
 * }
 * ```
 */
let ValueTemplateDirective = class ValueTemplateDirective {
    constructor(templateRef) {
        this.templateRef = templateRef;
    }
};
ValueTemplateDirective.ɵfac = function ValueTemplateDirective_Factory(t) { return new (t || ValueTemplateDirective)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.TemplateRef)); };
ValueTemplateDirective.ɵdir = /*@__PURE__*/ ɵngcc0.ɵɵdefineDirective({ type: ValueTemplateDirective, selectors: [["", "kendoDropDownListValueTemplate", ""], ["", "kendoDropDownTreeValueTemplate", ""]] });
ValueTemplateDirective = __decorate([ __metadata("design:paramtypes", [TemplateRef])
], ValueTemplateDirective);

/* tslint:disable:member-ordering */
var DropDownListComponent_1;
/**
 * @hidden
 */
const DROPDOWNLIST_VALUE_ACCESSOR = {
    multi: true,
    provide: NG_VALUE_ACCESSOR,
    useExisting: forwardRef(() => DropDownListComponent)
};
/**
 * Represents the [Kendo UI DropDownList component for Angular]({% slug overview_ddl %}).
 *
 * @example
 * ```ts
 * _@Component({
 * selector: 'my-app',
 * template: `
 *  <kendo-dropdownlist [data]="listItems">
 *  </kendo-dropdownlist>
 * `
 * })
 * class AppComponent {
 *   public listItems: Array<string> = ["Item 1", "Item 2", "Item 3", "Item 4"];
 * }
 * ```
 */
let DropDownListComponent = DropDownListComponent_1 = class DropDownListComponent {
    constructor(wrapper, localization, popupService, selectionService, navigationService, disabledItemsService, dataService, _zone, renderer, cdr, touchEnabled$$1) {
        this.wrapper = wrapper;
        this.localization = localization;
        this.popupService = popupService;
        this.selectionService = selectionService;
        this.navigationService = navigationService;
        this.disabledItemsService = disabledItemsService;
        this.dataService = dataService;
        this._zone = _zone;
        this.renderer = renderer;
        this.cdr = cdr;
        this.touchEnabled = touchEnabled$$1;
        /**
         * Sets the height of the options list. By default, `listHeight` is 200px.
         *
         * > The `listHeight` property affects only the list of options and not the whole popup container.
         * > To set the height of the popup container, use `popupSettings.height`.
         */
        this.listHeight = 200;
        /**
         * Sets the disabled state of the component.
         */
        this.disabled = false;
        /**
         * Sets the read-only state of the component.
         */
        this.readonly = false;
        /**
         * Enables the [filtering]({% slug filtering_ddl %}) functionality of the DropDownList.
         */
        this.filterable = false;
        /**
         * Enables a case-insensitive search. When filtration is disabled, use this option.
         */
        this.ignoreCase = true;
        /**
         * Sets the delay before an item search is performed. When filtration is disabled, use this option.
         */
        this.delay = 500;
        /**
         * Specifies the [`tabindex`](https://developer.mozilla.org/en-US/docs/Web/HTML/Global_attributes/tabindex) of the component.
         */
        this.tabindex = 0;
        /**
         * Fires each time the value is changed ([see example]({% slug overview_ddl %}#toc-events)).
         */
        this.valueChange = new EventEmitter();
        /**
         * Fires each time the user types in the input field
         * ([see example]({% slug overview_ddl %}#toc-events)).
         * You can filter the source based on the passed filtration value.
         * When the value of the component is programmatically changed to `ngModel` or `formControl`
         * through its API or form binding, the `valueChange` event is not triggered because it
         * might cause a mix-up with the built-in `valueChange` mechanisms of the `ngModel` or `formControl` bindings.
         */
        this.filterChange = new EventEmitter();
        /**
         * Fires each time the item selection is changed
         * ([see example]({% slug overview_ddl %}#toc-events)).
         */
        this.selectionChange = new EventEmitter();
        /**
         * Fires each time the popup is about to open
         * ([see example]({% slug openstate_ddl %}#toc-preventing-opening-and-closing)).
         * This event is preventable. If you cancel it, the popup will remain closed.
         */
        this.open = new EventEmitter();
        /**
         * Fires after the popup has been opened.
         */
        this.opened = new EventEmitter();
        /**
         * Fires each time the popup is about to close
         * ([see example]({% slug openstate_ddl %}#toc-preventing-opening-and-closing)).
         * This event is preventable. If you cancel it, the popup will remain open.
         */
        this.close = new EventEmitter();
        /**
         * Fires after the popup has been closed.
         */
        this.closed = new EventEmitter();
        /**
         * Fires each time the user focuses the DropDownList.
         */
        this.onFocus = new EventEmitter();
        /**
         * Fires each time the DropDownList gets blurred.
         */
        this.onBlur = new EventEmitter();
        this.hostClasses = true;
        /**
         * @hidden
         */
        this.focusableId = `k-${guid$1()}`;
        this.role = 'listbox';
        this.groupIndices = [];
        this.listBoxId = guid$1();
        this.optionPrefix = guid$1();
        this.filterText = "";
        this._isFocused = false;
        this.onTouchedCallback = (_) => { };
        this.onChangeCallback = (_) => { };
        this.word = "";
        this.last = "";
        this.filterFocused = new EventEmitter();
        this.filterBlurred = new EventEmitter();
        this.hostElementFocused = new EventEmitter();
        this.hostElementBlurred = new EventEmitter();
        this.selectionSubscription = new Subscription();
        this._open = false;
        this._popupSettings = { animate: true };
        this._size = 'medium';
        this._rounded = 'medium';
        this._fillMode = 'solid';
        validatePackage(packageMetadata);
        this.direction = localization.rtl ? 'rtl' : 'ltr';
        this.data = [];
        this.subscribeEvents();
        this.subscribeTouchEvents();
        this.subscribeFocusEvents();
        this.popupMouseDownHandler = this.onMouseDown.bind(this);
    }
    get width() {
        const wrapperWidth = isDocumentAvailable() ? this.wrapper.nativeElement.offsetWidth : 0;
        const width = this.popupSettings.width || wrapperWidth;
        const minWidth = isNaN(wrapperWidth) ? wrapperWidth : `${wrapperWidth}px`;
        const maxWidth = isNaN(width) ? width : `${width}px`;
        return { min: minWidth, max: maxWidth };
    }
    get height() {
        const popupHeight = this.popupSettings.height;
        return isPresent(popupHeight) ? `${popupHeight}px` : 'auto';
    }
    get widgetTabIndex() {
        if (this.disabled) {
            return undefined;
        }
        const providedTabIndex = Number(this.tabIndex);
        const defaultTabIndex = 0;
        return !isNaN(providedTabIndex) ? providedTabIndex : defaultTabIndex;
    }
    get ariaExpanded() {
        return this.isOpen;
    }
    get ariaOwns() {
        if (!this.isOpen) {
            return;
        }
        return this.listBoxId;
    }
    get ariaActivedescendant() {
        if (!isPresent(this.dataItem) || !this.isOpen) {
            return;
        }
        return this.optionPrefix + "-" + getter$1(this.dataItem, this.valueField);
    }
    get noDataLabel() {
        if (this.dataService.itemsCount === 0) {
            return this.messageFor('noDataText');
        }
    }
    get appendTo() {
        const { appendTo } = this.popupSettings;
        if (!appendTo || appendTo === 'root') {
            return undefined;
        }
        return appendTo === 'component' ? this.container : appendTo;
    }
    /**
     * Sets the data of the DropDownList.
     *
     * > The data has to be provided in an array-like list.
     */
    set data(data) {
        this.dataService.data = data || [];
        if (this.virtual) {
            this.virtual.skip = 0;
        }
        this.setState();
    }
    get data() {
        const virtual = this.virtual;
        if (virtual) {
            const start = virtual.skip || 0;
            const end = start + virtual.pageSize;
            // Use length instead of itemsCount because of the grouping.
            virtual.total = this.dataService.data.length;
            return this.dataService.data.slice(start, end);
        }
        return this.dataService.data;
    }
    /**
     * Sets the value of the DropDownList.
     * It can either be of the primitive (string, numbers) or of the complex (objects) type.
     * To define the type, use the `valuePrimitive` option.
     *
     * > All selected values which are not present in the source are ignored.
     */
    set value(newValue) {
        if (!isPresent(newValue)) {
            this._previousDataItem = undefined;
        }
        this._value = newValue;
        this.setState();
        this.cdr.markForCheck();
    }
    get value() {
        return this._value;
    }
    /**
     * Configures the popup of the DropDownList.
     *
     * The available options are:
     * - `animate: Boolean`&mdash;Controls the popup animation. By default, the open and close animations are enabled.
     * - `width: Number | String`&mdash;Sets the width of the popup container. By default, the width of the host element is used. If set to `auto`, the component automatically adjusts the width of the popup and no item labels are wrapped. The `auto` mode is not supported when virtual scrolling is enabled.
     * - `height: Number`&mdash;Sets the height of the popup container.
     * - `popupClass: String`&mdash;Specifies a list of CSS classes that are used to style the popup.
     * - `appendTo: "root" | "component" | ViewContainerRef`&mdash;Specifies the component to which the popup will be appended.
     */
    set popupSettings(settings) {
        this._popupSettings = Object.assign({ animate: true }, settings);
    }
    get popupSettings() {
        return this._popupSettings;
    }
    /**
     * Defines a Boolean function that is executed for each data item in the component
     * ([see examples]({% slug disableditems_ddl %})). Determines whether the item will be disabled.
     */
    set itemDisabled(fn) {
        if (typeof fn !== 'function') {
            throw new Error(`itemDisabled must be a function, but received ${JSON.stringify(fn)}.`);
        }
        this.disabledItemsService.itemDisabled = fn;
    }
    /**
     * Enables the [virtualization]({% slug virtualization_ddl %}) functionality.
     */
    set virtual(settings) {
        this._virtualSettings = normalizeVirtualizationSettings(settings);
    }
    get virtual() {
        return this._virtualSettings;
    }
    /**
     * Specifies the type of the selected value
     * ([more information and example]({% slug valuebinding_ddl %}#toc-primitive-values-from-object-fields)).
     * If set to `true`, the selected value has to be of a primitive value.
     */
    set valuePrimitive(isPrimitive) {
        this._valuePrimitive = isPrimitive;
    }
    get valuePrimitive() {
        if (!isPresent(this._valuePrimitive)) {
            return !isPresent(this.valueField);
        }
        return this._valuePrimitive;
    }
    /**
     * @hidden
     */
    set tabIndex(tabIndex) {
        this.tabindex = tabIndex;
    }
    get tabIndex() {
        return this.tabindex;
    }
    /**
     * Sets the size of the component.
     *
     * The possible values are:
     * * `'small'`
     * * `'medium'` (default)
     * * `'large'`
     * * `null`
     *
     */
    set size(size) {
        this.renderer.removeClass(this.wrapper.nativeElement, getSizeClass('picker', this.size));
        if (size) {
            this.renderer.addClass(this.wrapper.nativeElement, getSizeClass('picker', size));
        }
        this._size = size;
    }
    get size() {
        return this._size;
    }
    /**
     * Sets the border radius of the component.
     *
     * The possible values are:
     * * `'small'`
     * * `'medium'` (default)
     * * `'large'`
     * * `'full'`
     * * `null`
     *
     */
    set rounded(rounded) {
        this.renderer.removeClass(this.wrapper.nativeElement, getRoundedClass(this.rounded));
        if (rounded) {
            this.renderer.addClass(this.wrapper.nativeElement, getRoundedClass(rounded));
        }
        this._rounded = rounded;
    }
    get rounded() {
        return this._rounded;
    }
    /**
     * Sets the fillMode of the component.
     *
     * The possible values are:
     * * `'flat'`
     * * `'solid'` (default)
     * * `'outline'`
     * * `null`
     *
     */
    set fillMode(fillMode) {
        this.renderer.removeClass(this.wrapper.nativeElement, getFillModeClass('picker', this.fillMode));
        if (fillMode) {
            this.renderer.addClass(this.wrapper.nativeElement, getFillModeClass('picker', fillMode));
        }
        this._fillMode = fillMode;
    }
    get fillMode() {
        return this._fillMode;
    }
    /**
     * @hidden
     */
    blurComponent(event) {
        if (event.target !== this.wrapper.nativeElement) {
            return;
        }
        event.stopImmediatePropagation();
        this.hostElementBlurred.emit();
    }
    /**
     * @hidden
     */
    blurFilterInput() {
        this.filterBlurred.emit();
    }
    /**
     * @hidden
     */
    focusComponent(event) {
        if (event.target !== this.wrapper.nativeElement) {
            return;
        }
        event.stopImmediatePropagation();
        this.hostElementFocused.emit();
        if (!this.isFocused) {
            this.isFocused = true;
            if (hasObservers(this.onFocus)) {
                this._zone.run(() => {
                    this.onFocus.emit();
                });
            }
        }
    }
    /**
     * @hidden
     */
    onResize() {
        if (this._open) {
            const popupWrapper = this.popupRef.popupElement;
            const { min, max } = this.width;
            popupWrapper.style.minWidth = min;
            popupWrapper.style.width = max;
        }
    }
    get isDisabled() {
        return this.disabled;
    }
    get isLoading() {
        return this.loading;
    }
    get dir() {
        return this.direction;
    }
    get hostTabIndex() {
        return this.widgetTabIndex;
    }
    get isReadonly() {
        return this.readonly;
    }
    get isAriaExpanded() {
        return this.ariaExpanded;
    }
    get hostAriaOwns() {
        return this.ariaOwns;
    }
    get hostAriaActivedescendant() {
        return this.ariaActivedescendant;
    }
    get hostNoDataLabel() {
        return this.noDataLabel;
    }
    /**
     * @hidden
     */
    keydown(event) {
        const firstIndex = isPresent(this.defaultItem) ? -1 : 0;
        let focused = isNaN(this.selectionService.focused) ? this.firstFocusableIndex(firstIndex) : this.selectionService.focused;
        let offset = 0;
        if (this.disabled || this.readonly) {
            return;
        }
        const isHomeEnd = event.keyCode === Keys.Home || event.keyCode === Keys.End;
        const isFilterFocused = this.filterable && this.isFocused && this.isOpen;
        if (isFilterFocused && isHomeEnd) {
            return;
        }
        const hasSelected = isPresent(this.selectionService.selected[0]);
        const focusedItemNotSelected = isPresent(this.selectionService.focused) && !this.selectionService.isSelected(this.selectionService.focused);
        if (!hasSelected || focusedItemNotSelected) {
            if (event.keyCode === Keys.ArrowDown || event.keyCode === Keys.ArrowRight) {
                offset = -1;
            }
            else if (event.keyCode === Keys.ArrowUp || event.keyCode === Keys.ArrowLeft) {
                offset = 1;
            }
        }
        const eventData = event;
        const action = this.navigationService.process({
            current: focused + offset,
            max: this.dataService.itemsCount - 1,
            min: this.defaultItem ? -1 : 0,
            originalEvent: eventData
        });
        const leftRightKeys = (action === NavigationAction.Left) || (action === NavigationAction.Right);
        if (action !== NavigationAction.Undefined &&
            action !== NavigationAction.Tab &&
            action !== NavigationAction.Backspace &&
            action !== NavigationAction.Delete &&
            !(leftRightKeys && this.filterable) &&
            action !== NavigationAction.Enter //enter when popup is opened is handled before `handleEnter`
        ) {
            eventData.preventDefault();
        }
    }
    /**
     * @hidden
     */
    keypress(event) {
        if (this.disabled || this.readonly || this.filterable) {
            return;
        }
        this.onKeyPress(event);
    }
    /**
     * @hidden
     */
    click(event) {
        event.preventDefault();
        this.focus();
        this.togglePopup(!this.isOpen);
    }
    set isFocused(isFocused) {
        this.renderer[isFocused ? 'addClass' : 'removeClass'](this.wrapper.nativeElement, 'k-focus');
        this._isFocused = isFocused;
    }
    get isFocused() {
        return this._isFocused;
    }
    ngOnInit() {
        this.renderer.removeAttribute(this.wrapper.nativeElement, "tabindex");
        this.localizationChangesSubscription = this.localization
            .changes.subscribe(({ rtl }) => {
            this.direction = rtl ? 'rtl' : 'ltr';
            this.cdr.detectChanges();
        });
        this.assignAriaDescribedBy();
        this.setComponentClasses();
    }
    /**
     * @hidden
     * Used by the TextBoxContainer to determine if the component is empty.
     */
    isEmpty() {
        const value = this.value;
        return !(value === 0 || value === false || value || this.defaultItem);
    }
    /**
     * @hidden
     */
    onFilterFocus() {
        this.filterFocused.emit();
    }
    /**
     * @hidden
     */
    ngOnDestroy() {
        this.destroyPopup();
        this.unsubscribeEvents();
        if (this.localizationChangesSubscription) {
            this.localizationChangesSubscription.unsubscribe();
        }
    }
    /**
     * @hidden
     */
    ngOnChanges(changes) {
        const virtual = this.virtual;
        const requestInitialData = virtual && changes.data && changes.data.isFirstChange();
        if (requestInitialData) {
            this.pageChange({ skip: 0, take: virtual.pageSize });
        }
        if (isChanged('defaultItem', changes, false)) {
            this.disabledItemsService.defaultItem = this.defaultItem;
        }
        if (anyChanged(['textField', 'valueField', 'valuePrimitive', 'defaultItem', 'itemDisabled'], changes, false)) {
            this.setState();
        }
    }
    /**
     * @hidden
     */
    ngAfterContentChecked() {
        this.verifySettings();
    }
    /**
     * Focuses a specific item of the DropDownList based on a provided index.
     * If there is a default item it is positioned at index -1.
     * If null or invalid index is provided the focus will be removed.
     */
    focusItemAt(index) {
        const minIndex = isPresent(this.defaultItem) ? -1 : 0;
        const isInRange = minIndex <= index && index < this.data.length;
        if (isPresent(index) && isInRange && !this.disabledItemsService.isIndexDisabled(index)) {
            this.selectionService.focus(index);
        }
        else {
            this.selectionService.focus(null);
        }
    }
    /**
     * Focuses the DropDownList.
     */
    focus() {
        if (!this.disabled) {
            this.wrapper.nativeElement.focus();
        }
    }
    /**
     * Blurs the DropDownList.
     */
    blur() {
        if (!this.disabled) {
            this.wrapper.nativeElement.blur();
        }
    }
    /**
     * Toggles the visibility of the popup
     * ([see example]({% slug openstate_ddl %}#toc-setting-the-initially-opened-component)).
     * If you use the `toggle` method to open or close the popup, the `open` and `close` events will not be fired.
     *
     * @param open - The state of the popup.
     */
    toggle(open) {
        // The Promise is required to open the popup on load.
        // Otherwise, the "Expression has changed..." type error will be thrown.
        Promise.resolve(null).then(() => {
            const shouldOpen = isPresent(open) ? open : !this._open;
            this._toggle(shouldOpen);
        });
    }
    _toggle(open) {
        this._open = open;
        this.destroyPopup();
        if (this._open) {
            this.createPopup();
        }
    }
    triggerPopupEvents(open) {
        const eventArgs = new PreventableEvent();
        if (open) {
            this.open.emit(eventArgs);
        }
        else {
            this.close.emit(eventArgs);
        }
        return eventArgs.isDefaultPrevented();
    }
    /**
     * @hidden
     */
    togglePopup(open) {
        const isDisabled = this.disabled || this.readonly;
        const sameState = this.isOpen === open;
        if (isDisabled || sameState) {
            return;
        }
        const isDefaultPrevented = this.triggerPopupEvents(open);
        if (!isDefaultPrevented) {
            if (!open && this.filterable && this.isFocused) {
                this.focus();
            }
            this._toggle(open);
        }
    }
    /**
     * Returns the current open state of the popup.
     */
    get isOpen() {
        return this._open;
    }
    /**
     * Resets the value of the DropDownList.
     * If you use the `reset` method to clear the value of the component,
     * the model will not update automatically and the `selectionChange` and `valueChange` events will not be fired.
     */
    reset() {
        this.value = undefined;
    }
    /**
     * @hidden
     */
    messageFor(key) {
        return this.localization.get(key);
    }
    /**
     * @hidden
     */
    writeValue(value) {
        this.value = value === null ? undefined : value;
    }
    /**
     * @hidden
     */
    registerOnChange(fn) {
        this.onChangeCallback = fn;
    }
    /**
     * @hidden
     */
    registerOnTouched(fn) {
        this.onTouchedCallback = fn;
    }
    /**
     * @hidden
     */
    setDisabledState(isDisabled) {
        this.disabled = isDisabled;
    }
    /**
     * @hidden
     */
    get buttonClasses() {
        return this.loading ? 'k-i-loading' : this.iconClass || 'k-i-arrow-s';
    }
    /**
     * @hidden
     */
    get selectButtonClasses() {
        return `${this.size ? getSizeClass('button', this.size) : ''} ${this.fillMode ? 'k-button-' + this.fillMode : ''} ${this.fillMode ? 'k-button-' + this.fillMode + '-base' : ''}`;
    }
    /**
     * @hidden
     */
    get filterInputClasses() {
        return `${this.size ? getSizeClass('input', this.size) : ''} ${this.fillMode ? 'k-input-' + this.fillMode : ''} ${this.rounded ? getRoundedClass(this.rounded) : ''}`;
    }
    /**
     * @hidden
     */
    get optionLabelSizeClass() {
        return `${this.size ? getSizeClass('list', this.size) : ''}`;
    }
    /**
     * @hidden
     */
    get listContainerClasses() {
        const containerClasses = ['k-list-container', 'k-reset'];
        if (this.popupSettings.popupClass) {
            containerClasses.push(this.popupSettings.popupClass);
        }
        return containerClasses;
    }
    /**
     * @hidden
     */
    get isDisabledDefaultItem() {
        return this.disabledItemsService.isItemDisabled(this.defaultItem);
    }
    /**
     * @hidden
     */
    getText() {
        return this.text;
    }
    /**
     * @hidden
     */
    getDefaultItemText() {
        return getter$1(this.defaultItem, this.textField);
    }
    createPopup() {
        if (this.virtual) {
            this.virtual.skip = 0;
        }
        const horizontalAlign = this.direction === "rtl" ? "right" : "left";
        const anchorPosition = { horizontal: horizontalAlign, vertical: "bottom" };
        const popupPosition = { horizontal: horizontalAlign, vertical: "top" };
        this.popupRef = this.popupService.open({
            anchor: this.wrapper,
            anchorAlign: anchorPosition,
            animate: this.popupSettings.animate,
            appendTo: this.appendTo,
            content: this.popupTemplate,
            popupAlign: popupPosition,
            popupClass: this.listContainerClasses,
            positionMode: 'absolute'
        });
        const popupWrapper = this.popupRef.popupElement;
        const { min, max } = this.width;
        popupWrapper.addEventListener('mousedown', this.popupMouseDownHandler);
        popupWrapper.style.minWidth = min;
        popupWrapper.style.width = max;
        popupWrapper.style.height = this.height;
        popupWrapper.setAttribute("dir", this.direction);
        this.popupRef.popupOpen.subscribe(() => {
            this.cdr.detectChanges();
            this.optionsList.scrollToItem(this.selectionService.focused);
            this.opened.emit();
        });
        this.popupRef.popupClose.subscribe(() => {
            this.closed.emit();
        });
        if (!this.filterable) {
            this.popupRef.popupAnchorViewportLeave.subscribe(() => this.togglePopup(false));
        }
    }
    destroyPopup() {
        if (this.popupRef) {
            this.popupRef.popupElement
                .removeEventListener('mousedown', this.popupMouseDownHandler);
            this.popupRef.close();
            this.popupRef = null;
        }
    }
    updateState({ dataItem, confirm = false }) {
        this.dataItem = dataItem;
        this.text = getter$1(dataItem, this.textField);
        if (confirm) {
            this._previousDataItem = dataItem;
        }
    }
    clearState() {
        this.text = undefined;
        this.dataItem = undefined;
    }
    resetSelection(index) {
        const clear = !isPresent(index);
        this.selectionService.resetSelection(clear ? [] : [index]);
        this.selectionService.focused = clear ? this.firstFocusableIndex(0) : index;
    }
    onSelectionChange({ dataItem }) {
        this.updateState({ dataItem });
        this.selectionChange.emit(dataItem);
        // reassigning the value label ID as aria-deascibedby forces firefox/nvda, forefox/jaws to read
        // the new value when the popup is closed and the value is changed with the arrow keys (up/down)
        this.assignAriaDescribedBy();
    }
    subscribeEvents() {
        if (!isDocumentAvailable()) {
            return;
        }
        // Item selection when the popup is open.
        this.selectionSubscription.add(this.selectionService.onSelect.pipe(filter(_ => this.isOpen), map(this.itemFromEvent.bind(this)))
            .subscribe(this.onSelectionChange.bind(this)));
        // Item selection when the popup is closed | clicked | enter, and so on.
        this.selectionSubscription.add(merge(this.selectionService.onSelect.pipe(filter(_ => !this.isOpen)), this.selectionService.onChange).pipe(map(this.itemFromEvent.bind(this)), tap(_ => this.togglePopup(false)))
            .subscribe(({ dataItem, value: newValue, newSelection }) => {
            if (newSelection) {
                this.onSelectionChange({ dataItem });
            }
            const shouldUsePrevious = !isPresent(dataItem) && this._previousDataItem;
            const shouldUseNewValue = newValue !== getter$1(this.value, this.valueField);
            if (shouldUsePrevious) {
                this.updateState({ dataItem: this._previousDataItem });
                this.resetSelection();
            }
            else if (shouldUseNewValue) {
                this.value = this.valuePrimitive ? newValue : dataItem;
                this._previousDataItem = dataItem;
                this.emitChange(this.value);
            }
            this.clearFilter();
        }));
        this.navigationSubscription = merge(this.navigationService.up, this.navigationService.down, this.navigationService.left.pipe(skipWhile(() => this.filterable)), this.navigationService.right.pipe(skipWhile(() => this.filterable)), this.navigationService.home, this.navigationService.end)
            .pipe(filter((event) => !isNaN(event.index)))
            .subscribe((event) => this.selectionService.select(event.index));
        this.openSubscription = this.navigationService.open.subscribe(() => this.togglePopup(true));
        this.closeSubscription = this.navigationService.close.subscribe(() => {
            this.togglePopup(false);
            this.focus();
        });
        this.enterSubscription = this.navigationService.enter
            .pipe(tap((event) => event.originalEvent.preventDefault()))
            .subscribe(this.handleEnter.bind(this));
        this.escSubscription = this.navigationService.esc
            .subscribe(this.handleEscape.bind(this));
        this.filterBlurredSubscription = this.filterBlurred.pipe(concatMap(() => interval(10).pipe(take(1), takeUntil(this.hostElementFocused))))
            .subscribe(() => {
            this.hostElementBlurred.emit();
        });
        this._zone.runOutsideAngular(() => {
            this.componentBlurredSubscription =
                merge(this.hostElementBlurred.pipe(concatMap(() => interval(10).pipe(take(1), takeUntil(this.filterFocused)))), this.navigationService.tab).pipe(tap(event => event instanceof NavigationEvent && this.focus()), filter(() => this.isFocused))
                    .subscribe(() => this.componentBlur());
        });
    }
    subscribeTouchEvents() {
        if (!isDocumentAvailable() || !this.touchEnabled) {
            return;
        }
        this._zone.runOutsideAngular(() => 
        // Roll up DropDownList on iOS when tapped outside
        this.touchstartDisposeHandler = this.renderer.listen(document, 'touchstart', (e) => {
            const target = e.target;
            if (this.isFocused && !inDropDown(this.wrapper, target, this.popupRef)) {
                this._zone.run(() => {
                    if (this.filterFocused) {
                        // Close popup if filter is focused
                        this.togglePopup(false);
                    }
                    this.blur();
                });
            }
        }));
    }
    subscribeFocusEvents() {
        if (isDocumentAvailable()) {
            this.focusComponent = this.focusComponent.bind(this);
            this.blurComponent = this.blurComponent.bind(this);
            this._zone.runOutsideAngular(() => {
                const useCapture = true;
                document.addEventListener('focus', this.focusComponent, useCapture);
                document.addEventListener('blur', this.blurComponent, useCapture);
            });
        }
    }
    unSubscribeFocusEvents() {
        if (isDocumentAvailable()) {
            const useCapture = true;
            document.removeEventListener('focus', this.focusComponent, useCapture);
            document.removeEventListener('blur', this.blurComponent, useCapture);
        }
    }
    unsubscribeEvents() {
        if (!isDocumentAvailable()) {
            return;
        }
        this.navigationSubscription.unsubscribe();
        this.openSubscription.unsubscribe();
        this.closeSubscription.unsubscribe();
        this.enterSubscription.unsubscribe();
        this.escSubscription.unsubscribe();
        this.componentBlurredSubscription.unsubscribe();
        this.filterBlurredSubscription.unsubscribe();
        this.unSubscribeFocusEvents();
        if (this.touchstartDisposeHandler) {
            this.touchstartDisposeHandler();
        }
        if (this.selectionSubscription) {
            this.selectionSubscription.unsubscribe();
        }
    }
    itemFromEvent(event) {
        const index = event.indices[0];
        let dataItem = this.dataService.itemAt(index);
        dataItem = isPresent(dataItem) ? dataItem : this.currentOrDefault(index);
        const value = getter$1(dataItem, this.valueField);
        const newSelection = event.newSelection;
        return {
            dataItem,
            index,
            newSelection,
            value
        };
    }
    currentOrDefault(selectedIndex) {
        const defaultItemIndex = -1;
        if (isPresent(this.dataItem) && selectedIndex !== defaultItemIndex) {
            return this.dataItem;
        }
        else {
            return this.defaultItem;
        }
    }
    firstFocusableIndex(index) {
        const maxIndex = this.dataService.itemsCount - 1;
        if (this.disabledItemsService.isIndexDisabled(index)) {
            return (index < maxIndex) ? this.firstFocusableIndex(index + 1) : undefined;
        }
        else {
            return index;
        }
    }
    handleEnter() {
        if (this.isOpen) {
            this.selectionService.change(this.selectionService.focused);
            this.focus();
        }
        else {
            this.togglePopup(true);
        }
    }
    handleEscape() {
        if (isPresent(this.selectionService.selected[0])) {
            this.selectionService.change(this.selectionService.selected[0]);
        }
        else {
            this.togglePopup(false);
            this.clearFilter();
        }
        this.focus();
    }
    clearFilter() {
        if (!(this.filterable && this.filterText)) {
            return;
        }
        this.filterText = "";
        this.cdr.markForCheck();
        this.filterChange.emit(this.filterText);
    }
    verifySettings() {
        if (!isDevMode()) {
            return;
        }
        if (this.defaultItem && this.valueField && typeof this.defaultItem !== "object") {
            throw new Error(DropDownListMessages.defaultItem);
        }
        if (this.valuePrimitive === true && isPresent(this.value) && typeof this.value === "object") {
            throw new Error(DropDownListMessages.primitive);
        }
        if (this.valuePrimitive === false && isPresent(this.value) && typeof this.value !== "object") {
            throw new Error(DropDownListMessages.object);
        }
        const valueOrText = !isPresent(this.valueField) !== !isPresent(this.textField);
        if (valueOrText) {
            throw new Error(DropDownListMessages.textAndValue);
        }
    }
    componentBlur() {
        this.isFocused = false;
        const selectionPresent = isPresent(this.selectionService.selected[0]);
        const valueHasChanged = selectionPresent && getter$1(this.value, this.valueField) !== getter$1(this.dataService.itemAt(this.selectionService.selected[0]), this.valueField);
        if (valueHasChanged ||
            hasObservers(this.close) ||
            hasObservers(this.onBlur) ||
            hasObservers(this.filterChange) ||
            isUntouched(this.wrapper.nativeElement)) {
            this._zone.run(() => {
                if (valueHasChanged) {
                    this.selectionService.change(this.selectionService.selected[0]);
                }
                this.togglePopup(false);
                this.clearFilter();
                this.onBlur.emit();
                this.onTouchedCallback();
            });
        }
        else {
            this.togglePopup(false);
        }
    }
    /**
     * @hidden
     */
    onMouseDown(event) {
        const tagName = event.target.tagName.toLowerCase();
        if (tagName !== "input") {
            event.preventDefault();
        }
    }
    onKeyPress(event) {
        if (event.which === 0 || event.keyCode === Keys.Enter) {
            return;
        }
        let character = String.fromCharCode(event.charCode || event.keyCode);
        if (this.ignoreCase) {
            character = character.toLowerCase();
        }
        if (character === " ") {
            event.preventDefault();
        }
        this.word += character;
        this.last = character;
        this.search();
    }
    search() {
        clearTimeout(this.typingTimeout);
        if (!this.filterable) {
            this.typingTimeout = setTimeout(() => { this.word = ""; }, this.delay);
            this.selectNext();
        }
    }
    selectNext() {
        let data = this.dataService
            .filter((item) => isPresent(item) && !item.header && !this.disabledItemsService.isItemDisabled(item))
            .map((item) => {
            if (this.dataService.grouped) {
                return { item: item.value, itemIndex: item.offsetIndex };
            }
            return { item: item, itemIndex: this.dataService.indexOf(item) };
        });
        const isInLoop = sameCharsOnly(this.word, this.last);
        let dataLength = data.length;
        let hasSelected = !isNaN(this.selectionService.selected[0]);
        let startIndex = !hasSelected ? 0 : this.selectionService.selected[0];
        let text, index, defaultItem;
        if (this.defaultItem && !this.disabledItemsService.isItemDisabled(this.defaultItem)) {
            defaultItem = { item: this.defaultItem, itemIndex: -1 };
            dataLength += 1;
            startIndex += 1;
        }
        startIndex += isInLoop && hasSelected ? 1 : 0;
        data = shuffleData(data, startIndex, defaultItem);
        index = 0;
        for (; index < dataLength; index++) {
            text = getter$1(data[index].item, this.textField);
            const loopMatch = Boolean(isInLoop && matchText(text, this.last, this.ignoreCase));
            const nextMatch = Boolean(matchText(text, this.word, this.ignoreCase));
            if (loopMatch || nextMatch) {
                index = data[index].itemIndex;
                break;
            }
        }
        if (index !== dataLength) {
            this.navigate(index);
        }
    }
    emitChange(value) {
        this.onChangeCallback(value);
        this.valueChange.emit(value);
    }
    navigate(index) {
        this.selectionService.select(index);
    }
    findDataItem({ valueField, value }) {
        const result = {
            dataItem: null,
            index: -1
        };
        const prop = dataItem => getter$1(dataItem, valueField);
        let comparer;
        if (this.dataService.grouped) {
            comparer = (element) => {
                return prop(element.value) === prop(value);
            };
        }
        else {
            comparer = (element) => {
                return prop(element) === prop(value);
            };
        }
        const index = this.dataService.findIndex(comparer);
        result.dataItem = this.dataService.itemAt(index);
        result.index = index;
        return result;
    }
    setState() {
        const value = this.value;
        const valueField = this.valueField;
        const textField = this.textField;
        const primitive = this.valuePrimitive;
        if (this.defaultItem) {
            const defaultValue = getter$1(this.defaultItem, valueField);
            const currentValue = getter$1(value, valueField);
            if (!isPresent(value) || (currentValue === defaultValue)) {
                this.updateState({ dataItem: this.defaultItem, confirm: true });
                this.resetSelection(-1);
                if (this.filterable && this.filterText && this.dataService.itemsCount) {
                    this.selectionService.focused = this.firstFocusableIndex(0);
                }
                return;
            }
        }
        const resolved = this.findDataItem({ valueField, value });
        // The data and value are of same shape,
        // for example, value: 'foo', data: ['foo', 'bar']
        // or value: { value: 1, text: 'foo' }, data: [{ value: 1, text: 'foo' }].
        const ofSameType = !(primitive && textField);
        if (resolved.dataItem) {
            this.updateState({ dataItem: resolved.dataItem, confirm: true });
            this.resetSelection(resolved.index);
        }
        else if (isPresent(value) && ofSameType) {
            this.updateState({ dataItem: value });
            this.resetSelection();
        }
        else if (this._previousDataItem) {
            this.updateState({ dataItem: this._previousDataItem });
            this.resetSelection();
        }
        else {
            this.clearState();
            this.resetSelection();
        }
    }
    /**
     * @hidden
     */
    handleFilter(event) {
        this.filterChange.emit(event.target.value);
    }
    /**
     * @hidden
     */
    pageChange(event) {
        const virtual = this.virtual;
        virtual.skip = event.skip;
    }
    assignAriaDescribedBy() {
        const currentValue = this.wrapper.nativeElement.getAttribute('aria-describedby') || '';
        const trimmed = currentValue.replace(this.valueLabelId, '').trim();
        // reset the value label ID to force readers to read the new value
        this.valueLabelId = guid$1();
        // add to the current value - don't replace it
        const newValue = `${this.valueLabelId} ${trimmed}`.trim();
        this.renderer.setAttribute(this.wrapper.nativeElement, 'aria-describedby', newValue);
    }
    setComponentClasses() {
        if (this.size) {
            this.renderer.addClass(this.wrapper.nativeElement, getSizeClass('picker', this.size));
        }
        if (this.rounded) {
            this.renderer.addClass(this.wrapper.nativeElement, getRoundedClass(this.rounded));
        }
        if (this.fillMode) {
            this.renderer.addClass(this.wrapper.nativeElement, getFillModeClass('picker', this.fillMode));
        }
    }
};
DropDownListComponent.ɵfac = function DropDownListComponent_Factory(t) { return new (t || DropDownListComponent)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ElementRef), ɵngcc0.ɵɵdirectiveInject(ɵngcc1.LocalizationService), ɵngcc0.ɵɵdirectiveInject(ɵngcc4.PopupService), ɵngcc0.ɵɵdirectiveInject(SelectionService), ɵngcc0.ɵɵdirectiveInject(NavigationService), ɵngcc0.ɵɵdirectiveInject(DisabledItemsService), ɵngcc0.ɵɵdirectiveInject(DataService), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.NgZone), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.Renderer2), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ChangeDetectorRef), ɵngcc0.ɵɵdirectiveInject(TOUCH_ENABLED, 8)); };
DropDownListComponent.ɵcmp = /*@__PURE__*/ ɵngcc0.ɵɵdefineComponent({ type: DropDownListComponent, selectors: [["kendo-dropdownlist"]], contentQueries: function DropDownListComponent_ContentQueries(rf, ctx, dirIndex) { if (rf & 1) {
        ɵngcc0.ɵɵcontentQuery(dirIndex, ItemTemplateDirective, 5);
        ɵngcc0.ɵɵcontentQuery(dirIndex, GroupTemplateDirective, 5);
        ɵngcc0.ɵɵcontentQuery(dirIndex, FixedGroupTemplateDirective, 5);
        ɵngcc0.ɵɵcontentQuery(dirIndex, ValueTemplateDirective, 5);
        ɵngcc0.ɵɵcontentQuery(dirIndex, HeaderTemplateDirective, 5);
        ɵngcc0.ɵɵcontentQuery(dirIndex, FooterTemplateDirective, 5);
        ɵngcc0.ɵɵcontentQuery(dirIndex, NoDataTemplateDirective, 5);
    } if (rf & 2) {
        let _t;
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.itemTemplate = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.groupTemplate = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.fixedGroupTemplate = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.valueTemplate = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.headerTemplate = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.footerTemplate = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.noDataTemplate = _t.first);
    } }, viewQuery: function DropDownListComponent_Query(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵviewQuery(_c8, 7, ViewContainerRef);
        ɵngcc0.ɵɵviewQuery(_c9, 7);
        ɵngcc0.ɵɵviewQuery(_c10, 5);
    } if (rf & 2) {
        let _t;
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.container = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.popupTemplate = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.optionsList = _t.first);
    } }, hostVars: 20, hostBindings: function DropDownListComponent_HostBindings(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵlistener("keydown", function DropDownListComponent_keydown_HostBindingHandler($event) { return ctx.keydown($event); })("keypress", function DropDownListComponent_keypress_HostBindingHandler($event) { return ctx.keypress($event); })("click", function DropDownListComponent_click_HostBindingHandler($event) { return ctx.click($event); });
    } if (rf & 2) {
        ɵngcc0.ɵɵattribute("id", ctx.focusableId)("role", ctx.role)("aria-haspopup", ctx.role)("aria-disabled", ctx.isDisabled)("dir", ctx.dir)("tabindex", ctx.hostTabIndex)("readonly", ctx.isReadonly)("aria-readonly", ctx.isReadonly)("aria-expanded", ctx.isAriaExpanded)("aria-owns", ctx.hostAriaOwns)("aria-activedescendant", ctx.hostAriaActivedescendant)("aria-label", ctx.hostNoDataLabel);
        ɵngcc0.ɵɵclassProp("k-dropdownlist", ctx.hostClasses)("k-picker", ctx.hostClasses)("k-disabled", ctx.isDisabled)("k-loading", ctx.isLoading);
    } }, inputs: { listHeight: "listHeight", disabled: "disabled", readonly: "readonly", filterable: "filterable", ignoreCase: "ignoreCase", delay: "delay", tabindex: "tabindex", focusableId: ["id", "focusableId"], data: "data", value: "value", popupSettings: "popupSettings", itemDisabled: "itemDisabled", virtual: "virtual", valuePrimitive: "valuePrimitive", tabIndex: "tabIndex", size: "size", rounded: "rounded", fillMode: "fillMode", iconClass: "iconClass", loading: "loading", textField: "textField", valueField: "valueField", defaultItem: "defaultItem" }, outputs: { valueChange: "valueChange", filterChange: "filterChange", selectionChange: "selectionChange", open: "open", opened: "opened", close: "close", closed: "closed", onFocus: "focus", onBlur: "blur" }, exportAs: ["kendoDropDownList"], features: [ɵngcc0.ɵɵProvidersFeature([
            DROPDOWNLIST_VALUE_ACCESSOR,
            DataService,
            SelectionService,
            NavigationService,
            DisabledItemsService,
            LocalizationService,
            {
                provide: L10N_PREFIX,
                useValue: 'kendo.dropdownlist'
            },
            {
                provide: FilterableComponent, useExisting: forwardRef(() => DropDownListComponent_1)
            },
            {
                provide: KendoInput, useExisting: forwardRef(() => DropDownListComponent_1)
            }
        ]), ɵngcc0.ɵɵNgOnChangesFeature], decls: 12, vars: 10, consts: function () { let i18n_24; if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
        /**
         * @desc The text displayed in the popup when there are no items
         * @meaning kendo.dropdownlist.noDataText
         */
        const MSG_EXTERNAL_8289552890585138350$$DIST_FESM2015_INDEX_JS_25 = goog.getMsg("NO DATA FOUND");
        i18n_24 = MSG_EXTERNAL_8289552890585138350$$DIST_FESM2015_INDEX_JS_25;
    }
    else {
        i18n_24 = $localize `:kendo.dropdownlist.noDataText|The text displayed in the popup when there are no items␟4fc2f70c9c8cf7b18affd6b938105996d6ac3306␟8289552890585138350:NO DATA FOUND`;
    } let i18n_26; if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
        /**
         * @desc The text set as aria-label on the select button
         * @meaning kendo.dropdownlist.selectButtonText
         */
        const MSG_EXTERNAL_502653685822533375$$DIST_FESM2015_INDEX_JS_27 = goog.getMsg("Select");
        i18n_26 = MSG_EXTERNAL_502653685822533375$$DIST_FESM2015_INDEX_JS_27;
    }
    else {
        i18n_26 = $localize `:kendo.dropdownlist.selectButtonText|The text set as aria-label on the select button␟0c789b01a1fd1ca8a38d0ff85f8fb7df1a906306␟502653685822533375:Select`;
    } return [["kendoDropDownListLocalizedMessages", "", "noDataText", i18n_24, "selectButtonText", i18n_26], ["unselectable", "on", "role", "option", 1, "k-input-inner", 3, "id"], [1, "k-input-value-text"], [4, "ngIf"], [3, "ngIf"], ["tabindex", "-1", "unselectable", "on", "type", "button", 1, "k-input-button", "k-button", "k-icon-button", 3, "ngClass", "kendoEventsOutsideAngular"], ["unselectable", "on", 1, "k-button-icon", "k-icon", 3, "ngClass"], ["popupTemplate", ""], ["container", ""], [3, "templateContext"], [3, "size", "rounded", "id", "optionPrefix", "data", "textField", "valueField", "template", "groupTemplate", "fixedGroupTemplate", "height", "show", "virtual", "pageChange"], ["optionsList", ""], ["class", "k-no-data", 4, "ngIf"], [1, "k-list-filter", 3, "click"], [1, "k-searchbox", "k-input", 3, "ngClass"], ["unselectable", "on", 1, "k-input-icon", "k-icon", "k-i-search"], ["tabindex", "-1", 1, "k-input-inner", 3, "filterInput", "dir", "ngModel", "ngModelChange", "keydown", "input", "focus", "blur"], [1, "k-list", 3, "ngClass"], ["kendoDropDownsSelectable", "", 1, "k-list-optionlabel", 3, "ngClass", "index"], [1, "k-no-data"], [3, "ngIf", "templateContext"], [3, "resize"]]; }, template: function DropDownListComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵelementContainer(0, 0);
        ɵngcc0.ɵɵelementStart(1, "span", 1)(2, "span", 2);
        ɵngcc0.ɵɵtemplate(3, DropDownListComponent_3_Template, 1, 4, null, 3);
        ɵngcc0.ɵɵtemplate(4, DropDownListComponent_ng_template_4_Template, 1, 1, "ng-template", 4);
        ɵngcc0.ɵɵelementEnd()();
        ɵngcc0.ɵɵelementStart(5, "button", 5);
        ɵngcc0.ɵɵelement(6, "span", 6);
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵtemplate(7, DropDownListComponent_ng_template_7_Template, 8, 19, "ng-template", null, 7, ɵngcc0.ɵɵtemplateRefExtractor);
        ɵngcc0.ɵɵtemplate(9, DropDownListComponent_ng_template_9_Template, 1, 0, "ng-template", 4);
        ɵngcc0.ɵɵelementContainer(10, null, 8);
    } if (rf & 2) {
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("id", ctx.valueLabelId);
        ɵngcc0.ɵɵadvance(2);
        ɵngcc0.ɵɵproperty("ngIf", ctx.valueTemplate);
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngIf", !ctx.valueTemplate);
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngClass", ctx.selectButtonClasses)("kendoEventsOutsideAngular", ɵngcc0.ɵɵpureFunction1(8, _c23, ctx.onMouseDown));
        ɵngcc0.ɵɵattribute("aria-label", ctx.messageFor("selectButtonText"));
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngClass", ctx.buttonClasses);
        ɵngcc0.ɵɵadvance(3);
        ɵngcc0.ɵɵproperty("ngIf", ctx.isOpen);
    } }, directives: function () { return [LocalizedMessagesDirective, ɵngcc3.NgIf, TemplateContextDirective, ɵngcc3.NgClass, ɵngcc2.EventsOutsideAngularDirective, ɵngcc5.DefaultValueAccessor, FilterInputDirective, ɵngcc5.NgControlStatus, ɵngcc5.NgModel, SelectableDirective, ListComponent, ɵngcc2.ResizeSensorComponent]; }, encapsulation: 2 });
__decorate([
    Input(),
    __metadata("design:type", String)
], DropDownListComponent.prototype, "iconClass", void 0);
__decorate([
    Input(),
    __metadata("design:type", Boolean)
], DropDownListComponent.prototype, "loading", void 0);
__decorate([
    Input(),
    __metadata("design:type", Object),
    __metadata("design:paramtypes", [Object])
], DropDownListComponent.prototype, "data", null);
__decorate([
    Input(),
    __metadata("design:type", Object),
    __metadata("design:paramtypes", [Object])
], DropDownListComponent.prototype, "value", null);
__decorate([
    Input(),
    __metadata("design:type", String)
], DropDownListComponent.prototype, "textField", void 0);
__decorate([
    Input(),
    __metadata("design:type", String)
], DropDownListComponent.prototype, "valueField", void 0);
__decorate([
    Input(),
    __metadata("design:type", Object),
    __metadata("design:paramtypes", [Object])
], DropDownListComponent.prototype, "popupSettings", null);
__decorate([
    Input(),
    __metadata("design:type", Number)
], DropDownListComponent.prototype, "listHeight", void 0);
__decorate([
    Input(),
    __metadata("design:type", Object)
], DropDownListComponent.prototype, "defaultItem", void 0);
__decorate([
    Input(),
    __metadata("design:type", Boolean)
], DropDownListComponent.prototype, "disabled", void 0);
__decorate([
    Input(),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [Function])
], DropDownListComponent.prototype, "itemDisabled", null);
__decorate([
    Input(),
    __metadata("design:type", Boolean)
], DropDownListComponent.prototype, "readonly", void 0);
__decorate([
    Input(),
    __metadata("design:type", Boolean)
], DropDownListComponent.prototype, "filterable", void 0);
__decorate([
    Input(),
    __metadata("design:type", Object),
    __metadata("design:paramtypes", [Object])
], DropDownListComponent.prototype, "virtual", null);
__decorate([
    Input(),
    __metadata("design:type", Boolean)
], DropDownListComponent.prototype, "ignoreCase", void 0);
__decorate([
    Input(),
    __metadata("design:type", Number)
], DropDownListComponent.prototype, "delay", void 0);
__decorate([
    Input(),
    __metadata("design:type", Boolean),
    __metadata("design:paramtypes", [Boolean])
], DropDownListComponent.prototype, "valuePrimitive", null);
__decorate([
    Input(),
    __metadata("design:type", Number)
], DropDownListComponent.prototype, "tabindex", void 0);
__decorate([
    Input("tabIndex"),
    __metadata("design:type", Number),
    __metadata("design:paramtypes", [Number])
], DropDownListComponent.prototype, "tabIndex", null);
__decorate([
    Input(),
    __metadata("design:type", String),
    __metadata("design:paramtypes", [String])
], DropDownListComponent.prototype, "size", null);
__decorate([
    Input(),
    __metadata("design:type", String),
    __metadata("design:paramtypes", [String])
], DropDownListComponent.prototype, "rounded", null);
__decorate([
    Input(),
    __metadata("design:type", String),
    __metadata("design:paramtypes", [String])
], DropDownListComponent.prototype, "fillMode", null);
__decorate([
    Output(),
    __metadata("design:type", EventEmitter)
], DropDownListComponent.prototype, "valueChange", void 0);
__decorate([
    Output(),
    __metadata("design:type", EventEmitter)
], DropDownListComponent.prototype, "filterChange", void 0);
__decorate([
    Output(),
    __metadata("design:type", EventEmitter)
], DropDownListComponent.prototype, "selectionChange", void 0);
__decorate([
    Output(),
    __metadata("design:type", EventEmitter)
], DropDownListComponent.prototype, "open", void 0);
__decorate([
    Output(),
    __metadata("design:type", EventEmitter)
], DropDownListComponent.prototype, "opened", void 0);
__decorate([
    Output(),
    __metadata("design:type", EventEmitter)
], DropDownListComponent.prototype, "close", void 0);
__decorate([
    Output(),
    __metadata("design:type", EventEmitter)
], DropDownListComponent.prototype, "closed", void 0);
__decorate([
    Output('focus'),
    __metadata("design:type", EventEmitter)
], DropDownListComponent.prototype, "onFocus", void 0);
__decorate([
    Output('blur'),
    __metadata("design:type", EventEmitter)
], DropDownListComponent.prototype, "onBlur", void 0);
__decorate([
    ContentChild(ItemTemplateDirective, { static: false }),
    __metadata("design:type", ItemTemplateDirective)
], DropDownListComponent.prototype, "itemTemplate", void 0);
__decorate([
    ContentChild(GroupTemplateDirective, { static: false }),
    __metadata("design:type", GroupTemplateDirective)
], DropDownListComponent.prototype, "groupTemplate", void 0);
__decorate([
    ContentChild(FixedGroupTemplateDirective, { static: false }),
    __metadata("design:type", FixedGroupTemplateDirective)
], DropDownListComponent.prototype, "fixedGroupTemplate", void 0);
__decorate([
    ContentChild(ValueTemplateDirective, { static: false }),
    __metadata("design:type", ValueTemplateDirective)
], DropDownListComponent.prototype, "valueTemplate", void 0);
__decorate([
    ContentChild(HeaderTemplateDirective, { static: false }),
    __metadata("design:type", HeaderTemplateDirective)
], DropDownListComponent.prototype, "headerTemplate", void 0);
__decorate([
    ContentChild(FooterTemplateDirective, { static: false }),
    __metadata("design:type", FooterTemplateDirective)
], DropDownListComponent.prototype, "footerTemplate", void 0);
__decorate([
    ContentChild(NoDataTemplateDirective, { static: false }),
    __metadata("design:type", NoDataTemplateDirective)
], DropDownListComponent.prototype, "noDataTemplate", void 0);
__decorate([
    ViewChild('container', { read: ViewContainerRef, static: true }),
    __metadata("design:type", ViewContainerRef)
], DropDownListComponent.prototype, "container", void 0);
__decorate([
    ViewChild('popupTemplate', { static: true }),
    __metadata("design:type", TemplateRef)
], DropDownListComponent.prototype, "popupTemplate", void 0);
__decorate([
    ViewChild('optionsList', { static: false }),
    __metadata("design:type", ListComponent)
], DropDownListComponent.prototype, "optionsList", void 0);
__decorate([
    HostBinding('class.k-dropdownlist'),
    HostBinding('class.k-picker'),
    __metadata("design:type", Boolean)
], DropDownListComponent.prototype, "hostClasses", void 0);
__decorate([
    HostBinding('class.k-disabled'),
    HostBinding('attr.aria-disabled'),
    __metadata("design:type", Boolean),
    __metadata("design:paramtypes", [])
], DropDownListComponent.prototype, "isDisabled", null);
__decorate([
    HostBinding('class.k-loading'),
    __metadata("design:type", Boolean),
    __metadata("design:paramtypes", [])
], DropDownListComponent.prototype, "isLoading", null);
__decorate([
    Input('id'),
    HostBinding('attr.id'),
    __metadata("design:type", String)
], DropDownListComponent.prototype, "focusableId", void 0);
__decorate([
    HostBinding('attr.dir'),
    __metadata("design:type", String),
    __metadata("design:paramtypes", [])
], DropDownListComponent.prototype, "dir", null);
__decorate([
    HostBinding('attr.tabindex'),
    __metadata("design:type", Number),
    __metadata("design:paramtypes", [])
], DropDownListComponent.prototype, "hostTabIndex", null);
__decorate([
    HostBinding('attr.readonly'),
    HostBinding('attr.aria-readonly'),
    __metadata("design:type", Boolean),
    __metadata("design:paramtypes", [])
], DropDownListComponent.prototype, "isReadonly", null);
__decorate([
    HostBinding('attr.role'),
    HostBinding('attr.aria-haspopup'),
    __metadata("design:type", String)
], DropDownListComponent.prototype, "role", void 0);
__decorate([
    HostBinding('attr.aria-expanded'),
    __metadata("design:type", Boolean),
    __metadata("design:paramtypes", [])
], DropDownListComponent.prototype, "isAriaExpanded", null);
__decorate([
    HostBinding('attr.aria-owns'),
    __metadata("design:type", String),
    __metadata("design:paramtypes", [])
], DropDownListComponent.prototype, "hostAriaOwns", null);
__decorate([
    HostBinding('attr.aria-activedescendant'),
    __metadata("design:type", String),
    __metadata("design:paramtypes", [])
], DropDownListComponent.prototype, "hostAriaActivedescendant", null);
__decorate([
    HostBinding('attr.aria-label'),
    __metadata("design:type", String),
    __metadata("design:paramtypes", [])
], DropDownListComponent.prototype, "hostNoDataLabel", null);
__decorate([
    HostListener('keydown', ['$event']),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [Object]),
    __metadata("design:returntype", void 0)
], DropDownListComponent.prototype, "keydown", null);
__decorate([
    HostListener('keypress', ['$event']),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [Object]),
    __metadata("design:returntype", void 0)
], DropDownListComponent.prototype, "keypress", null);
__decorate([
    HostListener('click', ['$event']),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [Object]),
    __metadata("design:returntype", void 0)
], DropDownListComponent.prototype, "click", null);
DropDownListComponent = DropDownListComponent_1 = __decorate([ __param(10, Optional()), __param(10, Inject(TOUCH_ENABLED)),
    __metadata("design:paramtypes", [ElementRef,
        LocalizationService,
        PopupService,
        SelectionService,
        NavigationService,
        DisabledItemsService,
        DataService,
        NgZone,
        Renderer2,
        ChangeDetectorRef, Boolean])
], DropDownListComponent);

/**
 * Renders the content of the custom list item in the MultiSelect
 * ([see example]({% slug templates_multiselect %}#toc-customizing-the-item-content)).
 * The template context is set to the current component.
 * To get a reference to the current text that is typed by the
 * user, use the `let-customItem` directive.
 *
 * > The `CustomItemTemplate` directive can only be used with the MultiSelect component.
 *
 * @example
 * ```ts
 * _@Component({
 * selector: 'my-app',
 * template: `
 *  <kendo-multiselect [data]="listItems" [allowCustom]="true">
 *    <ng-template kendoMultiSelectCustomItemTemplate let-customItem>
 *      <span>New Item: {{customItem}}</span>
 *    </ng-template>
 *  </kendo-multiselect>
 * `
 * })
 * class AppComponent {
 *   public listItems: Array<string> = ["Item 1", "Item 2", "Item 3", "Item 4"];
 * }
 * ```
 *
 */
let CustomItemTemplateDirective = class CustomItemTemplateDirective {
    constructor(templateRef) {
        this.templateRef = templateRef;
    }
};
CustomItemTemplateDirective.ɵfac = function CustomItemTemplateDirective_Factory(t) { return new (t || CustomItemTemplateDirective)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.TemplateRef)); };
CustomItemTemplateDirective.ɵdir = /*@__PURE__*/ ɵngcc0.ɵɵdefineDirective({ type: CustomItemTemplateDirective, selectors: [["", "kendoMultiSelectCustomItemTemplate", ""]] });
CustomItemTemplateDirective = __decorate([ __metadata("design:paramtypes", [TemplateRef])
], CustomItemTemplateDirective);

/**
 * Renders the selected tag value of the MultiSelect
 * ([see example]({% slug templates_multiselect %}#toc-tag-template)).
 * The template context is set to the current component.
 * To get a reference to the current data item, use the `let-dataItem` directive.
 *
 * > The `TagTemplate` directive can only be used with the MultiSelect and MultiSelectTree components.
 *
 * @example
 * ```ts
 * _@Component({
 * selector: 'my-app',
 * template: `
 *  <kendo-multiselect [data]="items">
 *    <ng-template kendoMultiSelectTagTemplate let-dataItem>
 *      <span>{{dataItem}} option</span>
 *    </ng-template>
 *  </kendo-multiselect>
 * `
 * })
 * class AppComponent {
 *   public items: Array<string> = ["Item 1", "Item 2", "Item 3", "Item 4"];
 * }
 * ```
 */
let TagTemplateDirective = class TagTemplateDirective {
    constructor(templateRef) {
        this.templateRef = templateRef;
    }
};
TagTemplateDirective.ɵfac = function TagTemplateDirective_Factory(t) { return new (t || TagTemplateDirective)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.TemplateRef)); };
TagTemplateDirective.ɵdir = /*@__PURE__*/ ɵngcc0.ɵɵdefineDirective({ type: TagTemplateDirective, selectors: [["", "kendoMultiSelectTagTemplate", ""], ["", "kendoMultiSelectTreeTagTemplate", ""]] });
TagTemplateDirective = __decorate([ __metadata("design:paramtypes", [TemplateRef])
], TagTemplateDirective);

/**
 * Renders the grouped tag values in the MultiSelect
 * ([see example]({% slug summarytagmode_multiselect %})).
 * The template context is set to the current component.
 * To get a reference to the current grouped
 * data items collection, use the `let-dataItems` directive.
 *
 * > The `GroupTagTemplate` directive can only be used with the MultiSelect and MultiSelectTree components.
 *
 * @example
 * ```ts
 * _@Component({
 * selector: 'my-app',
 * template: `
 *  <kendo-multiselect kendoMultiSelectSummaryTag [data]="items">
 *    <ng-template kendoMultiSelectGroupTagTemplate let-dataItems>
 *      <span>{{dataItems.length}} item(s) selected</span>
 *    </ng-template>
 *  </kendo-multiselect>
 * `
 * })
 * class AppComponent {
 *   public items: Array<string> = ["Item 1", "Item 2", "Item 3", "Item 4"];
 * }
 * ```
 */
let GroupTagTemplateDirective = class GroupTagTemplateDirective {
    constructor(templateRef) {
        this.templateRef = templateRef;
    }
};
GroupTagTemplateDirective.ɵfac = function GroupTagTemplateDirective_Factory(t) { return new (t || GroupTagTemplateDirective)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.TemplateRef)); };
GroupTagTemplateDirective.ɵdir = /*@__PURE__*/ ɵngcc0.ɵɵdefineDirective({ type: GroupTagTemplateDirective, selectors: [["", "kendoMultiSelectGroupTagTemplate", ""], ["", "kendoMultiSelectTreeGroupTagTemplate", ""]] });
GroupTagTemplateDirective = __decorate([ __metadata("design:paramtypes", [TemplateRef])
], GroupTagTemplateDirective);

/**
 * Arguments for the `removeTag` event. The `removeTag` event fires when a tag is about
 * to the removed. If you cancel the event, the removal is prevented.
 */
class RemoveTagEvent extends PreventableEvent {
    /**
     * Constructs the event arguments for the `remove` event.
     * @param dataItem - The data item or an array of data items that will be removed.
     */
    constructor(dataItem) {
        super();
        this.dataItem = dataItem;
    }
}

/**
 * @hidden
 */
const normalizeCheckboxesSettings = (settings) => {
    if (isObject(settings)) {
        const defaultSettings = { enabled: true, checkOnClick: true };
        return Object.assign({}, defaultSettings, settings);
    }
    return { enabled: Boolean(settings), checkOnClick: true };
};

/* tslint:disable:member-ordering */
var MultiSelectComponent_1;
const MULTISELECT_VALUE_ACCESSOR = {
    multi: true,
    provide: NG_VALUE_ACCESSOR,
    // tslint:disable-next-line:no-use-before-declare
    useExisting: forwardRef(() => MultiSelectComponent)
};
/**
 * Represents the [Kendo UI MultiSelect component for Angular]({% slug overview_multiselect %}).
 *
 * @example
 * ```ts
 * _@Component({
 * selector: 'my-app',
 * template: `
 *  <kendo-multiselect [data]="listItems">
 *  </kendo-multiselect>
 * `
 * })
 * class AppComponent {
 *   public listItems: Array<string> = ["Item 1", "Item 2", "Item 3", "Item 4"];
 * }
 * ```
 */
let MultiSelectComponent = MultiSelectComponent_1 = class MultiSelectComponent {
    constructor(wrapper, localization, popupService, dataService, selectionService, navigationService, disabledItemsService, cdr, differs, renderer, _zone, touchEnabled$$1) {
        this.wrapper = wrapper;
        this.localization = localization;
        this.popupService = popupService;
        this.dataService = dataService;
        this.selectionService = selectionService;
        this.navigationService = navigationService;
        this.disabledItemsService = disabledItemsService;
        this.cdr = cdr;
        this.differs = differs;
        this.renderer = renderer;
        this._zone = _zone;
        this.touchEnabled = touchEnabled$$1;
        this.listBoxId = guid$1();
        this.tagListId = guid$1();
        this.tagPrefix = "tag-" + guid$1();
        this.optionPrefix = "option-" + guid$1();
        this.focusedTagIndex = undefined;
        /**
         * @hidden
         */
        this.focusableId = `k-${guid$1()}`;
        /**
         * Determines whether to close the options list of the MultiSelect after the item selection is finished
         * ([see example]({% slug openstate_multiselect %}#toc-keeping-the-options-list-open-while-on-focus)).
         * @default true
         */
        this.autoClose = true;
        /**
         * Specifies the [`tabindex`](https://developer.mozilla.org/en-US/docs/Web/HTML/Global_attributes/tabindex) of the component.
         */
        this.tabindex = 0;
        /**
         * Sets the disabled state of the component.
         */
        this.disabled = false;
        /**
         * Sets the read-only state of the component.
         */
        this.readonly = false;
        /**
         * Enables the [filtering]({% slug filtering_multiselect %}) functionality of the MultiSelect.
         */
        this.filterable = false;
        /**
         * Sets the height of the suggestions list. By default, `listHeight` is 200px.
         *
         * > The `listHeight` property affects only the list of suggestions and not the whole popup container.
         * > To set the height of the popup container, use `popupSettings.height`.
         */
        this.listHeight = 200;
        /**
         * If set to `true`, renders a button on hovering over the component.
         * Clicking this button resets the value of the component to an empty array and triggers the `change` event.
         */
        this.clearButton = true;
        /**
         * A user-defined callback function which receives an array of selected data items and maps them to an array of tags
         * ([see examples]({% slug summarytagmode_multiselect %}#toc-rendering-of-tags)).
         *
         * @param { Any[] } dataItems - The selected data items from the list.
         * @returns { Any[] } - The tags that will be rendered by the component.
         */
        this.tagMapper = (tags) => tags || [];
        /**
         * Specifies whether the MultiSelect allows user-defined values that are not present in the dataset
         * ([more information and examples]({% slug custom_values_multiselect %})).
         * Defaults to `false`.
         */
        this.allowCustom = false;
        /**
         * A user-defined callback function which returns normalized custom values.
         * Typically used when the data items are different from type `string`.
         *
         * @param { Any } value - The custom value that is defined by the user.
         * @returns { Any }
         *
         * @example
         * ```ts
         * import { map } from 'rxjs/operators';
         *
         * _@Component({
         * selector: 'my-app',
         * template: `
         *   <kendo-multiselect
         *       [allowCustom]="true"
         *       [data]="listItems"
         *       textField="text"
         *       valueField="value"
         *       [valueNormalizer]="valueNormalizer"
         *       (valueChange)="onValueChange($event)"
         *   >
         *   </kendo-multiselect>
         * `
         * })
         *
         * class AppComponent {
         *   public listItems: Array<{ text: string, value: number }> = [
         *       { text: "Small", value: 1 },
         *       { text: "Medium", value: 2 },
         *       { text: "Large", value: 3 }
         *   ];
         *
         *   public onValueChange(value) {
         *       console.log("valueChange : ", value);
         *   }
         *
         *   public valueNormalizer = (text$: Observable<string>) => text$.pipe(map((text: string) => {
         *      return {
         *         value: Math.floor(Math.random() * (1000 - 100) + 1000), //generate unique valueField
         *         text: text };
         *   }));
         *
         * }
         * ```
         */
        this.valueNormalizer = (text) => text.pipe(map((userInput) => {
            const comparer = (item) => typeof item === 'string' && userInput.toLowerCase() === item.toLowerCase();
            const matchingValue = this.value.find(comparer);
            if (matchingValue) {
                return matchingValue;
            }
            const matchingItem = this.dataService.find(comparer);
            return matchingItem ? matchingItem : userInput;
        }));
        /**
         * Fires each time the user types in the input field.
         * You can filter the source based on the passed filtration value.
         */
        this.filterChange = new EventEmitter();
        /**
         * Fires each time the value is changed&mdash;
         * when the component is blurred or the value is cleared through the **Clear** button
         * ([see example]({% slug overview_multiselect %}#toc-events)).
         * When the value of the component is programmatically changed to `ngModel` or `formControl`
         * through its API or form binding, the `valueChange` event is not triggered because it
         * might cause a mix-up with the built-in `valueChange` mechanisms of the `ngModel` or `formControl` bindings.
         */
        this.valueChange = new EventEmitter();
        /**
         * Fires each time the popup is about to open
         * ([see example]({% slug openstate_multiselect %}#toc-preventing-opening-and-closing)).
         * This event is preventable. If you cancel it, the popup will remain closed.
         */
        this.open = new EventEmitter();
        /**
         * Fires after the popup has been opened.
         */
        this.opened = new EventEmitter();
        /**
         * Fires each time the popup is about to close
         * ([see example]({% slug openstate_multiselect %}#toc-preventing-opening-and-closing)).
         * This event is preventable. If you cancel it, the popup will remain open.
         */
        this.close = new EventEmitter();
        /**
         * Fires after the popup has been closed.
         */
        this.closed = new EventEmitter();
        /**
         * Fires each time the user focuses the MultiSelect.
         */
        this.onFocus = new EventEmitter(); //tslint:disable-line:no-output-rename
        /**
         * Fires each time the MultiSelect gets blurred.
         */
        this.onBlur = new EventEmitter(); //tslint:disable-line:no-output-rename
        /**
         * Fires each time a tag is about to be removed.
         * This event is preventable. If you cancel it, the tag will not be removed.
         */
        this.removeTag = new EventEmitter();
        this.hostClasses = true;
        this.role = 'combobox';
        this.initialized = false;
        this._size = 'medium';
        this._rounded = 'medium';
        this._fillMode = 'solid';
        this.onChangeCallback = (_) => { };
        this.onTouchedCallback = (_) => { };
        this._placeholder = '';
        this._open = false;
        this._value = [];
        this._popupSettings = { animate: true };
        this._checkboxes = { enabled: false };
        this._isFocused = false;
        this.selectedDataItems = [];
        this.customValueSubject = new Subject();
        this.observableSubscriptions = new Subscription();
        validatePackage(packageMetadata);
        this.popupMouseDownHandler = this.onMouseDown.bind(this);
        this.data = [];
        this.direction = this.localization.rtl ? 'rtl' : 'ltr';
        this.subscribeEvents();
        this.subscribeTouchEvents();
    }
    /**
     * Focuses a specific item of the MultiSelect based on a provided index.
     * If there is a custom item it is positioned at index -1.
     * If null or invalid index is provided the focus will be removed.
     */
    focusItemAt(index) {
        const minIndex = this.allowCustom ? -1 : 0;
        const isInRange = minIndex <= 0 && index < this.data.length;
        if (isPresent(index) && isInRange && !this.disabledItemsService.isIndexDisabled(index)) {
            this.selectionService.focus(index);
        }
        else {
            this.selectionService.focus(null);
        }
    }
    /**
     * Focuses the MultiSelect.
     */
    focus() {
        if (!this.disabled) {
            this.searchbar.focus();
        }
    }
    /**
     * @hidden
     */
    onSearchBarFocus() {
        if (!this.isFocused) {
            this.isFocused = true;
            if (hasObservers(this.onFocus)) {
                this._zone.run(() => {
                    this.onFocus.emit();
                });
            }
        }
    }
    /**
     * Blurs the MultiSelect.
     */
    blur() {
        if (!this.disabled) {
            this.searchbar.blur();
        }
    }
    /**
     * @hidden
     */
    onSearchBarBlur() {
        if (!this.isFocused) {
            return;
        }
        this.isFocused = false;
        if (hasObservers(this.onBlur) ||
            hasObservers(this.filterChange) ||
            hasObservers(this.close) ||
            isUntouched(this.wrapper.nativeElement)) {
            this._zone.run(() => {
                this.closePopup();
                if (!(this.isOpen && this.allowCustom)) {
                    this.clearFilter();
                }
                this.onBlur.emit();
                this.onTouchedCallback();
            });
        }
        else {
            if (!this.allowCustom) {
                this.clearFilter();
            }
            this.closePopup();
        }
    }
    /**
     * @hidden
     */
    onMouseDown(event) {
        event.preventDefault();
    }
    /**
     * @hidden
     */
    onResize() {
        if (this._open) {
            const popupWrapper = this.popupRef.popupElement;
            const { min, max } = this.width;
            popupWrapper.style.minWidth = min;
            popupWrapper.style.width = max;
        }
    }
    get appendTo() {
        const { appendTo } = this.popupSettings;
        if (!appendTo || appendTo === 'root') {
            return undefined;
        }
        return appendTo === 'component' ? this.container : appendTo;
    }
    /**
     * Sets the data of the MultiSelect.
     *
     * > The data has to be provided in an array-like list of items.
     */
    set data(data) {
        this.dataService.data = data || [];
        if (this.virtual) {
            this.virtual.skip = 0;
        }
        if (this.initialized) {
            this.setState(this.value);
        }
    }
    get data() {
        const virtual = this.virtual;
        if (virtual) {
            const start = virtual.skip || 0;
            const end = start + virtual.pageSize;
            //Use length instead of itemsCount because of grouping
            virtual.total = this.dataService.data.length;
            return this.dataService.data.slice(start, end);
        }
        return this.dataService.data;
    }
    /**
     * Sets the value of the MultiSelect. It can be either of the primitive (string, numbers) or of the complex (objects) type.
     * To define the type, use the `valuePrimitive` option.
     *
     * > All selected values which are not present in the source are ignored.
     */
    set value(values) {
        this._value = values ? values : [];
        if (!this.differ && this.value) {
            this.differ = this.differs.find(this.value).create();
        }
        this.valueChangeDetected = true;
        if (this.initialized) {
            this.setState(this.value);
        }
    }
    get value() {
        return this._value;
    }
    /**
     * @hidden
     */
    set tabIndex(tabIndex) {
        this.tabindex = tabIndex;
    }
    get tabIndex() {
        return this.tabindex;
    }
    /**
     * Sets the size of the component.
     *
     * The possible values are:
     * * `'small'`
     * * `'medium'` (default)
     * * `'large'`
     * * `null`
     *
     */
    set size(size) {
        this.renderer.removeClass(this.wrapper.nativeElement, getSizeClass('input', this.size));
        if (size) {
            this.renderer.addClass(this.wrapper.nativeElement, getSizeClass('input', size));
        }
        this._size = size;
    }
    get size() {
        return this._size;
    }
    /**
     * Sets the border radius of the component.
     *
     * The possible values are:
     * * `'small'`
     * * `'medium'` (default)
     * * `'large'`
     * * `'full'`
     * * `null`
     *
     */
    set rounded(rounded) {
        this.renderer.removeClass(this.wrapper.nativeElement, getRoundedClass(this.rounded));
        if (rounded) {
            this.renderer.addClass(this.wrapper.nativeElement, getRoundedClass(rounded));
        }
        this._rounded = rounded;
    }
    get rounded() {
        return this._rounded;
    }
    /**
     * Sets the fillMode of the component.
     *
     * The possible values are:
     * * `'flat'`
     * * `'solid'` (default)
     * * `'outline'`
     * * `null`
     *
     */
    set fillMode(fillMode) {
        this.renderer.removeClass(this.wrapper.nativeElement, getFillModeClass('input', this.fillMode));
        if (fillMode) {
            this.renderer.addClass(this.wrapper.nativeElement, getFillModeClass('input', fillMode));
        }
        this._fillMode = fillMode;
    }
    get fillMode() {
        return this._fillMode;
    }
    /**
     * The hint which is displayed when the component is empty.
     * When the values are selected, it disappears.
     */
    set placeholder(text) {
        this._placeholder = text || '';
    }
    get placeholder() {
        return this.selectedDataItems.length ? '' : this._placeholder;
    }
    /**
     * Defines a Boolean function that is executed for each data item in the component
     * ([see examples]({% slug disableditems_multiselect %})). Determines whether the item will be disabled.
     */
    set itemDisabled(fn) {
        if (typeof fn !== 'function') {
            throw new Error(`itemDisabled must be a function, but received ${JSON.stringify(fn)}.`);
        }
        this.disabledItemsService.itemDisabled = fn;
    }
    /**
     * Specifies whether checkboxes will be rendered before each item in the popup list.
     */
    set checkboxes(settings) {
        this._checkboxes = normalizeCheckboxesSettings(settings);
    }
    get checkboxes() {
        return this._checkboxes;
    }
    /**
     * Enables the [virtualization]({% slug virtualization_multiselect %}) functionality.
     */
    set virtual(settings) {
        this._virtualSettings = normalizeVirtualizationSettings(settings);
    }
    get virtual() {
        return this._virtualSettings;
    }
    /**
     * Configures the popup of the MultiSelect.
     *
     * The available options are:
     * - `animate: Boolean`&mdash;Controls the popup animation. By default, the open and close animations are enabled.
     * - `width: Number | String`&mdash;Sets the width of the popup container. By default, the width of the host element is used. If set to `auto`, the component automatically adjusts the width of the popup and no item labels are wrapped. The `auto` mode is not supported when virtual scrolling is enabled.
     * - `height: Number`&mdash;Sets the height of the popup container.
     * - `popupClass: String`&mdash;Specifies a list of CSS classes that are used to style the popup.
     * - `appendTo: "root" | "component" | ViewContainerRef`&mdash;Specifies the component to which the popup will be appended.
     */
    set popupSettings(settings) {
        this._popupSettings = Object.assign({ animate: true }, settings);
    }
    get popupSettings() {
        return this._popupSettings;
    }
    /**
     * Specifies the type of the selected value.
     * If set to `true`, the selected value has to be of the primitive type
     * ([more information and example]({% slug valuebinding_multiselect %}#toc-primitive-values-from-object-fields)).
     */
    set valuePrimitive(isPrimitive) {
        this._valuePrimitive = isPrimitive;
    }
    get valuePrimitive() {
        if (!isPresent(this._valuePrimitive)) {
            return !isPresent(this.valueField);
        }
        return this._valuePrimitive;
    }
    get dir() {
        return this.direction;
    }
    get disabledClass() {
        return this.disabled;
    }
    get isLoading() {
        return this.loading;
    }
    get isAriaExpanded() {
        return this.isOpen;
    }
    /**
     * @hidden
     */
    hostMousedown(event) {
        const inputElement = this.searchbar.input.nativeElement;
        if (event.button === 0) {
            if (this.isFocused && this.isOpen && event.target === inputElement) {
                return;
            }
            if (!this.touchEnabled || (this.touchEnabled && event.target.tagName !== 'SPAN')) {
                this.searchbar.focus();
            }
            this.togglePopup(!this.isOpen);
            event.preventDefault();
        }
    }
    get listContainerClasses() {
        const containerClasses = ['k-list-container', 'k-reset'];
        if (this.popupSettings.popupClass) {
            containerClasses.push(this.popupSettings.popupClass);
        }
        return containerClasses;
    }
    /**
     * @hidden
     */
    get customItemSizeClass() {
        return `${this.size ? getSizeClass('list', this.size) : ''}`;
    }
    get width() {
        let wrapperOffsetWidth = 0;
        if (isDocumentAvailable()) {
            wrapperOffsetWidth = this.wrapper.nativeElement.offsetWidth;
        }
        const width = this.popupSettings.width || wrapperOffsetWidth;
        const minWidth = isNaN(wrapperOffsetWidth) ? wrapperOffsetWidth : `${wrapperOffsetWidth}px`;
        const maxWidth = isNaN(width) ? width : `${width}px`;
        return { min: minWidth, max: maxWidth };
    }
    get height() {
        const popupHeight = this.popupSettings.height;
        return isPresent(popupHeight) ? `${popupHeight}px` : 'auto';
    }
    get activeDescendant() {
        const focusedTagIndex = this.focusedTagIndex;
        const focusedListIndex = this.selectionService.focused;
        let prefix;
        let item;
        if (isPresent(focusedTagIndex) && !this.isOpen) {
            item = this.tags[focusedTagIndex];
            prefix = this.tagPrefix;
        }
        else if (isPresent(focusedListIndex) && focusedListIndex !== -1 && this.isOpen) {
            item = this.dataService.itemAt(focusedListIndex);
            prefix = this.optionPrefix;
        }
        else {
            return null;
        }
        return prefix + "-" + getter$1(item, this.valueField);
    }
    get noDataLabel() {
        if (this.dataService.itemsCount === 0) {
            return this.messageFor('noDataText');
        }
    }
    get clearButtonVisiblity() {
        if (this.touchEnabled) {
            return 'visible';
        }
    }
    /**
     * @hidden
     */
    verifySettings() {
        if (!isDevMode() || this.value.length === 0) {
            return;
        }
        if (!isArray(this.value)) {
            throw new Error(MultiselectMessages.array);
        }
        if (this.valuePrimitive === true && isObjectArray(this.value)) {
            throw new Error(MultiselectMessages.primitive);
        }
        if (this.valuePrimitive === false && !isObjectArray(this.value)) {
            throw new Error(MultiselectMessages.object);
        }
        const valueOrText = !isPresent(this.valueField) !== !isPresent(this.textField);
        if (valueOrText) {
            throw new Error(MultiselectMessages.textAndValue);
        }
    }
    /**
     * @hidden
     */
    change(event) {
        const isCustomItem = (isPresent(event.added) || isPresent(event.removed)) && (event.added === -1 || event.removed === -1);
        if (isCustomItem) {
            this.addCustomValue(this.text);
            return; // The change is emited asynchronosly.
        }
        // Existing items.
        if (isPresent(event.added)) {
            const dataItem = this.dataService.itemAt(event.added);
            const newItem = (this.valuePrimitive && isPresent(dataItem) && isPresent(dataItem[this.valueField])) ? dataItem[this.valueField] : dataItem;
            this.value = [...this.value, newItem];
        }
        if (isPresent(event.removed)) {
            const dataItem = this.dataService.itemAt(event.removed);
            const filter$$1 = (item) => getter$1(item, this.valueField) !== getter$1(dataItem, this.valueField);
            this.value = this.value.filter(filter$$1);
            this.selectionService.focused = event.removed;
            this.cdr.detectChanges();
        }
        this.emitValueChange();
    }
    /**
     * @hidden
     */
    setState(value) {
        let data = this.dataService.data;
        if (this.dataService.grouped) {
            data = data.filter(item => !item.header).map(item => item.value);
        }
        const selection = selectedIndices(this.value, data, this.valueField);
        this.selectionService.resetSelection(selection);
        if (this.disabledItemsService.isIndexDisabled(this.selectionService.focused)) {
            this.selectionService.focused = this.firstFocusableIndex(0);
        }
        if (this.isOpen && this.selectionService.focused === undefined) {
            if (this.dataService.itemsCount > 0) {
                this.selectionService.focused = this.firstFocusableIndex(0);
            }
            else if (this.allowCustom) {
                this.selectionService.focused = -1;
            }
        }
        if (this.valuePrimitive && !this.valueField) {
            this.selectedDataItems = value.slice();
        }
        if (isObjectArray(value) || this.valuePrimitive && this.valueField) {
            this.selectedDataItems = resolveAllValues(value, data, this.valueField);
        }
        if (this.selectedDataItems.length < value.length) {
            this.selectedDataItems = value
                .map(current => {
                const dataItem = this.selectedDataItems.find(item => getter$1(item, this.valueField) === getter$1(current, this.valueField));
                return isPresent(dataItem) ? dataItem : this.resolveDataItemFromTags(current);
            })
                .filter(dataItem => isPresent(dataItem));
        }
        this.tags = this.tagMapper(this.selectedDataItems.slice(0));
        this.disabledIndices = this.disabledItemsMapper();
        this.cdr.markForCheck();
    }
    /**
     * @hidden
     */
    handleFilter(text) {
        this.text = text;
        if (text && !this.isOpen) {
            this.openPopup();
        }
        if (this.filterable) {
            this.filterChange.emit(text);
        }
        else {
            this.searchTextAndFocus(text);
        }
        this.searchbar.setInputSize();
    }
    /**
     * @hidden
     */
    pageChange(event) {
        const virtual = this.virtual;
        virtual.skip = event.skip;
    }
    /**
     * @hidden
     */
    clearFilter() {
        if (this.filterable && this.text) {
            this.filterChange.emit("");
        }
        this.text = "";
        /* Clearing the value from the input as the setInputSize calculation will be incorrect otherwise.
         Calling cdr.detectChanges to clear the input value as a result of property binding
         causes JAWS to read outdated tag values in IE upon tag selection for some reason. */
        this.searchbar.input.nativeElement.value = "";
        this.searchbar.setInputSize();
    }
    /**
     * @hidden
     */
    handleNavigate(event) {
        const navigateInput = this.text && event.keyCode !== Keys.ArrowDown && event.keyCode !== Keys.ArrowUp;
        const selectValue = this.text && event.keyCode === Keys.Enter || event.keyCode === Keys.Escape;
        const deleteTag = !this.text && event.keyCode === Keys.Backspace && this.tags.length > 0;
        if (deleteTag) {
            this.handleBackspace();
            return;
        }
        if (this.disabled || navigateInput && !selectValue) {
            return;
        }
        const eventData = event;
        const focused = isNaN(this.selectionService.focused) ? -1 : this.selectionService.focused;
        const action = this.navigationService.process({
            current: focused,
            max: this.dataService.itemsCount - 1,
            min: this.allowCustom && this.text ? -1 : 0,
            open: this.isOpen,
            originalEvent: eventData
        });
        if (action !== NavigationAction.Undefined &&
            ((action === NavigationAction.Enter && this.isOpen) || action !== NavigationAction.Enter)) {
            event.preventDefault();
        }
    }
    /**
     * @hidden
     */
    handleRemoveTag({ tag }) {
        const eventArgs = new RemoveTagEvent(tag);
        if (this.disabled || this.readonly) {
            return;
        }
        this.focus();
        this.removeTag.emit(eventArgs);
        if (eventArgs.isDefaultPrevented()) {
            return;
        }
        if (tag instanceof Array) {
            this.removeGroupTag(tag);
        }
        else {
            this.removeSingleTag(tag);
        }
        this.cdr.detectChanges();
    }
    /**
     * @hidden
     */
    clearAll(event) {
        event.stopImmediatePropagation();
        event.preventDefault();
        this.focus();
        this.clearFilter();
        const selected = this.selectionService.selected;
        this.value = this.value.filter((_item, index) => this.disabledItemsService.isIndexDisabled(selected[index]));
        this.emitValueChange();
    }
    /**
     * @hidden
     */
    addCustomValue(text) {
        this.customValueSubject.next(text);
    }
    ngAfterContentChecked() {
        this.verifySettings();
    }
    ngDoCheck() {
        const valueChanges = this.differ && this.differ.diff(this.value);
        if (valueChanges && !this.valueChangeDetected) {
            this.setState(this.value);
        }
        this.valueChangeDetected = false;
    }
    ngOnInit() {
        this.renderer.removeAttribute(this.wrapper.nativeElement, "tabindex");
        this.createCustomValueStream();
        this.localizationChangeSubscription = this.localization
            .changes.subscribe(({ rtl }) => {
            this.direction = rtl ? 'rtl' : 'ltr';
            this.cdr.markForCheck();
        });
        this.setState(this.value);
        this.setComponentClasses();
        this.initialized = true;
    }
    ngOnChanges(changes) {
        const virtual = this.virtual;
        const requestInitialData = virtual && changes.data && changes.data.isFirstChange();
        if (requestInitialData) {
            this.pageChange({ skip: 0, take: virtual.pageSize });
        }
        if (isChanged('valueNormalizer', changes)) {
            this.createCustomValueStream();
        }
        if (anyChanged(['textField', 'valueField', 'valuePrimitive'], changes)) {
            this.setState(this.value);
        }
    }
    ngAfterViewInit() {
        this.searchbar.setInputSize();
    }
    ngOnDestroy() {
        this._toggle(false);
        this.unsubscribeEvents();
    }
    /**
     * Toggles the visibility of the popup
     * ([see example]({% slug openstate_multiselect %}#toc-setting-the-initially-opened-component)).
     * If you use the `toggle` method to open or close the popup, the respective `open` and `close` events will not be fired.
     *
     * @param open - The state of the popup.
     */
    toggle(open) {
        // The Promise is required for opening the popup on load.
        // Otherwise, the "Expression has changed..." type error will be thrown.
        Promise.resolve(null).then(() => {
            const shouldOpen = isPresent(open) ? open : !this._open;
            this._toggle(shouldOpen);
            this.cdr.markForCheck();
        });
    }
    /**
     * Returns the current open state of the popup.
     */
    get isOpen() {
        return this._open;
    }
    /**
     * Resets the value of the MultiSelect.
     * If you use the `reset` method to clear the value of the component,
     * the model will not update automatically and the `selectionChange` and `valueChange` events will not be fired.
     */
    reset() {
        this.text = "";
        this.value = [];
    }
    /**
     * @hidden
     */
    messageFor(key) {
        return this.localization.get(key);
    }
    // NG MODEL BINDINGS
    /**
     * @hidden
     */
    writeValue(value) {
        this.value = value || [];
    }
    /**
     * @hidden
     */
    registerOnChange(fn) {
        this.onChangeCallback = fn;
    }
    /**
     * @hidden
     */
    registerOnTouched(fn) {
        this.onTouchedCallback = fn;
    }
    /**
     * @hidden
     */
    setDisabledState(isDisabled) {
        this.disabled = isDisabled;
    }
    /**
     * @hidden
     */
    onTagMapperChange() {
        this.tags = this.tagMapper(this.selectedDataItems.slice(0));
        this.cdr.markForCheck();
    }
    set isFocused(isFocused) {
        this.renderer[isFocused ? 'addClass' : 'removeClass'](this.wrapper.nativeElement, 'k-focus');
        this._isFocused = isFocused;
    }
    get isFocused() {
        return this._isFocused;
    }
    subscribeEvents() {
        if (!isDocumentAvailable()) {
            return;
        }
        const isOpen = () => this.isOpen;
        const isClosed = () => !this.isOpen;
        const isTagFocused = () => !this.isOpen && this.focusedTagIndex !== undefined;
        [
            this.selectionService.onChange.subscribe(this.handleItemChange.bind(this)),
            this.navigationService.esc.subscribe(this.closePopup.bind(this)),
            this.navigationService.enter.pipe(filter(isOpen)).subscribe(this.handleEnter.bind(this)),
            this.navigationService.open.subscribe(this.openPopup.bind(this)),
            this.navigationService.close.subscribe(this.handleClose.bind(this)),
            this.navigationService.up.pipe(filter(isOpen)).subscribe((event) => this.handleUp(event.index)),
            this.navigationService.home.pipe(filter(() => isClosed)).subscribe(this.handleHome.bind(this)),
            this.navigationService.end.pipe(filter(() => isClosed)).subscribe(this.handleEnd.bind(this)),
            this.navigationService.backspace.pipe(filter(isTagFocused)).subscribe(this.handleBackspace.bind(this)),
            this.navigationService.delete.pipe(filter(isTagFocused)).subscribe(this.handleDelete.bind(this)),
            this.navigationService.left.subscribe(this.direction === 'rtl' ? this.handleRightKey.bind(this) : this.handleLeftKey.bind(this)),
            this.navigationService.right.subscribe(this.direction === 'rtl' ? this.handleLeftKey.bind(this) : this.handleRightKey.bind(this)),
            this.navigationService.down.subscribe((event) => this.handleDownKey(event.index))
        ].forEach(s => this.observableSubscriptions.add(s));
    }
    subscribeTouchEvents() {
        if (!isDocumentAvailable() || !this.touchEnabled) {
            return;
        }
        this._zone.runOutsideAngular(() => 
        // Roll up MultiSelect on iOS when tapped outside
        this.touchstartDisposeHandler = this.renderer.listen(document, 'touchstart', (e) => {
            const target = e.target;
            if ((this.isFocused || this.isOpen) && !inDropDown(this.wrapper, target, this.popupRef)) {
                this._zone.run(() => {
                    this.blur();
                    if (this.isOpen) {
                        this.togglePopup(false);
                    }
                });
            }
        }));
    }
    unsubscribeEvents() {
        if (!isDocumentAvailable()) {
            return;
        }
        this.observableSubscriptions.unsubscribe();
        if (this.customValueSubscription) {
            this.customValueSubscription.unsubscribe();
        }
        if (this.localizationChangeSubscription) {
            this.localizationChangeSubscription.unsubscribe();
        }
        if (this.touchstartDisposeHandler) {
            this.touchstartDisposeHandler();
        }
    }
    removeGroupTag(dataItems) {
        let data = this.dataService.data;
        if (this.dataService.grouped) {
            data = data.filter(item => !item.header).map(item => item.value);
        }
        const dataItemValues = new Set(dataItems.map(item => getter$1(item, this.valueField)));
        this.value = this.value.filter(value => {
            const index = selectedIndices([value], data, this.valueField)[0];
            const isDataItemDisabled = this.disabledItemsService.isIndexDisabled(index);
            return !dataItemValues.has(getter$1(value, this.valueField)) || isDataItemDisabled;
        });
        this.emitValueChange();
    }
    removeSingleTag(dataItem) {
        let data = this.dataService.data;
        if (this.dataService.grouped) {
            data = data.filter(item => !item.header).map(item => item.value);
        }
        const index = selectedIndices([dataItem], data, this.valueField)[0];
        if (this.disabledItemsService.isIndexDisabled(index)) {
            return;
        }
        if (isNumber(index)) {
            this.selectionService.unselect(index);
            this.selectionService.focused = index;
            this.togglePopup(false);
        }
        else { // the deleted item is not present in the source
            const filter$$1 = item => getter$1(item, this.valueField) !== getter$1(dataItem, this.valueField);
            this.value = this.value.filter(filter$$1);
            this.emitValueChange();
        }
    }
    /**
     * @hidden
     *
     * Determines which of the provided tags should be disabled and stores their position indices
     */
    disabledItemsMapper() {
        const { selected } = this.selectionService;
        return new Set(this.selectedDataItems.reduce((indices, _item, index) => {
            if (this.disabledItemsService.isIndexDisabled(selected[index])) {
                indices.push(index);
            }
            return indices;
        }, []));
    }
    createCustomValueStream() {
        if (this.customValueSubscription) {
            this.customValueSubscription.unsubscribe();
        }
        this.customValueSubscription = this.customValueSubject.pipe(tap(() => {
            this.loading = true;
            this.disabled = true;
            this.cdr.detectChanges();
        }), this.valueNormalizer, catchError(() => {
            this.loading = false;
            this.disabled = false;
            if (this.autoClose) {
                this.togglePopup(false);
            }
            if (this.autoClose || !this.filterable) {
                this.clearFilter();
            }
            this.nextTick(() => {
                this.searchbar.focus();
            });
            this.createCustomValueStream();
            return of(null);
        }))
            .subscribe((normalizedValue) => {
            this.loading = false;
            this.disabled = false;
            if (isPresent(normalizedValue)) { // if valueNormalizer returns `null` or `undefined` custom value is discarded
                const newValue = this.valuePrimitive ? getter$1(normalizedValue, this.valueField) : normalizedValue;
                const itemIndex = this.dataService.indexOf(newValue);
                const customItem = itemIndex === -1;
                if (this.value.indexOf(newValue) === -1) {
                    this.tags = this.tagMapper([...this.selectedDataItems, normalizedValue]);
                    if (!customItem) {
                        this.selectionService.add(itemIndex);
                    }
                    else {
                        this.value = [...this.value, newValue];
                    }
                }
                else {
                    if (!customItem && this.selectionService.isSelected(itemIndex)) {
                        this.selectionService.unselect(itemIndex);
                        this.selectionService.focused = itemIndex;
                    }
                    else {
                        this.value = this.value.filter(item => getter$1(item, this.valueField) !== newValue);
                    }
                }
                this.emitValueChange();
            }
            if (this.autoClose) {
                this.togglePopup(false);
            }
            if (this.autoClose || !this.filterable) {
                this.clearFilter();
            }
            this.nextTick(() => {
                this.searchbar.focus();
            });
        });
    }
    handleItemChange(event) {
        this.change(event);
        if (this.autoClose) {
            this.togglePopup(false);
        }
        if (this.autoClose || !this.filterable) {
            this.clearFilter();
        }
    }
    handleEnter(event) {
        const service = this.selectionService;
        const focusedIndex = this.selectionService.focused;
        if (this.isOpen) {
            event.originalEvent.preventDefault();
        }
        if (focusedIndex === -1) {
            if (this.allowCustom && this.text) {
                this.addCustomValue(this.text);
            }
            return; // Clear filter & close are done at customValueSubscription due to race conditions.
        }
        if (service.isSelected(focusedIndex)) {
            service.unselect(focusedIndex);
            service.focused = focusedIndex;
        }
        else {
            service.add(focusedIndex);
        }
        if (this.autoClose) {
            this.togglePopup(false);
        }
        if (this.autoClose || !this.filterable) {
            this.clearFilter();
        }
    }
    handleClose() {
        this.closePopup();
        this.searchbar.focus();
    }
    handleEnd() {
        this.focusedTagIndex = this.tags.length - 1;
    }
    handleHome() {
        this.focusedTagIndex = 0;
    }
    handleUp(index) {
        this.selectionService.focused = index;
    }
    handleBackspace() {
        if (this.focusedTagIndex !== undefined) {
            this.handleDelete();
        }
        else {
            this.handleRemoveTag({ tag: this.tags[this.tags.length - 1] });
            this.searchbar.focus();
        }
    }
    handleDelete() {
        this.handleRemoveTag({ tag: this.tags[this.focusedTagIndex] });
        if (this.focusedTagIndex === this.tags.length) {
            this.focusedTagIndex = undefined;
        }
    }
    handleLeftKey() {
        if (this.focusedTagIndex === undefined || this.focusedTagIndex < 0) {
            this.focusedTagIndex = this.tags.length - 1;
        }
        else if (this.focusedTagIndex !== 0) {
            this.focusedTagIndex--;
        }
    }
    handleDownKey(index) {
        if (this.isOpen) {
            this.selectionService.focused = index || this.firstFocusableIndex(0);
        }
        else {
            this.openPopup();
        }
    }
    handleRightKey() {
        const last = this.tags.length - 1;
        if (this.focusedTagIndex === last) {
            this.focusedTagIndex = undefined;
        }
        else if (this.focusedTagIndex < last) {
            this.focusedTagIndex++;
        }
    }
    findIndex(text, startsFrom = 0) {
        let itemText;
        text = text.toLowerCase();
        let index = this.dataService.findIndex(item => {
            if (this.dataService.grouped) {
                itemText = getter$1(item.value, this.textField);
            }
            else {
                itemText = getter$1(item, this.textField);
            }
            itemText = !isPresent(itemText) ? "" : itemText.toString().toLowerCase();
            return text && itemText.startsWith(text);
        }, startsFrom);
        if (this.disabledItemsService.isIndexDisabled(index)) {
            return (index + 1 > this.dataService.itemsCount) ? -1 : this.findIndex(text, index + 1);
        }
        else {
            return index;
        }
    }
    searchTextAndFocus(text) {
        const index = this.findIndex(text);
        this.selectionService.focused = index;
    }
    closePopup() {
        this.togglePopup(false);
        this.focusedTagIndex = undefined;
    }
    openPopup() {
        this.togglePopup(true);
        this.focusedTagIndex = undefined;
    }
    togglePopup(open) {
        const isDisabled = this.disabled || this.readonly;
        const sameState = this.isOpen === open;
        if (isDisabled || sameState) {
            return;
        }
        const isDefaultPrevented = this.triggerPopupEvents(open);
        if (!isDefaultPrevented) {
            this._toggle(open);
        }
    }
    triggerPopupEvents(open) {
        const eventArgs = new PreventableEvent();
        if (open) {
            this.open.emit(eventArgs);
        }
        else {
            this.close.emit(eventArgs);
        }
        return eventArgs.isDefaultPrevented();
    }
    _toggle(open) {
        this._open = open;
        this.destroyPopup();
        if (this._open) {
            this.createPopup();
        }
    }
    destroyPopup() {
        if (this.popupRef) {
            this.popupRef.popupElement
                .removeEventListener('mousedown', this.popupMouseDownHandler);
            this.popupRef.close();
            this.popupRef = null;
        }
    }
    createPopup() {
        if (this.virtual) {
            this.virtual.skip = 0;
        }
        const horizontalAlign = this.direction === "rtl" ? "right" : "left";
        const anchorPosition = { horizontal: horizontalAlign, vertical: "bottom" };
        const popupPosition = { horizontal: horizontalAlign, vertical: "top" };
        this.popupRef = this.popupService.open({
            anchor: this.wrapper,
            anchorAlign: anchorPosition,
            animate: this.popupSettings.animate,
            appendTo: this.appendTo,
            content: this.popupTemplate,
            popupAlign: popupPosition,
            popupClass: this.listContainerClasses,
            positionMode: 'absolute'
        });
        const popupWrapper = this.popupRef.popupElement;
        const { min, max } = this.width;
        popupWrapper.addEventListener('mousedown', this.popupMouseDownHandler);
        popupWrapper.style.minWidth = min;
        popupWrapper.style.width = max;
        popupWrapper.style.height = this.height;
        popupWrapper.setAttribute("dir", this.direction);
        this.popupRef.popupOpen.subscribe(() => {
            this.cdr.detectChanges();
            this.optionsList.scrollToItem(this.selectionService.focused);
            this.opened.emit();
        });
        this.popupRef.popupClose.subscribe(() => {
            this.closed.emit();
        });
        this.popupRef.popupAnchorViewportLeave.subscribe(() => {
            this.togglePopup(false);
        });
    }
    emitValueChange() {
        this.onChangeCallback(this.value);
        this.valueChange.emit(this.value);
    }
    resolveDataItemFromTags(value) {
        if (!(this.tags && this.tags.length && isPresent(value))) {
            return undefined;
        }
        // Flattening the tags array in case of a summary tag occurrence.
        const tags = this.tags.reduce((acc, tag) => {
            const items = isArray(tag) ? tag : [tag];
            acc.push(...items);
            return acc;
        }, []);
        return tags.find(tag => getter$1(tag, this.valueField) === getter$1(value, this.valueField));
    }
    firstFocusableIndex(index) {
        const maxIndex = this.dataService.itemsCount;
        if (this.disabledItemsService.isIndexDisabled(index)) {
            const nextIndex = index + 1;
            return (nextIndex < maxIndex) ? this.firstFocusableIndex(nextIndex) : undefined;
        }
        else {
            return index;
        }
    }
    nextTick(f) {
        this._zone.runOutsideAngular(() => {
            // Use `setTimeout` instead of a resolved promise
            // because the latter does not wait long enough.
            setTimeout(() => this._zone.run(f));
        });
    }
    setComponentClasses() {
        if (this.size) {
            this.renderer.addClass(this.wrapper.nativeElement, getSizeClass('input', this.size));
        }
        if (this.rounded) {
            this.renderer.addClass(this.wrapper.nativeElement, getRoundedClass(this.rounded));
        }
        if (this.fillMode) {
            this.renderer.addClass(this.wrapper.nativeElement, getFillModeClass('input', this.fillMode));
        }
    }
};
MultiSelectComponent.ɵfac = function MultiSelectComponent_Factory(t) { return new (t || MultiSelectComponent)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ElementRef), ɵngcc0.ɵɵdirectiveInject(ɵngcc1.LocalizationService), ɵngcc0.ɵɵdirectiveInject(ɵngcc4.PopupService), ɵngcc0.ɵɵdirectiveInject(DataService), ɵngcc0.ɵɵdirectiveInject(SelectionService), ɵngcc0.ɵɵdirectiveInject(NavigationService), ɵngcc0.ɵɵdirectiveInject(DisabledItemsService), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ChangeDetectorRef), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.KeyValueDiffers), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.Renderer2), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.NgZone), ɵngcc0.ɵɵdirectiveInject(TOUCH_ENABLED, 8)); };
MultiSelectComponent.ɵcmp = /*@__PURE__*/ ɵngcc0.ɵɵdefineComponent({ type: MultiSelectComponent, selectors: [["kendo-multiselect"]], contentQueries: function MultiSelectComponent_ContentQueries(rf, ctx, dirIndex) { if (rf & 1) {
        ɵngcc0.ɵɵcontentQuery(dirIndex, ItemTemplateDirective, 5);
        ɵngcc0.ɵɵcontentQuery(dirIndex, CustomItemTemplateDirective, 5);
        ɵngcc0.ɵɵcontentQuery(dirIndex, GroupTemplateDirective, 5);
        ɵngcc0.ɵɵcontentQuery(dirIndex, FixedGroupTemplateDirective, 5);
        ɵngcc0.ɵɵcontentQuery(dirIndex, HeaderTemplateDirective, 5);
        ɵngcc0.ɵɵcontentQuery(dirIndex, FooterTemplateDirective, 5);
        ɵngcc0.ɵɵcontentQuery(dirIndex, TagTemplateDirective, 5);
        ɵngcc0.ɵɵcontentQuery(dirIndex, GroupTagTemplateDirective, 5);
        ɵngcc0.ɵɵcontentQuery(dirIndex, NoDataTemplateDirective, 5);
    } if (rf & 2) {
        let _t;
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.template = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.customItemTemplate = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.groupTemplate = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.fixedGroupTemplate = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.headerTemplate = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.footerTemplate = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.tagTemplate = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.groupTagTemplate = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.noDataTemplate = _t.first);
    } }, viewQuery: function MultiSelectComponent_Query(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵviewQuery(_c8, 7, ViewContainerRef);
        ɵngcc0.ɵɵviewQuery(SearchBarComponent, 7);
        ɵngcc0.ɵɵviewQuery(_c9, 7);
        ɵngcc0.ɵɵviewQuery(_c10, 5);
    } if (rf & 2) {
        let _t;
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.container = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.searchbar = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.popupTemplate = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.optionsList = _t.first);
    } }, hostVars: 11, hostBindings: function MultiSelectComponent_HostBindings(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵlistener("mousedown", function MultiSelectComponent_mousedown_HostBindingHandler($event) { return ctx.hostMousedown($event); });
    } if (rf & 2) {
        ɵngcc0.ɵɵattribute("role", ctx.role)("dir", ctx.dir)("aria-expanded", ctx.isAriaExpanded);
        ɵngcc0.ɵɵclassProp("k-multiselect", ctx.hostClasses)("k-input", ctx.hostClasses)("k-disabled", ctx.disabledClass)("k-loading", ctx.isLoading);
    } }, inputs: { focusableId: "focusableId", autoClose: "autoClose", tabindex: "tabindex", disabled: "disabled", readonly: "readonly", filterable: "filterable", listHeight: "listHeight", clearButton: "clearButton", tagMapper: "tagMapper", allowCustom: "allowCustom", valueNormalizer: "valueNormalizer", data: "data", value: "value", tabIndex: "tabIndex", size: "size", rounded: "rounded", fillMode: "fillMode", placeholder: "placeholder", itemDisabled: "itemDisabled", checkboxes: "checkboxes", virtual: "virtual", popupSettings: "popupSettings", valuePrimitive: "valuePrimitive", loading: "loading", valueField: "valueField", textField: "textField" }, outputs: { filterChange: "filterChange", valueChange: "valueChange", open: "open", opened: "opened", close: "close", closed: "closed", onFocus: "focus", onBlur: "blur", removeTag: "removeTag" }, exportAs: ["kendoMultiSelect"], features: [ɵngcc0.ɵɵProvidersFeature([
            MULTISELECT_VALUE_ACCESSOR,
            DataService,
            SelectionService,
            NavigationService,
            DisabledItemsService,
            LocalizationService,
            {
                provide: L10N_PREFIX,
                useValue: 'kendo.multiselect'
            },
            {
                provide: FilterableComponent, useExisting: forwardRef(() => MultiSelectComponent_1)
            },
            {
                provide: KendoInput, useExisting: forwardRef(() => MultiSelectComponent_1)
            }
        ]), ɵngcc0.ɵɵNgOnChangesFeature], decls: 11, vars: 27, consts: function () { let i18n_29; if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
        /**
         * @desc The text displayed in the popup when there are no items
         * @meaning kendo.multiselect.noDataText
         */
        const MSG_EXTERNAL_1450213984397806503$$DIST_FESM2015_INDEX_JS_30 = goog.getMsg("NO DATA FOUND");
        i18n_29 = MSG_EXTERNAL_1450213984397806503$$DIST_FESM2015_INDEX_JS_30;
    }
    else {
        i18n_29 = $localize `:kendo.multiselect.noDataText|The text displayed in the popup when there are no items␟3cc1323f79a5fe012960578e513f8a35b2af1e96␟1450213984397806503:NO DATA FOUND`;
    } let i18n_31; if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
        /**
         * @desc The title of the clear button
         * @meaning kendo.multiselect.clearTitle
         */
        const MSG_EXTERNAL_4609022959269604009$$DIST_FESM2015_INDEX_JS_32 = goog.getMsg("clear");
        i18n_31 = MSG_EXTERNAL_4609022959269604009$$DIST_FESM2015_INDEX_JS_32;
    }
    else {
        i18n_31 = $localize `:kendo.multiselect.clearTitle|The title of the clear button␟9443fc64ff58c498712dd853ba77ce5c8b978769␟4609022959269604009:clear`;
    } return [["kendoMultiSelectLocalizedMessages", "", "noDataText", i18n_29, "clearTitle", i18n_31], [3, "size", "rounded", "fillMode", "id", "tags", "textField", "valueField", "focused", "disabled", "template", "groupTemplate", "tagPrefix", "disabledIndices", "removeTag"], [3, "id", "role", "tagListId", "activeDescendant", "noDataLabel", "userInput", "disabled", "readonly", "tabIndex", "popupOpen", "placeholder", "onNavigate", "valueChange", "onBlur", "onFocus"], ["searchbar", ""], ["class", "k-clear-value", "role", "button", "tabindex", "-1", 3, "visibility", "mousedown", 4, "ngIf"], ["class", "k-icon k-i-loading", 4, "ngIf"], ["popupTemplate", ""], [3, "ngIf"], ["container", ""], ["role", "button", "tabindex", "-1", 1, "k-clear-value", 3, "mousedown"], [1, "k-icon", "k-i-x"], [1, "k-icon", "k-i-loading"], [4, "ngIf"], ["class", "k-list", 3, "ngClass", 4, "ngIf"], [3, "size", "rounded", "id", "optionPrefix", "data", "textField", "valueField", "height", "template", "groupTemplate", "fixedGroupTemplate", "show", "multipleSelection", "virtual", "checkboxes", "pageChange"], ["optionsList", ""], ["class", "k-no-data", 4, "ngIf"], [3, "templateContext"], [1, "k-list", 3, "ngClass"], ["kendoDropDownsSelectable", "", 1, "k-list-item", "k-custom-item", 3, "multipleSelection", "index"], [4, "ngIf", "ngIfElse"], ["default_custom_item_template", ""], [1, "k-icon", "k-i-plus", 2, "float", "right"], [1, "k-no-data"], [3, "ngIf", "templateContext"], [3, "resize"]]; }, template: function MultiSelectComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵelementContainer(0, 0);
        ɵngcc0.ɵɵelementStart(1, "kendo-taglist", 1);
        ɵngcc0.ɵɵlistener("removeTag", function MultiSelectComponent_Template_kendo_taglist_removeTag_1_listener($event) { return ctx.handleRemoveTag($event); });
        ɵngcc0.ɵɵelementStart(2, "kendo-searchbar", 2, 3);
        ɵngcc0.ɵɵlistener("onNavigate", function MultiSelectComponent_Template_kendo_searchbar_onNavigate_2_listener($event) { return ctx.handleNavigate($event); })("valueChange", function MultiSelectComponent_Template_kendo_searchbar_valueChange_2_listener($event) { return ctx.handleFilter($event); })("onBlur", function MultiSelectComponent_Template_kendo_searchbar_onBlur_2_listener() { return ctx.onSearchBarBlur(); })("onFocus", function MultiSelectComponent_Template_kendo_searchbar_onFocus_2_listener() { return ctx.onSearchBarFocus(); });
        ɵngcc0.ɵɵelementEnd()();
        ɵngcc0.ɵɵtemplate(4, MultiSelectComponent_span_4_Template, 2, 3, "span", 4);
        ɵngcc0.ɵɵtemplate(5, MultiSelectComponent_span_5_Template, 1, 0, "span", 5);
        ɵngcc0.ɵɵtemplate(6, MultiSelectComponent_ng_template_6_Template, 6, 19, "ng-template", null, 6, ɵngcc0.ɵɵtemplateRefExtractor);
        ɵngcc0.ɵɵtemplate(8, MultiSelectComponent_ng_template_8_Template, 1, 0, "ng-template", 7);
        ɵngcc0.ɵɵelementContainer(9, null, 8);
    } if (rf & 2) {
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("size", ctx.size)("rounded", ctx.rounded)("fillMode", ctx.fillMode)("id", ctx.tagListId)("tags", ctx.tags)("textField", ctx.textField)("valueField", ctx.valueField)("focused", ctx.focusedTagIndex)("disabled", ctx.disabled)("template", ctx.tagTemplate)("groupTemplate", ctx.groupTagTemplate)("tagPrefix", ctx.tagPrefix)("disabledIndices", ctx.disabledIndices);
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("id", ctx.focusableId)("role", "textbox")("tagListId", ctx.tagListId)("activeDescendant", ctx.activeDescendant)("noDataLabel", ctx.noDataLabel)("userInput", ctx.text)("disabled", ctx.disabled)("readonly", ctx.readonly)("tabIndex", ctx.tabIndex)("popupOpen", ctx.isOpen)("placeholder", ctx.placeholder);
        ɵngcc0.ɵɵadvance(2);
        ɵngcc0.ɵɵproperty("ngIf", !ctx.loading && !ctx.readonly && ctx.clearButton && ((ctx.tags == null ? null : ctx.tags.length) || (ctx.text == null ? null : ctx.text.length)));
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngIf", ctx.loading);
        ɵngcc0.ɵɵadvance(3);
        ɵngcc0.ɵɵproperty("ngIf", ctx.isOpen);
    } }, directives: function () { return [LocalizedMessagesDirective, TagListComponent, SearchBarComponent, ɵngcc3.NgIf, TemplateContextDirective, ɵngcc3.NgClass, SelectableDirective, ListComponent, ɵngcc2.ResizeSensorComponent]; }, encapsulation: 2 });
__decorate([
    Input(),
    __metadata("design:type", String)
], MultiSelectComponent.prototype, "focusableId", void 0);
__decorate([
    Input(),
    __metadata("design:type", Boolean)
], MultiSelectComponent.prototype, "autoClose", void 0);
__decorate([
    Input(),
    __metadata("design:type", Boolean)
], MultiSelectComponent.prototype, "loading", void 0);
__decorate([
    Input(),
    __metadata("design:type", Array),
    __metadata("design:paramtypes", [Array])
], MultiSelectComponent.prototype, "data", null);
__decorate([
    Input(),
    __metadata("design:type", Array),
    __metadata("design:paramtypes", [Array])
], MultiSelectComponent.prototype, "value", null);
__decorate([
    Input(),
    __metadata("design:type", String)
], MultiSelectComponent.prototype, "valueField", void 0);
__decorate([
    Input(),
    __metadata("design:type", String)
], MultiSelectComponent.prototype, "textField", void 0);
__decorate([
    Input(),
    __metadata("design:type", Number)
], MultiSelectComponent.prototype, "tabindex", void 0);
__decorate([
    Input("tabIndex"),
    __metadata("design:type", Number),
    __metadata("design:paramtypes", [Number])
], MultiSelectComponent.prototype, "tabIndex", null);
__decorate([
    Input(),
    __metadata("design:type", String),
    __metadata("design:paramtypes", [String])
], MultiSelectComponent.prototype, "size", null);
__decorate([
    Input(),
    __metadata("design:type", String),
    __metadata("design:paramtypes", [String])
], MultiSelectComponent.prototype, "rounded", null);
__decorate([
    Input(),
    __metadata("design:type", String),
    __metadata("design:paramtypes", [String])
], MultiSelectComponent.prototype, "fillMode", null);
__decorate([
    Input(),
    __metadata("design:type", String),
    __metadata("design:paramtypes", [String])
], MultiSelectComponent.prototype, "placeholder", null);
__decorate([
    Input(),
    __metadata("design:type", Boolean)
], MultiSelectComponent.prototype, "disabled", void 0);
__decorate([
    Input(),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [Function])
], MultiSelectComponent.prototype, "itemDisabled", null);
__decorate([
    Input(),
    __metadata("design:type", Object),
    __metadata("design:paramtypes", [Object])
], MultiSelectComponent.prototype, "checkboxes", null);
__decorate([
    Input(),
    __metadata("design:type", Boolean)
], MultiSelectComponent.prototype, "readonly", void 0);
__decorate([
    Input(),
    __metadata("design:type", Boolean)
], MultiSelectComponent.prototype, "filterable", void 0);
__decorate([
    Input(),
    __metadata("design:type", Object),
    __metadata("design:paramtypes", [Object])
], MultiSelectComponent.prototype, "virtual", null);
__decorate([
    Input(),
    __metadata("design:type", Object),
    __metadata("design:paramtypes", [Object])
], MultiSelectComponent.prototype, "popupSettings", null);
__decorate([
    Input(),
    __metadata("design:type", Number)
], MultiSelectComponent.prototype, "listHeight", void 0);
__decorate([
    Input(),
    __metadata("design:type", Boolean),
    __metadata("design:paramtypes", [Boolean])
], MultiSelectComponent.prototype, "valuePrimitive", null);
__decorate([
    Input(),
    __metadata("design:type", Boolean)
], MultiSelectComponent.prototype, "clearButton", void 0);
__decorate([
    Input(),
    __metadata("design:type", Object)
], MultiSelectComponent.prototype, "tagMapper", void 0);
__decorate([
    Input(),
    __metadata("design:type", Boolean)
], MultiSelectComponent.prototype, "allowCustom", void 0);
__decorate([
    Input(),
    __metadata("design:type", Function)
], MultiSelectComponent.prototype, "valueNormalizer", void 0);
__decorate([
    Output(),
    __metadata("design:type", EventEmitter)
], MultiSelectComponent.prototype, "filterChange", void 0);
__decorate([
    Output(),
    __metadata("design:type", EventEmitter)
], MultiSelectComponent.prototype, "valueChange", void 0);
__decorate([
    Output(),
    __metadata("design:type", EventEmitter)
], MultiSelectComponent.prototype, "open", void 0);
__decorate([
    Output(),
    __metadata("design:type", EventEmitter)
], MultiSelectComponent.prototype, "opened", void 0);
__decorate([
    Output(),
    __metadata("design:type", EventEmitter)
], MultiSelectComponent.prototype, "close", void 0);
__decorate([
    Output(),
    __metadata("design:type", EventEmitter)
], MultiSelectComponent.prototype, "closed", void 0);
__decorate([
    Output('focus'),
    __metadata("design:type", EventEmitter)
], MultiSelectComponent.prototype, "onFocus", void 0);
__decorate([
    Output('blur'),
    __metadata("design:type", EventEmitter)
], MultiSelectComponent.prototype, "onBlur", void 0);
__decorate([
    Output(),
    __metadata("design:type", EventEmitter)
], MultiSelectComponent.prototype, "removeTag", void 0);
__decorate([
    ViewChild('container', { read: ViewContainerRef, static: true }),
    __metadata("design:type", ViewContainerRef)
], MultiSelectComponent.prototype, "container", void 0);
__decorate([
    ViewChild(SearchBarComponent, { static: true }),
    __metadata("design:type", SearchBarComponent)
], MultiSelectComponent.prototype, "searchbar", void 0);
__decorate([
    ViewChild('popupTemplate', { static: true }),
    __metadata("design:type", TemplateRef)
], MultiSelectComponent.prototype, "popupTemplate", void 0);
__decorate([
    ViewChild('optionsList', { static: false }),
    __metadata("design:type", ListComponent)
], MultiSelectComponent.prototype, "optionsList", void 0);
__decorate([
    ContentChild(ItemTemplateDirective, { static: false }),
    __metadata("design:type", ItemTemplateDirective)
], MultiSelectComponent.prototype, "template", void 0);
__decorate([
    ContentChild(CustomItemTemplateDirective, { static: false }),
    __metadata("design:type", CustomItemTemplateDirective)
], MultiSelectComponent.prototype, "customItemTemplate", void 0);
__decorate([
    ContentChild(GroupTemplateDirective, { static: false }),
    __metadata("design:type", GroupTemplateDirective)
], MultiSelectComponent.prototype, "groupTemplate", void 0);
__decorate([
    ContentChild(FixedGroupTemplateDirective, { static: false }),
    __metadata("design:type", FixedGroupTemplateDirective)
], MultiSelectComponent.prototype, "fixedGroupTemplate", void 0);
__decorate([
    ContentChild(HeaderTemplateDirective, { static: false }),
    __metadata("design:type", HeaderTemplateDirective)
], MultiSelectComponent.prototype, "headerTemplate", void 0);
__decorate([
    ContentChild(FooterTemplateDirective, { static: false }),
    __metadata("design:type", FooterTemplateDirective)
], MultiSelectComponent.prototype, "footerTemplate", void 0);
__decorate([
    ContentChild(TagTemplateDirective, { static: false }),
    __metadata("design:type", TagTemplateDirective)
], MultiSelectComponent.prototype, "tagTemplate", void 0);
__decorate([
    ContentChild(GroupTagTemplateDirective, { static: false }),
    __metadata("design:type", GroupTagTemplateDirective)
], MultiSelectComponent.prototype, "groupTagTemplate", void 0);
__decorate([
    ContentChild(NoDataTemplateDirective, { static: false }),
    __metadata("design:type", NoDataTemplateDirective)
], MultiSelectComponent.prototype, "noDataTemplate", void 0);
__decorate([
    HostBinding('class.k-multiselect'),
    HostBinding('class.k-input'),
    __metadata("design:type", Boolean)
], MultiSelectComponent.prototype, "hostClasses", void 0);
__decorate([
    HostBinding('attr.dir'),
    __metadata("design:type", String),
    __metadata("design:paramtypes", [])
], MultiSelectComponent.prototype, "dir", null);
__decorate([
    HostBinding('class.k-disabled'),
    __metadata("design:type", Boolean),
    __metadata("design:paramtypes", [])
], MultiSelectComponent.prototype, "disabledClass", null);
__decorate([
    HostBinding('class.k-loading'),
    __metadata("design:type", Boolean),
    __metadata("design:paramtypes", [])
], MultiSelectComponent.prototype, "isLoading", null);
__decorate([
    HostBinding('attr.role'),
    __metadata("design:type", String)
], MultiSelectComponent.prototype, "role", void 0);
__decorate([
    HostBinding('attr.aria-expanded'),
    __metadata("design:type", Boolean),
    __metadata("design:paramtypes", [])
], MultiSelectComponent.prototype, "isAriaExpanded", null);
__decorate([
    HostListener('mousedown', ['$event']),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [Object]),
    __metadata("design:returntype", void 0)
], MultiSelectComponent.prototype, "hostMousedown", null);
MultiSelectComponent = MultiSelectComponent_1 = __decorate([ __param(11, Optional()), __param(11, Inject(TOUCH_ENABLED)),
    __metadata("design:paramtypes", [ElementRef,
        LocalizationService,
        PopupService,
        DataService,
        SelectionService,
        NavigationService,
        DisabledItemsService,
        ChangeDetectorRef,
        KeyValueDiffers,
        Renderer2,
        NgZone, Boolean])
], MultiSelectComponent);

/**
 * Renders the column cell content of the MultiColumnComboBox. To define a column cell template, nest an `<ng-template>` tag
 * with the `kendoMultiColumnComboBoxColumnCellTemplate` directive inside the [`<kendo-combobox-column>`]({% slug api_dropdowns_comboboxcolumncomponent %}) tag
 * ([see example]({% slug templates_multicolumncombobox %})).
 *
 * The current [`column`]({% slug api_dropdowns_comboboxcolumncomponent %}) and data item are available as context variables:
 *
 * - `let-dataItem="dataItem"` (`any`) - The current data item. Also available as implicit context variable.
 * - `let-column="column"` ([`ColumnComponent`]({% slug api_dropdowns_comboboxcolumncomponent %})) - The current column configuration obejct.
 */
let ColumnCellTemplateDirective = class ColumnCellTemplateDirective {
    constructor(templateRef) {
        this.templateRef = templateRef;
    }
};
ColumnCellTemplateDirective.ɵfac = function ColumnCellTemplateDirective_Factory(t) { return new (t || ColumnCellTemplateDirective)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.TemplateRef)); };
ColumnCellTemplateDirective.ɵdir = /*@__PURE__*/ ɵngcc0.ɵɵdefineDirective({ type: ColumnCellTemplateDirective, selectors: [["", "kendoMultiColumnComboBoxColumnCellTemplate", ""]] });
ColumnCellTemplateDirective = __decorate([ __metadata("design:paramtypes", [TemplateRef])
], ColumnCellTemplateDirective);

/**
 * Renders the column header content of the MultiColumnComboBox. To define a column header template, nest an `<ng-template>` tag
 * with the `kendoMultiColumnComboBoxColumnHeaderTemplate` directive inside the [`<kendo-combobox-column>`]({% slug api_dropdowns_comboboxcolumncomponent %}) tag
 * ([see example]({% slug templates_multicolumncombobox %})).
 *
 * The current [`column`]({% slug api_dropdowns_comboboxcolumncomponent %}) is available as implicit context variable.
 */
let ColumnHeaderTemplateDirective = class ColumnHeaderTemplateDirective {
    constructor(templateRef) {
        this.templateRef = templateRef;
    }
};
ColumnHeaderTemplateDirective.ɵfac = function ColumnHeaderTemplateDirective_Factory(t) { return new (t || ColumnHeaderTemplateDirective)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.TemplateRef)); };
ColumnHeaderTemplateDirective.ɵdir = /*@__PURE__*/ ɵngcc0.ɵɵdefineDirective({ type: ColumnHeaderTemplateDirective, selectors: [["", "kendoMultiColumnComboBoxColumnHeaderTemplate", ""]] });
ColumnHeaderTemplateDirective = __decorate([ __metadata("design:paramtypes", [TemplateRef])
], ColumnHeaderTemplateDirective);

/**
 * Represents the column definition of the [MultiColumnComboBox]({% slug overview_multicolumncombobox %})
 * ([see example]({% slug columns_multicolumncombobox %})).
 */
let ComboBoxColumnComponent = class ComboBoxColumnComponent {
    /**
     * Represents the column definition of the [MultiColumnComboBox]({% slug overview_multicolumncombobox %})
     * ([see example]({% slug columns_multicolumncombobox %})).
     */
    constructor() {
        /**
         * Sets the visibility of the column.
         *
         * @default false
         */
        this.hidden = false;
        /**
         * @hidden
         */
        this.matchesMedia = true;
    }
};
ComboBoxColumnComponent.ɵfac = function ComboBoxColumnComponent_Factory(t) { return new (t || ComboBoxColumnComponent)(); };
ComboBoxColumnComponent.ɵcmp = /*@__PURE__*/ ɵngcc0.ɵɵdefineComponent({ type: ComboBoxColumnComponent, selectors: [["kendo-combobox-column"]], contentQueries: function ComboBoxColumnComponent_ContentQueries(rf, ctx, dirIndex) { if (rf & 1) {
        ɵngcc0.ɵɵcontentQuery(dirIndex, ColumnCellTemplateDirective, 5);
        ɵngcc0.ɵɵcontentQuery(dirIndex, ColumnHeaderTemplateDirective, 5);
    } if (rf & 2) {
        let _t;
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.cellTemplate = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.headerTemplate = _t.first);
    } }, inputs: { hidden: "hidden", field: "field", title: "title", width: "width", style: "style", headerStyle: "headerStyle", class: "class", headerClass: "headerClass", media: "media" }, decls: 0, vars: 0, template: function ComboBoxColumnComponent_Template(rf, ctx) { }, encapsulation: 2 });
__decorate([
    ContentChild(ColumnCellTemplateDirective, { static: false }),
    __metadata("design:type", ColumnCellTemplateDirective)
], ComboBoxColumnComponent.prototype, "cellTemplate", void 0);
__decorate([
    ContentChild(ColumnHeaderTemplateDirective, { static: false }),
    __metadata("design:type", ColumnHeaderTemplateDirective)
], ComboBoxColumnComponent.prototype, "headerTemplate", void 0);
__decorate([
    Input(),
    __metadata("design:type", String)
], ComboBoxColumnComponent.prototype, "field", void 0);
__decorate([
    Input(),
    __metadata("design:type", String)
], ComboBoxColumnComponent.prototype, "title", void 0);
__decorate([
    Input(),
    __metadata("design:type", Number)
], ComboBoxColumnComponent.prototype, "width", void 0);
__decorate([
    Input(),
    __metadata("design:type", Boolean)
], ComboBoxColumnComponent.prototype, "hidden", void 0);
__decorate([
    Input(),
    __metadata("design:type", Object)
], ComboBoxColumnComponent.prototype, "style", void 0);
__decorate([
    Input(),
    __metadata("design:type", Object)
], ComboBoxColumnComponent.prototype, "headerStyle", void 0);
__decorate([
    Input(),
    __metadata("design:type", Object)
], ComboBoxColumnComponent.prototype, "class", void 0);
__decorate([
    Input(),
    __metadata("design:type", Object)
], ComboBoxColumnComponent.prototype, "headerClass", void 0);
__decorate([
    Input(),
    __metadata("design:type", String)
], ComboBoxColumnComponent.prototype, "media", void 0);

/**
 * Persists the intially resolved scrollbar width value.
 */
let SCROLLBAR_WIDTH;
/**
 * @hidden
 *
 * Gets the default scrollbar width accoring to the current environment.
 */
const scrollbarWidth = () => {
    // calculate scrollbar width only once, then return the memoized value
    if (isNaN(SCROLLBAR_WIDTH)) {
        const div = document.createElement('div');
        div.style.cssText = 'overflow: scroll; overflow-x: hidden; zoom: 1; clear: both; display: block;';
        div.innerHTML = '&nbsp;';
        document.body.appendChild(div);
        SCROLLBAR_WIDTH = div.offsetWidth - div.scrollWidth;
        document.body.removeChild(div);
    }
    return SCROLLBAR_WIDTH;
};
/**
 * Checks if all columns have a valid user-defined width.
 */
const allColumnsWidthsSet = (columns) => {
    if (!isPresent(columns) || columns.length === 0) {
        return false;
    }
    return columns.toArray().every(column => !isNaN(column.width) && column.width > 0);
};
/**
 * @hidden
 *
 * Calculates the row width according to the passed columns width configuration.
 * Hidden columns and such that don't match the provided media query are ignored.
 * If some of the columns don't have a preset width or have an invalid width value, the function returns `null`.
 */
const getRowWidthFromColumnsMeta = (columns) => {
    if (!allColumnsWidthsSet(columns)) {
        return null;
    }
    const bordersWidth = 2;
    const initialRowWidht = scrollbarWidth() + bordersWidth;
    return columns.reduce((totalWidth, column) => {
        if (!column.hidden && column.matchesMedia) {
            totalWidth += parseInt(column.width, 10);
        }
        return totalWidth;
    }, initialRowWidht);
};

var MultiColumnComboBoxComponent_1;
/**
 * Represents the [Kendo UI MultiColumnComboBox component for Angular]({% slug overview_multicolumncombobox %}).
 */
let MultiColumnComboBoxComponent = MultiColumnComboBoxComponent_1 = class MultiColumnComboBoxComponent extends ComboBoxComponent {
    constructor(localization, popupService, selectionService, navigationService, disabledItemsService, dataService, zone, changeDetector, renderer, wrapper, touchEnabled$$1) {
        super(wrapper, localization, popupService, selectionService, navigationService, disabledItemsService, dataService, zone, changeDetector, renderer, touchEnabled$$1);
        /**
         * @hidden
         */
        this.hostClasses = true;
        this.removeWindowResizeListener = noop;
        // the row height in @progress/kendo-theme-default
        this.defaultVirtualItemHeight = 36;
        // use a smaller virtual page size as columns with multiple cells can cause poor performance
        this.defaultVirtualPageSize = 30;
    }
    /**
     * @hidden
     */
    get isDisabled() {
        return this.disabled;
    }
    /**
     * @hidden
     */
    set header(header) {
        // updates the header padding on initial render as the resize senzor doesn't kick in as early
        this.updateHeaderPadding(header && header.nativeElement);
    }
    get popupWidth() {
        const wrapperOffsetWidth = this.wrapper.nativeElement.offsetWidth;
        const min = `${wrapperOffsetWidth}px`;
        const width = this.popupSettings.width || getRowWidthFromColumnsMeta(this.columns) || wrapperOffsetWidth;
        const max = isNaN(width) ? width : `${width}px`;
        return { min, max };
    }
    /**
     * @hidden
     */
    get tableSizeClass() {
        return `${this.size ? getSizeClass('table', this.size) : ''}`;
    }
    /**
     * @hidden
     */
    get listContainerClasses() {
        return [
            'k-popup',
            'k-dropdowngrid-popup'
        ].concat(this.popupSettings.popupClass || []);
    }
    ngAfterViewInit() {
        this.updateColumnsMediaState();
        this.addWindowResizeListener();
    }
    ngOnDestroy() {
        super.ngOnDestroy();
        this.removeWindowResizeListener();
    }
    /**
     * @hidden
     */
    textFrom(dataItem, field) {
        return getter$1(dataItem, field);
    }
    /**
     * @hidden
     *
     * Adds or removes a padding value at the end of the header container equal to the size of the scrollbar.
     * As when the items container has a scrollbar, the column headers and the cells are misaligned.
     * When the container has a scrollbar, the padding style is added, and when there is none - it is removed.
     */
    updateHeaderPadding(header) {
        if (!isPresent(header)) {
            return;
        }
        // the scrollbar is rendered on the left in rtl
        const headerPaddingPosition = this.localization.rtl ? 'padding-left' : 'padding-right';
        if (this.optionsList.hasScrollbar() && scrollbarWidth() > 0) {
            this.renderer.setStyle(header, headerPaddingPosition, `${scrollbarWidth()}px`);
        }
        else {
            this.renderer.removeStyle(header, headerPaddingPosition);
        }
    }
    verifySettings() {
        if (!isDevMode()) {
            return;
        }
        if (isPresent(this.data) && this.data.length > 0 && this.data.some(item => !isObject(item))) {
            throw new Error(MultiColumnComboBoxMessages.data);
        }
        if (!isPresent(this.valueField) || !isPresent(this.textField)) {
            throw new Error(MultiColumnComboBoxMessages.textAndValue);
        }
        super.verifySettings();
    }
    addWindowResizeListener() {
        if (!isDocumentAvailable()) {
            return;
        }
        this.zone.runOutsideAngular(() => this.removeWindowResizeListener = this.renderer.listen(window, 'resize', this.updateColumnsMediaState.bind(this)));
    }
    updateColumnsMediaState() {
        if (!(isPresent(this.columns) && isDocumentAvailable())) {
            return;
        }
        this.columns.forEach(column => {
            const matchesMedia = !column.media || window.matchMedia(column.media).matches;
            if (column.matchesMedia !== matchesMedia) {
                column.matchesMedia = matchesMedia;
                if (this.isOpen) {
                    // enter the zone only if the popup is actually open
                    // update its width in case it's dependent on the columns' width
                    this.zone.run(() => this.popupRef.popupElement.style.width = this.popupWidth.max);
                }
            }
        });
    }
};
MultiColumnComboBoxComponent.ɵfac = function MultiColumnComboBoxComponent_Factory(t) { return new (t || MultiColumnComboBoxComponent)(ɵngcc0.ɵɵdirectiveInject(ɵngcc1.LocalizationService), ɵngcc0.ɵɵdirectiveInject(ɵngcc4.PopupService), ɵngcc0.ɵɵdirectiveInject(SelectionService), ɵngcc0.ɵɵdirectiveInject(NavigationService), ɵngcc0.ɵɵdirectiveInject(DisabledItemsService), ɵngcc0.ɵɵdirectiveInject(DataService), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.NgZone), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ChangeDetectorRef), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.Renderer2), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ElementRef), ɵngcc0.ɵɵdirectiveInject(TOUCH_ENABLED)); };
MultiColumnComboBoxComponent.ɵcmp = /*@__PURE__*/ ɵngcc0.ɵɵdefineComponent({ type: MultiColumnComboBoxComponent, selectors: [["kendo-multicolumncombobox"]], contentQueries: function MultiColumnComboBoxComponent_ContentQueries(rf, ctx, dirIndex) { if (rf & 1) {
        ɵngcc0.ɵɵcontentQuery(dirIndex, ComboBoxColumnComponent, 4);
    } if (rf & 2) {
        let _t;
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.columns = _t);
    } }, viewQuery: function MultiColumnComboBoxComponent_Query(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵviewQuery(_c33, 5);
    } if (rf & 2) {
        let _t;
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.header = _t.first);
    } }, hostVars: 4, hostBindings: function MultiColumnComboBoxComponent_HostBindings(rf, ctx) { if (rf & 2) {
        ɵngcc0.ɵɵclassProp("k-dropdowngrid", ctx.hostClasses)("k-disabled", ctx.isDisabled);
    } }, features: [ɵngcc0.ɵɵProvidersFeature([
            SelectionService,
            DataService,
            NavigationService,
            DisabledItemsService,
            LocalizationService,
            {
                provide: L10N_PREFIX,
                useValue: 'kendo.multicolumncombobox'
            },
            {
                multi: true,
                provide: NG_VALUE_ACCESSOR,
                useExisting: forwardRef(() => MultiColumnComboBoxComponent_1)
            },
            {
                provide: KendoInput,
                useExisting: forwardRef(() => MultiColumnComboBoxComponent_1)
            },
            {
                provide: FilterableComponent,
                useExisting: forwardRef(() => MultiColumnComboBoxComponent_1)
            }
        ]), ɵngcc0.ɵɵInheritDefinitionFeature], decls: 12, vars: 20, consts: function () { let i18n_34; if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
        /**
         * @desc The text displayed in the popup when there are no items
         * @meaning kendo.multicolumncombobox.noDataText
         */
        const MSG_EXTERNAL_3227251500690942605$$DIST_FESM2015_INDEX_JS_35 = goog.getMsg("NO DATA FOUND");
        i18n_34 = MSG_EXTERNAL_3227251500690942605$$DIST_FESM2015_INDEX_JS_35;
    }
    else {
        i18n_34 = $localize `:kendo.multicolumncombobox.noDataText|The text displayed in the popup when there are no items␟23a18095f2c16d40a04251fa2fb15d3927e7a79a␟3227251500690942605:NO DATA FOUND`;
    } let i18n_36; if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
        /**
         * @desc The title of the clear button
         * @meaning kendo.multicolumncombobox.clearTitle
         */
        const MSG_EXTERNAL_326603149056291198$$DIST_FESM2015_INDEX_JS_37 = goog.getMsg("clear");
        i18n_36 = MSG_EXTERNAL_326603149056291198$$DIST_FESM2015_INDEX_JS_37;
    }
    else {
        i18n_36 = $localize `:kendo.multicolumncombobox.clearTitle|The title of the clear button␟6b371962a2564e2e50986f7ec238e513b466d553␟326603149056291198:clear`;
    } return [["kendoMultiColumnComboBoxLocalizedMessages", "", "noDataText", i18n_34, "clearTitle", i18n_36], [3, "role", "id", "listId", "activeDescendant", "noDataLabel", "userInput", "suggestedText", "disabled", "readonly", "tabIndex", "popupOpen", "placeholder", "onNavigate", "valueChange", "onBlur", "onFocus"], ["searchbar", ""], ["class", "k-clear-value", "aria-hidden", "true", 3, "visibility", "kendoEventsOutsideAngular", "click", 4, "ngIf"], ["tabindex", "-1", "aria-hidden", "true", "unselectable", "on", "type", "button", 1, "k-input-button", "k-button", "k-icon-button", 3, "ngClass", "kendoEventsOutsideAngular"], ["select", ""], [1, "k-button-icon", "k-icon", 3, "ngClass"], ["popupTemplate", ""], [3, "resize", 4, "ngIf"], ["container", ""], ["aria-hidden", "true", 1, "k-clear-value", 3, "kendoEventsOutsideAngular", "click"], [1, "k-icon", "k-i-x"], [4, "ngIf"], [1, "k-data-table", 3, "ngClass"], [1, "k-table-header"], ["header", ""], [1, "k-table-header-wrap"], ["role", "presentation", 1, "k-table"], [4, "ngFor", "ngForOf"], [1, "k-table-thead"], [1, "k-table-row"], ["rowTemplate", ""], [3, "id", "optionPrefix", "data", "textField", "valueField", "template", "groupTemplate", "fixedGroupTemplate", "height", "show", "virtual", "type", "pageChange", "listResize"], ["optionsList", ""], ["class", "k-no-data", 4, "ngIf"], [3, "templateContext"], [3, "width", 4, "ngIf"], ["class", "k-table-th", 3, "ngStyle", "ngClass", 4, "ngIf"], [1, "k-table-th", 3, "ngStyle", "ngClass"], ["class", "k-table-td", 3, "ngClass", "width", "ngStyle", 4, "ngIf"], [1, "k-table-td", 3, "ngClass", "ngStyle"], [1, "k-no-data"], [3, "ngIf", "templateContext"], [3, "ngIf"], [1, "k-table-footer"], [1, "k-table"], [1, "k-table-tfoot"], [1, "k-table-td"], [3, "resize"]]; }, template: function MultiColumnComboBoxComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵelementContainer(0, 0);
        ɵngcc0.ɵɵelementStart(1, "kendo-searchbar", 1, 2);
        ɵngcc0.ɵɵlistener("onNavigate", function MultiColumnComboBoxComponent_Template_kendo_searchbar_onNavigate_1_listener($event) { return ctx.handleNavigate($event); })("valueChange", function MultiColumnComboBoxComponent_Template_kendo_searchbar_valueChange_1_listener($event) { return ctx.searchBarChange($event); })("onBlur", function MultiColumnComboBoxComponent_Template_kendo_searchbar_onBlur_1_listener() { return ctx.handleBlur(); })("onFocus", function MultiColumnComboBoxComponent_Template_kendo_searchbar_onFocus_1_listener() { return ctx.handleFocus(); });
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵtemplate(3, MultiColumnComboBoxComponent_span_3_Template, 2, 6, "span", 3);
        ɵngcc0.ɵɵelementStart(4, "button", 4, 5);
        ɵngcc0.ɵɵelement(6, "span", 6);
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵtemplate(7, MultiColumnComboBoxComponent_ng_template_7_Template, 17, 20, "ng-template", null, 7, ɵngcc0.ɵɵtemplateRefExtractor);
        ɵngcc0.ɵɵtemplate(9, MultiColumnComboBoxComponent_kendo_resize_sensor_9_Template, 1, 0, "kendo-resize-sensor", 8);
        ɵngcc0.ɵɵelementContainer(10, null, 9);
    } if (rf & 2) {
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("role", "combobox")("id", ctx.focusableId)("listId", ctx.listBoxId)("activeDescendant", ctx.activeDescendant)("noDataLabel", ctx.noDataLabel)("userInput", ctx.text)("suggestedText", ctx.getSuggestion())("disabled", ctx.disabled)("readonly", ctx.readonly)("tabIndex", ctx.tabIndex)("popupOpen", ctx.isOpen)("placeholder", ctx.placeholder);
        ɵngcc0.ɵɵadvance(2);
        ɵngcc0.ɵɵproperty("ngIf", ctx.clearButton && !ctx.loading && !ctx.disabled && !ctx.readonly && (ctx.text == null ? null : ctx.text.length));
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngClass", ctx.selectButtonClasses)("kendoEventsOutsideAngular", ɵngcc0.ɵɵpureFunction1(18, _c23, ctx.preventEventDefault));
        ɵngcc0.ɵɵattribute("aria-label", ctx.messageFor("selectButtonText"));
        ɵngcc0.ɵɵadvance(2);
        ɵngcc0.ɵɵproperty("ngClass", ctx.buttonClasses);
        ɵngcc0.ɵɵadvance(3);
        ɵngcc0.ɵɵproperty("ngIf", ctx.isOpen);
    } }, directives: function () { return [LocalizedMessagesDirective, SearchBarComponent, ɵngcc3.NgIf, ɵngcc2.EventsOutsideAngularDirective, ɵngcc3.NgClass, TemplateContextDirective, ɵngcc3.NgForOf, ɵngcc3.NgStyle, ListComponent, ɵngcc2.ResizeSensorComponent]; }, encapsulation: 2 });
__decorate([
    HostBinding('class.k-dropdowngrid'),
    __metadata("design:type", Boolean)
], MultiColumnComboBoxComponent.prototype, "hostClasses", void 0);
__decorate([
    HostBinding('class.k-disabled'),
    __metadata("design:type", Boolean),
    __metadata("design:paramtypes", [])
], MultiColumnComboBoxComponent.prototype, "isDisabled", null);
__decorate([
    ContentChildren(ComboBoxColumnComponent),
    __metadata("design:type", QueryList)
], MultiColumnComboBoxComponent.prototype, "columns", void 0);
__decorate([
    ViewChild('header', { static: false }),
    __metadata("design:type", ElementRef),
    __metadata("design:paramtypes", [ElementRef])
], MultiColumnComboBoxComponent.prototype, "header", null);
MultiColumnComboBoxComponent = MultiColumnComboBoxComponent_1 = __decorate([ __param(10, Inject(TOUCH_ENABLED)),
    __metadata("design:paramtypes", [LocalizationService,
        PopupService,
        SelectionService,
        NavigationService,
        DisabledItemsService,
        DataService,
        NgZone,
        ChangeDetectorRef,
        Renderer2,
        ElementRef, Boolean])
], MultiColumnComboBoxComponent);

/**
 * Renders the content of each node in the DropDownTree. To define a node template, nest an `<ng-template>` tag
 * with the `kendoDropDownTreeNodeTemplate` directive inside the `<kendo-dropdowntree>` tag.
 *
 * The current data item and hierarchical index are available as context variables:
 *
 * - `let-dataItem` (`any`) - The current data item. Available as implicit context variable.
 * - `let-index="index"` (`string`) - The current item hierarchical index.
 */
let NodeTemplateDirective = class NodeTemplateDirective {
    constructor(templateRef) {
        this.templateRef = templateRef;
    }
};
NodeTemplateDirective.ɵfac = function NodeTemplateDirective_Factory(t) { return new (t || NodeTemplateDirective)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.TemplateRef)); };
NodeTemplateDirective.ɵdir = /*@__PURE__*/ ɵngcc0.ɵɵdefineDirective({ type: NodeTemplateDirective, selectors: [["", "kendoDropDownTreeNodeTemplate", ""], ["", "kendoMultiSelectTreeNodeTemplate", ""]] });
NodeTemplateDirective = __decorate([ __metadata("design:paramtypes", [TemplateRef])
], NodeTemplateDirective);

var DropDownTreeComponent_1;
/* tslint:disable:member-ordering */
const DEFAULT_POPUP_SETTINGS = { animate: true };
const hasChildren = () => false;
const fetchChildren = () => of([]);
const itemDisabled = () => false;
const isNodeVisible = () => true;
/**
 * Represents the [Kendo UI DropDownTree component for Angular]({% slug overview_ddt %}).
 */
let DropDownTreeComponent = DropDownTreeComponent_1 = class DropDownTreeComponent {
    constructor(wrapper, popupService, navigationService, renderer, _zone, cdr, localization, touchEnabled$$1) {
        this.wrapper = wrapper;
        this.popupService = popupService;
        this.navigationService = navigationService;
        this.renderer = renderer;
        this._zone = _zone;
        this.cdr = cdr;
        this.localization = localization;
        this.touchEnabled = touchEnabled$$1;
        this.hostClasses = true;
        this.role = 'listbox';
        this.ariaHasPopup = 'tree';
        /**
         * Fires each time the popup is about to open
         * ([see example]({% slug openstate_ddt %})).
         * This event is preventable. If you cancel it, the popup will remain closed.
         */
        this.open = new EventEmitter();
        /**
         * Fires after the popup has been opened.
         */
        this.opened = new EventEmitter();
        /**
         * Fires each time the popup is about to close
         * ([see example]({% slug openstate_ddt %})).
         * This event is preventable. If you cancel it, the popup will remain open.
         */
        this.close = new EventEmitter();
        /**
         * Fires after the popup has been closed.
         */
        this.closed = new EventEmitter();
        /**
         * Fires when the user expands a node in the popup TreeView.
         */
        this.nodeExpand = new EventEmitter();
        /**
         * Fires when the user collapses a node in the popup TreeView.
         */
        this.nodeCollapse = new EventEmitter();
        /**
         * Fires each time the user focuses the DropDownTree.
         */
        this.onFocus = new EventEmitter();
        /**
         * Fires each time the DropDownTree gets blurred.
         */
        this.onBlur = new EventEmitter();
        /**
         * Fires each time the value is changed
         * ([see example]({% slug overview_ddt %}#toc-events)).
         */
        this.valueChange = new EventEmitter();
        /**
         * Fires when the value of the built-in filter input element changes.
         */
        this.filterChange = new EventEmitter();
        /**
         * If set to `true`, renders a button on hovering over the component.
         * Clicking this button resets the value of the component to `undefined` and triggers the `change` event.
         */
        this.clearButton = true;
        /**
         * A function which determines if a specific node has child nodes.
         */
        this.hasChildren = hasChildren;
        /**
         * A function which provides the child nodes for a given parent node.
         */
        this.fetchChildren = fetchChildren;
        /**
         * The hint which is displayed when the component is empty.
         */
        this.placeholder = "";
        /**
         * Sets the height of the options list. By default, `listHeight` is 200px.
         *
         * > The `listHeight` property affects only the list of options and not the whole popup container.
         * > To set the height of the popup container, use `popupSettings.height`.
         */
        this.listHeight = 200;
        /**
         * Sets the disabled state of the component.
         */
        this.disabled = false;
        /**
         * Sets the read-only state of the component.
         */
        this.readonly = false;
        /**
         * Specifies the type of the selected value
         * ([more information and example]({% slug valuebinding_ddt %}#toc-primitive-values)).
         * If set to `true`, the selected value has to be of a primitive value.
         */
        this.valuePrimitive = false;
        /**
         * A function that is executed for each data item and determines if a specific item is disabled.
         */
        this.itemDisabled = itemDisabled;
        /**
         * A callback which determines whether a tree node should be rendered as hidden. The utility .k-display-none class is used to hide the nodes.
         * Useful for custom filtering implementations.
         */
        this.isNodeVisible = isNodeVisible;
        /**
         * Indicates whether the child nodes will be fetched on node expand or will be initially prefetched.
         * @default true
         */
        this.loadOnDemand = true;
        /**
         * Renders the built-in input element for filtering the DropDownTree.
         * If set to `true`, the component emits the `filterChange` event, which can be used to [filter the DropDownTree manually]({% slug filtering_ddt %}#toc-manual-filtering).
         * A built-in filtering implementation is available to use with the [`kendoDropDownTreeHierarchyBinding`]({% slug api_dropdowns_dropdowntreehierarchybindingdirective %}) and [`kendoDropDownTreeFlatBinding`]({% slug api_dropdowns_dropdowntreeflatbindingdirective %}) directives.
         */
        this.filterable = false;
        /**
         * @hidden
         */
        this.filter = '';
        /**
         * @hidden
         *
         * Used by the kendo-label and kendo-floatinglabel to access and associate the focusable element with the provided label via aria-labelledby.
         */
        this.focusableId = `k-${guid()}`;
        /**
         * @hidden
         */
        this.selectedKeys = [];
        /**
         * @hidden
         */
        this.filterStateChange = new EventEmitter();
        /**
         * @hidden
         */
        this.allNodesHidden = false;
        /**
         * @hidden
         *
         * Used to associate the value label with the wrapper via aria-describedby.
         */
        this.valueLabelId = `k-${guid()}`;
        this._popupSettings = DEFAULT_POPUP_SETTINGS;
        this._tabindex = 0;
        this._isFocused = false;
        this._size = 'medium';
        this._rounded = 'medium';
        this._fillMode = 'solid';
        this.subscriptions = [];
        this.onTouchedCallback = noop;
        this.onChangeCallback = noop;
        this.direction = localization.rtl ? 'rtl' : 'ltr';
        this.subscribeEvents();
        this.subscribeTouchEvents();
        this.subscribeFocusEvents();
    }
    get isDisabled() {
        return this.disabled;
    }
    get isLoading() {
        return this.loading;
    }
    get id() {
        return this.focusableId;
    }
    get hostTabIndex() {
        return this.tabindex;
    }
    get isAriaExpanded() {
        return this.isOpen;
    }
    get isReadonly() {
        return this.readonly;
    }
    /**
     * @hidden
     */
    handleClick() {
        this.togglePopup(!this.isOpen);
    }
    /**
     * @hidden
     */
    handleKeydown(event) {
        if (this.disabled || this.readonly) {
            return;
        }
        const eventData = event;
        this.navigationService.process({
            originalEvent: eventData
        });
    }
    set treeview(treeview) {
        if (treeview) {
            if (this.isFocused && !this.filterable || this.touchEnabled) {
                treeview.focus();
            }
            // the treeview animations are initially disabled (we don't want expand animations during popup opening)
            // re-enables the animations for user interaction
            treeview.animate = true;
            this._treeview = treeview;
        }
    }
    get treeview() {
        return this._treeview;
    }
    /**
     * Sets the data of the DropDownTree.
     *
     * > The data has to be provided in an array-like list with objects.
     */
    set data(data) {
        this._nodes = data;
        this.setState();
    }
    get data() {
        return this._nodes;
    }
    /**
     * Sets the value of the DropDownTree.
     * It can either be of the primitive (string, numbers) or of the complex (objects) type.
     * To define the type, use the `valuePrimitive` option.
     *
     */
    set value(newValue) {
        this._value = newValue;
        this.setState();
    }
    get value() {
        return this._value;
    }
    /**
     * Configures the popup of the DropDownTree.
     *
     * The available options are:
     * - `animate: Boolean`&mdash;Controls the popup animation. By default, the open and close animations are enabled.
     * - `width: Number | String`&mdash;Sets the width of the popup container. By default, the width of the host element is used. If set to `auto`, the component automatically adjusts the width of the popup and no item labels are wrapped.
     * - `height: Number`&mdash;Sets the height of the popup container.
     * - `popupClass: String`&mdash;Specifies a list of CSS classes that are used to style the popup.
     * - `appendTo: "root" | "component" | ViewContainerRef`&mdash;Specifies the component to which the popup will be appended.
     */
    set popupSettings(settings) {
        this._popupSettings = Object.assign({}, DEFAULT_POPUP_SETTINGS, settings);
    }
    get popupSettings() {
        return this._popupSettings;
    }
    /**
     * Keeps the current `dataItem` object in order to resolve selection.
     * Needs to be provided when `value` is bound in and `valuePrimitive` is set to true.
     */
    set dataItem(item) {
        this._dataItem = item;
        this.setState();
    }
    get dataItem() {
        return this._dataItem ? this._dataItem : this.value;
    }
    /**
     * Specifies the [`tabindex`](https://developer.mozilla.org/en-US/docs/Web/HTML/Global_attributes/tabindex) of the component.
     */
    set tabindex(value) {
        const providedTabIndex = Number(value);
        const defaultTabIndex = 0;
        this._tabindex = !isNaN(providedTabIndex) ? providedTabIndex : defaultTabIndex;
    }
    get tabindex() {
        return this.disabled ? -1 : this._tabindex;
    }
    /**
     * Sets the size of the component.
     *
     * The possible values are:
     * * `'small'`
     * * `'medium'` (default)
     * * `'large'`
     * * `null`
     *
     */
    set size(size) {
        this.renderer.removeClass(this.wrapper.nativeElement, getSizeClass('picker', this.size));
        if (size) {
            this.renderer.addClass(this.wrapper.nativeElement, getSizeClass('picker', size));
        }
        this._size = size;
    }
    get size() {
        return this._size;
    }
    /**
     * Sets the border radius of the component.
     *
     * The possible values are:
     * * `'small'`
     * * `'medium'` (default)
     * * `'large'`
     * * `'full'`
     * * `null`
     *
     */
    set rounded(rounded) {
        this.renderer.removeClass(this.wrapper.nativeElement, getRoundedClass(this.rounded));
        if (rounded) {
            this.renderer.addClass(this.wrapper.nativeElement, getRoundedClass(rounded));
        }
        this._rounded = rounded;
    }
    get rounded() {
        return this._rounded;
    }
    /**
     * Sets the fillMode of the component.
     *
     * The possible values are:
     * * `'flat'`
     * * `'solid'` (default)
     * * `'outline'`
     * * `null`
     *
     */
    set fillMode(fillMode) {
        this.renderer.removeClass(this.wrapper.nativeElement, getFillModeClass('picker', this.fillMode));
        if (fillMode) {
            this.renderer.addClass(this.wrapper.nativeElement, getFillModeClass('picker', fillMode));
        }
        this._fillMode = fillMode;
    }
    get fillMode() {
        return this._fillMode;
    }
    set isFocused(isFocused) {
        this.renderer[isFocused ? 'addClass' : 'removeClass'](this.wrapper.nativeElement, 'k-focus');
        this._isFocused = isFocused;
    }
    get isFocused() {
        return this._isFocused;
    }
    get width() {
        const wrapperWidth = this.wrapper.nativeElement.offsetWidth;
        const width = this.popupSettings.width || wrapperWidth;
        const minWidth = isNaN(wrapperWidth) ? wrapperWidth : `${wrapperWidth}px`;
        const maxWidth = isNaN(width) ? width : `${width}px`;
        return { min: minWidth, max: maxWidth };
    }
    get height() {
        const popupHeight = this.popupSettings.height;
        return isPresent(popupHeight) ? `${popupHeight}px` : 'auto';
    }
    /**
     * Returns the current open state of the popup.
     */
    get isOpen() {
        return isPresent(this.popupRef);
    }
    get clearButtonVisiblity() {
        if (this.touchEnabled) {
            return 'visible';
        }
    }
    /**
     * @hidden
     *
     * Alias for `isNodeExpanded`. Used for compatibility with the `ExpandableComponent` interface.
     * Required for the expand-directive.
     */
    set isExpanded(callback) {
        this.isNodeExpanded = callback;
    }
    get isExpanded() {
        return this.isNodeExpanded;
    }
    /**
     * @hidden
     *
     * Alias for `nodeExpand`. Used for compatibility with the `ExpandableComponent` interface.
     * Required for the expand-directive.
     */
    get expand() {
        return this.nodeExpand;
    }
    /**
     * @hidden
     *
     * Alias for `nodeCollapse`. Used for compatibility with the `ExpandableComponent` interface.
     * Required for the expand-directive.
     */
    get collapse() {
        return this.nodeCollapse;
    }
    /**
     * @hidden
     *
     * Alias for `data`. Used for compatibility with the `DataBoundComponent` interface.
     * Required for the data-binding directives.
     */
    set nodes(nodes) {
        this.data = nodes;
    }
    get nodes() {
        return this.data;
    }
    /**
     * @hidden
     *
     * Alias for `fetchChildren`. Used for compatibility with the `DataBoundComponent` interface.
     * Required for the data-binding directives
     */
    set children(callback) {
        this.fetchChildren = callback;
    }
    get children() {
        return this.fetchChildren;
    }
    /**
     * @hidden
     *
     * Alias for `isNodeVisible`. Used for compatibility with the `DataBoundComponent` interface.
     * The `DataBoundComponent` interface is used in the data-binding directives.
     */
    set isVisible(callback) {
        this.isNodeVisible = callback;
    }
    get isVisible() {
        return this.isNodeVisible;
    }
    ngOnInit() {
        this.renderer.removeAttribute(this.wrapper.nativeElement, 'tabindex');
        this.assignAriaDescribedBy();
        this.subscriptions.push(this.localization
            .changes.subscribe(({ rtl }) => {
            this.direction = rtl ? 'rtl' : 'ltr';
            this.cdr.markForCheck();
        }));
        this.setComponentClasses();
    }
    /**
     * @hidden
     */
    ngOnDestroy() {
        this.destroyPopup();
        this.unsubscribeEvents();
    }
    /**
     * @hidden
     */
    ngOnChanges(changes) {
        if (anyChanged(['textField', 'valueField', 'valuePrimitive'], changes, false)) {
            this.setState();
        }
    }
    /**
     * @hidden
     */
    ngAfterContentChecked() {
        this.verifySettings();
    }
    /**
     * @hidden
     *
     * Used by the kendo-floatinglabel component to determine if the floating label
     * should be rendered inside the input when the component is not focused.
     */
    isEmpty() {
        return !this.text && !this.placeholder;
    }
    /**
     * @hidden
     */
    togglePopup(open) {
        const isDisabled = this.disabled || this.readonly;
        const sameState = this.isOpen === open;
        if (isDisabled || sameState) {
            return;
        }
        const togglePrevented = this.triggerPopupEvents(open);
        if (!togglePrevented) {
            open ?
                this.createPopup() :
                this.destroyPopup();
        }
    }
    /**
     * @hidden
     */
    handleFocus(event) {
        if (event.target !== this.wrapper.nativeElement) {
            return;
        }
        event.stopImmediatePropagation();
        if (!this.isFocused) {
            this.isFocused = true;
            if (hasObservers(this.onFocus)) {
                this._zone.run(() => {
                    this.onFocus.emit();
                });
            }
        }
    }
    /**
     * @hidden
     */
    handleBlur(e) {
        const relatedTarget = e && e.relatedTarget;
        if (this.wrapper.nativeElement.contains(relatedTarget) ||
            (this.isOpen && this.popupRef.popupElement.contains(relatedTarget))) {
            return;
        }
        this.isFocused = false;
        if (hasObservers(this.onBlur) ||
            isUntouched(this.wrapper.nativeElement)) {
            this._zone.run(() => {
                this.togglePopup(false);
                this.onBlur.emit();
                this.onTouchedCallback();
            });
        }
        else {
            this.togglePopup(false);
        }
    }
    /**
     * Focuses a specific item of the DropDownTree based on a provided index in the format of `1_1`.
     * The targeted item should be expanded in order for it to be focused.
     * If null or invalid index is provided the focus will be set on the first item.
     */
    focusItemAt(index) {
        if (this.treeview) {
            const lookup = this.treeview.itemLookup(index);
            let isItemDisabled = !isPresent(lookup) || this.treeview.isDisabled(lookup.item.dataItem, lookup.item.index);
            if (!isItemDisabled) {
                this.treeview.focus(index);
            }
        }
    }
    /**
     * Focuses the DropDownTree.
     */
    focus() {
        if (!this.disabled) {
            this.wrapper.nativeElement.focus();
        }
    }
    /**
     * Blurs the DropDownTree.
     */
    blur() {
        if (!this.disabled) {
            this.wrapper.nativeElement.blur();
        }
    }
    /**
     * Resets the value of the DropDownTree.
     * If you use the `reset` method to clear the value of the component,
     * the model will not update automatically and the `valueChange` event will not be fired.
     */
    reset() {
        this.value = undefined;
        this.dataItem = undefined;
    }
    /**
     * Toggles the visibility of the popup
     * ([see example]({% slug openstate_ddt %})).
     * If you use the `toggle` method to open or close the popup, the `open` and `close` events will not be fired.
     *
     * @param open - The state of the popup.
     */
    toggle(open) {
        // The Promise is required to open the popup on load.
        // Otherwise, the "ViewContainerRef not found..." error will be thrown.
        Promise.resolve(null).then(() => {
            const shouldOpen = isPresent(open) ? open : !isPresent(this.popupRef);
            this.destroyPopup();
            if (shouldOpen) {
                this.createPopup();
            }
        });
    }
    /**
     * @hidden
     */
    get popupContainerClasses() {
        const containerClasses = ['k-popup-dropdowntree'];
        if (this.popupSettings.popupClass) {
            containerClasses.push(this.popupSettings.popupClass);
        }
        return containerClasses;
    }
    /**
     * @hidden
     */
    onSelectionChange({ dataItem, index }) {
        this.valueDepth = index.split('_').length - 1;
        const valueField = this.getField(this.valueField, dataItem);
        const newValue = this.valuePrimitive ?
            getter(valueField)(dataItem) :
            dataItem;
        const shouldUpdateValue = newValue !== this.value;
        if (shouldUpdateValue) {
            this.value = newValue;
            this.dataItem = dataItem;
            this.emitValueChange(this.value);
        }
        this.togglePopup(false);
        this.focus();
    }
    /**
     * @hidden
     */
    messageFor(key) {
        return this.localization.get(key);
    }
    /**
     * @hidden
     */
    clearValue(event) {
        event.stopImmediatePropagation();
        this.focus();
        this.value = undefined;
        this.dataItem = undefined;
        this.clearState();
        this.valueChange.emit(undefined);
        this.emitValueChange();
    }
    get appendTo() {
        const { appendTo } = this.popupSettings;
        if (!appendTo || appendTo === 'root') {
            return undefined;
        }
        return appendTo === 'component' ? this.container : appendTo;
    }
    /**
     * @hidden
     */
    preventEventDefault(event) {
        event.preventDefault();
    }
    /**
     * @hidden
     */
    writeValue(value) {
        // If the user resets the value by providing null/undefined we need to reset the `dataItem`
        // Because upon initialization of the component the `writeValue` is being called twice -
        // first time with `null` value regardless of sync/async value - an extra check is added to
        // distinguish between client reset and initial phanotm 'null' value
        if (!isPresent(value) && isPresent(this.value)) {
            this.dataItem = null;
        }
        this.value = value === null ? undefined : value;
    }
    /**
     * @hidden
     */
    registerOnChange(fn) {
        this.onChangeCallback = fn;
    }
    /**
     * @hidden
     */
    registerOnTouched(fn) {
        this.onTouchedCallback = fn;
    }
    /**
     * @hidden
     */
    setDisabledState(isDisabled) {
        this.disabled = isDisabled;
        this.cdr.markForCheck();
    }
    /**
     * @hidden
     */
    handleFilterInputChange(term) {
        this.filterChange.next(term);
        this.allNodesHidden = this.nodes.every((node, index) => !this.isVisible(node, String(index)));
    }
    /**
     * @hidden
     */
    get buttonClasses() {
        return this.loading ? 'k-i-loading' : 'k-i-arrow-s';
    }
    /**
     * @hidden
     */
    get selectButtonClasses() {
        return `${this.size ? getSizeClass('button', this.size) : ''} ${this.fillMode ? 'k-button-' + this.fillMode : ''} ${this.fillMode ? 'k-button-' + this.fillMode + '-base' : ''}`;
    }
    /**
     * @hidden
     */
    get filterInputClasses() {
        return `${this.size ? getSizeClass('input', this.size) : ''} ${this.fillMode ? 'k-input-' + this.fillMode : ''} ${this.rounded ? getRoundedClass(this.rounded) : ''}`;
    }
    verifySettings() {
        if (!isDevMode()) {
            return;
        }
        if (this.valuePrimitive === true && isPresent(this.value) && typeof this.value === "object") {
            throw new Error(DropDownTreeMessages.primitive);
        }
        if (this.valuePrimitive === true && isPresent(this.value) && typeof this.dataItem !== "object") {
            throw new Error(DropDownTreeMessages.dataItem);
        }
        if (this.valuePrimitive === false && isPresent(this.value) && typeof this.value !== "object") {
            throw new Error(DropDownTreeMessages.object);
        }
        if (!isPresent(this.valueField) || !isPresent(this.textField)) {
            throw new Error(DropDownTreeMessages.textAndValue);
        }
        if ((isArray(this.valueField) || isArray(this.textField)) && isPresent(this.value) && !isPresent(this.valueDepth)) {
            throw new Error(DropDownTreeMessages.valueDepth);
        }
    }
    emitValueChange(value) {
        this.onChangeCallback(value);
        this.valueChange.emit(value);
    }
    getText(textField, dataItem) {
        if (isPresent(dataItem) && isPresent(textField)) {
            const field = this.getField(textField, dataItem);
            return getter(field)(dataItem);
        }
        return null;
    }
    /**
     * @hidden
     *
     * Determines the `valueField` and `textField` for a specific level in the data set
     *  @param field - the field value (string | string[])
     *  @param value - current value
     */
    getField(field, value) {
        const fieldsCount = field.length - 1;
        if (typeof field === 'string') {
            // If the `valueField` | `textField` is the same for all levels
            return field;
        }
        else if (isPresent(this.valueDepth)) {
            // When `valueDepth` can be defined from the index on selectionChange or provided by the user
            return fieldsCount < this.valueDepth ? field[fieldsCount] : field[this.valueDepth];
        }
        else {
            // Fallback: Look to find a match of each field in the current data item
            // Side effect may occur if all of the listed fields are present in the data item
            return field.find(item => item in value);
        }
    }
    triggerPopupEvents(open) {
        const eventArgs = new PreventableEvent();
        if (open) {
            this.open.emit(eventArgs);
        }
        else {
            this.close.emit(eventArgs);
        }
        return eventArgs.isDefaultPrevented();
    }
    createPopup() {
        const horizontalAlign = this.direction === "rtl" ? "right" : "left";
        const anchorPosition = { horizontal: horizontalAlign, vertical: 'bottom' };
        const popupPosition = { horizontal: horizontalAlign, vertical: 'top' };
        this.popupRef = this.popupService.open({
            anchor: this.wrapper,
            appendTo: this.appendTo,
            anchorAlign: anchorPosition,
            content: this.popupTemplate,
            popupAlign: popupPosition,
            positionMode: 'absolute',
            popupClass: this.popupContainerClasses
        });
        const popupWrapper = this.popupRef.popupElement;
        const { min, max } = this.width;
        popupWrapper.style.minWidth = min;
        popupWrapper.style.width = max;
        popupWrapper.style.height = this.height;
        popupWrapper.setAttribute("dir", this.direction);
        this.popupRef.popupOpen.subscribe(() => {
            this.cdr.detectChanges();
            this.opened.emit();
        });
        this.popupRef.popupClose.subscribe(() => {
            this.closed.emit();
        });
    }
    destroyPopup() {
        if (this.popupRef) {
            this.popupRef.close();
            this.popupRef = null;
            if (this.filter !== "") {
                this.filter = "";
                this.allNodesHidden = false;
                if (hasObservers(this.filterChange)) {
                    this._zone.run(() => {
                        this.filterChange.emit("");
                    });
                }
            }
        }
    }
    handleEscape() {
        this.togglePopup(false);
        this.focus();
    }
    setState() {
        if (isPresent(this.value) && isPresent(this.dataItem) && isPresent(this.valueField)) {
            this.text = this.getText(this.textField, this.dataItem);
            const valueField = this.getField(this.valueField, this.dataItem);
            this.selectBy = valueField;
            this.selectedKeys = [getter(valueField)(this.dataItem)];
        }
        else {
            this.clearState();
        }
        this.cdr.markForCheck();
    }
    clearState() {
        this.text = undefined;
        this.selectedKeys = [];
    }
    subscribeEvents() {
        this.subscriptions.push(this.navigationService.open.subscribe(() => this.togglePopup(true)), this.navigationService.close.subscribe(() => {
            this.togglePopup(false);
            this.focus();
        }), this.navigationService.enter
            .pipe(tap((event) => event.originalEvent.preventDefault()))
            .subscribe(() => this.togglePopup(true)), this.navigationService.esc
            .subscribe(() => this.handleEscape()), this.navigationService.tab.subscribe(() => this.focus()), this.navigationService.down.subscribe((event) => {
            if (!this.treeview) {
                return;
            }
            event.originalEvent.preventDefault();
            if (!this.treeview.isActive) {
                this.treeview.focus();
            }
        }), this.navigationService.up.subscribe((event) => {
            if (!this.treeview) {
                return;
            }
            event.originalEvent.preventDefault();
            if (this.filterable && this.treeview['navigationService']['activeIndex'] === '0') {
                this.filterInput.nativeElement.focus();
            }
        }));
    }
    subscribeTouchEvents() {
        if (!isDocumentAvailable() || !this.touchEnabled) {
            return;
        }
        this._zone.runOutsideAngular(() => 
        // Roll up DropDownTree on iOS when tapped outside
        this.touchstartDisposeHandler = this.renderer.listen(document, 'touchstart', (e) => {
            const target = e.target;
            if (this.isFocused && !inDropDown(this.wrapper, target, this.popupRef)) {
                this._zone.run(() => {
                    if (this.isOpen) {
                        this.treeview.blur();
                    }
                    this.blur();
                });
            }
        }));
    }
    subscribeFocusEvents() {
        if (isDocumentAvailable()) {
            this.handleFocus = this.handleFocus.bind(this);
            this.handleDocumentBlur = this.handleDocumentBlur.bind(this);
            this._zone.runOutsideAngular(() => {
                const useCapture = true;
                document.addEventListener('focus', this.handleFocus, useCapture);
                document.addEventListener('blur', this.handleDocumentBlur, useCapture);
            });
        }
    }
    unSubscribeFocusEvents() {
        if (isDocumentAvailable()) {
            const useCapture = true;
            document.removeEventListener('focus', this.handleFocus, useCapture);
            document.removeEventListener('blur', this.handleDocumentBlur, useCapture);
        }
    }
    unsubscribeEvents() {
        this.subscriptions.forEach(sub => sub.unsubscribe());
        this.unSubscribeFocusEvents();
        if (this.touchstartDisposeHandler) {
            this.touchstartDisposeHandler();
        }
    }
    handleDocumentBlur(event) {
        if (event.target !== this.wrapper.nativeElement) {
            return;
        }
        event.stopImmediatePropagation();
        this.handleBlur(event);
    }
    assignAriaDescribedBy() {
        const currentValue = this.wrapper.nativeElement.getAttribute('aria-describedby') || '';
        // add to the current value - don't replace it (the aria-describedby is used by the FormField component as well)
        const newValue = `${this.valueLabelId} ${currentValue.trim()}`.trim();
        this.renderer.setAttribute(this.wrapper.nativeElement, 'aria-describedby', newValue);
    }
    setComponentClasses() {
        if (this.size) {
            this.renderer.addClass(this.wrapper.nativeElement, getSizeClass('picker', this.size));
        }
        if (this.rounded) {
            this.renderer.addClass(this.wrapper.nativeElement, getRoundedClass(this.rounded));
        }
        if (this.fillMode) {
            this.renderer.addClass(this.wrapper.nativeElement, getFillModeClass('picker', this.fillMode));
        }
    }
};
DropDownTreeComponent.ɵfac = function DropDownTreeComponent_Factory(t) { return new (t || DropDownTreeComponent)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ElementRef), ɵngcc0.ɵɵdirectiveInject(ɵngcc4.PopupService), ɵngcc0.ɵɵdirectiveInject(NavigationService), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.Renderer2), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.NgZone), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ChangeDetectorRef), ɵngcc0.ɵɵdirectiveInject(ɵngcc1.LocalizationService), ɵngcc0.ɵɵdirectiveInject(TOUCH_ENABLED, 8)); };
DropDownTreeComponent.ɵcmp = /*@__PURE__*/ ɵngcc0.ɵɵdefineComponent({ type: DropDownTreeComponent, selectors: [["kendo-dropdowntree"]], contentQueries: function DropDownTreeComponent_ContentQueries(rf, ctx, dirIndex) { if (rf & 1) {
        ɵngcc0.ɵɵcontentQuery(dirIndex, NoDataTemplateDirective, 5);
        ɵngcc0.ɵɵcontentQuery(dirIndex, HeaderTemplateDirective, 5);
        ɵngcc0.ɵɵcontentQuery(dirIndex, FooterTemplateDirective, 5);
        ɵngcc0.ɵɵcontentQuery(dirIndex, NodeTemplateDirective, 5);
        ɵngcc0.ɵɵcontentQuery(dirIndex, ValueTemplateDirective, 5);
    } if (rf & 2) {
        let _t;
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.noDataTemplate = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.headerTemplate = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.footerTemplate = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.nodeTemplate = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.valueTemplate = _t.first);
    } }, viewQuery: function DropDownTreeComponent_Query(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵviewQuery(_c40, 5);
        ɵngcc0.ɵɵviewQuery(_c9, 7);
        ɵngcc0.ɵɵviewQuery(_c8, 7, ViewContainerRef);
        ɵngcc0.ɵɵviewQuery(_c41, 5);
    } if (rf & 2) {
        let _t;
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.treeview = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.popupTemplate = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.container = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.filterInput = _t.first);
    } }, hostVars: 17, hostBindings: function DropDownTreeComponent_HostBindings(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵlistener("click", function DropDownTreeComponent_click_HostBindingHandler() { return ctx.handleClick(); })("keydown", function DropDownTreeComponent_keydown_HostBindingHandler($event) { return ctx.handleKeydown($event); });
    } if (rf & 2) {
        ɵngcc0.ɵɵattribute("role", ctx.role)("aria-haspopup", ctx.ariaHasPopup)("dir", ctx.direction)("aria-disabled", ctx.isDisabled)("id", ctx.id)("tabindex", ctx.hostTabIndex)("aria-expanded", ctx.isAriaExpanded)("readonly", ctx.isReadonly)("aria-readonly", ctx.isReadonly);
        ɵngcc0.ɵɵclassProp("k-dropdowntree", ctx.hostClasses)("k-picker", ctx.hostClasses)("k-disabled", ctx.isDisabled)("k-loading", ctx.isLoading);
    } }, inputs: { clearButton: "clearButton", hasChildren: "hasChildren", fetchChildren: "fetchChildren", placeholder: "placeholder", listHeight: "listHeight", disabled: "disabled", readonly: "readonly", valuePrimitive: "valuePrimitive", itemDisabled: "itemDisabled", isNodeVisible: "isNodeVisible", loadOnDemand: "loadOnDemand", filterable: "filterable", filter: "filter", focusableId: "focusableId", data: "data", value: "value", popupSettings: "popupSettings", dataItem: "dataItem", tabindex: "tabindex", size: "size", rounded: "rounded", fillMode: "fillMode", isNodeExpanded: "isNodeExpanded", valueDepth: "valueDepth", loading: "loading", textField: "textField", valueField: "valueField" }, outputs: { open: "open", opened: "opened", close: "close", closed: "closed", nodeExpand: "nodeExpand", nodeCollapse: "nodeCollapse", onFocus: "focus", onBlur: "blur", valueChange: "valueChange", filterChange: "filterChange" }, exportAs: ["kendoDropDownTree"], features: [ɵngcc0.ɵɵProvidersFeature([
            DataService,
            SelectionService,
            NavigationService,
            DisabledItemsService,
            LocalizationService,
            {
                provide: L10N_PREFIX,
                useValue: 'kendo.dropdowntree'
            },
            {
                multi: true,
                provide: NG_VALUE_ACCESSOR,
                useExisting: forwardRef(() => DropDownTreeComponent_1)
            },
            {
                provide: KendoInput,
                useExisting: forwardRef(() => DropDownTreeComponent_1)
            },
            {
                provide: DataBoundComponent,
                useExisting: forwardRef(() => DropDownTreeComponent_1)
            },
            {
                provide: ExpandableComponent,
                useExisting: forwardRef(() => DropDownTreeComponent_1)
            }
        ]), ɵngcc0.ɵɵNgOnChangesFeature], decls: 12, vars: 7, consts: function () { let i18n_42; if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
        /**
         * @desc The text displayed in the popup when there are no items
         * @meaning kendo.dropdowntree.noDataText
         */
        const MSG_EXTERNAL_8377764809518564323$$DIST_FESM2015_INDEX_JS_43 = goog.getMsg("NO DATA FOUND");
        i18n_42 = MSG_EXTERNAL_8377764809518564323$$DIST_FESM2015_INDEX_JS_43;
    }
    else {
        i18n_42 = $localize `:kendo.dropdowntree.noDataText|The text displayed in the popup when there are no items␟b5507b240a829a596159da3600ea1c73810d8708␟8377764809518564323:NO DATA FOUND`;
    } let i18n_44; if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
        /**
         * @desc The title of the clear button
         * @meaning kendo.dropdowntree.clearTitle
         */
        const MSG_EXTERNAL_5091538317194981642$$DIST_FESM2015_INDEX_JS_45 = goog.getMsg("clear");
        i18n_44 = MSG_EXTERNAL_5091538317194981642$$DIST_FESM2015_INDEX_JS_45;
    }
    else {
        i18n_44 = $localize `:kendo.dropdowntree.clearTitle|The title of the clear button␟549a21c02a5be9711c5297a917390d5f4c06448b␟5091538317194981642:clear`;
    } let i18n_46; if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
        /**
         * @desc The text set as aria-label on the select button
         * @meaning kendo.dropdowntree.selectButtonText
         */
        const MSG_EXTERNAL_7607456189720144875$$DIST_FESM2015_INDEX_JS_47 = goog.getMsg("Select");
        i18n_46 = MSG_EXTERNAL_7607456189720144875$$DIST_FESM2015_INDEX_JS_47;
    }
    else {
        i18n_46 = $localize `:kendo.dropdowntree.selectButtonText|The text set as aria-label on the select button␟21b7c8cbddfdd8513e788c3bddb60ebe8234a4b9␟7607456189720144875:Select`;
    } return [["kendoDropDownTreeLocalizedMessages", "", "noDataText", i18n_42, "clearTitle", i18n_44, "selectButtonText", i18n_46], ["role", "option", 1, "k-input-inner"], [1, "k-input-value-text"], [4, "ngIf"], [3, "ngIf"], ["class", "k-clear-value", "aria-hidden", "true", 3, "visibility", "click", 4, "ngIf"], ["tabindex", "-1", "type", "button", "aria-hidden", "true", 1, "k-input-button", "k-button", "k-icon-button", 3, "ngClass"], [1, "k-button-icon", "k-icon", 3, "ngClass"], ["popupTemplate", ""], ["container", ""], [3, "templateContext"], ["aria-hidden", "true", 1, "k-clear-value", 3, "click"], [1, "k-icon", "k-i-x"], ["class", "k-list-filter", 4, "ngIf"], ["kendoTreeViewSelectable", "", 3, "size", "nodes", "maxHeight", "animate", "selectedKeys", "selectBy", "textField", "children", "hasChildren", "loadOnDemand", "isExpanded", "isDisabled", "nodeTemplate", "filter", "isVisible", "selectedKeysChange", "focusout", "keydown", "selectionChange", "expand", "collapse", 4, "ngIf"], ["class", "k-no-data", 4, "ngIf"], [1, "k-list-filter"], [1, "k-textbox", "k-input", 3, "ngClass"], [1, "k-input-prefix"], [1, "k-input-icon", "k-icon", "k-i-search"], ["role", "textbox", "aria-haspopup", "true", "aria-expanded", "false", "tabindex", "0", "aria-disabled", "false", "aria-readonly", "false", 1, "k-input-inner", 3, "filterInput", "ngModel", "kendoEventsOutsideAngular", "scope", "input", "keydown.arrowdown", "keydown.alt.arrowup", "ngModelChange"], ["filterInput", ""], ["kendoTreeViewSelectable", "", 3, "size", "nodes", "animate", "selectedKeys", "selectBy", "textField", "children", "hasChildren", "loadOnDemand", "isExpanded", "isDisabled", "nodeTemplate", "filter", "isVisible", "selectedKeysChange", "focusout", "keydown", "selectionChange", "expand", "collapse"], ["treeview", ""], [1, "k-no-data"], [3, "ngIf", "templateContext"]]; }, template: function DropDownTreeComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵelementContainer(0, 0);
        ɵngcc0.ɵɵelementStart(1, "span", 1)(2, "span", 2);
        ɵngcc0.ɵɵtemplate(3, DropDownTreeComponent_3_Template, 1, 4, null, 3);
        ɵngcc0.ɵɵtemplate(4, DropDownTreeComponent_ng_template_4_Template, 1, 1, "ng-template", 4);
        ɵngcc0.ɵɵelementEnd()();
        ɵngcc0.ɵɵtemplate(5, DropDownTreeComponent_span_5_Template, 2, 3, "span", 5);
        ɵngcc0.ɵɵelementStart(6, "button", 6);
        ɵngcc0.ɵɵelement(7, "span", 7);
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵtemplate(8, DropDownTreeComponent_ng_template_8_Template, 5, 5, "ng-template", null, 8, ɵngcc0.ɵɵtemplateRefExtractor);
        ɵngcc0.ɵɵelementContainer(10, null, 9);
    } if (rf & 2) {
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵattribute("id", ctx.valueLabelId);
        ɵngcc0.ɵɵadvance(2);
        ɵngcc0.ɵɵproperty("ngIf", ctx.valueTemplate);
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngIf", !ctx.valueTemplate);
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngIf", !ctx.loading && !ctx.readonly && ctx.clearButton && (ctx.text == null ? null : ctx.text.length) && !ctx.disabled);
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngClass", ctx.selectButtonClasses);
        ɵngcc0.ɵɵattribute("aria-label", ctx.messageFor("selectButtonText"));
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngClass", ctx.buttonClasses);
    } }, directives: function () { return [LocalizedMessagesDirective, ɵngcc3.NgIf, TemplateContextDirective, ɵngcc3.NgClass, ɵngcc5.DefaultValueAccessor, FilterInputDirective, ɵngcc5.NgControlStatus, ɵngcc5.NgModel, ɵngcc2.EventsOutsideAngularDirective, ɵngcc6.TreeViewComponent, ɵngcc6.SelectDirective]; }, encapsulation: 2, changeDetection: 0 });
__decorate([
    HostBinding('class.k-dropdowntree'),
    HostBinding('class.k-picker'),
    __metadata("design:type", Boolean)
], DropDownTreeComponent.prototype, "hostClasses", void 0);
__decorate([
    HostBinding('class.k-disabled'),
    HostBinding('attr.aria-disabled'),
    __metadata("design:type", Boolean),
    __metadata("design:paramtypes", [])
], DropDownTreeComponent.prototype, "isDisabled", null);
__decorate([
    HostBinding('class.k-loading'),
    __metadata("design:type", Boolean),
    __metadata("design:paramtypes", [])
], DropDownTreeComponent.prototype, "isLoading", null);
__decorate([
    HostBinding('attr.id'),
    __metadata("design:type", String),
    __metadata("design:paramtypes", [])
], DropDownTreeComponent.prototype, "id", null);
__decorate([
    HostBinding('attr.dir'),
    __metadata("design:type", String)
], DropDownTreeComponent.prototype, "direction", void 0);
__decorate([
    HostBinding('attr.tabindex'),
    __metadata("design:type", Number),
    __metadata("design:paramtypes", [])
], DropDownTreeComponent.prototype, "hostTabIndex", null);
__decorate([
    HostBinding('attr.role'),
    __metadata("design:type", String)
], DropDownTreeComponent.prototype, "role", void 0);
__decorate([
    HostBinding('attr.aria-haspopup'),
    __metadata("design:type", String)
], DropDownTreeComponent.prototype, "ariaHasPopup", void 0);
__decorate([
    HostBinding('attr.aria-expanded'),
    __metadata("design:type", Boolean),
    __metadata("design:paramtypes", [])
], DropDownTreeComponent.prototype, "isAriaExpanded", null);
__decorate([
    HostBinding('attr.readonly'),
    HostBinding('attr.aria-readonly'),
    __metadata("design:type", Boolean),
    __metadata("design:paramtypes", [])
], DropDownTreeComponent.prototype, "isReadonly", null);
__decorate([
    HostListener('click'),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", []),
    __metadata("design:returntype", void 0)
], DropDownTreeComponent.prototype, "handleClick", null);
__decorate([
    HostListener('keydown', ['$event']),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [Object]),
    __metadata("design:returntype", void 0)
], DropDownTreeComponent.prototype, "handleKeydown", null);
__decorate([
    ContentChild(NoDataTemplateDirective, { static: false }),
    __metadata("design:type", NoDataTemplateDirective)
], DropDownTreeComponent.prototype, "noDataTemplate", void 0);
__decorate([
    ContentChild(HeaderTemplateDirective, { static: false }),
    __metadata("design:type", HeaderTemplateDirective)
], DropDownTreeComponent.prototype, "headerTemplate", void 0);
__decorate([
    ContentChild(FooterTemplateDirective, { static: false }),
    __metadata("design:type", FooterTemplateDirective)
], DropDownTreeComponent.prototype, "footerTemplate", void 0);
__decorate([
    ContentChild(NodeTemplateDirective, { static: false }),
    __metadata("design:type", NodeTemplateDirective)
], DropDownTreeComponent.prototype, "nodeTemplate", void 0);
__decorate([
    ContentChild(ValueTemplateDirective, { static: false }),
    __metadata("design:type", ValueTemplateDirective)
], DropDownTreeComponent.prototype, "valueTemplate", void 0);
__decorate([
    ViewChild('popupTemplate', { static: true }),
    __metadata("design:type", TemplateRef)
], DropDownTreeComponent.prototype, "popupTemplate", void 0);
__decorate([
    ViewChild('container', { read: ViewContainerRef, static: true }),
    __metadata("design:type", ViewContainerRef)
], DropDownTreeComponent.prototype, "container", void 0);
__decorate([
    ViewChild('treeview', { static: false }),
    __metadata("design:type", TreeViewComponent),
    __metadata("design:paramtypes", [TreeViewComponent])
], DropDownTreeComponent.prototype, "treeview", null);
__decorate([
    ViewChild('filterInput', { static: false }),
    __metadata("design:type", ElementRef)
], DropDownTreeComponent.prototype, "filterInput", void 0);
__decorate([
    Output(),
    __metadata("design:type", EventEmitter)
], DropDownTreeComponent.prototype, "open", void 0);
__decorate([
    Output(),
    __metadata("design:type", EventEmitter)
], DropDownTreeComponent.prototype, "opened", void 0);
__decorate([
    Output(),
    __metadata("design:type", EventEmitter)
], DropDownTreeComponent.prototype, "close", void 0);
__decorate([
    Output(),
    __metadata("design:type", EventEmitter)
], DropDownTreeComponent.prototype, "closed", void 0);
__decorate([
    Output(),
    __metadata("design:type", EventEmitter)
], DropDownTreeComponent.prototype, "nodeExpand", void 0);
__decorate([
    Output(),
    __metadata("design:type", EventEmitter)
], DropDownTreeComponent.prototype, "nodeCollapse", void 0);
__decorate([
    Output('focus'),
    __metadata("design:type", EventEmitter)
], DropDownTreeComponent.prototype, "onFocus", void 0);
__decorate([
    Output('blur'),
    __metadata("design:type", EventEmitter)
], DropDownTreeComponent.prototype, "onBlur", void 0);
__decorate([
    Output(),
    __metadata("design:type", EventEmitter)
], DropDownTreeComponent.prototype, "valueChange", void 0);
__decorate([
    Output(),
    __metadata("design:type", EventEmitter)
], DropDownTreeComponent.prototype, "filterChange", void 0);
__decorate([
    Input(),
    __metadata("design:type", Boolean)
], DropDownTreeComponent.prototype, "loading", void 0);
__decorate([
    Input(),
    __metadata("design:type", Boolean)
], DropDownTreeComponent.prototype, "clearButton", void 0);
__decorate([
    Input(),
    __metadata("design:type", Array),
    __metadata("design:paramtypes", [Array])
], DropDownTreeComponent.prototype, "data", null);
__decorate([
    Input(),
    __metadata("design:type", Object),
    __metadata("design:paramtypes", [Object])
], DropDownTreeComponent.prototype, "value", null);
__decorate([
    Input(),
    __metadata("design:type", Object)
], DropDownTreeComponent.prototype, "textField", void 0);
__decorate([
    Input(),
    __metadata("design:type", Object)
], DropDownTreeComponent.prototype, "valueField", void 0);
__decorate([
    Input(),
    __metadata("design:type", Number)
], DropDownTreeComponent.prototype, "valueDepth", void 0);
__decorate([
    Input(),
    __metadata("design:type", Function)
], DropDownTreeComponent.prototype, "hasChildren", void 0);
__decorate([
    Input(),
    __metadata("design:type", Function)
], DropDownTreeComponent.prototype, "fetchChildren", void 0);
__decorate([
    Input(),
    __metadata("design:type", String)
], DropDownTreeComponent.prototype, "placeholder", void 0);
__decorate([
    Input(),
    __metadata("design:type", Object),
    __metadata("design:paramtypes", [Object])
], DropDownTreeComponent.prototype, "popupSettings", null);
__decorate([
    Input(),
    __metadata("design:type", Object),
    __metadata("design:paramtypes", [Object])
], DropDownTreeComponent.prototype, "dataItem", null);
__decorate([
    Input(),
    __metadata("design:type", Number)
], DropDownTreeComponent.prototype, "listHeight", void 0);
__decorate([
    Input(),
    __metadata("design:type", Boolean)
], DropDownTreeComponent.prototype, "disabled", void 0);
__decorate([
    Input(),
    __metadata("design:type", Boolean)
], DropDownTreeComponent.prototype, "readonly", void 0);
__decorate([
    Input(),
    __metadata("design:type", Boolean)
], DropDownTreeComponent.prototype, "valuePrimitive", void 0);
__decorate([
    Input(),
    __metadata("design:type", Number),
    __metadata("design:paramtypes", [Number])
], DropDownTreeComponent.prototype, "tabindex", null);
__decorate([
    Input(),
    __metadata("design:type", String),
    __metadata("design:paramtypes", [String])
], DropDownTreeComponent.prototype, "size", null);
__decorate([
    Input(),
    __metadata("design:type", String),
    __metadata("design:paramtypes", [String])
], DropDownTreeComponent.prototype, "rounded", null);
__decorate([
    Input(),
    __metadata("design:type", String),
    __metadata("design:paramtypes", [String])
], DropDownTreeComponent.prototype, "fillMode", null);
__decorate([
    Input(),
    __metadata("design:type", Function)
], DropDownTreeComponent.prototype, "itemDisabled", void 0);
__decorate([
    Input(),
    __metadata("design:type", Function)
], DropDownTreeComponent.prototype, "isNodeExpanded", void 0);
__decorate([
    Input(),
    __metadata("design:type", Function)
], DropDownTreeComponent.prototype, "isNodeVisible", void 0);
__decorate([
    Input(),
    __metadata("design:type", Boolean)
], DropDownTreeComponent.prototype, "loadOnDemand", void 0);
__decorate([
    Input(),
    __metadata("design:type", Boolean)
], DropDownTreeComponent.prototype, "filterable", void 0);
__decorate([
    Input(),
    __metadata("design:type", String)
], DropDownTreeComponent.prototype, "filter", void 0);
__decorate([
    Input(),
    __metadata("design:type", String)
], DropDownTreeComponent.prototype, "focusableId", void 0);
DropDownTreeComponent = DropDownTreeComponent_1 = __decorate([ __param(7, Optional()), __param(7, Inject(TOUCH_ENABLED)),
    __metadata("design:paramtypes", [ElementRef,
        PopupService,
        NavigationService,
        Renderer2,
        NgZone,
        ChangeDetectorRef,
        LocalizationService, Boolean])
], DropDownTreeComponent);

var MultiSelectTreeComponent_1;
/* tslint:disable:member-ordering */
const DEFAULT_POPUP_SETTINGS$1 = { animate: true };
const DEFAULT_CHECKABLE_SETTINGS = { checkChildren: true, checkOnClick: true };
const hasChildren$1 = () => false;
const fetchChildren$1 = () => of([]);
const itemDisabled$1 = () => false;
const isNodeVisible$1 = () => true;
/**
 * Represents the [Kendo UI MultiSelectTree component for Angular]({% slug overview_multiselecttree %}).
 */
let MultiSelectTreeComponent = MultiSelectTreeComponent_1 = class MultiSelectTreeComponent {
    constructor(wrapper, popupService, renderer, navigationService, _zone, localization, cdr, touchEnabled$$1) {
        this.wrapper = wrapper;
        this.popupService = popupService;
        this.renderer = renderer;
        this.navigationService = navigationService;
        this._zone = _zone;
        this.localization = localization;
        this.cdr = cdr;
        this.touchEnabled = touchEnabled$$1;
        this.hostClasses = true;
        this.role = 'combobox';
        this.ariaHasPopup = 'tree';
        /**
         * Sets the levels in the data set where the values can be found when `valueField` is an Array.
         * The field serves to correctly allocate a data item used when the MultiSelectTree is initialized with a value.
         */
        this.valueDepth = [];
        /**
         * The hint which is displayed when the component is empty.
         */
        this.placeholder = "";
        /**
         * Sets the height of the options list. By default, `listHeight` is 200px.
         *
         * > The `listHeight` property affects only the list of options and not the whole popup container.
         * > To set the height of the popup container, use `popupSettings.height`.
         */
        this.listHeight = 200;
        /**
         * Sets the disabled state of the component.
         */
        this.disabled = false;
        /**
         * Sets the read-only state of the component.
         */
        this.readonly = false;
        /**
         * Specifies the type of the selected value
         * ([more information and example]({% slug valuebinding_multiselecttree %}#toc-primitive-values)).
         * If set to `true`, the selected value has to be a primitive one.
         */
        this.valuePrimitive = false;
        /**
         * Indicates whether the child nodes will be fetched on node expand or will be initially prefetched.
         * @default false
         */
        this.loadOnDemand = false;
        /**
         * @hidden
         *
         * Used by the kendo-label and kendo-floatinglabel to access and associate the focusable element with the provided label via aria-labelledby.
         */
        this.focusableId = `k-${guid()}`;
        /**
         * If set to `true`, renders a button on hovering over the component.
         * Clicking this button resets the value of the component to `undefined` and triggers the `change` event.
         * @default true
         */
        this.clearButton = true;
        /**
         * Renders the built-in input element for filtering the MultiSelectTree.
         * If set to `true`, the component emits the `filterChange` event, which can be used to [filter the MultiSelectTree manually]({% slug filtering_multiselecttree %}#toc-manual-filtering).
         * A built-in filtering implementation is available to use with the [`kendoMultiSelectTreeHierarchyBinding`]({% slug api_dropdowns_multiselecttreehierarchybindingdirective %}) and [`kendoMultiSelectTreeFlatBinding`]({% slug api_dropdowns_multiselecttreeflatbindingdirective %}) directives.
         * @default false
         */
        this.filterable = false;
        /**
         * If `checkАll` is set to `true` and the checkboxes are enabled, a tri-state checkbox appears above the embedded treeview.
         * Clicking the checkbox checks or unchecks all enabled items of the treeview that are loaded.
         * @default false
         */
        this.checkAll = false;
        /**
         * A function which determines if a specific node has child nodes.
         */
        this.hasChildren = hasChildren$1;
        /**
         * A function which provides the child nodes for a given parent node.
         */
        this.fetchChildren = fetchChildren$1;
        /**
         * A callback which determines whether a tree node should be rendered as hidden. The utility .k-display-none class is used to hide the nodes.
         * Useful for custom filtering implementations.
         */
        this.isNodeVisible = isNodeVisible$1;
        /**
         * A function that is executed for each data item and determines if a specific item is disabled.
         */
        this.itemDisabled = itemDisabled$1;
        /**
         * A user-defined callback function which receives an array of selected data items and maps them to an array of tags.
         *
         * @param { Any[] } dataItems - The selected data items from the list.
         * @returns { Any[] } - The tags that will be rendered by the component.
         */
        this.tagMapper = (tags) => tags || [];
        /**
         * Fires each time the user focuses the MultiSelectTree.
         */
        this.onFocus = new EventEmitter();
        /**
         * Fires each time the MultiSelectTree gets blurred.
         */
        this.onBlur = new EventEmitter();
        /**
         * Fires each time the popup is about to open
         * ([see example]({% slug openstate_multiselecttree %})).
         * This event is preventable. If you cancel it, the popup will remain closed.
         */
        this.open = new EventEmitter();
        /**
         * Fires after the popup has been opened.
         */
        this.opened = new EventEmitter();
        /**
         * Fires each time the popup is about to close
         * ([see example]({% slug openstate_multiselecttree %})).
         * This event is preventable. If you cancel it, the popup will remain open.
         */
        this.close = new EventEmitter();
        /**
         * Fires after the popup has been closed.
         */
        this.closed = new EventEmitter();
        /**
         * Fires when the user expands a node in the popup TreeView.
         */
        this.nodeExpand = new EventEmitter();
        /**
         * Fires when the user collapses a node in the popup TreeView.
         */
        this.nodeCollapse = new EventEmitter();
        /**
         * Fires each time the value is changed
         * ([see example]({% slug overview_multiselecttree %}#toc-events)).
         */
        this.valueChange = new EventEmitter();
        /**
         * Fires each time a tag is about to be removed.
         * This event is preventable. If you cancel it, the tag will not be removed.
         */
        this.removeTag = new EventEmitter();
        /**
         * Fires when the value of the built-in filter input element changes.
         */
        this.filterChange = new EventEmitter();
        /**
         * @hidden
         */
        this.filterStateChange = new EventEmitter();
        /**
         * @hidden
         */
        this.checkedItems = [];
        /**
         * @hidden
         */
        this.checkBy = (item) => item;
        /**
         * @hidden
         */
        this.showAfter = 0;
        /**
         * @hidden
         */
        this.allNodesHidden = false;
        this.tagListId = guid();
        this.tagPrefix = "tag-" + guid();
        this.focusedTagIndex = undefined;
        this._value = [];
        this._tabindex = 0;
        this._popupSettings = DEFAULT_POPUP_SETTINGS$1;
        this._checkableSettings = DEFAULT_CHECKABLE_SETTINGS;
        this._isFocused = false;
        this._size = 'medium';
        this._rounded = 'medium';
        this._fillMode = 'solid';
        this.subscriptions = [];
        this.lastAction = 'check';
        this.onTouchedCallback = noop;
        this.onChangeCallback = noop;
        this.direction = localization.rtl ? 'rtl' : 'ltr';
        this.subscribeEvents();
        this.subscribeFocusEvents();
    }
    get isDisabled() {
        return this.disabled;
    }
    get isLoading() {
        return this.loading;
    }
    get id() {
        return this.focusableId;
    }
    get hostTabIndex() {
        return this.tabindex;
    }
    get isAriaExpanded() {
        return this.isOpen;
    }
    get isReadonly() {
        return this.readonly;
    }
    get ariaDescribedBy() {
        return this.tagListId;
    }
    get ariaActiveDescendant() {
        return this.focusedTagId;
    }
    /**
     * @hidden
     */
    handleClick() {
        this.togglePopup(!this.isOpen);
    }
    /**
     * @hidden
     */
    handleKeydown(event) {
        const deleteTag = this.isWrapperActive && event.keyCode === Keys.Backspace && this.tags.length > 0;
        if (deleteTag) {
            this.handleBackspace();
            return;
        }
        if (this.disabled || this.readonly) {
            return;
        }
        const eventData = event;
        const action = this.navigationService.process({
            originalEvent: eventData
        });
        if (action === NavigationAction.Open) {
            eventData.preventDefault();
        }
    }
    set treeview(treeview) {
        this._treeview = treeview;
        if (treeview) {
            // If filtering is enabled, focus the TreeView on mobile devices instead of the filter input
            if (this.isFocused && !this.filterable && !this.checkAll || this.touchEnabled) {
                treeview.focus();
            }
            /**
             * the treeview animations are initially disabled (we don't want expand animations during popup opening)
             * re-enables the animations for user interaction
             * The Promise is required to properly change the `animate` property when
             * the popup is appended to a container and opened upon initialization.
             * Otherwise, the "Expression has changed..." type error will be thrown.
             */
            Promise.resolve(null).then(() => this.treeview.animate = true);
        }
    }
    get treeview() {
        return this._treeview;
    }
    /**
     * Specifies the [`tabindex`](https://developer.mozilla.org/en-US/docs/Web/HTML/Global_attributes/tabindex) of the component.
     */
    set tabindex(value) {
        const providedTabIndex = parseNumber(value);
        const defaultTabIndex = 0;
        this._tabindex = !isNaN(providedTabIndex) ? providedTabIndex : defaultTabIndex;
    }
    get tabindex() {
        return this.disabled ? -1 : this._tabindex;
    }
    /**
     * Sets the size of the component.
     *
     * The possible values are:
     * * `'small'`
     * * `'medium'` (default)
     * * `'large'`
     * * `null`
     *
     */
    set size(size) {
        this.renderer.removeClass(this.wrapper.nativeElement, getSizeClass('input', this.size));
        if (size) {
            this.renderer.addClass(this.wrapper.nativeElement, getSizeClass('input', size));
        }
        this._size = size;
    }
    get size() {
        return this._size;
    }
    /**
     * Sets the border radius of the component.
     *
     * The possible values are:
     * * `'small'`
     * * `'medium'` (default)
     * * `'large'`
     * * `'full'`
     * * `null`
     *
     */
    set rounded(rounded) {
        this.renderer.removeClass(this.wrapper.nativeElement, getRoundedClass(this.rounded));
        if (rounded) {
            this.renderer.addClass(this.wrapper.nativeElement, getRoundedClass(rounded));
        }
        this._rounded = rounded;
    }
    get rounded() {
        return this._rounded;
    }
    /**
     * Sets the fillMode of the component.
     *
     * The possible values are:
     * * `'flat'`
     * * `'solid'` (default)
     * * `'outline'`
     * * `null`
     *
     */
    set fillMode(fillMode) {
        this.renderer.removeClass(this.wrapper.nativeElement, getFillModeClass('input', this.fillMode));
        if (fillMode) {
            this.renderer.addClass(this.wrapper.nativeElement, getFillModeClass('input', fillMode));
        }
        this._fillMode = fillMode;
    }
    get fillMode() {
        return this._fillMode;
    }
    /**
     * Configures the popup of the MultiSelectTree.
     *
     * The available options are:
     * - `animate: Boolean`&mdash;Controls the popup animation. By default, the open and close animations are enabled.
     * - `width: Number | String`&mdash;Sets the width of the popup container. By default, the width of the host element is used. If set to `auto`, the component automatically adjusts the width of the popup and no item labels are wrapped.
     * - `height: Number`&mdash;Sets the height of the popup container.
     * - `popupClass: String`&mdash;Specifies a list of CSS classes that are used to style the popup.
     * - `appendTo: "root" | "component" | ViewContainerRef`&mdash;Specifies the component to which the popup will be appended.
     */
    set popupSettings(settings) {
        this._popupSettings = Object.assign({}, DEFAULT_POPUP_SETTINGS$1, settings);
        // `detectChanges` needed, otherwise upon value initialization and `appendTo` property
        // an error is thrown => ExpressionChangedAfterItHasBeenCheckedError
        this.cdr.detectChanges();
    }
    get popupSettings() {
        return this._popupSettings;
    }
    /**
     * Defines the checkable settings of the MultiSelecTree nodes.
     * If no value is provided, the default [`CheckableSettings`]({% slug api_dropdowns_multiselecttreecheckablesettings %}) are applied.
     */
    set checkableSettings(settings) {
        this._checkableSettings = Object.assign({}, DEFAULT_CHECKABLE_SETTINGS, settings);
    }
    get checkableSettings() {
        return this._checkableSettings;
    }
    /**
     * Sets the data of the MultiSelectTree.
     *
     * > The data has to be provided in an array-like list with objects.
     */
    set data(data) {
        this._nodes = data;
        this.setState();
    }
    get data() {
        return this._nodes;
    }
    /**
     * Sets the value of the MultiSelectTree.
     * It can either be of the primitive (string, numbers) or of the complex (objects) type.
     * To define the type, use the `valuePrimitive` option.
     *
     */
    set value(value) {
        this._value = value ? value : [];
        this.setState();
    }
    get value() {
        return this._value;
    }
    /**
     * Keeps the current `dataItems` object in order to resolve selection.
     * Needs to be provided when when programmatically setting a `value` and `valuePrimitive` is set to `true`.
     */
    set dataItems(items) {
        this._dataItems = (items || []).map((item, index) => {
            if (hasProps(item, ['dataItem', 'index', 'level'])) {
                return item;
            }
            return {
                dataItem: item,
                index: null,
                level: this.valueDepth[index] || 0
            };
        });
        this.setState();
    }
    get dataItems() {
        return this._dataItems || this.value.map((value, index) => ({
            dataItem: value,
            index: null,
            level: this.valueDepth[index] || 0
        }));
    }
    /**
     * @hidden
     */
    get focusedTagId() {
        if (!isPresent(this.focusedTagIndex) || this.isOpen) {
            return null;
        }
        const dataItem = this.tags[this.focusedTagIndex];
        return `${this.tagPrefix}-${valueFrom({ dataItem }, this.valueField)}`;
    }
    set isFocused(isFocused) {
        this.renderer[isFocused ? 'addClass' : 'removeClass'](this.wrapper.nativeElement, 'k-focus');
        this._isFocused = isFocused;
    }
    get isFocused() {
        return this._isFocused;
    }
    /**
     * Returns the current open state of the popup.
     */
    get isOpen() {
        return isPresent(this.popupRef);
    }
    get width() {
        const wrapperWidth = this.wrapper.nativeElement.offsetWidth;
        const width = this.popupSettings.width || wrapperWidth;
        const minWidth = isNaN(wrapperWidth) ? wrapperWidth : `${wrapperWidth}px`;
        const maxWidth = isNaN(width) ? width : `${width}px`;
        return { min: minWidth, max: maxWidth };
    }
    get height() {
        const popupHeight = this.popupSettings.height;
        return isPresent(popupHeight) ? `${popupHeight}px` : 'auto';
    }
    get appendTo() {
        const { appendTo } = this.popupSettings;
        if (!appendTo || appendTo === 'root') {
            return undefined;
        }
        return appendTo === 'component' ? this.container : appendTo;
    }
    /**
     * @hidden
     */
    get popupContainerClasses() {
        const containerClasses = ['k-popup-dropdowntree'];
        if (this.popupSettings.popupClass) {
            containerClasses.push(this.popupSettings.popupClass);
        }
        return containerClasses;
    }
    /**
     * @hidden
     *
     * Alias for `data`. Used for compatibility with the `DataBoundComponent` interface.
     * Required for the data-binding directives.
     */
    set nodes(nodes) {
        this.data = nodes;
    }
    get nodes() {
        return this.data;
    }
    /**
     * @hidden
     *
     * Alias for `fetchChildren`. Used for compatibility with the `DataBoundComponent` interface.
     * Required for the data-binding directives
     */
    set children(callback) {
        this.fetchChildren = callback;
    }
    get children() {
        return this.fetchChildren;
    }
    /**
     * @hidden
     *
     * Alias for `nodeExpand`. Used for compatibility with the `ExpandableComponent` interface.
     * Required for the expand-directive.
     */
    get expand() {
        return this.nodeExpand;
    }
    /**
     * @hidden
     *
     * Alias for `nodeCollapse`. Used for compatibility with the `ExpandableComponent` interface.
     * Required for the expand-directive.
     */
    get collapse() {
        return this.nodeCollapse;
    }
    /**
     * @hidden
     *
     * Alias for `isNodeExpanded`. Used for compatibility with the `ExpandableComponent` interface.
     * Required for the expand-directive.
     */
    set isExpanded(callback) {
        this.isNodeExpanded = callback;
    }
    get isExpanded() {
        return this.isNodeExpanded;
    }
    /**
     * @hidden
     *
     * Alias for `isNodeVisible`. Used for compatibility with the `DataBoundComponent` interface.
     * The `DataBoundComponent` interface is used in the data-binding directives.
     */
    set isVisible(callback) {
        this.isNodeVisible = callback;
    }
    get isVisible() {
        return this.isNodeVisible;
    }
    get isTagFocused() {
        return !this.isOpen && this.focusedTagIndex !== undefined;
    }
    get isTreeViewActive() {
        return this.treeview && this.treeview.isActive;
    }
    get isWrapperActive() {
        return document.activeElement === this.wrapper.nativeElement;
    }
    get isFilterActive() {
        return this.filterInput && document.activeElement === this.filterInput.nativeElement;
    }
    get isCheckAllActive() {
        return this.checkAllInput && document.activeElement === this.checkAllInput.nativeElement;
    }
    ngOnInit() {
        this.renderer.removeAttribute(this.wrapper.nativeElement, 'tabindex');
        this.renderer.setAttribute(this.wrapper.nativeElement, 'aria-expanded', String(this.isOpen));
        this.subscriptions.push(this.localization
            .changes.subscribe(({ rtl }) => {
            this.direction = rtl ? 'rtl' : 'ltr';
            this.cdr.markForCheck();
        }));
        this.setComponentClasses();
    }
    /**
     * @hidden
     */
    ngOnDestroy() {
        this.destroyPopup();
        this.unsubscribeEvents();
    }
    /**
     * @hidden
     */
    ngOnChanges(changes) {
        if (anyChanged(['textField', 'valueField', 'valuePrimitive'], changes, false)) {
            this.setState();
        }
        if (anyChanged(['valueDepth', 'value', 'dataItems'], changes, false)) {
            if (changes.value && !changes.dataItems && !this.valuePrimitive) {
                // Update the dataItems if the value is updated programmatically (non-primitive values only)
                // In the primitive case, the client should update the dataItems as well
                this.dataItems = this.value;
            }
            else {
                // Re-map the dataItems because `valueDepth` is not yet available when the check directive parses the items
                this.dataItems = this.dataItems.map((item, index) => (Object.assign({}, item, { level: this.valueDepth[index] || 0 })));
            }
        }
    }
    /**
     * @hidden
     */
    ngAfterContentChecked() {
        this.verifySettings();
    }
    /**
     * @hidden
     *
     * Used by the kendo-floatinglabel component to determine if the floating label
     * should be rendered inside the input when the component is not focused.
     */
    isEmpty() {
        return !Boolean(this.placeholder) && (!isPresent(this.value) || this.value.length === 0);
    }
    /**
     * Focuses the MultiSelectTree.
     */
    focus() {
        if (!this.disabled) {
            this.wrapper.nativeElement.focus();
        }
    }
    /**
     * Blurs the MultiSelectTree.
     */
    blur() {
        if (!this.disabled) {
            this.wrapper.nativeElement.blur();
        }
    }
    /**
     * Focuses a specific item of the MultiSelectTree based on a provided index in the format of `1_1`.
     * The targeted item should be expanded in order for it to be focused.
     * If null or invalid index is provided the focus will be set on the first item.
     */
    focusItemAt(index) {
        if (this.treeview) {
            const lookup = this.treeview.itemLookup(index);
            const isItemDisabled = !isPresent(lookup) || this.treeview.isDisabled(lookup.item.dataItem, lookup.item.index);
            if (!isItemDisabled) {
                this.treeview.focus(index);
            }
        }
    }
    /**
     * Resets the value of the MultiSelectTree.
     * If you use the `reset` method to clear the value of the component,
     * the model will not update automatically and the `valueChange` event will not be fired.
     */
    reset() {
        this.value = [];
        this.dataItems = [];
        this.valueDepth = [];
    }
    /**
     * Toggles the visibility of the popup
     * ([see example]({% slug openstate_multiselecttree %})).
     * If you use the `toggle` method to open or close the popup, the `open` and `close` events will not be fired.
     *
     * @param open - The state of the popup.
     */
    toggle(open) {
        // The Promise is required to open the popup on load.
        // Otherwise, the "ViewContainerRef not found..." error will be thrown.
        Promise.resolve(null).then(() => {
            const shouldOpen = isPresent(open) ? open : !isPresent(this.popupRef);
            this.destroyPopup();
            if (shouldOpen) {
                this.createPopup();
            }
        });
    }
    /**
     * @hidden
     */
    handleFocus(event) {
        if (event.target !== this.wrapper.nativeElement) {
            return;
        }
        event.stopImmediatePropagation();
        if (!this.isFocused) {
            this.isFocused = true;
            if (hasObservers(this.onFocus)) {
                this._zone.run(() => {
                    this.onFocus.emit();
                });
            }
            // Re-focus the treeview if `close` is prevented
            if (this.isOpen && this.treeview) {
                if (this.lastNodeOnFocus) {
                    this.lastNodeOnFocus.setAttribute('tabindex', '0');
                }
                this.treeview.focus();
            }
        }
    }
    /**
     * @hidden
     */
    handleBlur(e) {
        const relatedTarget = e && e.relatedTarget;
        if (this.wrapper.nativeElement.contains(relatedTarget) ||
            (this.isOpen && this.popupRef.popupElement.contains(relatedTarget))) {
            return;
        }
        this.isFocused = false;
        this.togglePopup(false);
        if (hasObservers(this.onBlur) ||
            isUntouched(this.wrapper.nativeElement)) {
            this._zone.run(() => {
                this.onBlur.emit();
                this.onTouchedCallback();
            });
        }
    }
    /**
     * @hidden
     */
    handleNodeClick(node) {
        if (!this.isFocused) {
            // Re-focus the MultiSelectTree when popup close is prevented and a node is clicked
            // On click the focus should be on the clicked element which is why we need to update the lastNodeOnFocus
            const parent = node.originalEvent.target.parentElement.parentElement;
            this.lastNodeOnFocus = parent;
            this.focus();
        }
    }
    /**
     * @hidden
     */
    togglePopup(open) {
        const isDisabled = this.disabled || this.readonly;
        const sameState = this.isOpen === open;
        this._zone.run(() => {
            this.focusedTagIndex = undefined;
        });
        if (isDisabled || sameState) {
            return;
        }
        const togglePrevented = this.triggerPopupEvents(open);
        if (!togglePrevented) {
            open ?
                this.createPopup() :
                this.destroyPopup();
        }
        else {
            this.removeTreeViewFromTabOrder();
        }
    }
    /**
     * @hidden
     */
    messageFor(key) {
        return this.localization.get(key);
    }
    /**
     * @hidden
     */
    handleCheckedItemsChange(items) {
        this.valueDepth = items.map(item => item.level);
        this.lastAction = items.length > this.dataItems.length ? 'check' : 'uncheck';
        this.dataItems = items.slice();
        this.updateValue(this.dataItems);
    }
    /**
     * @hidden
     */
    handleRemoveTag({ tag, index }) {
        if (this.disabled || this.readonly) {
            return;
        }
        const eventArgs = new RemoveTagEvent(tag);
        this.removeTag.emit(eventArgs);
        if (eventArgs.isDefaultPrevented()) {
            return;
        }
        // Remove tags based on their position index
        if (tag instanceof Array) {
            // Remove group tag
            this.dataItems = this.dataItems.filter((_item, i) => i < this.showAfter || this.disabledIndices.has(i));
            this.valueDepth = this.valueDepth.filter((_item, i) => i < this.showAfter || this.disabledIndices.has(i));
        }
        else {
            // Remove single tag
            this.dataItems = this.dataItems.filter((_item, i) => i !== index || this.disabledIndices.has(i));
            this.valueDepth = this.valueDepth.filter((_item, i) => i !== index || this.disabledIndices.has(i));
        }
        this.updateValue(this.dataItems);
        // focus the wrapper if the component is not focused - the floating label reacts to focus/blur
        if (!this.isFocused) {
            this.focus();
        }
    }
    /**
     * @hidden
     */
    handleTagMapperChange(showAfter) {
        this.showAfter = parseNumber(showAfter);
        this.setTags();
    }
    /**
     * @hidden
     */
    clearAll(event) {
        event.stopImmediatePropagation();
        event.preventDefault();
        this.focus();
        this.value = this.value.filter((_item, index) => this.disabledIndices.has(index));
        this.dataItems = this.dataItems.filter((_item, index) => this.disabledIndices.has(index));
        this.valueDepth = this.valueDepth.filter((_depth, index) => this.disabledIndices.has(index));
        this.emitValueChange(this.value);
    }
    /**
     * @hidden
     */
    writeValue(value) {
        this.value = value || [];
        // Update the dataItems if the value is updated programmatically (non-primitive values only)
        // In the primitive case, the client should update the dataItems as well
        if (!this.valuePrimitive) {
            this.dataItems = this.value;
        }
    }
    /**
     * @hidden
     */
    registerOnChange(fn) {
        this.onChangeCallback = fn;
    }
    /**
     * @hidden
     */
    registerOnTouched(fn) {
        this.onTouchedCallback = fn;
    }
    /**
     * @hidden
     */
    setDisabledState(isDisabled) {
        this.disabled = isDisabled;
        this.cdr.markForCheck();
    }
    /**
     * @hidden
     */
    handleFilterInputChange(term) {
        this.filterChange.next(term);
        this.allNodesHidden = this.nodes.every((node, index) => !this.isVisible(node, String(index)));
    }
    /**
     * @hidden
     */
    get filterInputClasses() {
        return `${this.size ? getSizeClass('input', this.size) : ''} ${this.fillMode ? 'k-input-' + this.fillMode : ''} ${this.rounded ? getRoundedClass(this.rounded) : ''}`;
    }
    /**
     * @hidden
     */
    get checkAllCheckboxClasses() {
        return `${this.size ? getSizeClass('checkbox', this.size) : ''}`;
    }
    /**
     * @hidden
     */
    toggleCheckAll() {
        this.checkAllInput.nativeElement.focus();
        this.checkAllInput.nativeElement.click();
    }
    verifySettings() {
        if (!isDevMode()) {
            return;
        }
        if (!isPresent(this.valueField) || !isPresent(this.textField)) {
            throw new Error(MultiSelectTreeMessages.textAndValue);
        }
        if (!isArray(this.value)) {
            throw new Error(MultiSelectTreeMessages.array);
        }
        if (this.value.length > 0) {
            if (this.valuePrimitive && this.value.some(item => isObject(item))) {
                throw new Error(MultiSelectTreeMessages.primitive);
            }
            const isEveryDataItemObject = this.dataItems.every(item => isObject(item.dataItem));
            if (this.valuePrimitive && !isArray(this.dataItems)) {
                throw new Error(MultiSelectTreeMessages.dataItems);
            }
            if (this.valuePrimitive && !isEveryDataItemObject) {
                throw new Error(MultiSelectTreeMessages.dataItems);
            }
            if (this.valuePrimitive && this.dataItems.length !== this.value.length) {
                throw new Error(MultiSelectTreeMessages.dataItemsLength);
            }
            if (!this.valuePrimitive && !isObjectArray(this.value)) {
                throw new Error(MultiSelectTreeMessages.object);
            }
            if ((isArray(this.valueField) || isArray(this.textField)) && !isArray(this.valueDepth)) {
                throw new Error(MultiSelectTreeMessages.valueDepth);
            }
            if ((isArray(this.valueField) || isArray(this.textField)) && this.valueDepth.length === 0) {
                throw new Error(MultiSelectTreeMessages.valueDepth);
            }
            if ((isArray(this.valueField) || isArray(this.textField)) && this.valueDepth.length !== this.value.length) {
                throw new Error(MultiSelectTreeMessages.valueDepthLength);
            }
        }
    }
    emitValueChange(value) {
        this.onChangeCallback(value);
        this.valueChange.emit(value);
    }
    triggerPopupEvents(open) {
        const eventArgs = new PreventableEvent();
        open ?
            this.open.emit(eventArgs) :
            this.close.emit(eventArgs);
        return eventArgs.isDefaultPrevented();
    }
    createPopup() {
        const horizontalAlign = this.direction === "rtl" ? "right" : "left";
        const anchorPosition = { horizontal: horizontalAlign, vertical: 'bottom' };
        const popupPosition = { horizontal: horizontalAlign, vertical: 'top' };
        this.popupRef = this.popupService.open({
            anchor: this.wrapper,
            appendTo: this.appendTo,
            anchorAlign: anchorPosition,
            content: this.popupTemplate,
            popupAlign: popupPosition,
            positionMode: 'absolute',
            popupClass: this.popupContainerClasses
        });
        const popupWrapper = this.popupRef.popupElement;
        const { min, max } = this.width;
        popupWrapper.style.minWidth = min;
        popupWrapper.style.width = max;
        popupWrapper.style.height = this.height;
        this.renderer.setAttribute(popupWrapper, 'dir', this.direction);
        this.renderer.setAttribute(this.wrapper.nativeElement, 'aria-expanded', 'true');
        this.popupRef.popupOpen.subscribe(() => {
            this.cdr.detectChanges();
            this.opened.emit();
        });
        this.popupRef.popupClose.subscribe(() => {
            this.closed.emit();
        });
    }
    destroyPopup() {
        if (this.popupRef) {
            this.popupRef.close();
            this.popupRef = null;
            this.renderer.setAttribute(this.wrapper.nativeElement, 'aria-expanded', 'false');
            if (this.filter !== "") {
                this.filter = "";
                this.allNodesHidden = false;
                if (hasObservers(this.filterChange)) {
                    this._zone.run(() => {
                        this.filterChange.emit("");
                    });
                }
            }
        }
    }
    subscribeEvents() {
        this.subscriptions.push(this.navigationService.open.subscribe(() => this.togglePopup(true)), this.navigationService.enter
            .pipe(tap((event) => event.originalEvent.preventDefault()))
            .subscribe(() => this.togglePopup(true)), merge(this.navigationService.close, this.navigationService.esc).subscribe(() => {
            this.focus();
            this.togglePopup(false);
        }), this.navigationService.tab.subscribe(this.handleTabKey.bind(this)), this.navigationService.up.subscribe(this.handleUpKey.bind(this)), this.navigationService.down.subscribe(this.handleDownKey.bind(this)), this.navigationService.left
            .pipe(filter(() => !this.isTreeViewActive))
            .subscribe(this.direction === 'rtl' ? this.handleRightKey.bind(this) : this.handleLeftKey.bind(this)), this.navigationService.right
            .pipe(filter(() => !this.isTreeViewActive))
            .subscribe(this.direction === 'rtl' ? this.handleLeftKey.bind(this) : this.handleRightKey.bind(this)), this.navigationService.home.pipe(filter(() => !this.isOpen)).subscribe(this.handleHome.bind(this)), this.navigationService.end.pipe(filter(() => !this.isOpen)).subscribe(this.handleEnd.bind(this)), this.navigationService.backspace.pipe(filter(() => this.isTagFocused)).subscribe(this.handleBackspace.bind(this)), this.navigationService.delete.pipe(filter(() => this.isTagFocused)).subscribe(this.handleDelete.bind(this)));
    }
    subscribeFocusEvents() {
        if (isDocumentAvailable()) {
            this.handleFocus = this.handleFocus.bind(this);
            this.handleDocumentBlur = this.handleDocumentBlur.bind(this);
            this._zone.runOutsideAngular(() => {
                const useCapture = true;
                document.addEventListener('focus', this.handleFocus, useCapture);
                document.addEventListener('blur', this.handleDocumentBlur, useCapture);
            });
        }
    }
    unSubscribeFocusEvents() {
        if (isDocumentAvailable()) {
            const useCapture = true;
            document.removeEventListener('focus', this.handleFocus, useCapture);
            document.removeEventListener('blur', this.handleDocumentBlur, useCapture);
        }
    }
    handleDocumentBlur(event) {
        if (event.target !== this.wrapper.nativeElement) {
            return;
        }
        event.stopImmediatePropagation();
        this.handleBlur(event);
    }
    handleTabKey() {
        this.focus();
        if (this.isOpen) {
            this.treeview.blur();
            this.removeTreeViewFromTabOrder();
        }
    }
    handleUpKey(event) {
        if (!this.treeview) {
            return;
        }
        event.originalEvent.preventDefault();
        // Prevent toggling the focus between the filterInput and the wrapper elements with `up` key
        if (this.isWrapperActive) {
            return;
        }
        const isFirstNodeActive = this.treeview['navigationService']['activeIndex'] === '0';
        // Current focus is on the filter input => should focus the wrapper
        if (this.filterable && this.isFilterActive) {
            this.focus();
            // Current focus is on the treeview first node => should focus the check all checkbox if enabled
        }
        else if (this.checkAll && !this.isCheckAllActive && isFirstNodeActive) {
            this.checkAllInput.nativeElement.focus();
            // Current focus is either on the check all checkbox or the treeview's first node
            // => should focus either the filter input (if enabled) or the wrapper
        }
        else if (this.isCheckAllActive || isFirstNodeActive) {
            this.filterable ?
                this.filterInput.nativeElement.focus() :
                this.focus();
        }
    }
    handleDownKey(event) {
        if (!this.treeview) {
            return;
        }
        event.originalEvent.preventDefault();
        // Current focus is on the wrapper => should focus the filter input
        if (this.filterable && this.isWrapperActive) {
            this.filterInput.nativeElement.focus();
            // Current focus is on the wrapper/filter input => should focus check all checkbox if enabled
        }
        else if (this.checkAll && (this.isWrapperActive || this.isFilterActive)) {
            this.checkAllInput.nativeElement.focus();
            // Should focus the treeview if filterable and check all are disabled
        }
        else if (!this.treeview.isActive) {
            this.treeview.focus();
        }
        this.focusedTagIndex = undefined;
    }
    handleRightKey(event) {
        event.originalEvent.preventDefault();
        const last = this.tags.length - 1;
        if (this.focusedTagIndex === last) {
            this.focusedTagIndex = undefined;
        }
        else if (this.focusedTagIndex < last) {
            this.focusedTagIndex++;
        }
        else if (!this.focusedTagIndex) {
            this.focusedTagIndex = 0;
        }
    }
    handleLeftKey(event) {
        event.originalEvent.preventDefault();
        if (this.focusedTagIndex === undefined || this.focusedTagIndex < 0) {
            this.focusedTagIndex = this.tags.length - 1;
        }
        else if (this.focusedTagIndex !== 0) {
            this.focusedTagIndex--;
        }
    }
    handleEnd(event) {
        event.originalEvent.preventDefault();
        this.focusedTagIndex = this.tags.length - 1;
    }
    handleHome(event) {
        event.originalEvent.preventDefault();
        this.focusedTagIndex = 0;
    }
    handleBackspace() {
        if (this.focusedTagIndex !== undefined) {
            this.handleDelete();
        }
        else {
            const tag = this.tags[this.tags.length - 1];
            const index = this.tags.length - 1;
            this.handleRemoveTag({ tag, index });
        }
    }
    handleDelete() {
        const tag = this.tags[this.focusedTagIndex];
        const index = this.focusedTagIndex;
        this.handleRemoveTag({ tag, index });
        if (this.focusedTagIndex === this.tags.length) {
            this.focusedTagIndex = undefined;
        }
    }
    unsubscribeEvents() {
        this.subscriptions.forEach(sub => sub.unsubscribe());
        this.unSubscribeFocusEvents();
    }
    /**
     * Remove the `TreeView` from the tab order, otherwise a focus loop between the page elements will occur
     * and the user will not be able to tab to the rest of the browser elements
     */
    removeTreeViewFromTabOrder() {
        const nodes = this.treeview.element.nativeElement.querySelectorAll('li');
        nodes.forEach(item => {
            if (item.getAttribute('tabindex') === '0') {
                this.lastNodeOnFocus = item;
                this.lastNodeOnFocus.setAttribute('tabindex', '-1');
            }
        });
    }
    setState() {
        if (isPresent(this.dataItems) && isPresent(this.valueField)) {
            this.setTags();
            this.checkedItems = this.dataItems.slice();
        }
        this.cdr.markForCheck();
    }
    setTags() {
        const source = this.dataItems.map(item => item.dataItem);
        this.tags = this.tagMapper(source);
        this.disabledIndices = this.disabledItemsMapper();
    }
    updateValue(value) {
        const newValue = this.valuePrimitive ?
            value.map(item => valueFrom(item, this.valueField)) :
            value.map(item => item.dataItem);
        this.value = newValue;
        this.emitValueChange(this.value);
    }
    /**
     * @hidden
     *
     * Determines which of the provided tags should be disabled and stores their position indices
     */
    disabledItemsMapper() {
        return new Set(this.dataItems.reduce((indices, item, index) => {
            if (this.itemDisabled(item.dataItem, item.index)) {
                indices.push(index);
            }
            return indices;
        }, []));
    }
    setComponentClasses() {
        if (this.size) {
            this.renderer.addClass(this.wrapper.nativeElement, getSizeClass('input', this.size));
        }
        if (this.rounded) {
            this.renderer.addClass(this.wrapper.nativeElement, getRoundedClass(this.rounded));
        }
        if (this.fillMode) {
            this.renderer.addClass(this.wrapper.nativeElement, getFillModeClass('input', this.fillMode));
        }
    }
};
MultiSelectTreeComponent.ɵfac = function MultiSelectTreeComponent_Factory(t) { return new (t || MultiSelectTreeComponent)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ElementRef), ɵngcc0.ɵɵdirectiveInject(ɵngcc4.PopupService), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.Renderer2), ɵngcc0.ɵɵdirectiveInject(NavigationService), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.NgZone), ɵngcc0.ɵɵdirectiveInject(ɵngcc1.LocalizationService), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ChangeDetectorRef), ɵngcc0.ɵɵdirectiveInject(TOUCH_ENABLED, 8)); };
MultiSelectTreeComponent.ɵcmp = /*@__PURE__*/ ɵngcc0.ɵɵdefineComponent({ type: MultiSelectTreeComponent, selectors: [["kendo-multiselecttree"]], contentQueries: function MultiSelectTreeComponent_ContentQueries(rf, ctx, dirIndex) { if (rf & 1) {
        ɵngcc0.ɵɵcontentQuery(dirIndex, HeaderTemplateDirective, 5);
        ɵngcc0.ɵɵcontentQuery(dirIndex, FooterTemplateDirective, 5);
        ɵngcc0.ɵɵcontentQuery(dirIndex, NodeTemplateDirective, 5);
        ɵngcc0.ɵɵcontentQuery(dirIndex, NoDataTemplateDirective, 5);
        ɵngcc0.ɵɵcontentQuery(dirIndex, TagTemplateDirective, 5);
        ɵngcc0.ɵɵcontentQuery(dirIndex, GroupTagTemplateDirective, 5);
    } if (rf & 2) {
        let _t;
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.headerTemplate = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.footerTemplate = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.nodeTemplate = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.noDataTemplate = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.tagTemplate = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.groupTagTemplate = _t.first);
    } }, viewQuery: function MultiSelectTreeComponent_Query(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵviewQuery(_c40, 5);
        ɵngcc0.ɵɵviewQuery(_c9, 7);
        ɵngcc0.ɵɵviewQuery(_c8, 7, ViewContainerRef);
        ɵngcc0.ɵɵviewQuery(_c41, 5);
        ɵngcc0.ɵɵviewQuery(_c49, 5);
    } if (rf & 2) {
        let _t;
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.treeview = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.popupTemplate = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.container = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.filterInput = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.checkAllInput = _t.first);
    } }, hostVars: 19, hostBindings: function MultiSelectTreeComponent_HostBindings(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵlistener("click", function MultiSelectTreeComponent_click_HostBindingHandler() { return ctx.handleClick(); })("keydown", function MultiSelectTreeComponent_keydown_HostBindingHandler($event) { return ctx.handleKeydown($event); });
    } if (rf & 2) {
        ɵngcc0.ɵɵattribute("role", ctx.role)("aria-haspopup", ctx.ariaHasPopup)("dir", ctx.direction)("aria-disabled", ctx.isDisabled)("id", ctx.id)("tabindex", ctx.hostTabIndex)("aria-expanded", ctx.isAriaExpanded)("readonly", ctx.isReadonly)("aria-readonly", ctx.isReadonly)("aria-describedby", ctx.ariaDescribedBy)("aria-activedescendant", ctx.ariaActiveDescendant);
        ɵngcc0.ɵɵclassProp("k-dropdowntree", ctx.hostClasses)("k-input", ctx.hostClasses)("k-disabled", ctx.isDisabled)("k-loading", ctx.isLoading);
    } }, inputs: { valueDepth: "valueDepth", placeholder: "placeholder", listHeight: "listHeight", disabled: "disabled", readonly: "readonly", valuePrimitive: "valuePrimitive", loadOnDemand: "loadOnDemand", focusableId: "focusableId", clearButton: "clearButton", filterable: "filterable", checkAll: "checkAll", hasChildren: "hasChildren", fetchChildren: "fetchChildren", isNodeVisible: "isNodeVisible", itemDisabled: "itemDisabled", tagMapper: "tagMapper", tabindex: "tabindex", size: "size", rounded: "rounded", fillMode: "fillMode", popupSettings: "popupSettings", checkableSettings: "checkableSettings", data: "data", value: "value", dataItems: "dataItems", isNodeExpanded: "isNodeExpanded", textField: "textField", valueField: "valueField", loading: "loading" }, outputs: { onFocus: "focus", onBlur: "blur", open: "open", opened: "opened", close: "close", closed: "closed", nodeExpand: "nodeExpand", nodeCollapse: "nodeCollapse", valueChange: "valueChange", removeTag: "removeTag", filterChange: "filterChange" }, exportAs: ["kendoMultiSelectTree"], features: [ɵngcc0.ɵɵProvidersFeature([
            LocalizationService,
            NavigationService,
            DataService,
            DisabledItemsService,
            SelectionService,
            {
                provide: L10N_PREFIX,
                useValue: 'kendo.multiselecttree'
            },
            {
                multi: true,
                provide: NG_VALUE_ACCESSOR,
                useExisting: forwardRef(() => MultiSelectTreeComponent_1)
            },
            {
                provide: DataBoundComponent,
                useExisting: forwardRef(() => MultiSelectTreeComponent_1)
            },
            {
                provide: ExpandableComponent,
                useExisting: forwardRef(() => MultiSelectTreeComponent_1)
            },
            {
                provide: KendoInput,
                useExisting: forwardRef(() => MultiSelectTreeComponent_1)
            }
        ]), ɵngcc0.ɵɵNgOnChangesFeature], decls: 9, vars: 17, consts: function () { let i18n_50; if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
        /**
         * @desc The text displayed in the popup when there are no items
         * @meaning kendo.multiselecttree.noDataText
         */
        const MSG_EXTERNAL_5589893825114548617$$DIST_FESM2015_INDEX_JS_51 = goog.getMsg("NO DATA FOUND");
        i18n_50 = MSG_EXTERNAL_5589893825114548617$$DIST_FESM2015_INDEX_JS_51;
    }
    else {
        i18n_50 = $localize `:kendo.multiselecttree.noDataText|The text displayed in the popup when there are no items␟1689309191709bbbb071c889072707cb3f12dc93␟5589893825114548617:NO DATA FOUND`;
    } let i18n_52; if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
        /**
         * @desc The title of the clear button
         * @meaning kendo.multiselecttree.clearTitle
         */
        const MSG_EXTERNAL_7268188619735862842$$DIST_FESM2015_INDEX_JS_53 = goog.getMsg("clear");
        i18n_52 = MSG_EXTERNAL_7268188619735862842$$DIST_FESM2015_INDEX_JS_53;
    }
    else {
        i18n_52 = $localize `:kendo.multiselecttree.clearTitle|The title of the clear button␟f99cf5ed2ae05c7d1df8dc97f56176a4934c8db9␟7268188619735862842:clear`;
    } let i18n_54; if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
        /**
         * @desc The text displayed for the check-all checkbox
         * @meaning kendo.multiselecttree.checkAllText
         */
        const MSG_EXTERNAL_4511060501589211517$$DIST_FESM2015_INDEX_JS_55 = goog.getMsg("Check all");
        i18n_54 = MSG_EXTERNAL_4511060501589211517$$DIST_FESM2015_INDEX_JS_55;
    }
    else {
        i18n_54 = $localize `:kendo.multiselecttree.checkAllText|The text displayed for the check-all checkbox␟7213da1304801b92c6dd35231b5305408e2734e3␟4511060501589211517:Check all`;
    } return [["kendoMultiSelectTreeLocalizedMessages", "", "noDataText", i18n_50, "clearTitle", i18n_52, "checkAllText", i18n_54], [3, "size", "rounded", "fillMode", "id", "tags", "focused", "textField", "valueField", "valueDepth", "disabled", "tagPrefix", "template", "groupTemplate", "disabledIndices", "removeTag"], ["class", "k-input-inner k-readonly", 4, "ngIf"], ["class", "k-clear-value", "role", "button", "tabindex", "-1", 3, "click", 4, "ngIf"], ["class", "k-icon k-i-loading", 4, "ngIf"], ["popupTemplate", ""], ["container", ""], [1, "k-input-inner", "k-readonly"], [1, "k-input-value-text"], ["role", "button", "tabindex", "-1", 1, "k-clear-value", 3, "click"], [1, "k-icon", "k-i-x"], [1, "k-icon", "k-i-loading"], ["class", "k-list-filter", 4, "ngIf"], [4, "ngIf"], ["class", "k-check-all", 4, "ngIf"], ["kendoMultiSelectTreeCheckable", "", 3, "size", "nodes", "animate", "checkable", "checkedItems", "valueField", "textField", "children", "hasChildren", "isExpanded", "isDisabled", "nodeTemplate", "loadOnDemand", "filter", "isVisible", "kendoEventsOutsideAngular", "scope", "keydown", "nodeClick", "expand", "collapse", "checkedItemsChange"], ["treeview", ""], ["class", "k-no-data", 4, "ngIf"], [1, "k-list-filter"], [1, "k-textbox", "k-input", 3, "ngClass"], [1, "k-input-prefix"], [1, "k-input-icon", "k-icon", "k-i-search"], ["role", "textbox", "aria-haspopup", "true", "aria-expanded", "false", "tabindex", "0", "aria-disabled", "false", "aria-readonly", "false", 1, "k-input-inner", 3, "filterInput", "ngModel", "kendoEventsOutsideAngular", "scope", "input", "keydown", "ngModelChange"], ["filterInput", ""], [3, "templateContext"], [1, "k-check-all"], ["type", "checkbox", "role", "checkbox", "tabindex", "0", "aria-disabled", "false", "aria-readonly", "false", 1, "k-checkbox", 3, "checkAll", "ngClass", "treeview", "checkedItems", "valueField", "lastAction", "kendoEventsOutsideAngular", "scope", "checkedItemsChange", "keydown"], ["checkAllInput", ""], [1, "k-checkbox-label", 3, "click", "mousedown"], [1, "k-no-data"], [3, "ngIf", "templateContext"], [3, "ngIf"]]; }, template: function MultiSelectTreeComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵelementContainer(0, 0);
        ɵngcc0.ɵɵelementStart(1, "kendo-taglist", 1);
        ɵngcc0.ɵɵlistener("removeTag", function MultiSelectTreeComponent_Template_kendo_taglist_removeTag_1_listener($event) { return ctx.handleRemoveTag($event); });
        ɵngcc0.ɵɵtemplate(2, MultiSelectTreeComponent_span_2_Template, 3, 1, "span", 2);
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵtemplate(3, MultiSelectTreeComponent_span_3_Template, 2, 1, "span", 3);
        ɵngcc0.ɵɵtemplate(4, MultiSelectTreeComponent_span_4_Template, 1, 0, "span", 4);
        ɵngcc0.ɵɵtemplate(5, MultiSelectTreeComponent_ng_template_5_Template, 7, 26, "ng-template", null, 5, ɵngcc0.ɵɵtemplateRefExtractor);
        ɵngcc0.ɵɵelementContainer(7, null, 6);
    } if (rf & 2) {
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("size", ctx.size)("rounded", ctx.rounded)("fillMode", ctx.fillMode)("id", ctx.tagListId)("tags", ctx.tags)("focused", ctx.focusedTagIndex)("textField", ctx.textField)("valueField", ctx.valueField)("valueDepth", ctx.valueDepth)("disabled", ctx.disabled)("tagPrefix", ctx.tagPrefix)("template", ctx.tagTemplate)("groupTemplate", ctx.groupTagTemplate)("disabledIndices", ctx.disabledIndices);
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngIf", !ctx.tags || !ctx.tags.length);
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngIf", !ctx.disabled && !ctx.loading && !ctx.readonly && ctx.clearButton && (ctx.tags == null ? null : ctx.tags.length));
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngIf", ctx.loading);
    } }, directives: function () { return [LocalizedMessagesDirective, TagListComponent, ɵngcc3.NgIf, ɵngcc3.NgClass, ɵngcc5.DefaultValueAccessor, FilterInputDirective, ɵngcc5.NgControlStatus, ɵngcc5.NgModel, ɵngcc2.EventsOutsideAngularDirective, TemplateContextDirective, CheckAllDirective, ɵngcc6.TreeViewComponent, CheckDirective]; }, encapsulation: 2 });
__decorate([
    HostBinding('class.k-dropdowntree'),
    HostBinding('class.k-input'),
    __metadata("design:type", Boolean)
], MultiSelectTreeComponent.prototype, "hostClasses", void 0);
__decorate([
    HostBinding('class.k-disabled'),
    HostBinding('attr.aria-disabled'),
    __metadata("design:type", Boolean),
    __metadata("design:paramtypes", [])
], MultiSelectTreeComponent.prototype, "isDisabled", null);
__decorate([
    HostBinding('class.k-loading'),
    __metadata("design:type", Boolean),
    __metadata("design:paramtypes", [])
], MultiSelectTreeComponent.prototype, "isLoading", null);
__decorate([
    HostBinding('attr.id'),
    __metadata("design:type", String),
    __metadata("design:paramtypes", [])
], MultiSelectTreeComponent.prototype, "id", null);
__decorate([
    HostBinding('attr.dir'),
    __metadata("design:type", String)
], MultiSelectTreeComponent.prototype, "direction", void 0);
__decorate([
    HostBinding('attr.tabindex'),
    __metadata("design:type", Number),
    __metadata("design:paramtypes", [])
], MultiSelectTreeComponent.prototype, "hostTabIndex", null);
__decorate([
    HostBinding('attr.role'),
    __metadata("design:type", String)
], MultiSelectTreeComponent.prototype, "role", void 0);
__decorate([
    HostBinding('attr.aria-expanded'),
    __metadata("design:type", Boolean),
    __metadata("design:paramtypes", [])
], MultiSelectTreeComponent.prototype, "isAriaExpanded", null);
__decorate([
    HostBinding('attr.aria-haspopup'),
    __metadata("design:type", String)
], MultiSelectTreeComponent.prototype, "ariaHasPopup", void 0);
__decorate([
    HostBinding('attr.readonly'),
    HostBinding('attr.aria-readonly'),
    __metadata("design:type", Boolean),
    __metadata("design:paramtypes", [])
], MultiSelectTreeComponent.prototype, "isReadonly", null);
__decorate([
    HostBinding('attr.aria-describedby'),
    __metadata("design:type", String),
    __metadata("design:paramtypes", [])
], MultiSelectTreeComponent.prototype, "ariaDescribedBy", null);
__decorate([
    HostBinding('attr.aria-activedescendant'),
    __metadata("design:type", String),
    __metadata("design:paramtypes", [])
], MultiSelectTreeComponent.prototype, "ariaActiveDescendant", null);
__decorate([
    HostListener('click'),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", []),
    __metadata("design:returntype", void 0)
], MultiSelectTreeComponent.prototype, "handleClick", null);
__decorate([
    HostListener('keydown', ['$event']),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [Object]),
    __metadata("design:returntype", void 0)
], MultiSelectTreeComponent.prototype, "handleKeydown", null);
__decorate([
    ContentChild(HeaderTemplateDirective, { static: false }),
    __metadata("design:type", HeaderTemplateDirective)
], MultiSelectTreeComponent.prototype, "headerTemplate", void 0);
__decorate([
    ContentChild(FooterTemplateDirective, { static: false }),
    __metadata("design:type", FooterTemplateDirective)
], MultiSelectTreeComponent.prototype, "footerTemplate", void 0);
__decorate([
    ContentChild(NodeTemplateDirective, { static: false }),
    __metadata("design:type", NodeTemplateDirective)
], MultiSelectTreeComponent.prototype, "nodeTemplate", void 0);
__decorate([
    ContentChild(NoDataTemplateDirective, { static: false }),
    __metadata("design:type", NoDataTemplateDirective)
], MultiSelectTreeComponent.prototype, "noDataTemplate", void 0);
__decorate([
    ContentChild(TagTemplateDirective, { static: false }),
    __metadata("design:type", TagTemplateDirective)
], MultiSelectTreeComponent.prototype, "tagTemplate", void 0);
__decorate([
    ContentChild(GroupTagTemplateDirective, { static: false }),
    __metadata("design:type", GroupTagTemplateDirective)
], MultiSelectTreeComponent.prototype, "groupTagTemplate", void 0);
__decorate([
    ViewChild('popupTemplate', { static: true }),
    __metadata("design:type", TemplateRef)
], MultiSelectTreeComponent.prototype, "popupTemplate", void 0);
__decorate([
    ViewChild('container', { read: ViewContainerRef, static: true }),
    __metadata("design:type", ViewContainerRef)
], MultiSelectTreeComponent.prototype, "container", void 0);
__decorate([
    ViewChild('treeview', { static: false }),
    __metadata("design:type", TreeViewComponent),
    __metadata("design:paramtypes", [TreeViewComponent])
], MultiSelectTreeComponent.prototype, "treeview", null);
__decorate([
    ViewChild('filterInput', { static: false }),
    __metadata("design:type", ElementRef)
], MultiSelectTreeComponent.prototype, "filterInput", void 0);
__decorate([
    ViewChild('checkAllInput', { static: false }),
    __metadata("design:type", ElementRef)
], MultiSelectTreeComponent.prototype, "checkAllInput", void 0);
__decorate([
    Input(),
    __metadata("design:type", Number),
    __metadata("design:paramtypes", [Number])
], MultiSelectTreeComponent.prototype, "tabindex", null);
__decorate([
    Input(),
    __metadata("design:type", String),
    __metadata("design:paramtypes", [String])
], MultiSelectTreeComponent.prototype, "size", null);
__decorate([
    Input(),
    __metadata("design:type", String),
    __metadata("design:paramtypes", [String])
], MultiSelectTreeComponent.prototype, "rounded", null);
__decorate([
    Input(),
    __metadata("design:type", String),
    __metadata("design:paramtypes", [String])
], MultiSelectTreeComponent.prototype, "fillMode", null);
__decorate([
    Input(),
    __metadata("design:type", Object),
    __metadata("design:paramtypes", [Object])
], MultiSelectTreeComponent.prototype, "popupSettings", null);
__decorate([
    Input(),
    __metadata("design:type", Object),
    __metadata("design:paramtypes", [Object])
], MultiSelectTreeComponent.prototype, "checkableSettings", null);
__decorate([
    Input(),
    __metadata("design:type", Array),
    __metadata("design:paramtypes", [Array])
], MultiSelectTreeComponent.prototype, "data", null);
__decorate([
    Input(),
    __metadata("design:type", Array),
    __metadata("design:paramtypes", [Array])
], MultiSelectTreeComponent.prototype, "value", null);
__decorate([
    Input(),
    __metadata("design:type", Array),
    __metadata("design:paramtypes", [Array])
], MultiSelectTreeComponent.prototype, "dataItems", null);
__decorate([
    Input(),
    __metadata("design:type", Object)
], MultiSelectTreeComponent.prototype, "textField", void 0);
__decorate([
    Input(),
    __metadata("design:type", Object)
], MultiSelectTreeComponent.prototype, "valueField", void 0);
__decorate([
    Input(),
    __metadata("design:type", Array)
], MultiSelectTreeComponent.prototype, "valueDepth", void 0);
__decorate([
    Input(),
    __metadata("design:type", Boolean)
], MultiSelectTreeComponent.prototype, "loading", void 0);
__decorate([
    Input(),
    __metadata("design:type", String)
], MultiSelectTreeComponent.prototype, "placeholder", void 0);
__decorate([
    Input(),
    __metadata("design:type", Number)
], MultiSelectTreeComponent.prototype, "listHeight", void 0);
__decorate([
    Input(),
    __metadata("design:type", Boolean)
], MultiSelectTreeComponent.prototype, "disabled", void 0);
__decorate([
    Input(),
    __metadata("design:type", Boolean)
], MultiSelectTreeComponent.prototype, "readonly", void 0);
__decorate([
    Input(),
    __metadata("design:type", Boolean)
], MultiSelectTreeComponent.prototype, "valuePrimitive", void 0);
__decorate([
    Input(),
    __metadata("design:type", Boolean)
], MultiSelectTreeComponent.prototype, "loadOnDemand", void 0);
__decorate([
    Input(),
    __metadata("design:type", String)
], MultiSelectTreeComponent.prototype, "focusableId", void 0);
__decorate([
    Input(),
    __metadata("design:type", Boolean)
], MultiSelectTreeComponent.prototype, "clearButton", void 0);
__decorate([
    Input(),
    __metadata("design:type", Boolean)
], MultiSelectTreeComponent.prototype, "filterable", void 0);
__decorate([
    Input(),
    __metadata("design:type", Boolean)
], MultiSelectTreeComponent.prototype, "checkAll", void 0);
__decorate([
    Input(),
    __metadata("design:type", Function)
], MultiSelectTreeComponent.prototype, "hasChildren", void 0);
__decorate([
    Input(),
    __metadata("design:type", Function)
], MultiSelectTreeComponent.prototype, "fetchChildren", void 0);
__decorate([
    Input(),
    __metadata("design:type", Function)
], MultiSelectTreeComponent.prototype, "isNodeExpanded", void 0);
__decorate([
    Input(),
    __metadata("design:type", Function)
], MultiSelectTreeComponent.prototype, "isNodeVisible", void 0);
__decorate([
    Input(),
    __metadata("design:type", Function)
], MultiSelectTreeComponent.prototype, "itemDisabled", void 0);
__decorate([
    Input(),
    __metadata("design:type", Object)
], MultiSelectTreeComponent.prototype, "tagMapper", void 0);
__decorate([
    Output('focus'),
    __metadata("design:type", EventEmitter)
], MultiSelectTreeComponent.prototype, "onFocus", void 0);
__decorate([
    Output('blur'),
    __metadata("design:type", EventEmitter)
], MultiSelectTreeComponent.prototype, "onBlur", void 0);
__decorate([
    Output(),
    __metadata("design:type", EventEmitter)
], MultiSelectTreeComponent.prototype, "open", void 0);
__decorate([
    Output(),
    __metadata("design:type", EventEmitter)
], MultiSelectTreeComponent.prototype, "opened", void 0);
__decorate([
    Output(),
    __metadata("design:type", EventEmitter)
], MultiSelectTreeComponent.prototype, "close", void 0);
__decorate([
    Output(),
    __metadata("design:type", EventEmitter)
], MultiSelectTreeComponent.prototype, "closed", void 0);
__decorate([
    Output(),
    __metadata("design:type", EventEmitter)
], MultiSelectTreeComponent.prototype, "nodeExpand", void 0);
__decorate([
    Output(),
    __metadata("design:type", EventEmitter)
], MultiSelectTreeComponent.prototype, "nodeCollapse", void 0);
__decorate([
    Output(),
    __metadata("design:type", EventEmitter)
], MultiSelectTreeComponent.prototype, "valueChange", void 0);
__decorate([
    Output(),
    __metadata("design:type", EventEmitter)
], MultiSelectTreeComponent.prototype, "removeTag", void 0);
__decorate([
    Output(),
    __metadata("design:type", EventEmitter)
], MultiSelectTreeComponent.prototype, "filterChange", void 0);
MultiSelectTreeComponent = MultiSelectTreeComponent_1 = __decorate([ __param(7, Optional()), __param(7, Inject(TOUCH_ENABLED)),
    __metadata("design:paramtypes", [ElementRef,
        PopupService,
        Renderer2,
        NavigationService,
        NgZone,
        LocalizationService,
        ChangeDetectorRef, Boolean])
], MultiSelectTreeComponent);

/**
 * A directive which encapsulates the retrieval of the child nodes when flat data is provided.
 */
let DropDownTreeFlatBindingDirective = class DropDownTreeFlatBindingDirective extends FlatDataBindingDirective {
    constructor(dropDownTree) {
        super(dropDownTree);
    }
};
DropDownTreeFlatBindingDirective.ɵfac = function DropDownTreeFlatBindingDirective_Factory(t) { return new (t || DropDownTreeFlatBindingDirective)(ɵngcc0.ɵɵdirectiveInject(ɵngcc6.DataBoundComponent)); };
DropDownTreeFlatBindingDirective.ɵdir = /*@__PURE__*/ ɵngcc0.ɵɵdefineDirective({ type: DropDownTreeFlatBindingDirective, selectors: [["", "kendoDropDownTreeFlatBinding", ""]], inputs: { nodes: ["kendoDropDownTreeFlatBinding", "nodes"], idField: ["valueField", "idField"] }, features: [ɵngcc0.ɵɵInheritDefinitionFeature] });
__decorate([
    Input('kendoDropDownTreeFlatBinding'),
    __metadata("design:type", Array)
], DropDownTreeFlatBindingDirective.prototype, "nodes", void 0);
__decorate([
    Input('valueField'),
    __metadata("design:type", String)
], DropDownTreeFlatBindingDirective.prototype, "idField", void 0);
DropDownTreeFlatBindingDirective = __decorate([ __metadata("design:paramtypes", [DataBoundComponent])
], DropDownTreeFlatBindingDirective);

/**
 * A directive which encapsulates the retrieval of the child nodes when hierarchical data is provided.
 */
let DropDownTreeHierarchyBindingDirective = class DropDownTreeHierarchyBindingDirective extends HierarchyBindingDirective {
    constructor(dropDownTree) {
        super(dropDownTree);
        this.dropDownTree = dropDownTree;
    }
    /**
     * The nodes which will be displayed by the DropDownTree.
     */
    set data(nodes) {
        this.dropDownTree.nodes = nodes;
        this.nodes = nodes;
    }
};
DropDownTreeHierarchyBindingDirective.ɵfac = function DropDownTreeHierarchyBindingDirective_Factory(t) { return new (t || DropDownTreeHierarchyBindingDirective)(ɵngcc0.ɵɵdirectiveInject(ɵngcc6.DataBoundComponent)); };
DropDownTreeHierarchyBindingDirective.ɵdir = /*@__PURE__*/ ɵngcc0.ɵɵdefineDirective({ type: DropDownTreeHierarchyBindingDirective, selectors: [["", "kendoDropDownTreeHierarchyBinding", ""]], inputs: { data: ["kendoDropDownTreeHierarchyBinding", "data"] }, features: [ɵngcc0.ɵɵInheritDefinitionFeature] });
__decorate([
    Input('kendoDropDownTreeHierarchyBinding'),
    __metadata("design:type", Array),
    __metadata("design:paramtypes", [Array])
], DropDownTreeHierarchyBindingDirective.prototype, "data", null);
DropDownTreeHierarchyBindingDirective = __decorate([ __metadata("design:paramtypes", [DataBoundComponent])
], DropDownTreeHierarchyBindingDirective);

/**
 * A directive which encapsulates the retrieval of the child nodes when flat data is provided.
 */
let MultiSelectTreeFlatBindingDirective = class MultiSelectTreeFlatBindingDirective extends FlatDataBindingDirective {
    constructor(multiSelectTree) {
        super(multiSelectTree);
    }
};
MultiSelectTreeFlatBindingDirective.ɵfac = function MultiSelectTreeFlatBindingDirective_Factory(t) { return new (t || MultiSelectTreeFlatBindingDirective)(ɵngcc0.ɵɵdirectiveInject(ɵngcc6.DataBoundComponent)); };
MultiSelectTreeFlatBindingDirective.ɵdir = /*@__PURE__*/ ɵngcc0.ɵɵdefineDirective({ type: MultiSelectTreeFlatBindingDirective, selectors: [["", "kendoMultiSelectTreeFlatBinding", ""]], inputs: { nodes: ["kendoMultiSelectTreeFlatBinding", "nodes"], idField: ["valueField", "idField"] }, features: [ɵngcc0.ɵɵInheritDefinitionFeature] });
__decorate([
    Input('kendoMultiSelectTreeFlatBinding'),
    __metadata("design:type", Array)
], MultiSelectTreeFlatBindingDirective.prototype, "nodes", void 0);
__decorate([
    Input('valueField'),
    __metadata("design:type", String)
], MultiSelectTreeFlatBindingDirective.prototype, "idField", void 0);
MultiSelectTreeFlatBindingDirective = __decorate([ __metadata("design:paramtypes", [DataBoundComponent])
], MultiSelectTreeFlatBindingDirective);

/**
 * A directive which encapsulates the retrieval of the child nodes when hierarchical data is provided.
 */
let MultiSelectTreeHierarchyBindingDirective = class MultiSelectTreeHierarchyBindingDirective extends HierarchyBindingDirective {
    constructor(multiSelectTree) {
        super(multiSelectTree);
        this.multiSelectTree = multiSelectTree;
    }
    /**
     * The nodes which will be displayed by the MultiSelectTree.
     */
    set data(nodes) {
        this.multiSelectTree.nodes = nodes;
        this.nodes = nodes;
    }
};
MultiSelectTreeHierarchyBindingDirective.ɵfac = function MultiSelectTreeHierarchyBindingDirective_Factory(t) { return new (t || MultiSelectTreeHierarchyBindingDirective)(ɵngcc0.ɵɵdirectiveInject(ɵngcc6.DataBoundComponent)); };
MultiSelectTreeHierarchyBindingDirective.ɵdir = /*@__PURE__*/ ɵngcc0.ɵɵdefineDirective({ type: MultiSelectTreeHierarchyBindingDirective, selectors: [["", "kendoMultiSelectTreeHierarchyBinding", ""]], inputs: { data: ["kendoMultiSelectTreeHierarchyBinding", "data"] }, features: [ɵngcc0.ɵɵInheritDefinitionFeature] });
__decorate([
    Input('kendoMultiSelectTreeHierarchyBinding'),
    __metadata("design:type", Array),
    __metadata("design:paramtypes", [Array])
], MultiSelectTreeHierarchyBindingDirective.prototype, "data", null);
MultiSelectTreeHierarchyBindingDirective = __decorate([ __metadata("design:paramtypes", [DataBoundComponent])
], MultiSelectTreeHierarchyBindingDirective);

/**
 * A directive which manages the expanded state of the popup TreeView.
 */
let DropDownTreesExpandDirective = class DropDownTreesExpandDirective extends ExpandDirective {
    constructor(dropDownTree) {
        super(dropDownTree);
    }
};
DropDownTreesExpandDirective.ɵfac = function DropDownTreesExpandDirective_Factory(t) { return new (t || DropDownTreesExpandDirective)(ɵngcc0.ɵɵdirectiveInject(ɵngcc6.ExpandableComponent)); };
DropDownTreesExpandDirective.ɵdir = /*@__PURE__*/ ɵngcc0.ɵɵdefineDirective({ type: DropDownTreesExpandDirective, selectors: [["", "kendoDropDownTreeExpandable", ""], ["", "kendoMultiSelectTreeExpandable", ""]], inputs: { isExpanded: ["isNodeExpanded", "isExpanded"] }, features: [ɵngcc0.ɵɵInheritDefinitionFeature] });
__decorate([
    Input('isNodeExpanded'),
    __metadata("design:type", Function)
], DropDownTreesExpandDirective.prototype, "isExpanded", void 0);
DropDownTreesExpandDirective = __decorate([ __metadata("design:paramtypes", [ExpandableComponent])
], DropDownTreesExpandDirective);

/**
 * @hidden
 */
let TagListComponent = class TagListComponent {
    constructor(renderer, hostElement) {
        this.renderer = renderer;
        this.hostElement = hostElement;
        this.rounded = 'medium';
        this.fillMode = 'solid';
        /**
         * A collection with the disabled tags' indices.
         */
        this.disabledIndices = new Set();
        this.removeTag = new EventEmitter();
        this.hostClasses = true;
        this._size = 'medium';
    }
    set size(size) {
        this.renderer.removeClass(this.hostElement.nativeElement, getSizeClass('chip-list', this.size));
        if (size) {
            this.renderer.addClass(this.hostElement.nativeElement, getSizeClass('chip-list', size));
        }
        this._size = size;
    }
    get size() {
        return this._size;
    }
    get hostId() {
        return this.id;
    }
    tagProp(tag, prop, index) {
        const propField = prop && this.getPropField(tag, prop, index);
        return getter$1(tag, propField);
    }
    isTagDisabled(tag, positionIndex) {
        if (this.isGroupTag(tag)) {
            /** The `positionIndex` is used to determine after how many single tags is the group tag displayed =>
             * => it is used to increment the indices inside the group tag so that we determine the actual position index
             * of each group tag item as they appear in the `value` (important to check against `disabledIndices`)
             * e.g. `disabledIndices = [0, 1]` && `tags = ['Small', ['Medium', 'Large']]` => without the incrementation with
             * `positionIndex`, the group tag would yield [0, 1] as indices, while it should yield [1, 2]
             */
            return tag.every((_tag, index) => this.disabledIndices.has(index + positionIndex));
        }
        return this.disabledIndices.has(positionIndex);
    }
    deleteTag(event, tag, index) {
        event.preventDefault();
        event.stopImmediatePropagation();
        if (!this.disabled && event.which === 1) {
            this.removeTag.emit({ tag, index });
        }
    }
    itemId(tag, index) {
        if (tag) { //because of custom values
            return this.tagPrefix + "-" + this.tagProp(tag, this.valueField, index);
        }
    }
    isGroupTag(tag) {
        return tag instanceof Array;
    }
    tagAriaHidden(index) {
        return isPresent(this.focused) && this.focused !== index;
    }
    getPropField(tag, prop, index) {
        // Needed for MultiSelectTree value binding (Heterogeneous Data)
        const fieldsCount = prop.length - 1;
        if (typeof prop === 'string') {
            return prop;
        }
        else if (this.valueDepth) {
            const depth = this.valueDepth[index];
            return fieldsCount < depth ? prop[fieldsCount] : prop[depth];
        }
        else {
            return prop.find(item => item in tag);
        }
    }
};
TagListComponent.ɵfac = function TagListComponent_Factory(t) { return new (t || TagListComponent)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.Renderer2), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ElementRef)); };
TagListComponent.ɵcmp = /*@__PURE__*/ ɵngcc0.ɵɵdefineComponent({ type: TagListComponent, selectors: [["kendo-taglist"]], hostVars: 7, hostBindings: function TagListComponent_HostBindings(rf, ctx) { if (rf & 2) {
        ɵngcc0.ɵɵattribute("id", ctx.hostId);
        ɵngcc0.ɵɵclassProp("k-input-values", ctx.hostClasses)("k-chip-list", ctx.hostClasses)("k-selection-multiple", ctx.hostClasses);
    } }, inputs: { rounded: "rounded", fillMode: "fillMode", disabledIndices: "disabledIndices", size: "size", tags: "tags", textField: "textField", valueField: "valueField", valueDepth: "valueDepth", focused: "focused", template: "template", groupTemplate: "groupTemplate", disabled: "disabled", tagPrefix: "tagPrefix", id: "id" }, outputs: { removeTag: "removeTag" }, ngContentSelectors: _c58, decls: 2, vars: 1, consts: [["class", "k-chip", 3, "ngClass", 4, "ngFor", "ngForOf"], [1, "k-chip", 3, "ngClass"], [1, "k-chip-content"], [4, "ngIf", "ngIfThen", "ngIfElse"], ["groupTag", ""], ["singleTag", ""], [1, "k-chip-actions"], ["aria-label", "delete", 1, "k-chip-action", "k-chip-remove-action"], [1, "k-icon", "k-i-x-circle", 3, "mousedown"], [1, "k-chip-label", "k-text-ellipsis"], [4, "ngIf"], [3, "ngIf"], [3, "templateContext"]], template: function TagListComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵprojectionDef();
        ɵngcc0.ɵɵtemplate(0, TagListComponent_div_0_Template, 10, 20, "div", 0);
        ɵngcc0.ɵɵprojection(1);
    } if (rf & 2) {
        ɵngcc0.ɵɵproperty("ngForOf", ctx.tags);
    } }, directives: function () { return [ɵngcc3.NgForOf, ɵngcc3.NgClass, ɵngcc3.NgIf, TemplateContextDirective]; }, encapsulation: 2 });
__decorate([
    Input(),
    __metadata("design:type", Array)
], TagListComponent.prototype, "tags", void 0);
__decorate([
    Input(),
    __metadata("design:type", Object)
], TagListComponent.prototype, "textField", void 0);
__decorate([
    Input(),
    __metadata("design:type", String)
], TagListComponent.prototype, "valueField", void 0);
__decorate([
    Input(),
    __metadata("design:type", Array)
], TagListComponent.prototype, "valueDepth", void 0);
__decorate([
    Input(),
    __metadata("design:type", Number)
], TagListComponent.prototype, "focused", void 0);
__decorate([
    Input(),
    __metadata("design:type", TagTemplateDirective)
], TagListComponent.prototype, "template", void 0);
__decorate([
    Input(),
    __metadata("design:type", GroupTagTemplateDirective)
], TagListComponent.prototype, "groupTemplate", void 0);
__decorate([
    Input(),
    __metadata("design:type", Boolean)
], TagListComponent.prototype, "disabled", void 0);
__decorate([
    Input(),
    __metadata("design:type", String)
], TagListComponent.prototype, "tagPrefix", void 0);
__decorate([
    Input(),
    __metadata("design:type", String)
], TagListComponent.prototype, "id", void 0);
__decorate([
    Input(),
    __metadata("design:type", String),
    __metadata("design:paramtypes", [String])
], TagListComponent.prototype, "size", null);
__decorate([
    Input(),
    __metadata("design:type", String)
], TagListComponent.prototype, "rounded", void 0);
__decorate([
    Input(),
    __metadata("design:type", String)
], TagListComponent.prototype, "fillMode", void 0);
__decorate([
    Input(),
    __metadata("design:type", Set)
], TagListComponent.prototype, "disabledIndices", void 0);
__decorate([
    Output(),
    __metadata("design:type", EventEmitter)
], TagListComponent.prototype, "removeTag", void 0);
__decorate([
    HostBinding('class.k-input-values'),
    HostBinding('class.k-chip-list'),
    HostBinding('class.k-selection-multiple'),
    __metadata("design:type", Boolean)
], TagListComponent.prototype, "hostClasses", void 0);
__decorate([
    HostBinding('attr.id'),
    __metadata("design:type", String),
    __metadata("design:paramtypes", [])
], TagListComponent.prototype, "hostId", null);
TagListComponent = __decorate([ __metadata("design:paramtypes", [Renderer2,
        ElementRef])
], TagListComponent);

/**
 * @hidden
 */
class Messages extends ComponentMessages {
}
Messages.ɵfac = /*@__PURE__*/ function () { let ɵMessages_BaseFactory; return function Messages_Factory(t) { return (ɵMessages_BaseFactory || (ɵMessages_BaseFactory = ɵngcc0.ɵɵgetInheritedFactory(Messages)))(t || Messages); }; }();
Messages.ɵdir = /*@__PURE__*/ ɵngcc0.ɵɵdefineDirective({ type: Messages, inputs: { noDataText: "noDataText", clearTitle: "clearTitle", checkAllText: "checkAllText", selectButtonText: "selectButtonText" }, features: [ɵngcc0.ɵɵInheritDefinitionFeature] });
__decorate([
    Input(),
    __metadata("design:type", String)
], Messages.prototype, "noDataText", void 0);
__decorate([
    Input(),
    __metadata("design:type", String)
], Messages.prototype, "clearTitle", void 0);
__decorate([
    Input(),
    __metadata("design:type", String)
], Messages.prototype, "checkAllText", void 0);
__decorate([
    Input(),
    __metadata("design:type", String)
], Messages.prototype, "selectButtonText", void 0);

var LocalizedMessagesDirective_1;
/**
 * @hidden
 */
let LocalizedMessagesDirective = LocalizedMessagesDirective_1 = class LocalizedMessagesDirective extends Messages {
    constructor(service) {
        super();
        this.service = service;
    }
};
LocalizedMessagesDirective.ɵfac = function LocalizedMessagesDirective_Factory(t) { return new (t || LocalizedMessagesDirective)(ɵngcc0.ɵɵdirectiveInject(ɵngcc1.LocalizationService)); };
LocalizedMessagesDirective.ɵdir = /*@__PURE__*/ ɵngcc0.ɵɵdefineDirective({ type: LocalizedMessagesDirective, selectors: [["", "kendoDropDownListLocalizedMessages", ""], ["", "kendoDropDownTreeLocalizedMessages", ""], ["", "kendoComboBoxLocalizedMessages", ""], ["", "kendoMultiColumnComboBoxLocalizedMessages", ""], ["", "kendoAutoCompleteLocalizedMessages", ""], ["", "kendoMultiSelectLocalizedMessages", ""], ["", "kendoMultiSelectTreeLocalizedMessages", ""]], features: [ɵngcc0.ɵɵProvidersFeature([
            {
                provide: Messages,
                useExisting: forwardRef(() => LocalizedMessagesDirective_1)
            }
        ]), ɵngcc0.ɵɵInheritDefinitionFeature] });
LocalizedMessagesDirective = LocalizedMessagesDirective_1 = __decorate([ __metadata("design:paramtypes", [LocalizationService])
], LocalizedMessagesDirective);

var CustomMessagesComponent_1;
/**
 * Custom component messages override default component messages
 * ([see example]({% slug rtl_dropdowns %}#toc-messages)).
 */
let CustomMessagesComponent = CustomMessagesComponent_1 = class CustomMessagesComponent extends Messages {
    constructor(service) {
        super();
        this.service = service;
    }
    get override() {
        return true;
    }
};
CustomMessagesComponent.ɵfac = function CustomMessagesComponent_Factory(t) { return new (t || CustomMessagesComponent)(ɵngcc0.ɵɵdirectiveInject(ɵngcc1.LocalizationService)); };
CustomMessagesComponent.ɵcmp = /*@__PURE__*/ ɵngcc0.ɵɵdefineComponent({ type: CustomMessagesComponent, selectors: [["kendo-dropdownlist-messages"], ["kendo-combobox-messages"], ["kendo-multicolumncombobox-messages"], ["kendo-autocomplete-messages"], ["kendo-multiselect-messages"], ["kendo-dropdowntree-messages"], ["kendo-multiselecttree-messages"]], features: [ɵngcc0.ɵɵProvidersFeature([
            {
                provide: Messages,
                useExisting: forwardRef(() => CustomMessagesComponent_1)
            }
        ]), ɵngcc0.ɵɵInheritDefinitionFeature], decls: 0, vars: 0, template: function CustomMessagesComponent_Template(rf, ctx) { }, encapsulation: 2 });
CustomMessagesComponent = CustomMessagesComponent_1 = __decorate([ __metadata("design:paramtypes", [LocalizationService])
], CustomMessagesComponent);

const DEFAULT_FILTER_SETTINGS = {
    caseSensitive: false,
    operator: 'startsWith'
};
/**
 * Implements an event handler for the `filterChange` event of a DropDowns component
 * which performs simple data filtering.
 *
 * @example
 * ```ts
 * _@Component({
 * selector: 'my-app',
 * template: `
 *  <kendo-autocomplete
 *      [data]="data"
 *      kendoDropDownFilter
 *      placeholder="e.g. Andorra"
 *  >
 *  </kendo-autocomplete>
 * `
 * })
 * class AppComponent {
 *     public data: Array<string> = ["Albania", "Andorra", "Armenia", "Austria", "Azerbaijan"];
 * }
 * ```
 * > Currently, the built-in filtering does not work with [grouped data]({% slug api_kendo-data-query_groupby %}).
 */
let FilterDirective = class FilterDirective {
    constructor(component) {
        this.component = component;
        /**
         * @hidden
         *
         * Sets whether the filtering functionality is enabled on component init.
         */
        this.filterable = true;
        this._data = [];
    }
    /**
     * The initial data that will be used as a source array for the filtering operations.
     */
    set data(data) {
        this._data = data || [];
    }
    get data() {
        return this._data;
    }
    ngOnInit() {
        this.component.filterable = this.filterable;
        this.filterChangeSubscription = this.component.filterChange
            .subscribe(this.handleFilterChange.bind(this));
    }
    ngOnDestroy() {
        if (isPresent(this.filterChangeSubscription)) {
            this.filterChangeSubscription.unsubscribe();
        }
    }
    handleFilterChange(query) {
        this.component.data = this.data.filter(item => this.matchesAnyField(item, query));
    }
    matchesAnyField(item, query) {
        const normalizedQuery = this.normalizeValue(query);
        const { fields } = this.filterSettings;
        // if no filter fields are present, we are dealing with primitive data
        if (fields.length === 0) {
            return this.checkItem(item, normalizedQuery);
        }
        return fields.some(field => this.checkItem(getter$1(item, field), normalizedQuery));
    }
    checkItem(target, query) {
        target = this.normalizeValue(target);
        if (this.filterSettings.operator === 'contains') {
            return target.indexOf(query) !== -1;
        }
        else {
            return target.indexOf(query) === 0;
        }
    }
    normalizeValue(value) {
        const normalizedValue = isPresent(value) ? value.toString() : '';
        return this.filterSettings.caseSensitive ? normalizedValue : normalizedValue.toLowerCase();
    }
    getFilterFields(providedFields) {
        // ignore provided fields if the component deals with primitive data
        if (!this.component.textField && !this.component.valueField) {
            return [];
        }
        if (isArray(providedFields) && providedFields.length > 0) {
            return providedFields;
        }
        else {
            // the autocomplete uses `valueField` for text extraction
            const textField = this.component.textField || this.component.valueField;
            return [textField];
        }
    }
    get filterSettings() {
        const settings = this.rawSettings;
        const providedFields = isPresent(settings) && typeof settings === 'object' ? settings.fields : [];
        return Object.assign({}, DEFAULT_FILTER_SETTINGS, settings, { fields: this.getFilterFields(providedFields) });
    }
};
FilterDirective.ɵfac = function FilterDirective_Factory(t) { return new (t || FilterDirective)(ɵngcc0.ɵɵdirectiveInject(FilterableComponent)); };
FilterDirective.ɵdir = /*@__PURE__*/ ɵngcc0.ɵɵdefineDirective({ type: FilterDirective, selectors: [["", "kendoDropDownFilter", ""]], inputs: { filterable: "filterable", data: "data", rawSettings: ["kendoDropDownFilter", "rawSettings"] } });
__decorate([
    Input(),
    __metadata("design:type", Array),
    __metadata("design:paramtypes", [Array])
], FilterDirective.prototype, "data", null);
__decorate([
    Input('kendoDropDownFilter'),
    __metadata("design:type", Object)
], FilterDirective.prototype, "rawSettings", void 0);
__decorate([
    Input(),
    __metadata("design:type", Boolean)
], FilterDirective.prototype, "filterable", void 0);
FilterDirective = __decorate([ __metadata("design:paramtypes", [FilterableComponent])
], FilterDirective);

/**
 * @hidden
 */
let FilterInputDirective = class FilterInputDirective {
    constructor(element, zone) {
        this.element = element;
        this.zone = zone;
    }
    ngOnChanges() {
        if (this.focused) {
            this.nextTick(() => this.element.nativeElement.focus());
        }
    }
    nextTick(fn) {
        this.zone.runOutsideAngular(() => setTimeout(fn));
    }
};
FilterInputDirective.ɵfac = function FilterInputDirective_Factory(t) { return new (t || FilterInputDirective)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ElementRef), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.NgZone)); };
FilterInputDirective.ɵdir = /*@__PURE__*/ ɵngcc0.ɵɵdefineDirective({ type: FilterInputDirective, selectors: [["", "filterInput", ""]], inputs: { focused: ["filterInput", "focused"] }, features: [ɵngcc0.ɵɵNgOnChangesFeature] });
__decorate([
    Input('filterInput'),
    __metadata("design:type", Boolean)
], FilterInputDirective.prototype, "focused", void 0);
FilterInputDirective = __decorate([ __metadata("design:paramtypes", [ElementRef,
        NgZone])
], FilterInputDirective);

const SHARED_DIRECTIVES = [
    HeaderTemplateDirective,
    FooterTemplateDirective,
    ItemTemplateDirective,
    GroupTemplateDirective,
    FixedGroupTemplateDirective,
    NoDataTemplateDirective,
    ValueTemplateDirective,
    TagTemplateDirective,
    GroupTagTemplateDirective,
    LocalizedMessagesDirective,
    CustomMessagesComponent,
    FilterDirective,
    FilterInputDirective
];
/**
 * @hidden
 *
 * The exported package module.
 *
 * The package exports:
 * - `ItemTemplateDirective`&mdash;The item template directive.
 * - `ValueTemplateDirective`&mdash;The value template directive.
 * - `HeaderTemplateDirective`&mdash;The header template directive.
 * - `FooterTemplateDirective`&mdash;The footer template directive.
 * - `NoDataTemplateDirective`&mdash;The noData template directive.
 * - `TagTemplateDirective`&mdash;The tag template directive.
 * - `SummaryTagTemplateDirective`&mdash;The summary tag template directive.
 */
let SharedDirectivesModule = class SharedDirectivesModule {
};
SharedDirectivesModule.ɵfac = function SharedDirectivesModule_Factory(t) { return new (t || SharedDirectivesModule)(); };
SharedDirectivesModule.ɵmod = /*@__PURE__*/ ɵngcc0.ɵɵdefineNgModule({ type: SharedDirectivesModule });
SharedDirectivesModule.ɵinj = /*@__PURE__*/ ɵngcc0.ɵɵdefineInjector({});

/**
 * @hidden
 */
let SelectableDirective = class SelectableDirective {
    constructor(selectionService) {
        this.checkboxes = { enabled: false };
        // @HostBinding('attr.offset-index')
        // @Input() public offsetIndex: number;
        this.multipleSelection = false;
        this.selectionService = selectionService;
    }
    get focusedClassName() {
        return this.selectionService.isFocused(this.index);
    }
    get selectedClassName() {
        return !this.checkboxes.enabled && this.selectionService.isSelected(this.index);
    }
    onClick(event) {
        event.stopPropagation();
        if (this.checkboxes.enabled && !this.checkboxes.checkOnClick) {
            return;
        }
        if (this.multipleSelection) {
            if (this.selectionService.isSelected(this.index)) {
                this.selectionService.unselect(this.index);
            }
            else {
                this.selectionService.add(this.index);
            }
        }
        else {
            this.selectionService.change(this.index);
        }
    }
};
SelectableDirective.ɵfac = function SelectableDirective_Factory(t) { return new (t || SelectableDirective)(ɵngcc0.ɵɵdirectiveInject(SelectionService)); };
SelectableDirective.ɵdir = /*@__PURE__*/ ɵngcc0.ɵɵdefineDirective({ type: SelectableDirective, selectors: [["", "kendoDropDownsSelectable", ""]], hostVars: 9, hostBindings: function SelectableDirective_HostBindings(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵlistener("click", function SelectableDirective_click_HostBindingHandler($event) { return ctx.onClick($event); });
    } if (rf & 2) {
        ɵngcc0.ɵɵattribute("index", ctx.index);
        ɵngcc0.ɵɵstyleProp("height", ctx.height, "px")("min-height", ctx.height, "px");
        ɵngcc0.ɵɵclassProp("k-focus", ctx.focusedClassName)("k-selected", ctx.selectedClassName);
    } }, inputs: { checkboxes: "checkboxes", multipleSelection: "multipleSelection", index: "index", height: "height" } });
__decorate([
    HostBinding('attr.index'),
    Input(),
    __metadata("design:type", Number)
], SelectableDirective.prototype, "index", void 0);
__decorate([
    Input(),
    __metadata("design:type", Object)
], SelectableDirective.prototype, "checkboxes", void 0);
__decorate([
    HostBinding('style.height.px'),
    HostBinding('style.minHeight.px'),
    Input(),
    __metadata("design:type", Number)
], SelectableDirective.prototype, "height", void 0);
__decorate([
    Input(),
    __metadata("design:type", Boolean)
], SelectableDirective.prototype, "multipleSelection", void 0);
__decorate([
    HostBinding('class.k-focus'),
    __metadata("design:type", Boolean),
    __metadata("design:paramtypes", [])
], SelectableDirective.prototype, "focusedClassName", null);
__decorate([
    HostBinding('class.k-selected'),
    __metadata("design:type", Boolean),
    __metadata("design:paramtypes", [])
], SelectableDirective.prototype, "selectedClassName", null);
__decorate([
    HostListener('click', ['$event']),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [Object]),
    __metadata("design:returntype", void 0)
], SelectableDirective.prototype, "onClick", null);
SelectableDirective = __decorate([ __metadata("design:paramtypes", [SelectionService])
], SelectableDirective);

/**
 * @hidden
 */
let TemplateContextDirective = class TemplateContextDirective {
    constructor(viewContainerRef) {
        this.viewContainerRef = viewContainerRef;
    }
    set templateContext(context) {
        if (this.insertedViewRef) {
            this.viewContainerRef.remove(this.viewContainerRef.indexOf(this.insertedViewRef));
            this.insertedViewRef = undefined;
        }
        if (context.templateRef) {
            this.insertedViewRef = this.viewContainerRef.createEmbeddedView(context.templateRef, context);
        }
    }
};
TemplateContextDirective.ɵfac = function TemplateContextDirective_Factory(t) { return new (t || TemplateContextDirective)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ViewContainerRef)); };
TemplateContextDirective.ɵdir = /*@__PURE__*/ ɵngcc0.ɵɵdefineDirective({ type: TemplateContextDirective, selectors: [["", "templateContext", ""]], inputs: { templateContext: "templateContext" } });
__decorate([
    Input(),
    __metadata("design:type", Object),
    __metadata("design:paramtypes", [Object])
], TemplateContextDirective.prototype, "templateContext", null);
TemplateContextDirective = __decorate([ __metadata("design:paramtypes", [ViewContainerRef])
], TemplateContextDirective);

/**
 * @hidden
 *
 * A directive which manages the in-memory checked state of the MultiSelectTree nodes.
 */
class BaseCheckDirective {
    addItem(item) {
        if (this.isItemChecked(item)) {
            return;
        }
        const level = getHierarchicalItemLevel(item.index);
        const candidate = Object.assign({}, item, { level });
        this.checkedItems.push(candidate);
        this.checkedKeys.add(this.getKey(candidate));
    }
    removeItem(item) {
        if (!this.isItemChecked(item)) {
            return;
        }
        const level = getHierarchicalItemLevel(item.index);
        const candidate = Object.assign({}, item, { level });
        this.checkedItems = this.checkedItems
            .filter(item => valueFrom(item, this.valueField) !== valueFrom(candidate, this.valueField));
        this.checkedKeys.delete(this.getKey(candidate));
    }
    isItemChecked(item) {
        const level = item.index.split('_').length - 1;
        item.level = level;
        return this.checkedKeys.has(this.getKey(item));
    }
    updateItems() {
        this.checkedItems = this.checkedItems || [];
        this.checkedKeys = new Set(this.checkedItems.map(item => this.getKey(item)));
    }
    /**
     * Adds the item's depth to the item's value to allow duplicate values on different levels.
     *
     * @param item - The checked key.
     * @returns { string } - A string key consisting of the item's `valueField` value and its depth.
     */
    getKey(item) {
        if (isArray(this.valueField)) {
            return valueFrom(item, this.valueField) + '_' + item.level;
        }
        return valueFrom(item, this.valueField);
    }
}
BaseCheckDirective.ɵfac = function BaseCheckDirective_Factory(t) { return new (t || BaseCheckDirective)(); };
BaseCheckDirective.ɵdir = /*@__PURE__*/ ɵngcc0.ɵɵdefineDirective({ type: BaseCheckDirective, inputs: { checkedItems: "checkedItems", valueField: "valueField" } });
__decorate([
    Input(),
    __metadata("design:type", Object)
], BaseCheckDirective.prototype, "valueField", void 0);
__decorate([
    Input(),
    __metadata("design:type", Array)
], BaseCheckDirective.prototype, "checkedItems", void 0);

/**
 * @hidden
 *
 * A directive which manages the in-memory checked state of the MultiSelectTree nodes.
 */
let CheckDirective = class CheckDirective extends BaseCheckDirective {
    constructor(treeView) {
        super();
        this.treeView = treeView;
        /**
         * Fires when the `checkedItems` collection was updated.
         */
        this.checkedItemsChange = new EventEmitter();
        /**
         * Holds a Set with just the checked item keys.
         *
         * Should be updated each time the `checkedItems` value or content is changed.
         * Can be used for efficient look-up of whether an item is checked or not (O(1) access time).
         */
        this.checkedKeys = new Set();
        this.subscriptions = new Subscription();
        this.subscriptions.add(this.treeView.checkedChange
            .subscribe(this.handleCheckedChange.bind(this)));
        this.treeView.isChecked = this.getCheckedState.bind(this);
    }
    ngOnChanges(changes) {
        if (isPresent(changes.checkable)) {
            this.toggleCheckOnClick();
        }
        if (isPresent(changes.checkedItems)) {
            this.updateItems();
        }
    }
    ngOnDestroy() {
        this.subscriptions.unsubscribe();
        this.unsubscribeClick();
    }
    getCheckedState(dataItem, index) {
        if (this.isItemChecked({ dataItem, index })) {
            return 'checked';
        }
        else if (this.checkable.checkChildren && this.isItemIndeterminate(this.treeView.itemLookup(index))) {
            return 'indeterminate';
        }
        else {
            return 'none';
        }
    }
    handleCheckedChange(node) {
        this.checkNode(node);
        // parents should be checked if `checkChildren` is set to `true` (single config option for both)
        const checkParents = this.checkable.checkChildren;
        if (checkParents) {
            this.checkParents(node.parent);
        }
        this.checkedItemsChange.emit(this.checkedItems.slice());
    }
    toggleCheckOnClick() {
        this.unsubscribeClick();
        if (this.checkable.checkOnClick) {
            this.clickSubscription = this.treeView.nodeClick
                .pipe(filter(event => event.type === 'click'))
                .subscribe(event => {
                const lookup = this.treeView.itemLookup(event.item.index);
                this.handleCheckedChange(lookup);
            });
        }
    }
    unsubscribeClick() {
        if (this.clickSubscription) {
            this.clickSubscription.unsubscribe();
            this.clickSubscription = null;
        }
    }
    checkNode(lookup) {
        if (this.treeView.isDisabled(lookup.item.dataItem, lookup.item.index)) {
            return;
        }
        const target = lookup.item;
        const pendingCheck = [target];
        // TODO: extract in a separate `checkChildren` method?
        if (this.checkable.checkChildren) {
            const filter$$1 = (item) => this.treeView.isVisible(item.dataItem, item.index) &&
                !this.treeView.isDisabled(item.dataItem, item.index);
            fetchDescendentNodes(lookup, filter$$1)
                .forEach(lookup => pendingCheck.push(lookup.item));
        }
        const shouldCheck = !this.isItemChecked(target);
        pendingCheck.forEach(item => {
            if (shouldCheck) {
                this.addItem(item);
            }
            else {
                this.removeItem(item);
            }
        });
    }
    checkParents(parent) {
        let currentParent = parent;
        while (currentParent) {
            const allChildrenSelected = currentParent.children.every(item => this.isItemChecked(item));
            if (allChildrenSelected) {
                this.addItem(currentParent.item);
            }
            else {
                this.removeItem(currentParent.item);
            }
            currentParent = currentParent.parent;
        }
    }
    isItemIndeterminate(lookup) {
        const children = lookup.children;
        if (!Array.isArray(children) || children.length === 0) {
            return false;
        }
        let index = 0;
        let child = children[index];
        while (isPresent(child)) {
            if (this.isItemChecked(child.item) || this.isItemIndeterminate(child)) {
                return true;
            }
            index += 1;
            child = children[index];
        }
        return false;
    }
};
CheckDirective.ɵfac = function CheckDirective_Factory(t) { return new (t || CheckDirective)(ɵngcc0.ɵɵdirectiveInject(ɵngcc6.TreeViewComponent)); };
CheckDirective.ɵdir = /*@__PURE__*/ ɵngcc0.ɵɵdefineDirective({ type: CheckDirective, selectors: [["", "kendoMultiSelectTreeCheckable", ""]], inputs: { checkable: "checkable", valueField: "valueField", checkedItems: "checkedItems" }, outputs: { checkedItemsChange: "checkedItemsChange" }, features: [ɵngcc0.ɵɵInheritDefinitionFeature, ɵngcc0.ɵɵNgOnChangesFeature] });
__decorate([
    Input(),
    __metadata("design:type", Object)
], CheckDirective.prototype, "checkable", void 0);
__decorate([
    Input(),
    __metadata("design:type", Object)
], CheckDirective.prototype, "valueField", void 0);
__decorate([
    Input(),
    __metadata("design:type", Array)
], CheckDirective.prototype, "checkedItems", void 0);
__decorate([
    Output(),
    __metadata("design:type", EventEmitter)
], CheckDirective.prototype, "checkedItemsChange", void 0);
CheckDirective = __decorate([ __metadata("design:paramtypes", [TreeViewComponent])
], CheckDirective);

/**
 * @hidden
 *
 * A directive which manages the in-memory checked state of the MultiSelectTree nodes.
 */
let CheckAllDirective = class CheckAllDirective extends BaseCheckDirective {
    constructor(element, zone, cdr, renderer) {
        super();
        this.element = element;
        this.zone = zone;
        this.cdr = cdr;
        this.renderer = renderer;
        /**
         * Fires when the `checkedItems` collection was updated.
         */
        this.checkedItemsChange = new EventEmitter();
        /**
         * Holds a Set with just the checked item keys.
         *
         * Should be updated each time the `checkedItems` value or content is changed.
         * Can be used for efficient look-up of whether an item is checked or not (O(1) access time).
         */
        this.checkedKeys = new Set();
    }
    handleChange(event) {
        // Need to store the current checkbox state at the moment of click
        this.currentCheckedState = event.checked;
        this.currentIndeterminateState = this.isIndeterminate;
        this.treeview.nodes.map((_value, index) => {
            const itemIndex = String(index);
            const itemLookup = this.treeview.itemLookup(itemIndex);
            this.checkNode(itemLookup);
        });
        this.checkedItemsChange.emit(this.checkedItems.slice());
    }
    get isIndeterminate() {
        const isIndeterminate = this.treeview.nodes.some((_node, index) => {
            const itemIndex = String(index);
            const itemLookup = this.treeview.itemLookup(itemIndex);
            return this.someChecked(itemLookup);
        });
        return this.isChecked ? false : isIndeterminate;
    }
    get isChecked() {
        const isChecked = this.treeview.nodes.every((_node, index) => {
            const itemIndex = String(index);
            const itemLookup = this.treeview.itemLookup(itemIndex);
            return this.allChecked(itemLookup);
        });
        return isChecked;
    }
    ngOnChanges(changes) {
        if (isPresent(changes.checkedItems)) {
            this.updateItems();
            this.renderer.setProperty(this.element.nativeElement, 'checked', this.isChecked);
            this.renderer.setProperty(this.element.nativeElement, 'indeterminate', this.isIndeterminate);
        }
    }
    ngOnInit() {
        if (this.focused) {
            this.nextTick(() => this.element.nativeElement.focus());
        }
    }
    nextTick(fn) {
        this.zone.runOutsideAngular(() => setTimeout(fn));
    }
    checkNode(itemLookup) {
        if (this.treeview.isDisabled(itemLookup.item.dataItem, itemLookup.item.index)) {
            return;
        }
        const pendingCheck = [];
        const filter$$1 = (item) => this.treeview.isVisible(item.dataItem, item.index) &&
            !this.treeview.isDisabled(item.dataItem, item.index);
        pendingCheck.push(itemLookup.item);
        fetchDescendentNodes(itemLookup, filter$$1)
            .forEach(lookup => pendingCheck.push(lookup.item));
        pendingCheck.forEach(item => {
            if (this.currentIndeterminateState) {
                this.lastAction === 'check' ?
                    this.addItem(item) :
                    this.removeItem(item);
                return;
            }
            this.currentCheckedState ?
                this.addItem(item) :
                this.removeItem(item);
        });
    }
    allChecked(lookup) {
        const children = lookup && lookup.children;
        if (!Array.isArray(children)) {
            return;
        }
        const childrenChecked = children.every(child => {
            if (child.children.length) {
                return this.isItemChecked(child.item) && this.allChecked(child);
            }
            return this.isItemChecked(child.item);
        });
        return childrenChecked && this.isItemChecked(lookup.item);
    }
    someChecked(lookup) {
        const children = lookup && lookup.children;
        if (!Array.isArray(children)) {
            return;
        }
        const childrenChecked = children.some(child => {
            if (child.children.length) {
                return this.isItemChecked(child.item) || this.someChecked(child);
            }
            return this.isItemChecked(child.item);
        });
        return childrenChecked || this.isItemChecked(lookup.item);
    }
};
CheckAllDirective.ɵfac = function CheckAllDirective_Factory(t) { return new (t || CheckAllDirective)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ElementRef), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.NgZone), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ChangeDetectorRef), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.Renderer2)); };
CheckAllDirective.ɵdir = /*@__PURE__*/ ɵngcc0.ɵɵdefineDirective({ type: CheckAllDirective, selectors: [["", "checkAll", ""]], hostBindings: function CheckAllDirective_HostBindings(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵlistener("change", function CheckAllDirective_change_HostBindingHandler($event) { return ctx.handleChange($event.target); });
    } }, inputs: { lastAction: "lastAction", treeview: "treeview", checkedItems: "checkedItems", valueField: "valueField", focused: ["checkAll", "focused"] }, outputs: { checkedItemsChange: "checkedItemsChange" }, features: [ɵngcc0.ɵɵInheritDefinitionFeature, ɵngcc0.ɵɵNgOnChangesFeature] });
__decorate([
    Input(),
    __metadata("design:type", String)
], CheckAllDirective.prototype, "lastAction", void 0);
__decorate([
    Input(),
    __metadata("design:type", TreeViewComponent)
], CheckAllDirective.prototype, "treeview", void 0);
__decorate([
    Input(),
    __metadata("design:type", Array)
], CheckAllDirective.prototype, "checkedItems", void 0);
__decorate([
    Input(),
    __metadata("design:type", Object)
], CheckAllDirective.prototype, "valueField", void 0);
__decorate([
    Input('checkAll'),
    __metadata("design:type", Boolean)
], CheckAllDirective.prototype, "focused", void 0);
__decorate([
    Output(),
    __metadata("design:type", EventEmitter)
], CheckAllDirective.prototype, "checkedItemsChange", void 0);
__decorate([
    HostListener('change', ['$event.target']),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [Object]),
    __metadata("design:returntype", void 0)
], CheckAllDirective.prototype, "handleChange", null);
CheckAllDirective = __decorate([ __metadata("design:paramtypes", [ElementRef, NgZone, ChangeDetectorRef, Renderer2])
], CheckAllDirective);

const INTERNAL_DIRECTIVES = [
    ListComponent,
    ListItemDirective,
    SelectableDirective,
    SearchBarComponent,
    TemplateContextDirective,
    TagListComponent,
    CheckDirective,
    CheckAllDirective
];
/**
 * @hidden
 */
let SharedModule = class SharedModule {
};
SharedModule.ɵfac = function SharedModule_Factory(t) { return new (t || SharedModule)(); };
SharedModule.ɵmod = /*@__PURE__*/ ɵngcc0.ɵɵdefineNgModule({ type: SharedModule });
SharedModule.ɵinj = /*@__PURE__*/ ɵngcc0.ɵɵdefineInjector({ imports: [[CommonModule, FormsModule, PopupModule, ResizeSensorModule, SharedDirectivesModule, EventsModule], CommonModule, FormsModule, PopupModule, ResizeSensorModule, SharedDirectivesModule, EventsModule] });

/**
 * A directive which configures the MultiSelectTree to show one single summary tag for all selected data items.
 * When a number is provided, the summary tag is displayed after the given amount of data items are selected
 * ([more information and examples]({% slug api_dropdowns_multiselecttreesummarytagdirective %})).
 *
 * @example
 * ```ts-no-run
 * <kendo-multiselecttree kendoMultiSelectTreeSummaryTag [data]="data"></kendo-multiselecttree>
 * ```
 *
 * @example
 * ```ts-no-run
 * <kendo-multiselecttree [kendoMultiSelectTreeSummaryTag]="2" [data]="data"></kendo-multiselecttree>
 * ```
 */
let MultiSelectTreeSummaryTagDirective = class MultiSelectTreeSummaryTagDirective {
    constructor(multiSelectTreeComponent) {
        this.multiSelectTreeComponent = multiSelectTreeComponent;
        /**
         * A numeric value that indicates the number of selected data items after which the summary tag will appear.
         */
        this.showAfter = 0;
        this.createTagMapper();
    }
    ngOnChanges(changes) {
        if (isPresent(changes.showAfter)) {
            this.createTagMapper();
            this.multiSelectTreeComponent.handleTagMapperChange(this.showAfter);
        }
    }
    createTagMapper() {
        const showAfter = parseNumber(this.showAfter);
        this.multiSelectTreeComponent.tagMapper = (tags) => {
            if (tags.length > showAfter) {
                // tags provided in an array are rendered as a single group tag
                return [...tags.slice(0, showAfter), tags.slice(showAfter)];
            }
            else {
                return tags;
            }
        };
    }
};
MultiSelectTreeSummaryTagDirective.ɵfac = function MultiSelectTreeSummaryTagDirective_Factory(t) { return new (t || MultiSelectTreeSummaryTagDirective)(ɵngcc0.ɵɵdirectiveInject(MultiSelectTreeComponent)); };
MultiSelectTreeSummaryTagDirective.ɵdir = /*@__PURE__*/ ɵngcc0.ɵɵdefineDirective({ type: MultiSelectTreeSummaryTagDirective, selectors: [["", "kendoMultiSelectTreeSummaryTag", ""]], inputs: { showAfter: ["kendoMultiSelectTreeSummaryTag", "showAfter"] }, features: [ɵngcc0.ɵɵNgOnChangesFeature] });
__decorate([
    Input('kendoMultiSelectTreeSummaryTag'),
    __metadata("design:type", Object)
], MultiSelectTreeSummaryTagDirective.prototype, "showAfter", void 0);
MultiSelectTreeSummaryTagDirective = __decorate([ __metadata("design:paramtypes", [MultiSelectTreeComponent])
], MultiSelectTreeSummaryTagDirective);

const DROPDOWNTREE_DIRECTIVES = [
    DropDownTreeComponent,
    MultiSelectTreeComponent,
    DropDownTreeFlatBindingDirective,
    DropDownTreeHierarchyBindingDirective,
    MultiSelectTreeFlatBindingDirective,
    MultiSelectTreeHierarchyBindingDirective,
    DropDownTreesExpandDirective,
    NodeTemplateDirective,
    MultiSelectTreeSummaryTagDirective
];
/**
 * @hidden
 */
let DropDownTreesModule = class DropDownTreesModule {
};
DropDownTreesModule.ɵfac = function DropDownTreesModule_Factory(t) { return new (t || DropDownTreesModule)(); };
DropDownTreesModule.ɵmod = /*@__PURE__*/ ɵngcc0.ɵɵdefineNgModule({ type: DropDownTreesModule });
DropDownTreesModule.ɵinj = /*@__PURE__*/ ɵngcc0.ɵɵdefineInjector({ imports: [[SharedModule, TreeViewModule], SharedDirectivesModule] });

/**
 * A directive which configures the MultiSelect to show one single summary tag for all selected data items.
 * When a number is provided, the summary tag is displayed after the given amount of data items are selected
 * ([more information and examples]({% slug summarytagmode_multiselect %})).
 *
 * @example
 * ```ts-no-run
 * <kendo-multiselect kendoMultiSelectSummaryTag [data]="data"></kendo-multiselect>
 * ```
 *
 * @example
 * ```ts-no-run
 * <kendo-multiselect [kendoMultiSelectSummaryTag]="2" [data]="data"></kendo-multiselect>
 * ```
 */
let SummaryTagDirective = class SummaryTagDirective {
    constructor(multiSelectComponent) {
        this.multiSelectComponent = multiSelectComponent;
        /**
         * A numeric value that indicates the number of selected data items after which the summary tag will appear.
         */
        this.showAfter = 0;
        this.createTagMapper();
    }
    ngOnChanges(changes) {
        if (isPresent(changes.showAfter)) {
            this.createTagMapper();
            this.multiSelectComponent.onTagMapperChange();
        }
    }
    createTagMapper() {
        const showAfter = parseNumber(this.showAfter);
        this.multiSelectComponent.tagMapper = (tags) => {
            if (tags.length > showAfter) {
                let result;
                result = tags.slice(0, showAfter);
                result.push(tags.slice(showAfter, tags.length));
                return result;
            }
            else {
                return tags;
            }
        };
    }
};
SummaryTagDirective.ɵfac = function SummaryTagDirective_Factory(t) { return new (t || SummaryTagDirective)(ɵngcc0.ɵɵdirectiveInject(MultiSelectComponent)); };
SummaryTagDirective.ɵdir = /*@__PURE__*/ ɵngcc0.ɵɵdefineDirective({ type: SummaryTagDirective, selectors: [["", "kendoMultiSelectSummaryTag", ""]], inputs: { showAfter: ["kendoMultiSelectSummaryTag", "showAfter"] }, features: [ɵngcc0.ɵɵNgOnChangesFeature] });
__decorate([
    Input('kendoMultiSelectSummaryTag'),
    __metadata("design:type", Object)
], SummaryTagDirective.prototype, "showAfter", void 0);
SummaryTagDirective = __decorate([ __metadata("design:paramtypes", [MultiSelectComponent])
], SummaryTagDirective);

const AUTOCOMPLETE_DIRECTIVES = [
    AutoCompleteComponent
];
/**
 * @hidden
 *
 * The exported package module.
 *
 * The package exports:
 * - `AutoCompleteComponent`&mdash;The AutoComplete component class.
 * - `ItemTemplateDirective`&mdash;The item template directive.
 * - `HeaderTemplateDirective`&mdash;The header template directive.
 * - `FooterTemplateDirective`&mdash;The footer template directive.
 */
let AutoCompleteModule = class AutoCompleteModule {
};
AutoCompleteModule.ɵfac = function AutoCompleteModule_Factory(t) { return new (t || AutoCompleteModule)(); };
AutoCompleteModule.ɵmod = /*@__PURE__*/ ɵngcc0.ɵɵdefineNgModule({ type: AutoCompleteModule });
AutoCompleteModule.ɵinj = /*@__PURE__*/ ɵngcc0.ɵɵdefineInjector({ imports: [[SharedModule], SharedDirectivesModule] });

const COMBOBOX_DIRECTIVES = [
    ComboBoxComponent,
    MultiColumnComboBoxComponent,
    ComboBoxColumnComponent,
    ColumnHeaderTemplateDirective,
    ColumnCellTemplateDirective
];
const ɵ0$4 = touchEnabled;
/**
 * @hidden
 *
 * The exported package module.
 *
 * The package exports:
 * - `ComboBoxComponent`&mdash;The ComboBox component class.
 * - `MultiColumnComboBoxComponent`&mdash;The MultiColumnComboBox component class.
 * - `ItemTemplateDirective`&mdash;The item template directive.
 * - `HeaderTemplateDirective`&mdash;The header template directive.
 * - `FooterTemplateDirective`&mdash;The footer template directive.
 * - `ColumnHeaderTemplateDirective`&mdash;The column header template directive.
 * - `ColumnCellTemplateDirective`&mdash;The column cell template directive.
 */
let ComboBoxModule = class ComboBoxModule {
};
ComboBoxModule.ɵfac = function ComboBoxModule_Factory(t) { return new (t || ComboBoxModule)(); };
ComboBoxModule.ɵmod = /*@__PURE__*/ ɵngcc0.ɵɵdefineNgModule({ type: ComboBoxModule });
ComboBoxModule.ɵinj = /*@__PURE__*/ ɵngcc0.ɵɵdefineInjector({ providers: [{ provide: TOUCH_ENABLED, useValue: ɵ0$4 }], imports: [[SharedModule], SharedDirectivesModule] });

const DROPDOWNLIST_DIRECTIVES = [
    DropDownListComponent
];
/**
 * @hidden
 *
 * The exported package module.
 *
 * The package exports:
 * - `DropDownListComponent`&mdash;The DropDownList component class.
 * - `ItemTemplateDirective`&mdash;The item template directive.
 * - `ValueTemplateDirective`&mdash;The value template directive.
 * - `HeaderTemplateDirective`&mdash;The header template directive.
 * - `FooterTemplateDirective`&mdash;The footer template directive.
 */
let DropDownListModule = class DropDownListModule {
};
DropDownListModule.ɵfac = function DropDownListModule_Factory(t) { return new (t || DropDownListModule)(); };
DropDownListModule.ɵmod = /*@__PURE__*/ ɵngcc0.ɵɵdefineNgModule({ type: DropDownListModule });
DropDownListModule.ɵinj = /*@__PURE__*/ ɵngcc0.ɵɵdefineInjector({ imports: [[SharedModule], SharedDirectivesModule] });

const MULTISELECT_DIRECTIVES = [
    MultiSelectComponent,
    SummaryTagDirective,
    CustomItemTemplateDirective
];
const ɵ0$5 = touchEnabled;
/**
 * @hidden
 *
 * The exported package module.
 *
 * The package exports:
 * - `MultiSelectComponent`&mdash;The MultiSelect component class.
 * - `SummaryTagDirective`&mdash;The MultiSelect summary tag directive.
 * - `ItemTemplateDirective`&mdash;The item template directive.
 * - `CustomItemTemplateDirective`&mdash;The custom item template directive.
 * - `TagTemplateDirective`&mdash;The tag template directive.
 * - `SummaryTagTemplateDirective`&mdash;The summary tag template directive.
 * - `HeaderTemplateDirective`&mdash;The header template directive.
 * - `FooterTemplateDirective`&mdash;The footer template directive.
 * - `NoDataTemplateDirective`&mdash;The no-data template directive.
 */
let MultiSelectModule = class MultiSelectModule {
};
MultiSelectModule.ɵfac = function MultiSelectModule_Factory(t) { return new (t || MultiSelectModule)(); };
MultiSelectModule.ɵmod = /*@__PURE__*/ ɵngcc0.ɵɵdefineNgModule({ type: MultiSelectModule });
MultiSelectModule.ɵinj = /*@__PURE__*/ ɵngcc0.ɵɵdefineInjector({ providers: [{ provide: TOUCH_ENABLED, useValue: ɵ0$5 }], imports: [[SharedModule], SharedDirectivesModule] });

/**
 * Represents the [NgModule]({{ site.data.urls.angular['ngmoduleapi'] }})
 * definition for the Dropdowns components.
 *
 * @example
 *
 * ```ts-no-run
 * // Import the Dropdowns module
 * import { DropDownsModule } from '@progress/kendo-angular-dropdowns';
 *
 * // The browser platform with a compiler
 * import { platformBrowserDynamic } from '@angular/platform-browser-dynamic';
 *
 * import { NgModule } from '@angular/core';
 *
 * // Import the app component
 * import { AppComponent } from './app.component';
 *
 * // Define the app module
 * _@NgModule({
 *     declarations: [AppComponent], // declare the app component
 *     imports:      [BrowserModule, DropDownsModule], // import the Dropdowns module
 *     bootstrap:    [AppComponent]
 * })
 * export class AppModule {}
 *
 * // Compile and launch the module
 * platformBrowserDynamic().bootstrapModule(AppModule);
 *
 * ```
 */
let DropDownsModule = class DropDownsModule {
};
DropDownsModule.ɵfac = function DropDownsModule_Factory(t) { return new (t || DropDownsModule)(); };
DropDownsModule.ɵmod = /*@__PURE__*/ ɵngcc0.ɵɵdefineNgModule({ type: DropDownsModule });
DropDownsModule.ɵinj = /*@__PURE__*/ ɵngcc0.ɵɵdefineInjector({ imports: [AutoCompleteModule, ComboBoxModule, DropDownListModule, MultiSelectModule, DropDownTreesModule] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(SearchBarComponent, [{
        type: Component,
        args: [{
                selector: 'kendo-searchbar',
                template: `
        <input #input
            autocomplete="off"
            [id]="id"
            [disabled]="disabled"
            [readonly]="readonly"
            [placeholder]="placeholder"
            [class]="'k-input-inner'"
            (input)="handleInput($event)"
            (keydown)="handleKeydown($event)"
            [kendoEventsOutsideAngular]="{
                focus: handleFocus,
                blur: handleBlur
            }"
            [scope]="this"
            [attr.tabIndex]="tabIndex"
            [attr.dir]="direction"
            [attr.role]="role"
            [attr.aria-disabled]="disabled"
            [attr.aria-readonly]="readonly"
            aria-haspopup="listbox"
            [attr.aria-expanded]="ariaExpanded"
            [attr.aria-owns]="listId"
            [attr.aria-describedby]="tagListId"
            [attr.aria-activedescendant]="activeDescendant"
            [attr.aria-label]="noDataLabel"
        />
   `
            }]
    }], function () { return [{ type: ɵngcc1.LocalizationService }, { type: ɵngcc0.Renderer2 }]; }, { valueChange: [{
            type: Output
        }], onBlur: [{
            type: Output
        }], onFocus: [{
            type: Output
        }], onClick: [{
            type: Output
        }], onNavigate: [{
            type: Output
        }], searchBarClass: [{
            type: HostBinding,
            args: ['class.k-searchbar']
        }], userInput: [{
            type: Input
        }], placeholder: [{
            type: Input
        }], id: [{
            type: Input
        }], listId: [{
            type: Input
        }], tagListId: [{
            type: Input
        }], activeDescendant: [{
            type: Input
        }], noDataLabel: [{
            type: Input
        }], disabled: [{
            type: Input
        }], readonly: [{
            type: Input
        }], tabIndex: [{
            type: Input
        }], popupOpen: [{
            type: Input
        }], role: [{
            type: Input
        }], suggestedText: [{
            type: Input
        }], input: [{
            type: ViewChild,
            args: ['input', { static: true }]
        }] }); })();
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(ItemTemplateDirective, [{
        type: Directive,
        args: [{
                selector: '[kendoDropDownListItemTemplate],[kendoComboBoxItemTemplate],[kendoAutoCompleteItemTemplate],[kendoMultiSelectItemTemplate]'
            }]
    }], function () { return [{ type: ɵngcc0.TemplateRef }]; }, null); })();
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(HeaderTemplateDirective, [{
        type: Directive,
        args: [{
                selector: '[kendoDropDownListHeaderTemplate],[kendoComboBoxHeaderTemplate],[kendoDropDownTreeHeaderTemplate],[kendoMultiColumnComboBoxHeaderTemplate],[kendoAutoCompleteHeaderTemplate],[kendoMultiSelectHeaderTemplate],[kendoMultiSelectTreeHeaderTemplate]'
            }]
    }], function () { return [{ type: ɵngcc0.TemplateRef }]; }, null); })();
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(FooterTemplateDirective, [{
        type: Directive,
        args: [{
                selector: '[kendoDropDownListFooterTemplate],[kendoComboBoxFooterTemplate],[kendoDropDownTreeFooterTemplate],[kendoMultiColumnComboBoxFooterTemplate],[kendoAutoCompleteFooterTemplate],[kendoMultiSelectFooterTemplate],[kendoMultiSelectTreeFooterTemplate]'
            }]
    }], function () { return [{ type: ɵngcc0.TemplateRef }]; }, null); })();
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(GroupTemplateDirective, [{
        type: Directive,
        args: [{
                selector: '[kendoDropDownListGroupTemplate],[kendoComboBoxGroupTemplate],[kendoMultiColumnComboBoxGroupTemplate],[kendoAutoCompleteGroupTemplate],[kendoMultiSelectGroupTemplate]'
            }]
    }], function () { return [{ type: ɵngcc0.TemplateRef }]; }, null); })();
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(FixedGroupTemplateDirective, [{
        type: Directive,
        args: [{
                selector: '[kendoDropDownListFixedGroupTemplate],[kendoComboBoxFixedGroupTemplate],[kendoMultiColumnComboBoxFixedGroupTemplate],[kendoAutoCompleteFixedGroupTemplate],[kendoMultiSelectFixedGroupTemplate]'
            }]
    }], function () { return [{ type: ɵngcc0.TemplateRef }]; }, null); })();
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(SelectionService, [{
        type: Injectable
    }], function () { return []; }, null); })();
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(DataService, [{
        type: Injectable
    }], function () { return []; }, null); })();
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(DisabledItemsService, [{
        type: Injectable
    }], function () { return [{ type: DataService }]; }, null); })();
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(NavigationService, [{
        type: Injectable
    }], function () { return [{ type: DisabledItemsService }, { type: SelectionService }]; }, null); })();
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(NoDataTemplateDirective, [{
        type: Directive,
        args: [{
                selector: '[kendoDropDownListNoDataTemplate],[kendoDropDownTreeNoDataTemplate],[kendoComboBoxNoDataTemplate],[kendoMultiColumnComboBoxNoDataTemplate],[kendoAutoCompleteNoDataTemplate],[kendoMultiSelectNoDataTemplate],[kendoMultiSelectTreeNoDataTemplate]'
            }]
    }], function () { return [{ type: ɵngcc0.TemplateRef }]; }, null); })();
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(ListItemDirective, [{
        type: Directive,
        args: [{
                selector: '"li[role=option], li[role=group]"' // tslint:disable-line
            }]
    }], function () { return [{ type: ɵngcc0.ElementRef }]; }, null); })();
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(ListComponent, [{
        type: Component,
        args: [{
                selector: 'kendo-list',
                template: `
    <div *ngIf="dataService.grouped"
        [class]="listGroupStickyHeaderClass"
        [ngStyle]="{
            'height.px': virtual?.itemHeight,
            'minHeight.px' : virtual?.itemHeight,
            'boxSizing' : virtual ? 'border-box' : 'inherit'}"
        >
        <ng-template *ngIf="fixedGroupTemplate"
            [templateContext]="{
                templateRef: fixedGroupTemplate.templateRef,
                $implicit: currentGroup
            }">
        </ng-template>
        <ng-template [ngIf]="!fixedGroupTemplate"><span [class]="listGroupStickyHeaderTextClass">{{ currentGroup }}</span></ng-template>
    </div>
    <div #content
        [class]="listContentClass"
        [style.overscrollBehavior]="'none'"
        [style.maxHeight.px]="height"
        unselectable="on">
    <ul #list
        role="listbox"
        [class]="listClass"
        [attr.id]="id"
        [attr.aria-hidden]="!show">
         <ng-template *ngIf="!dataService.grouped && show" ngFor let-dataItem let-itemIndex="index" [ngForOf]="data">
            <li
                role="option"
                kendoDropDownsSelectable
                [checkboxes]="checkboxes"
                [height]="virtual?.itemHeight"
                [index]="itemIndex + startFrom"
                [multipleSelection]="multipleSelection"
                [attr.id]="optionPrefix + '-' + getValue(dataItem)"
                [attr.tabIndex]="-1"
                [class]="listItemClass"
                [ngClass]="{
                    'k-disabled': isDisabled(itemIndex),
                    'k-table-alt-row': isAltRow(itemIndex)
                }"
            >
                <input
                    *ngIf="checkboxes.enabled"
                    type="checkbox"
                    class="k-checkbox"
                    [ngClass]="checkboxClasses"
                    (change)="onCheckedChange($event, itemIndex)"
                    [checked]="isChecked(itemIndex)"
                />
                <ng-template *ngIf="template"
                    [templateContext]="{
                        templateRef: template.templateRef,
                        $implicit: dataItem
                    }">
                </ng-template>
                <ng-template [ngIf]="!template"><span class="k-list-item-text">{{ getText(dataItem) }}</span></ng-template>
            </li>
         </ng-template>
         <ng-template *ngIf="dataService.grouped" ngFor let-dataItem let-itemIndex="index" [ngForOf]="data">
            <li
                *ngIf="dataItem.header && dataItem.index > 0"
                role="group"
                [class]="listGroupItemClass"
                [class.k-table-alt-row]="isAltRow(itemIndex - 1)"
                [ngStyle]="{
                    'height.px': virtual?.itemHeight,
                    'minHeight.px' : virtual?.itemHeight,
                    'boxSizing' : virtual ? 'border-box' : 'inherit'}"
                [attr.group-index]="dataItem.index"
                [attr.id]="optionPrefix + '-' + getValue(dataItem.value)"
                [attr.tabIndex]="-1">
                    <span [class]="listGroupItemTextClass">
                        <ng-template *ngIf="groupTemplate"
                            [templateContext]="{
                                templateRef: groupTemplate.templateRef,
                                $implicit: dataItem.value
                        }">
                        </ng-template>
                        <ng-template [ngIf]="!groupTemplate">{{ dataItem.value }}</ng-template>
                    </span>
            </li>
            <li
                *ngIf="!dataItem.header"
                role="option"
                kendoDropDownsSelectable
                [height]="virtual?.itemHeight"
                [index]="dataItem.offsetIndex"
                [multipleSelection]="multipleSelection"
                [attr.absolute-index]="dataItem.index"
                [attr.id]="optionPrefix + '-' + getValue(dataItem.value)"
                [attr.tabIndex]="-1"
                [class]="listItemClass"
                [ngClass]="{
                    'k-disabled': isDisabled(dataItem.offsetIndex),
                    'k-table-alt-row': isAltRow(itemIndex - 1)
                }"
            >
                <ng-template *ngIf="template"
                    [templateContext]="{
                        templateRef: template.templateRef,
                        $implicit: dataItem.value
                    }">
                </ng-template>
                <ng-template [ngIf]="!template"><span class="k-list-item-text">{{ getText(dataItem.value) }}</span></ng-template>
            </li>
        </ng-template>
        <kendo-resize-sensor
            *ngIf="!virtual"
            (resize)="listResize.emit()"
        >
        </kendo-resize-sensor>
    </ul>
    <div *ngIf="virtual" #virtualContainer class="k-height-container" role="presentation">
        <div [style.height.px]="scrollHeight">
            <kendo-resize-sensor (resize)="listResize.emit()"></kendo-resize-sensor>
        </div>
    </div>
    </div>
  `
            }]
    }], function () { return [{ type: DataService }, { type: ɵngcc0.ElementRef }, { type: SelectionService }, { type: DisabledItemsService }, { type: ɵngcc0.ChangeDetectorRef }, { type: ɵngcc0.NgZone }, { type: ɵngcc0.Renderer2 }]; }, { selected: [{
            type: Input
        }], focused: [{
            type: Input
        }], show: [{
            type: Input
        }], multipleSelection: [{
            type: Input
        }], type: [{
            type: Input
        }], checkboxes: [{
            type: Input
        }], rounded: [{
            type: Input
        }], onClick: [{
            type: Output
        }], pageChange: [{
            type: Output
        }], listResize: [{
            type: Output
        }], data: [{
            type: Input
        }], size: [{
            type: Input
        }], textField: [{
            type: Input
        }], valueField: [{
            type: Input
        }], height: [{
            type: Input
        }], template: [{
            type: Input
        }], groupTemplate: [{
            type: Input
        }], fixedGroupTemplate: [{
            type: Input
        }], id: [{
            type: Input
        }], optionPrefix: [{
            type: Input
        }], virtual: [{
            type: Input
        }], items: [{
            type: ViewChildren,
            args: [ListItemDirective]
        }], content: [{
            type: ViewChild,
            args: ['content', { static: true }]
        }], list: [{
            type: ViewChild,
            args: ['list', { static: true }]
        }], virtualContainer: [{
            type: ViewChild,
            args: ['virtualContainer', { static: false }]
        }] }); })();
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(AutoCompleteComponent, [{
        type: Component,
        args: [{
                exportAs: 'kendoAutoComplete',
                providers: [
                    AUTOCOMPLETE_VALUE_ACCESSOR,
                    DataService,
                    SelectionService,
                    NavigationService,
                    DisabledItemsService,
                    LocalizationService,
                    {
                        provide: L10N_PREFIX,
                        useValue: 'kendo.autocomplete'
                    },
                    {
                        provide: FilterableComponent,
                        useExisting: forwardRef(() => AutoCompleteComponent_1)
                    },
                    {
                        provide: KendoInput,
                        useExisting: forwardRef(() => AutoCompleteComponent_1)
                    }
                ],
                selector: 'kendo-autocomplete',
                template: `
        <ng-container kendoAutoCompleteLocalizedMessages
            i18n-noDataText="kendo.autocomplete.noDataText|The text displayed in the popup when there are no items"
            noDataText="NO DATA FOUND"

            i18n-clearTitle="kendo.autocomplete.clearTitle|The title of the clear button"
            clearTitle="clear"
        >
        </ng-container>
        <kendo-searchbar #searchbar
            [role]="'combobox'"
            [id]="focusableId"
            [listId]="listBoxId"
            [activeDescendant]="activeDescendant"
            [noDataLabel]="noDataLabel"
            [userInput]="text"
            [suggestedText]="suggestion"
            [disabled]="disabled"
            [readonly]="readonly"
            [tabIndex]="tabIndex"
            [popupOpen]="isOpen"
            [placeholder]="placeholder"
            (onNavigate)="handleNavigate($event)"
            (valueChange)="searchBarChange($event)"
            (onBlur)="handleBlur()"
            (onFocus)="handleFocus()"
        ></kendo-searchbar>
        <span
            *ngIf="!loading && !readonly && (clearButton && text?.length)"
            class="k-clear-value"
            [style.visibility]="clearButtonVisiblity"
            [attr.title]="messageFor('clearTitle')"
            role="button"
            tabindex="-1"
            (click)="clearValue($event)"
            (mousedown)="$event.preventDefault()"
        >
            <span class="k-icon k-i-x"></span>
        </span>
        <span *ngIf="loading" class="k-icon k-i-loading"></span>
        <ng-template #popupTemplate>
            <!--header template-->
            <ng-template *ngIf="headerTemplate"
                [templateContext]="{
                    templateRef: headerTemplate.templateRef
                }">
            </ng-template>
            <!--list-->
            <kendo-list
                #optionsList
                [size]="size"
                [rounded]="rounded"
                [id]="listBoxId"
                [optionPrefix]="optionPrefix"
                [data]="data"
                [textField]="valueField"
                [valueField]="valueField"
                [template]="template"
                [groupTemplate]="groupTemplate"
                [fixedGroupTemplate]="fixedGroupTemplate"
                [height]="listHeight"
                [show]="isOpen"
                [virtual]="virtual"
                (pageChange)="pageChange($event)"
            >
            </kendo-list>
            <!--no-data template-->
            <div class="k-no-data" *ngIf="data.length === 0">
                <ng-template [ngIf]="noDataTemplate"
                    [templateContext]="{
                        templateRef: noDataTemplate?.templateRef
                    }">
                </ng-template>
                <ng-template [ngIf]="!noDataTemplate">
                    <div>{{ messageFor('noDataText') }}</div>
                </ng-template>
            </div>
            <!--footer template-->
            <ng-template *ngIf="footerTemplate"
                [templateContext]="{
                    templateRef: footerTemplate.templateRef
                }">
            </ng-template>
        </ng-template>
        <ng-template [ngIf]="isOpen">
            <kendo-resize-sensor (resize)="onResize()"></kendo-resize-sensor>
        </ng-template>
        <ng-container #container></ng-container>
  `
            }]
    }], function () { return [{ type: ɵngcc1.LocalizationService }, { type: DataService }, { type: ɵngcc4.PopupService }, { type: SelectionService }, { type: NavigationService }, { type: DisabledItemsService }, { type: ɵngcc0.NgZone }, { type: ɵngcc0.ChangeDetectorRef }, { type: ɵngcc0.Renderer2 }, { type: ɵngcc0.ElementRef }, { type: Boolean, decorators: [{
                type: Optional
            }, {
                type: Inject,
                args: [TOUCH_ENABLED]
            }] }]; }, { highlightFirst: [{
            type: Input
        }], focusableId: [{
            type: Input
        }], placeholder: [{
            type: Input
        }], listHeight: [{
            type: Input
        }], clearButton: [{
            type: Input
        }], disabled: [{
            type: Input
        }], readonly: [{
            type: Input
        }], tabindex: [{
            type: Input
        }], filterable: [{
            type: Input
        }], valueChange: [{
            type: Output
        }], filterChange: [{
            type: Output
        }], open: [{
            type: Output
        }], opened: [{
            type: Output
        }], close: [{
            type: Output
        }], closed: [{
            type: Output
        }], onFocus: [{
            type: Output,
            args: ['focus']
        }], onBlur: [{
            type: Output,
            args: ['blur']
        }], widgetClasses: [{
            type: HostBinding,
            args: ['class.k-autocomplete']
        }, {
            type: HostBinding,
            args: ['class.k-input']
        }], data: [{
            type: Input
        }], value: [{
            type: Input
        }], popupSettings: [{
            type: Input
        }], itemDisabled: [{
            type: Input
        }], tabIndex: [{
            type: Input,
            args: ["tabIndex"]
        }], virtual: [{
            type: Input
        }], size: [{
            type: Input
        }], rounded: [{
            type: Input
        }], fillMode: [{
            type: Input
        }], isDisabled: [{
            type: HostBinding,
            args: ['class.k-disabled']
        }], isLoading: [{
            type: HostBinding,
            args: ['class.k-loading']
        }], dir: [{
            type: HostBinding,
            args: ['attr.dir']
        }], valueField: [{
            type: Input
        }], loading: [{
            type: Input
        }], suggest: [{
            type: Input
        }], template: [{
            type: ContentChild,
            args: [ItemTemplateDirective, { static: false }]
        }], headerTemplate: [{
            type: ContentChild,
            args: [HeaderTemplateDirective, { static: false }]
        }], footerTemplate: [{
            type: ContentChild,
            args: [FooterTemplateDirective, { static: false }]
        }], noDataTemplate: [{
            type: ContentChild,
            args: [NoDataTemplateDirective, { static: false }]
        }], groupTemplate: [{
            type: ContentChild,
            args: [GroupTemplateDirective, { static: false }]
        }], fixedGroupTemplate: [{
            type: ContentChild,
            args: [FixedGroupTemplateDirective, { static: false }]
        }], container: [{
            type: ViewChild,
            args: ['container', { read: ViewContainerRef, static: true }]
        }], popupTemplate: [{
            type: ViewChild,
            args: ['popupTemplate', { static: true }]
        }], searchbar: [{
            type: ViewChild,
            args: [SearchBarComponent, { static: true }]
        }], optionsList: [{
            type: ViewChild,
            args: ['optionsList', { static: false }]
        }] }); })();
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(ComboBoxComponent, [{
        type: Component,
        args: [{
                exportAs: 'kendoComboBox',
                providers: [
                    COMBOBOX_VALUE_ACCESSOR,
                    DataService,
                    SelectionService,
                    NavigationService,
                    DisabledItemsService,
                    LocalizationService,
                    {
                        provide: L10N_PREFIX,
                        useValue: 'kendo.combobox'
                    },
                    {
                        provide: FilterableComponent, useExisting: forwardRef(() => ComboBoxComponent_1)
                    },
                    {
                        provide: KendoInput, useExisting: forwardRef(() => ComboBoxComponent_1)
                    }
                ],
                selector: 'kendo-combobox',
                template: `
        <ng-container kendoComboBoxLocalizedMessages
            i18n-noDataText="kendo.combobox.noDataText|The text displayed in the popup when there are no items"
            noDataText="NO DATA FOUND"

            i18n-clearTitle="kendo.combobox.clearTitle|The title of the clear button"
            clearTitle="clear"

            i18n-selectButtonText="kendo.combobox.selectButtonText|The text set as aria-label on the select button"
            selectButtonText="Select"
        >
        </ng-container>
        <kendo-searchbar #searchbar
            [role]="'combobox'"
            [id]="focusableId"
            [listId]="listBoxId"
            [activeDescendant]="activeDescendant"
            [noDataLabel]="noDataLabel"
            [userInput]="text"
            [suggestedText]="getSuggestion()"
            [disabled]="disabled"
            [readonly]="readonly"
            [tabIndex]="tabIndex"
            [popupOpen]="isOpen"
            [placeholder]="placeholder"
            (onNavigate)="handleNavigate($event)"
            (valueChange)="searchBarChange($event)"
            (onBlur)="handleBlur()"
            (onFocus)="handleFocus()"
        ></kendo-searchbar>
        <span
            *ngIf="clearButton && !loading && !disabled && !readonly && text?.length"
            class="k-clear-value"
            [style.visibility]="clearButtonVisiblity"
            aria-hidden="true"
            [attr.title]="messageFor('clearTitle')"
            (click)="clearValue($event)"
            [kendoEventsOutsideAngular]="{
                mousedown: preventEventDefault
            }"
        >
            <span class="k-icon k-i-x"></span>
        </span>
        <button
            #select
            unselectable="on"
            type="button"
            class="k-input-button k-button k-icon-button"
            [ngClass]="selectButtonClasses"
            [attr.aria-label]="messageFor('selectButtonText')"
            [kendoEventsOutsideAngular]="{
                mousedown: preventEventDefault
            }"
        >
            <span class="k-button-icon k-icon" [ngClass]="buttonClasses"></span>
        </button>
        <ng-template #popupTemplate>
            <!--header template-->
            <ng-template *ngIf="headerTemplate"
                [templateContext]="{
                    templateRef: headerTemplate.templateRef
                }">
            </ng-template>
            <!--list-->
            <kendo-list
                #optionsList
                [size]="size"
                [rounded]="rounded"
                [id]="listBoxId"
                [optionPrefix]="optionPrefix"
                [data]="data"
                [textField]="textField"
                [valueField]="valueField"
                [template]="template"
                [groupTemplate]="groupTemplate"
                [fixedGroupTemplate]="fixedGroupTemplate"
                [height]="listHeight"
                [show]="isOpen"
                [virtual]="virtual"
                (pageChange)="pageChange($event)"
            >
            </kendo-list>
            <!--no-data template-->
            <div class="k-no-data" *ngIf="data.length === 0">
                <ng-template [ngIf]="noDataTemplate"
                    [templateContext]="{
                        templateRef: noDataTemplate ? noDataTemplate.templateRef : undefined
                    }">
                </ng-template>
                <ng-template [ngIf]="!noDataTemplate">
                    <div>{{ messageFor('noDataText') }}</div>
                </ng-template>
            </div>
            <!--footer template-->
            <ng-template *ngIf="footerTemplate"
                [templateContext]="{
                    templateRef: footerTemplate.templateRef
                }">
            </ng-template>
        </ng-template>
        <ng-template [ngIf]="isOpen">
            <kendo-resize-sensor (resize)="onResize()"></kendo-resize-sensor>
        </ng-template>
        <ng-container #container></ng-container>
  `
            }]
    }], function () { return [{ type: ɵngcc0.ElementRef }, { type: ɵngcc1.LocalizationService }, { type: ɵngcc4.PopupService }, { type: SelectionService }, { type: NavigationService }, { type: DisabledItemsService }, { type: DataService }, { type: ɵngcc0.NgZone }, { type: ɵngcc0.ChangeDetectorRef }, { type: ɵngcc0.Renderer2 }, { type: Boolean, decorators: [{
                type: Optional
            }, {
                type: Inject,
                args: [TOUCH_ENABLED]
            }] }]; }, { focusableId: [{
            type: Input
        }], allowCustom: [{
            type: Input
        }], valueNormalizer: [{
            type: Input
        }], placeholder: [{
            type: Input
        }], listHeight: [{
            type: Input
        }], suggest: [{
            type: Input
        }], clearButton: [{
            type: Input
        }], disabled: [{
            type: Input
        }], readonly: [{
            type: Input
        }], tabindex: [{
            type: Input
        }], filterable: [{
            type: Input
        }], valueChange: [{
            type: Output
        }], selectionChange: [{
            type: Output
        }], filterChange: [{
            type: Output
        }], open: [{
            type: Output
        }], opened: [{
            type: Output
        }], close: [{
            type: Output
        }], closed: [{
            type: Output
        }], onFocus: [{
            type: Output,
            args: ['focus']
        }], onBlur: [{
            type: Output,
            args: ['blur']
        }], widgetClasses: [{
            type: HostBinding,
            args: ['class.k-combobox']
        }, {
            type: HostBinding,
            args: ['class.k-input']
        }], data: [{
            type: Input
        }], value: [{
            type: Input
        }], valuePrimitive: [{
            type: Input
        }], popupSettings: [{
            type: Input
        }], itemDisabled: [{
            type: Input
        }], tabIndex: [{
            type: Input,
            args: ["tabIndex"]
        }], virtual: [{
            type: Input
        }], size: [{
            type: Input
        }], rounded: [{
            type: Input
        }], fillMode: [{
            type: Input
        }], isDisabled: [{
            type: HostBinding,
            args: ['class.k-disabled']
        }], isLoading: [{
            type: HostBinding,
            args: ['class.k-loading']
        }], dir: [{
            type: HostBinding,
            args: ['attr.dir']
        }], loading: [{
            type: Input
        }], textField: [{
            type: Input
        }], valueField: [{
            type: Input
        }], iconClass: [{
            type: Input
        }], template: [{
            type: ContentChild,
            args: [ItemTemplateDirective, { static: false }]
        }], headerTemplate: [{
            type: ContentChild,
            args: [HeaderTemplateDirective, { static: false }]
        }], footerTemplate: [{
            type: ContentChild,
            args: [FooterTemplateDirective, { static: false }]
        }], noDataTemplate: [{
            type: ContentChild,
            args: [NoDataTemplateDirective, { static: false }]
        }], groupTemplate: [{
            type: ContentChild,
            args: [GroupTemplateDirective, { static: false }]
        }], fixedGroupTemplate: [{
            type: ContentChild,
            args: [FixedGroupTemplateDirective, { static: false }]
        }], container: [{
            type: ViewChild,
            args: ['container', { read: ViewContainerRef, static: true }]
        }], popupTemplate: [{
            type: ViewChild,
            args: ['popupTemplate', { static: true }]
        }], searchbar: [{
            type: ViewChild,
            args: [SearchBarComponent, { static: true }]
        }], optionsList: [{
            type: ViewChild,
            args: ['optionsList', { static: false }]
        }], select: [{
            type: ViewChild,
            args: ['select', { static: true }]
        }] }); })();
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(ValueTemplateDirective, [{
        type: Directive,
        args: [{
                selector: '[kendoDropDownListValueTemplate],[kendoDropDownTreeValueTemplate]'
            }]
    }], function () { return [{ type: ɵngcc0.TemplateRef }]; }, null); })();
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(DropDownListComponent, [{
        type: Component,
        args: [{
                exportAs: 'kendoDropDownList',
                providers: [
                    DROPDOWNLIST_VALUE_ACCESSOR,
                    DataService,
                    SelectionService,
                    NavigationService,
                    DisabledItemsService,
                    LocalizationService,
                    {
                        provide: L10N_PREFIX,
                        useValue: 'kendo.dropdownlist'
                    },
                    {
                        provide: FilterableComponent, useExisting: forwardRef(() => DropDownListComponent_1)
                    },
                    {
                        provide: KendoInput, useExisting: forwardRef(() => DropDownListComponent_1)
                    }
                ],
                selector: 'kendo-dropdownlist',
                template: `
        <ng-container kendoDropDownListLocalizedMessages
            i18n-noDataText="kendo.dropdownlist.noDataText|The text displayed in the popup when there are no items"
            noDataText="NO DATA FOUND"

            i18n-selectButtonText="kendo.dropdownlist.selectButtonText|The text set as aria-label on the select button"
            selectButtonText="Select"
        >
        </ng-container>
        <span class="k-input-inner" unselectable="on" role="option" [id]="valueLabelId">
            <span class="k-input-value-text">
                <ng-template *ngIf="valueTemplate"
                    [templateContext]="{
                        templateRef: valueTemplate.templateRef,
                        $implicit: dataItem
                    }">
                </ng-template>
                <ng-template [ngIf]="!valueTemplate">{{ getText() }}</ng-template>
            </span>
        </span>
        <button
            tabindex="-1"
            unselectable="on"
            type="button"
            class="k-input-button k-button k-icon-button"
            [ngClass]="selectButtonClasses"
            [attr.aria-label]="messageFor('selectButtonText')"
            [kendoEventsOutsideAngular]="{
                mousedown: onMouseDown
            }"
        >
            <span
                class="k-button-icon k-icon"
                unselectable="on"
                [ngClass]="buttonClasses"
            ></span>
        </button>
        <ng-template #popupTemplate>
            <!--filterable-->

            <ng-template [ngIf]="filterable">
                <div class="k-list-filter" (click)="$event.stopImmediatePropagation()">
                    <span
                        class="k-searchbox k-input"
                        [ngClass]="filterInputClasses"
                    >
                        <span class="k-input-icon k-icon k-i-search" unselectable="on"></span>
                        <input
                            [attr.aria-owns]="ariaOwns"
                            [attr.aria-activedescendant]="ariaActivedescendant"
                            [attr.aria-label]="noDataLabel"
                            tabindex="-1"
                            [filterInput]="isFocused && !touchEnabled"
                            [dir]="direction"
                            [(ngModel)]="filterText"
                            class="k-input-inner"
                            (keydown)="keydown($event)"
                            (input)="handleFilter($event)"
                            (focus)="onFilterFocus()"
                            (blur)="blurFilterInput()" />
                    </span>
                </div>
            </ng-template>
            <!--default item-->
            <ng-template [ngIf]="defaultItem && !itemTemplate">
                <div
                    class="k-list"
                    [ngClass]="optionLabelSizeClass"
                >
                    <div class="k-list-optionlabel" [ngClass]="{ 'k-disabled': isDisabledDefaultItem }" kendoDropDownsSelectable [index]="-1">
                        {{ getDefaultItemText() }}
                    </div>
                </div>
            </ng-template>
            <ng-template [ngIf]="defaultItem && itemTemplate">
                <div
                    class="k-list"
                    [ngClass]="optionLabelSizeClass"
                >
                    <div class="k-list-optionlabel" [ngClass]="{ 'k-disabled': isDisabledDefaultItem }" kendoDropDownsSelectable [index]="-1">
                        <ng-template
                            [templateContext]="{
                                templateRef: itemTemplate.templateRef,
                                $implicit: defaultItem
                            }">
                        </ng-template>
                    </div>
                </div>
            </ng-template>
            <!--header template-->
            <ng-template *ngIf="headerTemplate"
                [templateContext]="{
                    templateRef: headerTemplate.templateRef
                }">
            </ng-template>
            <!--list-->
            <kendo-list
                #optionsList
                [size]="size"
                [rounded]="rounded"
                [id]="listBoxId"
                [optionPrefix]="optionPrefix"
                [data]="data"
                [textField]="textField"
                [valueField]="valueField"
                [template]="itemTemplate"
                [groupTemplate]="groupTemplate"
                [fixedGroupTemplate]="fixedGroupTemplate"
                [height]="listHeight"
                [show]="isOpen"
                [virtual]="virtual"
                (pageChange)="pageChange($event)"
                >
            </kendo-list>
            <!--no-data template-->
            <div class="k-no-data" *ngIf="data.length === 0">
                <ng-template [ngIf]="noDataTemplate"
                    [templateContext]="{
                        templateRef: noDataTemplate ? noDataTemplate.templateRef : undefined
                    }">
                </ng-template>
                <ng-template [ngIf]="!noDataTemplate">
                    <div>{{ messageFor('noDataText') }}</div>
                </ng-template>
            </div>
            <!--footer template-->
            <ng-template *ngIf="footerTemplate"
                [templateContext]="{
                    templateRef: footerTemplate.templateRef
                }">
            </ng-template>
        </ng-template>
        <ng-template [ngIf]="isOpen">
            <kendo-resize-sensor (resize)="onResize()"></kendo-resize-sensor>
        </ng-template>
        <ng-container #container></ng-container>
  `
            }]
    }], function () { return [{ type: ɵngcc0.ElementRef }, { type: ɵngcc1.LocalizationService }, { type: ɵngcc4.PopupService }, { type: SelectionService }, { type: NavigationService }, { type: DisabledItemsService }, { type: DataService }, { type: ɵngcc0.NgZone }, { type: ɵngcc0.Renderer2 }, { type: ɵngcc0.ChangeDetectorRef }, { type: Boolean, decorators: [{
                type: Optional
            }, {
                type: Inject,
                args: [TOUCH_ENABLED]
            }] }]; }, { listHeight: [{
            type: Input
        }], disabled: [{
            type: Input
        }], readonly: [{
            type: Input
        }], filterable: [{
            type: Input
        }], ignoreCase: [{
            type: Input
        }], delay: [{
            type: Input
        }], tabindex: [{
            type: Input
        }], valueChange: [{
            type: Output
        }], filterChange: [{
            type: Output
        }], selectionChange: [{
            type: Output
        }], open: [{
            type: Output
        }], opened: [{
            type: Output
        }], close: [{
            type: Output
        }], closed: [{
            type: Output
        }], onFocus: [{
            type: Output,
            args: ['focus']
        }], onBlur: [{
            type: Output,
            args: ['blur']
        }], hostClasses: [{
            type: HostBinding,
            args: ['class.k-dropdownlist']
        }, {
            type: HostBinding,
            args: ['class.k-picker']
        }], focusableId: [{
            type: Input,
            args: ['id']
        }, {
            type: HostBinding,
            args: ['attr.id']
        }], role: [{
            type: HostBinding,
            args: ['attr.role']
        }, {
            type: HostBinding,
            args: ['attr.aria-haspopup']
        }], data: [{
            type: Input
        }], value: [{
            type: Input
        }], popupSettings: [{
            type: Input
        }], itemDisabled: [{
            type: Input
        }], virtual: [{
            type: Input
        }], valuePrimitive: [{
            type: Input
        }], tabIndex: [{
            type: Input,
            args: ["tabIndex"]
        }], size: [{
            type: Input
        }], rounded: [{
            type: Input
        }], fillMode: [{
            type: Input
        }], isDisabled: [{
            type: HostBinding,
            args: ['class.k-disabled']
        }, {
            type: HostBinding,
            args: ['attr.aria-disabled']
        }], isLoading: [{
            type: HostBinding,
            args: ['class.k-loading']
        }], dir: [{
            type: HostBinding,
            args: ['attr.dir']
        }], hostTabIndex: [{
            type: HostBinding,
            args: ['attr.tabindex']
        }], isReadonly: [{
            type: HostBinding,
            args: ['attr.readonly']
        }, {
            type: HostBinding,
            args: ['attr.aria-readonly']
        }], isAriaExpanded: [{
            type: HostBinding,
            args: ['attr.aria-expanded']
        }], hostAriaOwns: [{
            type: HostBinding,
            args: ['attr.aria-owns']
        }], hostAriaActivedescendant: [{
            type: HostBinding,
            args: ['attr.aria-activedescendant']
        }], hostNoDataLabel: [{
            type: HostBinding,
            args: ['attr.aria-label']
        }], 
    /**
     * @hidden
     */
    keydown: [{
            type: HostListener,
            args: ['keydown', ['$event']]
        }], 
    /**
     * @hidden
     */
    keypress: [{
            type: HostListener,
            args: ['keypress', ['$event']]
        }], 
    /**
     * @hidden
     */
    click: [{
            type: HostListener,
            args: ['click', ['$event']]
        }], iconClass: [{
            type: Input
        }], loading: [{
            type: Input
        }], textField: [{
            type: Input
        }], valueField: [{
            type: Input
        }], defaultItem: [{
            type: Input
        }], itemTemplate: [{
            type: ContentChild,
            args: [ItemTemplateDirective, { static: false }]
        }], groupTemplate: [{
            type: ContentChild,
            args: [GroupTemplateDirective, { static: false }]
        }], fixedGroupTemplate: [{
            type: ContentChild,
            args: [FixedGroupTemplateDirective, { static: false }]
        }], valueTemplate: [{
            type: ContentChild,
            args: [ValueTemplateDirective, { static: false }]
        }], headerTemplate: [{
            type: ContentChild,
            args: [HeaderTemplateDirective, { static: false }]
        }], footerTemplate: [{
            type: ContentChild,
            args: [FooterTemplateDirective, { static: false }]
        }], noDataTemplate: [{
            type: ContentChild,
            args: [NoDataTemplateDirective, { static: false }]
        }], container: [{
            type: ViewChild,
            args: ['container', { read: ViewContainerRef, static: true }]
        }], popupTemplate: [{
            type: ViewChild,
            args: ['popupTemplate', { static: true }]
        }], optionsList: [{
            type: ViewChild,
            args: ['optionsList', { static: false }]
        }] }); })();
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(CustomItemTemplateDirective, [{
        type: Directive,
        args: [{
                selector: '[kendoMultiSelectCustomItemTemplate]'
            }]
    }], function () { return [{ type: ɵngcc0.TemplateRef }]; }, null); })();
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(TagTemplateDirective, [{
        type: Directive,
        args: [{
                selector: '[kendoMultiSelectTagTemplate],[kendoMultiSelectTreeTagTemplate]'
            }]
    }], function () { return [{ type: ɵngcc0.TemplateRef }]; }, null); })();
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(GroupTagTemplateDirective, [{
        type: Directive,
        args: [{
                selector: '[kendoMultiSelectGroupTagTemplate],[kendoMultiSelectTreeGroupTagTemplate]'
            }]
    }], function () { return [{ type: ɵngcc0.TemplateRef }]; }, null); })();
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(MultiSelectComponent, [{
        type: Component,
        args: [{
                exportAs: 'kendoMultiSelect',
                providers: [
                    MULTISELECT_VALUE_ACCESSOR,
                    DataService,
                    SelectionService,
                    NavigationService,
                    DisabledItemsService,
                    LocalizationService,
                    {
                        provide: L10N_PREFIX,
                        useValue: 'kendo.multiselect'
                    },
                    {
                        provide: FilterableComponent, useExisting: forwardRef(() => MultiSelectComponent_1)
                    },
                    {
                        provide: KendoInput, useExisting: forwardRef(() => MultiSelectComponent_1)
                    }
                ],
                selector: 'kendo-multiselect',
                template: `
        <ng-container kendoMultiSelectLocalizedMessages
            i18n-noDataText="kendo.multiselect.noDataText|The text displayed in the popup when there are no items"
            noDataText="NO DATA FOUND"

            i18n-clearTitle="kendo.multiselect.clearTitle|The title of the clear button"
            clearTitle="clear"
        >
        </ng-container>
        <kendo-taglist
            [size]="size"
            [rounded]="rounded"
            [fillMode]="fillMode"
            [id]="tagListId"
            [tags]="tags"
            [textField]="textField"
            [valueField]="valueField"
            [focused]="focusedTagIndex"
            [disabled]="disabled"
            [template]="tagTemplate"
            [groupTemplate]="groupTagTemplate"
            [tagPrefix]="tagPrefix"
            [disabledIndices]="disabledIndices"
            (removeTag)="handleRemoveTag($event)"
        >
            <kendo-searchbar
                #searchbar
                [id]="focusableId"
                [role]="'textbox'"
                [tagListId]="tagListId"
                [activeDescendant]="activeDescendant"
                [noDataLabel]="noDataLabel"
                [userInput]="text"
                [disabled]="disabled"
                [readonly]="readonly"
                [tabIndex]="tabIndex"
                [popupOpen]="isOpen"
                [placeholder]="placeholder"
                (onNavigate)="handleNavigate($event)"
                (valueChange)="handleFilter($event)"
                (onBlur)="onSearchBarBlur()"
                (onFocus)="onSearchBarFocus()"
            >
            </kendo-searchbar>
        </kendo-taglist>

        <span
            *ngIf="!loading && !readonly && clearButton && (tags?.length || text?.length)"
            class="k-clear-value"
            [style.visibility]="clearButtonVisiblity"
            [attr.title]="messageFor('clearTitle')"
            role="button"
            tabindex="-1"
            (mousedown)="clearAll($event)"
        >
            <span class="k-icon k-i-x"></span>
        </span>
        <span
            *ngIf="loading"
            class="k-icon k-i-loading"
        >
        </span>
        <ng-template #popupTemplate>
            <!--header template-->
            <ng-template *ngIf="headerTemplate"
                [templateContext]="{
                    templateRef: headerTemplate.templateRef
                }">
            </ng-template>
            <!--custom item template-->
            <div
                *ngIf="allowCustom && text"
                class="k-list"
                [ngClass]="customItemSizeClass"
            >
                <div class="k-list-item k-custom-item" kendoDropDownsSelectable [multipleSelection]="true" [index]="-1">
                    <ng-template *ngIf="customItemTemplate;else default_custom_item_template"
                        [templateContext]="{
                            templateRef: customItemTemplate.templateRef,
                            $implicit: text
                        }">
                    </ng-template>
                    <ng-template #default_custom_item_template>{{ text }}</ng-template>
                    <span class="k-icon k-i-plus" style="float: right"></span>
                </div>
            </div>
            <!--list-->
            <kendo-list
                #optionsList
                [size]="size"
                [rounded]="rounded"
                [id]="listBoxId"
                [optionPrefix]="optionPrefix"
                [data]="data"
                [textField]="textField"
                [valueField]="valueField"
                [height]="listHeight"
                [template]="template"
                [groupTemplate]="groupTemplate"
                [fixedGroupTemplate]="fixedGroupTemplate"
                [show]="isOpen"
                [multipleSelection]="true"
                [virtual]="virtual"
                (pageChange)="pageChange($event)"
                [checkboxes]="checkboxes"
                >
            </kendo-list>
            <!--no data template-->
            <div class="k-no-data" *ngIf="data.length === 0">
                <ng-template [ngIf]="noDataTemplate"
                    [templateContext]="{
                        templateRef: noDataTemplate ? noDataTemplate.templateRef : undefined
                    }">
                </ng-template>
                <ng-template [ngIf]="!noDataTemplate">
                    <div>{{ messageFor('noDataText') }}</div>
                </ng-template>
            </div>
            <!--footer template-->
            <ng-template *ngIf="footerTemplate"
                [templateContext]="{
                    templateRef: footerTemplate.templateRef
                }">
            </ng-template>
        </ng-template>
        <ng-template [ngIf]="isOpen">
            <kendo-resize-sensor (resize)="onResize()"></kendo-resize-sensor>
        </ng-template>
        <ng-container #container></ng-container>
  `
            }]
    }], function () { return [{ type: ɵngcc0.ElementRef }, { type: ɵngcc1.LocalizationService }, { type: ɵngcc4.PopupService }, { type: DataService }, { type: SelectionService }, { type: NavigationService }, { type: DisabledItemsService }, { type: ɵngcc0.ChangeDetectorRef }, { type: ɵngcc0.KeyValueDiffers }, { type: ɵngcc0.Renderer2 }, { type: ɵngcc0.NgZone }, { type: Boolean, decorators: [{
                type: Optional
            }, {
                type: Inject,
                args: [TOUCH_ENABLED]
            }] }]; }, { focusableId: [{
            type: Input
        }], autoClose: [{
            type: Input
        }], tabindex: [{
            type: Input
        }], disabled: [{
            type: Input
        }], readonly: [{
            type: Input
        }], filterable: [{
            type: Input
        }], listHeight: [{
            type: Input
        }], clearButton: [{
            type: Input
        }], tagMapper: [{
            type: Input
        }], allowCustom: [{
            type: Input
        }], valueNormalizer: [{
            type: Input
        }], filterChange: [{
            type: Output
        }], valueChange: [{
            type: Output
        }], open: [{
            type: Output
        }], opened: [{
            type: Output
        }], close: [{
            type: Output
        }], closed: [{
            type: Output
        }], onFocus: [{
            type: Output,
            args: ['focus']
        }], onBlur: [{
            type: Output,
            args: ['blur']
        }], removeTag: [{
            type: Output
        }], hostClasses: [{
            type: HostBinding,
            args: ['class.k-multiselect']
        }, {
            type: HostBinding,
            args: ['class.k-input']
        }], role: [{
            type: HostBinding,
            args: ['attr.role']
        }], data: [{
            type: Input
        }], value: [{
            type: Input
        }], tabIndex: [{
            type: Input,
            args: ["tabIndex"]
        }], size: [{
            type: Input
        }], rounded: [{
            type: Input
        }], fillMode: [{
            type: Input
        }], placeholder: [{
            type: Input
        }], itemDisabled: [{
            type: Input
        }], checkboxes: [{
            type: Input
        }], virtual: [{
            type: Input
        }], popupSettings: [{
            type: Input
        }], valuePrimitive: [{
            type: Input
        }], dir: [{
            type: HostBinding,
            args: ['attr.dir']
        }], disabledClass: [{
            type: HostBinding,
            args: ['class.k-disabled']
        }], isLoading: [{
            type: HostBinding,
            args: ['class.k-loading']
        }], isAriaExpanded: [{
            type: HostBinding,
            args: ['attr.aria-expanded']
        }], 
    /**
     * @hidden
     */
    hostMousedown: [{
            type: HostListener,
            args: ['mousedown', ['$event']]
        }], loading: [{
            type: Input
        }], valueField: [{
            type: Input
        }], textField: [{
            type: Input
        }], container: [{
            type: ViewChild,
            args: ['container', { read: ViewContainerRef, static: true }]
        }], searchbar: [{
            type: ViewChild,
            args: [SearchBarComponent, { static: true }]
        }], popupTemplate: [{
            type: ViewChild,
            args: ['popupTemplate', { static: true }]
        }], optionsList: [{
            type: ViewChild,
            args: ['optionsList', { static: false }]
        }], template: [{
            type: ContentChild,
            args: [ItemTemplateDirective, { static: false }]
        }], customItemTemplate: [{
            type: ContentChild,
            args: [CustomItemTemplateDirective, { static: false }]
        }], groupTemplate: [{
            type: ContentChild,
            args: [GroupTemplateDirective, { static: false }]
        }], fixedGroupTemplate: [{
            type: ContentChild,
            args: [FixedGroupTemplateDirective, { static: false }]
        }], headerTemplate: [{
            type: ContentChild,
            args: [HeaderTemplateDirective, { static: false }]
        }], footerTemplate: [{
            type: ContentChild,
            args: [FooterTemplateDirective, { static: false }]
        }], tagTemplate: [{
            type: ContentChild,
            args: [TagTemplateDirective, { static: false }]
        }], groupTagTemplate: [{
            type: ContentChild,
            args: [GroupTagTemplateDirective, { static: false }]
        }], noDataTemplate: [{
            type: ContentChild,
            args: [NoDataTemplateDirective, { static: false }]
        }] }); })();
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(ColumnCellTemplateDirective, [{
        type: Directive,
        args: [{
                selector: '[kendoMultiColumnComboBoxColumnCellTemplate]'
            }]
    }], function () { return [{ type: ɵngcc0.TemplateRef }]; }, null); })();
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(ColumnHeaderTemplateDirective, [{
        type: Directive,
        args: [{
                selector: '[kendoMultiColumnComboBoxColumnHeaderTemplate]'
            }]
    }], function () { return [{ type: ɵngcc0.TemplateRef }]; }, null); })();
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(ComboBoxColumnComponent, [{
        type: Component,
        args: [{
                selector: 'kendo-combobox-column',
                template: ''
            }]
    }], function () { return []; }, { hidden: [{
            type: Input
        }], cellTemplate: [{
            type: ContentChild,
            args: [ColumnCellTemplateDirective, { static: false }]
        }], headerTemplate: [{
            type: ContentChild,
            args: [ColumnHeaderTemplateDirective, { static: false }]
        }], field: [{
            type: Input
        }], title: [{
            type: Input
        }], width: [{
            type: Input
        }], style: [{
            type: Input
        }], headerStyle: [{
            type: Input
        }], class: [{
            type: Input
        }], headerClass: [{
            type: Input
        }], media: [{
            type: Input
        }] }); })();
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(MultiColumnComboBoxComponent, [{
        type: Component,
        args: [{
                providers: [
                    SelectionService,
                    DataService,
                    NavigationService,
                    DisabledItemsService,
                    LocalizationService,
                    {
                        provide: L10N_PREFIX,
                        useValue: 'kendo.multicolumncombobox'
                    },
                    {
                        multi: true,
                        provide: NG_VALUE_ACCESSOR,
                        useExisting: forwardRef(() => MultiColumnComboBoxComponent_1)
                    },
                    {
                        provide: KendoInput,
                        useExisting: forwardRef(() => MultiColumnComboBoxComponent_1)
                    },
                    {
                        provide: FilterableComponent,
                        useExisting: forwardRef(() => MultiColumnComboBoxComponent_1)
                    }
                ],
                selector: 'kendo-multicolumncombobox',
                template: `
        <ng-container
            kendoMultiColumnComboBoxLocalizedMessages

            i18n-noDataText="kendo.multicolumncombobox.noDataText|The text displayed in the popup when there are no items"
            noDataText="NO DATA FOUND"

            i18n-clearTitle="kendo.multicolumncombobox.clearTitle|The title of the clear button"
            clearTitle="clear"
        >
        </ng-container>
        <kendo-searchbar
            #searchbar
            [role]="'combobox'"
            [id]="focusableId"
            [listId]="listBoxId"
            [activeDescendant]="activeDescendant"
            [noDataLabel]="noDataLabel"
            [userInput]="text"
            [suggestedText]="getSuggestion()"
            [disabled]="disabled"
            [readonly]="readonly"
            [tabIndex]="tabIndex"
            [popupOpen]="isOpen"
            [placeholder]="placeholder"
            (onNavigate)="handleNavigate($event)"
            (valueChange)="searchBarChange($event)"
            (onBlur)="handleBlur()"
            (onFocus)="handleFocus()"
        >
        </kendo-searchbar>

        <span
            *ngIf="clearButton && !loading && !disabled && !readonly && text?.length"
            class="k-clear-value"
            [style.visibility]="clearButtonVisiblity"
            aria-hidden="true"
            [attr.title]="messageFor('clearTitle')"
            (click)="clearValue($event)"
            [kendoEventsOutsideAngular]="{
                mousedown: preventEventDefault
            }"
        >
            <span class="k-icon k-i-x"></span>
        </span>

        <button
            #select
            tabindex="-1"
            aria-hidden="true"
            unselectable="on"
            type="button"
            class="k-input-button k-button k-icon-button"
            [ngClass]="selectButtonClasses"
            [attr.aria-label]="messageFor('selectButtonText')"
            [kendoEventsOutsideAngular]="{
                mousedown: preventEventDefault
            }"
        >
            <span class="k-button-icon k-icon" [ngClass]="buttonClasses"></span>
        </button>

        <ng-template #popupTemplate>
            <!--user-defined header template -->
            <ng-template
                *ngIf="headerTemplate"
                [templateContext]="{
                    templateRef: headerTemplate?.templateRef
                }"
            >
            </ng-template>

            <!--data table-->
            <div class="k-data-table" [ngClass]="tableSizeClass">

                <!--grid header-->
                <div
                    #header
                    class="k-table-header"
                >
                    <div class="k-table-header-wrap">
                        <table class="k-table" role="presentation">
                            <colgroup>
                                <ng-container *ngFor="let column of columns">
                                    <col
                                        *ngIf="!column.hidden && column.matchesMedia"
                                        [style.width.px]="column.width"
                                    />
                                </ng-container>
                            </colgroup>
                            <thead class="k-table-thead">
                                <tr class="k-table-row">
                                    <ng-container *ngFor="let column of columns">
                                        <th
                                            *ngIf="!column.hidden && column.matchesMedia"
                                            class="k-table-th"
                                            [ngStyle]="column.headerStyle"
                                            [ngClass]="column.headerClass"
                                        >
                                            <ng-container *ngIf="!column.headerTemplate">
                                                {{ column.title || column.field }}
                                            </ng-container>
                                            <ng-template
                                                *ngIf="column.headerTemplate"
                                                [templateContext]="{
                                                    templateRef: column.headerTemplate?.templateRef,
                                                    $implicit: column,
                                                    column: column
                                                }"
                                            >
                                            </ng-template>
                                        </th>
                                    </ng-container>
                                </tr>
                            </thead>
                        </table>
                    </div>
                </div>

                <!-- item template -->
                <ng-template #rowTemplate let-dataItem>
                    <ng-container *ngFor="let column of columns">
                        <span
                            *ngIf="!column.hidden && column.matchesMedia"
                            class="k-table-td"
                            [ngClass]="column.class"
                            [style.width.px]="column.width"
                            [ngStyle]="column.style"
                        >
                            <ng-container *ngIf="!column.cellTemplate">
                                {{ textFrom(dataItem, column.field) }}
                            </ng-container>
                            <ng-template
                                *ngIf="column.cellTemplate"
                                [templateContext]="{
                                    templateRef: column.cellTemplate?.templateRef,
                                    $implicit: dataItem,
                                    dataItem: dataItem,
                                    column: column
                                }"
                            >
                            </ng-template>
                        </span>
                    </ng-container>
                </ng-template>

                <!--list-->
                <kendo-list
                    #optionsList
                    [id]="listBoxId"
                    [optionPrefix]="optionPrefix"
                    [data]="data"
                    [textField]="textField"
                    [valueField]="valueField"
                    [template]="{ templateRef: rowTemplate }"
                    [groupTemplate]="groupTemplate"
                    [fixedGroupTemplate]="fixedGroupTemplate"
                    [height]="listHeight"
                    [show]="isOpen"
                    [virtual]="virtual"
                    [type]="'dropdowngrid'"
                    (pageChange)="pageChange($event)"
                    (listResize)="updateHeaderPadding(header)"
                >
                </kendo-list>

                <!--no-data template-->
                <div
                    class="k-no-data"
                    *ngIf="data.length === 0"
                >
                    <ng-template
                        [ngIf]="noDataTemplate"
                        [templateContext]="{
                            templateRef: noDataTemplate?.templateRef
                        }"
                    >
                    </ng-template>
                    <ng-template [ngIf]="!noDataTemplate">
                        <div>{{ messageFor('noDataText') }}</div>
                    </ng-template>
                </div>

                <!--user-defined footer template-->
                <ng-container *ngIf="footerTemplate">
                    <div class="k-table-footer">
                        <table class="k-table">
                            <tfoot class="k-table-tfoot">
                                <tr class="k-table-row">
                                    <td class="k-table-td">
                                        <ng-template
                                            [templateContext]="{
                                                templateRef: footerTemplate.templateRef
                                            }"
                                        >
                                        </ng-template>
                                    </td>
                                </tr>
                            </tfoot>
                        </table>
                    </div>
                </ng-container>

            </div>

        </ng-template>

        <kendo-resize-sensor
            *ngIf="isOpen"
            (resize)="onResize()"
        >
        </kendo-resize-sensor>

        <!-- when the popupSettings.appendTo value is set to 'component', this container is used -->
        <ng-container #container></ng-container>
    `
            }]
    }], function () { return [{ type: ɵngcc1.LocalizationService }, { type: ɵngcc4.PopupService }, { type: SelectionService }, { type: NavigationService }, { type: DisabledItemsService }, { type: DataService }, { type: ɵngcc0.NgZone }, { type: ɵngcc0.ChangeDetectorRef }, { type: ɵngcc0.Renderer2 }, { type: ɵngcc0.ElementRef }, { type: Boolean, decorators: [{
                type: Inject,
                args: [TOUCH_ENABLED]
            }] }]; }, { hostClasses: [{
            type: HostBinding,
            args: ['class.k-dropdowngrid']
        }], isDisabled: [{
            type: HostBinding,
            args: ['class.k-disabled']
        }], header: [{
            type: ViewChild,
            args: ['header', { static: false }]
        }], columns: [{
            type: ContentChildren,
            args: [ComboBoxColumnComponent]
        }] }); })();
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(NodeTemplateDirective, [{
        type: Directive,
        args: [{
                selector: '[kendoDropDownTreeNodeTemplate], [kendoMultiSelectTreeNodeTemplate]'
            }]
    }], function () { return [{ type: ɵngcc0.TemplateRef }]; }, null); })();
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(DropDownTreeComponent, [{
        type: Component,
        args: [{
                exportAs: 'kendoDropDownTree',
                providers: [
                    DataService,
                    SelectionService,
                    NavigationService,
                    DisabledItemsService,
                    LocalizationService,
                    {
                        provide: L10N_PREFIX,
                        useValue: 'kendo.dropdowntree'
                    },
                    {
                        multi: true,
                        provide: NG_VALUE_ACCESSOR,
                        useExisting: forwardRef(() => DropDownTreeComponent_1)
                    },
                    {
                        provide: KendoInput,
                        useExisting: forwardRef(() => DropDownTreeComponent_1)
                    },
                    {
                        provide: DataBoundComponent,
                        useExisting: forwardRef(() => DropDownTreeComponent_1)
                    },
                    {
                        provide: ExpandableComponent,
                        useExisting: forwardRef(() => DropDownTreeComponent_1)
                    }
                ],
                selector: 'kendo-dropdowntree',
                template: `
        <ng-container kendoDropDownTreeLocalizedMessages
            i18n-noDataText="kendo.dropdowntree.noDataText|The text displayed in the popup when there are no items"
            noDataText="NO DATA FOUND"

            i18n-clearTitle="kendo.dropdowntree.clearTitle|The title of the clear button"
            clearTitle="clear"

            i18n-selectButtonText="kendo.dropdowntree.selectButtonText|The text set as aria-label on the select button"
            selectButtonText="Select"
        >
        </ng-container>
        <span
            [attr.id]="valueLabelId"
            class="k-input-inner"
            role="option"
        >
            <span class="k-input-value-text">
                <ng-template *ngIf="valueTemplate"
                    [templateContext]="{
                        templateRef: valueTemplate.templateRef,
                        $implicit: dataItem
                    }">
                </ng-template>
                <ng-template [ngIf]="!valueTemplate"> {{ text || placeholder }} </ng-template>
            </span>
        </span>
        <span
            *ngIf="!loading && !readonly && clearButton && text?.length && !disabled"
            class="k-clear-value"
            [style.visibility]="clearButtonVisiblity"
            aria-hidden="true"
            [attr.title]="messageFor('clearTitle')"
            (click)="clearValue($event)"
        >
            <span class="k-icon k-i-x"></span>
        </span>
        <button
            tabindex="-1"
            type="button"
            aria-hidden="true"
            class="k-input-button k-button k-icon-button"
            [ngClass]="selectButtonClasses"
            [attr.aria-label]="messageFor('selectButtonText')"
        >
            <span
                class="k-button-icon k-icon"
                [ngClass]="buttonClasses"
            ></span>
        </button>
        <ng-template #popupTemplate>
            <span
                *ngIf="filterable"
                class="k-list-filter"
            >
                <span
                    class="k-textbox k-input"
                    [ngClass]="filterInputClasses"
                >
                    <span class="k-input-prefix">
                        <span class="k-input-icon k-icon k-i-search"></span>
                    </span>
                    <input
                        #filterInput
                        (input)="handleFilterInputChange($event.target.value)"
                        [filterInput]="filterable && !touchEnabled"
                        (keydown.arrowdown)="handleKeydown($event)"
                        (keydown.alt.arrowup)="handleKeydown($event)"
                        [(ngModel)]="filter"
                        class="k-input-inner"
                        role="textbox"
                        aria-haspopup="true"
                        aria-expanded="false"
                        tabindex="0"
                        aria-disabled="false"
                        aria-readonly="false"
                        [kendoEventsOutsideAngular]="{
                            blur: handleBlur
                        }"
                        [scope]="this"
                    >
                </span>
            </span>
            <!--header template-->
            <ng-template
                *ngIf="headerTemplate"
                [templateContext]="{
                    templateRef: headerTemplate?.templateRef
                }">
            </ng-template>
            <kendo-treeview
                #treeview
                *ngIf="data.length !== 0 && !allNodesHidden"
                [size]="size"
                [nodes]="data"
                [style.maxHeight.px]="listHeight"
                [animate]="false"
                [(selectedKeys)]="selectedKeys"
                [selectBy]="selectBy"
                [textField]="textField"
                kendoTreeViewSelectable
                [children]="children"
                [hasChildren]="hasChildren"
                [loadOnDemand]="loadOnDemand"
                [isExpanded]="isNodeExpanded"
                [isDisabled]="itemDisabled"
                [nodeTemplate]="nodeTemplate"
                [filter]="filter"
                [isVisible]="isNodeVisible"
                (focusout)="handleBlur($event)"
                (keydown)="handleKeydown($event)"
                (selectionChange)="onSelectionChange($event)"
                (expand)="nodeExpand.emit($event)"
                (collapse)="nodeCollapse.emit($event)"
            >
            </kendo-treeview>
            <!--footer template-->
            <ng-template
                *ngIf="footerTemplate"
                [templateContext]="{
                    templateRef: footerTemplate?.templateRef
                }">
            </ng-template>
            <!--no-data template-->
            <div class="k-no-data" *ngIf="data.length === 0 || allNodesHidden">
                <ng-template [ngIf]="noDataTemplate"
                    [templateContext]="{
                        templateRef: noDataTemplate?.templateRef
                    }">
                </ng-template>
                <ng-template [ngIf]="!noDataTemplate">
                    <div>{{ messageFor('noDataText') }}</div>
                </ng-template>
            </div>
        </ng-template>
        <ng-container #container></ng-container>
    `,
                changeDetection: ChangeDetectionStrategy.OnPush
            }]
    }], function () { return [{ type: ɵngcc0.ElementRef }, { type: ɵngcc4.PopupService }, { type: NavigationService }, { type: ɵngcc0.Renderer2 }, { type: ɵngcc0.NgZone }, { type: ɵngcc0.ChangeDetectorRef }, { type: ɵngcc1.LocalizationService }, { type: Boolean, decorators: [{
                type: Optional
            }, {
                type: Inject,
                args: [TOUCH_ENABLED]
            }] }]; }, { hostClasses: [{
            type: HostBinding,
            args: ['class.k-dropdowntree']
        }, {
            type: HostBinding,
            args: ['class.k-picker']
        }], role: [{
            type: HostBinding,
            args: ['attr.role']
        }], ariaHasPopup: [{
            type: HostBinding,
            args: ['attr.aria-haspopup']
        }], open: [{
            type: Output
        }], opened: [{
            type: Output
        }], close: [{
            type: Output
        }], closed: [{
            type: Output
        }], nodeExpand: [{
            type: Output
        }], nodeCollapse: [{
            type: Output
        }], onFocus: [{
            type: Output,
            args: ['focus']
        }], onBlur: [{
            type: Output,
            args: ['blur']
        }], valueChange: [{
            type: Output
        }], filterChange: [{
            type: Output
        }], clearButton: [{
            type: Input
        }], hasChildren: [{
            type: Input
        }], fetchChildren: [{
            type: Input
        }], placeholder: [{
            type: Input
        }], listHeight: [{
            type: Input
        }], disabled: [{
            type: Input
        }], readonly: [{
            type: Input
        }], valuePrimitive: [{
            type: Input
        }], itemDisabled: [{
            type: Input
        }], isNodeVisible: [{
            type: Input
        }], loadOnDemand: [{
            type: Input
        }], filterable: [{
            type: Input
        }], filter: [{
            type: Input
        }], focusableId: [{
            type: Input
        }], direction: [{
            type: HostBinding,
            args: ['attr.dir']
        }], isDisabled: [{
            type: HostBinding,
            args: ['class.k-disabled']
        }, {
            type: HostBinding,
            args: ['attr.aria-disabled']
        }], isLoading: [{
            type: HostBinding,
            args: ['class.k-loading']
        }], id: [{
            type: HostBinding,
            args: ['attr.id']
        }], hostTabIndex: [{
            type: HostBinding,
            args: ['attr.tabindex']
        }], isAriaExpanded: [{
            type: HostBinding,
            args: ['attr.aria-expanded']
        }], isReadonly: [{
            type: HostBinding,
            args: ['attr.readonly']
        }, {
            type: HostBinding,
            args: ['attr.aria-readonly']
        }], 
    /**
     * @hidden
     */
    handleClick: [{
            type: HostListener,
            args: ['click']
        }], 
    /**
     * @hidden
     */
    handleKeydown: [{
            type: HostListener,
            args: ['keydown', ['$event']]
        }], treeview: [{
            type: ViewChild,
            args: ['treeview', { static: false }]
        }], data: [{
            type: Input
        }], value: [{
            type: Input
        }], popupSettings: [{
            type: Input
        }], dataItem: [{
            type: Input
        }], tabindex: [{
            type: Input
        }], size: [{
            type: Input
        }], rounded: [{
            type: Input
        }], fillMode: [{
            type: Input
        }], isNodeExpanded: [{
            type: Input
        }], valueDepth: [{
            type: Input
        }], noDataTemplate: [{
            type: ContentChild,
            args: [NoDataTemplateDirective, { static: false }]
        }], headerTemplate: [{
            type: ContentChild,
            args: [HeaderTemplateDirective, { static: false }]
        }], footerTemplate: [{
            type: ContentChild,
            args: [FooterTemplateDirective, { static: false }]
        }], nodeTemplate: [{
            type: ContentChild,
            args: [NodeTemplateDirective, { static: false }]
        }], valueTemplate: [{
            type: ContentChild,
            args: [ValueTemplateDirective, { static: false }]
        }], popupTemplate: [{
            type: ViewChild,
            args: ['popupTemplate', { static: true }]
        }], container: [{
            type: ViewChild,
            args: ['container', { read: ViewContainerRef, static: true }]
        }], filterInput: [{
            type: ViewChild,
            args: ['filterInput', { static: false }]
        }], loading: [{
            type: Input
        }], textField: [{
            type: Input
        }], valueField: [{
            type: Input
        }] }); })();
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(MultiSelectTreeComponent, [{
        type: Component,
        args: [{
                exportAs: 'kendoMultiSelectTree',
                providers: [
                    LocalizationService,
                    NavigationService,
                    DataService,
                    DisabledItemsService,
                    SelectionService,
                    {
                        provide: L10N_PREFIX,
                        useValue: 'kendo.multiselecttree'
                    },
                    {
                        multi: true,
                        provide: NG_VALUE_ACCESSOR,
                        useExisting: forwardRef(() => MultiSelectTreeComponent_1)
                    },
                    {
                        provide: DataBoundComponent,
                        useExisting: forwardRef(() => MultiSelectTreeComponent_1)
                    },
                    {
                        provide: ExpandableComponent,
                        useExisting: forwardRef(() => MultiSelectTreeComponent_1)
                    },
                    {
                        provide: KendoInput,
                        useExisting: forwardRef(() => MultiSelectTreeComponent_1)
                    }
                ],
                selector: 'kendo-multiselecttree',
                template: `
        <ng-container kendoMultiSelectTreeLocalizedMessages
            i18n-noDataText="kendo.multiselecttree.noDataText|The text displayed in the popup when there are no items"
            noDataText="NO DATA FOUND"

            i18n-clearTitle="kendo.multiselecttree.clearTitle|The title of the clear button"
            clearTitle="clear"

            i18n-checkAllText="kendo.multiselecttree.checkAllText|The text displayed for the check-all checkbox"
            checkAllText="Check all"
        >
        </ng-container>
        <kendo-taglist
            [size]="size"
            [rounded]="rounded"
            [fillMode]="fillMode"
            [id]="tagListId"
            [tags]="tags"
            [focused]="focusedTagIndex"
            [textField]="textField"
            [valueField]="valueField"
            [valueDepth]="valueDepth"
            [disabled]="disabled"
            [tagPrefix]="tagPrefix"
            [template]="tagTemplate"
            [groupTemplate]="groupTagTemplate"
            [disabledIndices]="disabledIndices"
            (removeTag)="handleRemoveTag($event)"
        >
            <span *ngIf="!tags || !tags.length"
                class="k-input-inner k-readonly"
            >
                <span class="k-input-value-text">{{ placeholder }}</span>
            </span>
        </kendo-taglist>
        <span
            *ngIf="!disabled && !loading && !readonly && clearButton && tags?.length"
            class="k-clear-value"
            [attr.title]="messageFor('clearTitle')"
            role="button"
            tabindex="-1"
            (click)="clearAll($event)"
        >
            <span class="k-icon k-i-x"></span>
        </span>
        <span
            *ngIf="loading"
            class="k-icon k-i-loading"
        >
        </span>
        <ng-template #popupTemplate>
            <span
                *ngIf="filterable"
                class="k-list-filter"
            >
                <span
                    class="k-textbox k-input"
                    [ngClass]="filterInputClasses"
                >
                    <span class="k-input-prefix">
                        <span class="k-input-icon k-icon k-i-search"></span>
                    </span>
                    <input
                        #filterInput
                        (input)="handleFilterInputChange($event.target.value)"
                        [filterInput]="filterable && !touchEnabled"
                        (keydown)="handleKeydown($event)"
                        [(ngModel)]="filter"
                        class="k-input-inner"
                        role="textbox"
                        aria-haspopup="true"
                        aria-expanded="false"
                        tabindex="0"
                        aria-disabled="false"
                        aria-readonly="false"
                        [kendoEventsOutsideAngular]="{
                            blur: handleBlur
                        }"
                        [scope]="this"
                    >
                </span>
            </span>
            <!--header template-->
            <ng-template
                *ngIf="headerTemplate"
                [templateContext]="{
                    templateRef: headerTemplate?.templateRef
                }">
            </ng-template>
            <div *ngIf="checkAll" class="k-check-all">
                <input
                    #checkAllInput
                    [checkAll]="!filterable && !touchEnabled"
                    type="checkbox"
                    class="k-checkbox"
                    [ngClass]="checkAllCheckboxClasses"
                    role="checkbox"
                    tabindex="0"
                    aria-disabled="false"
                    aria-readonly="false"
                    [treeview]="treeview"
                    [checkedItems]="checkedItems"
                    [valueField]="valueField"
                    [lastAction]="lastAction"
                    (checkedItemsChange)="handleCheckedItemsChange($event)"
                    (keydown)="handleKeydown($event)"
                    [kendoEventsOutsideAngular]="{
                        blur: handleBlur
                    }"
                    [scope]="this"
                >
                <span
                    class="k-checkbox-label"
                    (click)="toggleCheckAll()"
                    (mousedown)="$event.preventDefault()"
                >
                    {{ messageFor('checkAllText') }}
                </span>
            </div>
            <kendo-treeview
                #treeview
                [size]="size"
                [nodes]="data"
                [style.maxHeight.px]="listHeight"
                [animate]="false"
                kendoMultiSelectTreeCheckable
                [checkable]="checkableSettings"
                [checkedItems]="checkedItems"
                [valueField]="valueField"
                [textField]="textField"
                [children]="children"
                [hasChildren]="hasChildren"
                [isExpanded]="isNodeExpanded"
                [isDisabled]="itemDisabled"
                [nodeTemplate]="nodeTemplate"
                [loadOnDemand]="loadOnDemand"
                [filter]="filter"
                [isVisible]="isNodeVisible"
                (keydown)="handleKeydown($event)"
                (nodeClick)="handleNodeClick($event)"
                (expand)="nodeExpand.emit($event)"
                (collapse)="nodeCollapse.emit($event)"
                (checkedItemsChange)="handleCheckedItemsChange($event)"
                [kendoEventsOutsideAngular]="{
                    focusout: handleBlur
                }"
                [scope]="this"
            >
            </kendo-treeview>
            <!--footer template-->
            <ng-template
                *ngIf="footerTemplate"
                [templateContext]="{
                    templateRef: footerTemplate?.templateRef
                }">
            </ng-template>
            <!--no-data template-->
            <div class="k-no-data" *ngIf="data?.length === 0 || allNodesHidden">
                <ng-template [ngIf]="noDataTemplate"
                    [templateContext]="{
                        templateRef: noDataTemplate?.templateRef
                    }">
                </ng-template>
                <ng-template [ngIf]="!noDataTemplate">
                    <div>{{ messageFor('noDataText') }}</div>
                </ng-template>
            </div>
        </ng-template>
        <ng-container #container></ng-container>
    `
            }]
    }], function () { return [{ type: ɵngcc0.ElementRef }, { type: ɵngcc4.PopupService }, { type: ɵngcc0.Renderer2 }, { type: NavigationService }, { type: ɵngcc0.NgZone }, { type: ɵngcc1.LocalizationService }, { type: ɵngcc0.ChangeDetectorRef }, { type: Boolean, decorators: [{
                type: Optional
            }, {
                type: Inject,
                args: [TOUCH_ENABLED]
            }] }]; }, { hostClasses: [{
            type: HostBinding,
            args: ['class.k-dropdowntree']
        }, {
            type: HostBinding,
            args: ['class.k-input']
        }], role: [{
            type: HostBinding,
            args: ['attr.role']
        }], ariaHasPopup: [{
            type: HostBinding,
            args: ['attr.aria-haspopup']
        }], valueDepth: [{
            type: Input
        }], placeholder: [{
            type: Input
        }], listHeight: [{
            type: Input
        }], disabled: [{
            type: Input
        }], readonly: [{
            type: Input
        }], valuePrimitive: [{
            type: Input
        }], loadOnDemand: [{
            type: Input
        }], focusableId: [{
            type: Input
        }], clearButton: [{
            type: Input
        }], filterable: [{
            type: Input
        }], checkAll: [{
            type: Input
        }], hasChildren: [{
            type: Input
        }], fetchChildren: [{
            type: Input
        }], isNodeVisible: [{
            type: Input
        }], itemDisabled: [{
            type: Input
        }], tagMapper: [{
            type: Input
        }], onFocus: [{
            type: Output,
            args: ['focus']
        }], onBlur: [{
            type: Output,
            args: ['blur']
        }], open: [{
            type: Output
        }], opened: [{
            type: Output
        }], close: [{
            type: Output
        }], closed: [{
            type: Output
        }], nodeExpand: [{
            type: Output
        }], nodeCollapse: [{
            type: Output
        }], valueChange: [{
            type: Output
        }], removeTag: [{
            type: Output
        }], filterChange: [{
            type: Output
        }], direction: [{
            type: HostBinding,
            args: ['attr.dir']
        }], isDisabled: [{
            type: HostBinding,
            args: ['class.k-disabled']
        }, {
            type: HostBinding,
            args: ['attr.aria-disabled']
        }], isLoading: [{
            type: HostBinding,
            args: ['class.k-loading']
        }], id: [{
            type: HostBinding,
            args: ['attr.id']
        }], hostTabIndex: [{
            type: HostBinding,
            args: ['attr.tabindex']
        }], isAriaExpanded: [{
            type: HostBinding,
            args: ['attr.aria-expanded']
        }], isReadonly: [{
            type: HostBinding,
            args: ['attr.readonly']
        }, {
            type: HostBinding,
            args: ['attr.aria-readonly']
        }], ariaDescribedBy: [{
            type: HostBinding,
            args: ['attr.aria-describedby']
        }], ariaActiveDescendant: [{
            type: HostBinding,
            args: ['attr.aria-activedescendant']
        }], 
    /**
     * @hidden
     */
    handleClick: [{
            type: HostListener,
            args: ['click']
        }], 
    /**
     * @hidden
     */
    handleKeydown: [{
            type: HostListener,
            args: ['keydown', ['$event']]
        }], treeview: [{
            type: ViewChild,
            args: ['treeview', { static: false }]
        }], tabindex: [{
            type: Input
        }], size: [{
            type: Input
        }], rounded: [{
            type: Input
        }], fillMode: [{
            type: Input
        }], popupSettings: [{
            type: Input
        }], checkableSettings: [{
            type: Input
        }], data: [{
            type: Input
        }], value: [{
            type: Input
        }], dataItems: [{
            type: Input
        }], isNodeExpanded: [{
            type: Input
        }], headerTemplate: [{
            type: ContentChild,
            args: [HeaderTemplateDirective, { static: false }]
        }], footerTemplate: [{
            type: ContentChild,
            args: [FooterTemplateDirective, { static: false }]
        }], nodeTemplate: [{
            type: ContentChild,
            args: [NodeTemplateDirective, { static: false }]
        }], noDataTemplate: [{
            type: ContentChild,
            args: [NoDataTemplateDirective, { static: false }]
        }], tagTemplate: [{
            type: ContentChild,
            args: [TagTemplateDirective, { static: false }]
        }], groupTagTemplate: [{
            type: ContentChild,
            args: [GroupTagTemplateDirective, { static: false }]
        }], popupTemplate: [{
            type: ViewChild,
            args: ['popupTemplate', { static: true }]
        }], container: [{
            type: ViewChild,
            args: ['container', { read: ViewContainerRef, static: true }]
        }], filterInput: [{
            type: ViewChild,
            args: ['filterInput', { static: false }]
        }], checkAllInput: [{
            type: ViewChild,
            args: ['checkAllInput', { static: false }]
        }], textField: [{
            type: Input
        }], valueField: [{
            type: Input
        }], loading: [{
            type: Input
        }] }); })();
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(DropDownTreeFlatBindingDirective, [{
        type: Directive,
        args: [{
                selector: '[kendoDropDownTreeFlatBinding]'
            }]
    }], function () { return [{ type: ɵngcc6.DataBoundComponent }]; }, { nodes: [{
            type: Input,
            args: ['kendoDropDownTreeFlatBinding']
        }], idField: [{
            type: Input,
            args: ['valueField']
        }] }); })();
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(DropDownTreeHierarchyBindingDirective, [{
        type: Directive,
        args: [{
                selector: '[kendoDropDownTreeHierarchyBinding]'
            }]
    }], function () { return [{ type: ɵngcc6.DataBoundComponent }]; }, { data: [{
            type: Input,
            args: ['kendoDropDownTreeHierarchyBinding']
        }] }); })();
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(MultiSelectTreeFlatBindingDirective, [{
        type: Directive,
        args: [{
                selector: '[kendoMultiSelectTreeFlatBinding]'
            }]
    }], function () { return [{ type: ɵngcc6.DataBoundComponent }]; }, { nodes: [{
            type: Input,
            args: ['kendoMultiSelectTreeFlatBinding']
        }], idField: [{
            type: Input,
            args: ['valueField']
        }] }); })();
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(MultiSelectTreeHierarchyBindingDirective, [{
        type: Directive,
        args: [{
                selector: '[kendoMultiSelectTreeHierarchyBinding]'
            }]
    }], function () { return [{ type: ɵngcc6.DataBoundComponent }]; }, { data: [{
            type: Input,
            args: ['kendoMultiSelectTreeHierarchyBinding']
        }] }); })();
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(DropDownTreesExpandDirective, [{
        type: Directive,
        args: [{
                selector: '[kendoDropDownTreeExpandable], [kendoMultiSelectTreeExpandable]'
            }]
    }], function () { return [{ type: ɵngcc6.ExpandableComponent }]; }, { isExpanded: [{
            type: Input,
            args: ['isNodeExpanded']
        }] }); })();
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(TagListComponent, [{
        type: Component,
        args: [{
                selector: 'kendo-taglist',
                template: `
        <div
            *ngFor="let tag of tags; let index = index;"
            [attr.id]="itemId(tag, index)"
            [attr.aria-hidden]="tagAriaHidden(index)"
            class="k-chip"
            [ngClass]="{
                'k-focus': index === focused,
                'k-disabled': isTagDisabled(tag, index),
                'k-chip-sm': size === 'small',
                'k-chip-md': size === 'medium',
                'k-chip-lg': size === 'large',
                'k-rounded-sm': rounded === 'small',
                'k-rounded-md': rounded === 'medium',
                'k-rounded-lg': rounded === 'large',
                'k-rounded-full': rounded === 'full',
                'k-chip-solid k-chip-solid-base': fillMode === 'solid',
                'k-chip-flat k-chip-flat-base': fillMode === 'flat',
                'k-chip-outline k-chip-outline-base': fillMode === 'outline'
            }"
        >
            <span class="k-chip-content">
                <ng-template *ngIf="isGroupTag(tag); then groupTag else singleTag"></ng-template>
                <ng-template #groupTag>
                    <span class="k-chip-label k-text-ellipsis">
                        <ng-template *ngIf="groupTemplate"
                            [templateContext]="{
                            templateRef: groupTemplate.templateRef,
                            $implicit: tag
                        }">
                        </ng-template>
                        <ng-template [ngIf]="!groupTemplate">{{ tag.length }} {{ tag.length === 1 ? 'item' : 'items' }} selected</ng-template>
                    </span>
                </ng-template>
                <ng-template #singleTag>
                    <span class="k-chip-label k-text-ellipsis">
                        <ng-template *ngIf="template"
                            [templateContext]="{
                            templateRef: template.templateRef,
                            $implicit: tag
                        }">
                        </ng-template>
                        <ng-template [ngIf]="!template">{{ tagProp(tag, textField, index) }}</ng-template>
                    </span>
                </ng-template>
            </span>

            <span class="k-chip-actions">
                <span aria-label="delete" [attr.aria-hidden]="index !== focused" class="k-chip-action k-chip-remove-action">
                    <span class="k-icon k-i-x-circle" (mousedown)="deleteTag($event, tag, index)">
                    </span>
                </span>
            </span>
        </div>
        <ng-content></ng-content>
  `
            }]
    }], function () { return [{ type: ɵngcc0.Renderer2 }, { type: ɵngcc0.ElementRef }]; }, { rounded: [{
            type: Input
        }], fillMode: [{
            type: Input
        }], disabledIndices: [{
            type: Input
        }], removeTag: [{
            type: Output
        }], hostClasses: [{
            type: HostBinding,
            args: ['class.k-input-values']
        }, {
            type: HostBinding,
            args: ['class.k-chip-list']
        }, {
            type: HostBinding,
            args: ['class.k-selection-multiple']
        }], size: [{
            type: Input
        }], hostId: [{
            type: HostBinding,
            args: ['attr.id']
        }], tags: [{
            type: Input
        }], textField: [{
            type: Input
        }], valueField: [{
            type: Input
        }], valueDepth: [{
            type: Input
        }], focused: [{
            type: Input
        }], template: [{
            type: Input
        }], groupTemplate: [{
            type: Input
        }], disabled: [{
            type: Input
        }], tagPrefix: [{
            type: Input
        }], id: [{
            type: Input
        }] }); })();

(function () { (typeof ngDevMode === "undefined" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(LocalizedMessagesDirective, [{
        type: Directive,
        args: [{
                providers: [
                    {
                        provide: Messages,
                        useExisting: forwardRef(() => LocalizedMessagesDirective_1)
                    }
                ],
                selector: `
    [kendoDropDownListLocalizedMessages],
    [kendoDropDownTreeLocalizedMessages],
    [kendoComboBoxLocalizedMessages],
    [kendoMultiColumnComboBoxLocalizedMessages],
    [kendoAutoCompleteLocalizedMessages],
    [kendoMultiSelectLocalizedMessages],
    [kendoMultiSelectTreeLocalizedMessages]
  `
            }]
    }], function () { return [{ type: ɵngcc1.LocalizationService }]; }, null); })();
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(CustomMessagesComponent, [{
        type: Component,
        args: [{
                providers: [
                    {
                        provide: Messages,
                        useExisting: forwardRef(() => CustomMessagesComponent_1)
                    }
                ],
                selector: 'kendo-dropdownlist-messages,kendo-combobox-messages,kendo-multicolumncombobox-messages,kendo-autocomplete-messages,kendo-multiselect-messages,kendo-dropdowntree-messages,kendo-multiselecttree-messages',
                template: ``
            }]
    }], function () { return [{ type: ɵngcc1.LocalizationService }]; }, null); })();
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(FilterDirective, [{
        type: Directive,
        args: [{
                selector: '[kendoDropDownFilter]'
            }]
    }], function () { return [{ type: FilterableComponent }]; }, { filterable: [{
            type: Input
        }], data: [{
            type: Input
        }], rawSettings: [{
            type: Input,
            args: ['kendoDropDownFilter']
        }] }); })();
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(FilterInputDirective, [{
        type: Directive,
        args: [{
                selector: '[filterInput]' // tslint:disable-line
            }]
    }], function () { return [{ type: ɵngcc0.ElementRef }, { type: ɵngcc0.NgZone }]; }, { focused: [{
            type: Input,
            args: ['filterInput']
        }] }); })();
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(SharedDirectivesModule, [{
        type: NgModule,
        args: [{
                declarations: [SHARED_DIRECTIVES],
                exports: [SHARED_DIRECTIVES]
            }]
    }], null, null); })();
(function () { (typeof ngJitMode === "undefined" || ngJitMode) && ɵngcc0.ɵɵsetNgModuleScope(SharedDirectivesModule, { declarations: [HeaderTemplateDirective, FooterTemplateDirective, ItemTemplateDirective, GroupTemplateDirective, FixedGroupTemplateDirective, NoDataTemplateDirective, ValueTemplateDirective, TagTemplateDirective, GroupTagTemplateDirective, LocalizedMessagesDirective, CustomMessagesComponent, FilterDirective, FilterInputDirective], exports: [HeaderTemplateDirective, FooterTemplateDirective, ItemTemplateDirective, GroupTemplateDirective, FixedGroupTemplateDirective, NoDataTemplateDirective, ValueTemplateDirective, TagTemplateDirective, GroupTagTemplateDirective, LocalizedMessagesDirective, CustomMessagesComponent, FilterDirective, FilterInputDirective] }); })();
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(SelectableDirective, [{
        type: Directive,
        args: [{
                selector: '[kendoDropDownsSelectable]'
            }]
    }], function () { return [{ type: SelectionService }]; }, { checkboxes: [{
            type: Input
        }], multipleSelection: [{
            type: Input
        }], focusedClassName: [{
            type: HostBinding,
            args: ['class.k-focus']
        }], selectedClassName: [{
            type: HostBinding,
            args: ['class.k-selected']
        }], onClick: [{
            type: HostListener,
            args: ['click', ['$event']]
        }], index: [{
            type: HostBinding,
            args: ['attr.index']
        }, {
            type: Input
        }], height: [{
            type: HostBinding,
            args: ['style.height.px']
        }, {
            type: HostBinding,
            args: ['style.minHeight.px']
        }, {
            type: Input
        }] }); })();
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(TemplateContextDirective, [{
        type: Directive,
        args: [{
                selector: '[templateContext]' // tslint:disable-line
            }]
    }], function () { return [{ type: ɵngcc0.ViewContainerRef }]; }, { templateContext: [{
            type: Input
        }] }); })();

(function () { (typeof ngDevMode === "undefined" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(CheckDirective, [{
        type: Directive,
        args: [{
                selector: '[kendoMultiSelectTreeCheckable]'
            }]
    }], function () { return [{ type: ɵngcc6.TreeViewComponent }]; }, { checkedItemsChange: [{
            type: Output
        }], checkable: [{
            type: Input
        }], valueField: [{
            type: Input
        }], checkedItems: [{
            type: Input
        }] }); })();
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(CheckAllDirective, [{
        type: Directive,
        args: [{
                selector: '[checkAll]' // tslint:disable-line
            }]
    }], function () { return [{ type: ɵngcc0.ElementRef }, { type: ɵngcc0.NgZone }, { type: ɵngcc0.ChangeDetectorRef }, { type: ɵngcc0.Renderer2 }]; }, { checkedItemsChange: [{
            type: Output
        }], handleChange: [{
            type: HostListener,
            args: ['change', ['$event.target']]
        }], lastAction: [{
            type: Input
        }], treeview: [{
            type: Input
        }], checkedItems: [{
            type: Input
        }], valueField: [{
            type: Input
        }], focused: [{
            type: Input,
            args: ['checkAll']
        }] }); })();
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(SharedModule, [{
        type: NgModule,
        args: [{
                declarations: [INTERNAL_DIRECTIVES],
                exports: [INTERNAL_DIRECTIVES, CommonModule, FormsModule, PopupModule, ResizeSensorModule, SharedDirectivesModule, EventsModule],
                imports: [CommonModule, FormsModule, PopupModule, ResizeSensorModule, SharedDirectivesModule, EventsModule]
            }]
    }], null, null); })();
(function () { (typeof ngJitMode === "undefined" || ngJitMode) && ɵngcc0.ɵɵsetNgModuleScope(SharedModule, { declarations: function () { return [ListComponent, ListItemDirective, SelectableDirective, SearchBarComponent, TemplateContextDirective, TagListComponent, CheckDirective, CheckAllDirective]; }, imports: function () { return [CommonModule, FormsModule, PopupModule, ResizeSensorModule, SharedDirectivesModule, EventsModule]; }, exports: function () { return [ListComponent, ListItemDirective, SelectableDirective, SearchBarComponent, TemplateContextDirective, TagListComponent, CheckDirective, CheckAllDirective, CommonModule, FormsModule, PopupModule, ResizeSensorModule, SharedDirectivesModule, EventsModule]; } }); })();
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(MultiSelectTreeSummaryTagDirective, [{
        type: Directive,
        args: [{
                selector: '[kendoMultiSelectTreeSummaryTag]'
            }]
    }], function () { return [{ type: MultiSelectTreeComponent }]; }, { showAfter: [{
            type: Input,
            args: ['kendoMultiSelectTreeSummaryTag']
        }] }); })();
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(DropDownTreesModule, [{
        type: NgModule,
        args: [{
                declarations: [DROPDOWNTREE_DIRECTIVES],
                exports: [DROPDOWNTREE_DIRECTIVES, SharedDirectivesModule],
                imports: [SharedModule, TreeViewModule]
            }]
    }], null, null); })();
(function () { (typeof ngJitMode === "undefined" || ngJitMode) && ɵngcc0.ɵɵsetNgModuleScope(DropDownTreesModule, { declarations: function () { return [DropDownTreeComponent, MultiSelectTreeComponent, DropDownTreeFlatBindingDirective, DropDownTreeHierarchyBindingDirective, MultiSelectTreeFlatBindingDirective, MultiSelectTreeHierarchyBindingDirective, DropDownTreesExpandDirective, NodeTemplateDirective, MultiSelectTreeSummaryTagDirective]; }, imports: function () { return [SharedModule, TreeViewModule]; }, exports: function () { return [DropDownTreeComponent, MultiSelectTreeComponent, DropDownTreeFlatBindingDirective, DropDownTreeHierarchyBindingDirective, MultiSelectTreeFlatBindingDirective, MultiSelectTreeHierarchyBindingDirective, DropDownTreesExpandDirective, NodeTemplateDirective, MultiSelectTreeSummaryTagDirective, SharedDirectivesModule]; } }); })();
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(SummaryTagDirective, [{
        type: Directive,
        args: [{
                selector: '[kendoMultiSelectSummaryTag]'
            }]
    }], function () { return [{ type: MultiSelectComponent }]; }, { showAfter: [{
            type: Input,
            args: ['kendoMultiSelectSummaryTag']
        }] }); })();
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(AutoCompleteModule, [{
        type: NgModule,
        args: [{
                declarations: [AUTOCOMPLETE_DIRECTIVES],
                exports: [AUTOCOMPLETE_DIRECTIVES, SharedDirectivesModule],
                imports: [SharedModule]
            }]
    }], null, null); })();
(function () { (typeof ngJitMode === "undefined" || ngJitMode) && ɵngcc0.ɵɵsetNgModuleScope(AutoCompleteModule, { declarations: [AutoCompleteComponent], imports: [SharedModule], exports: [AutoCompleteComponent, SharedDirectivesModule] }); })();
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(ComboBoxModule, [{
        type: NgModule,
        args: [{
                declarations: [COMBOBOX_DIRECTIVES],
                exports: [COMBOBOX_DIRECTIVES, SharedDirectivesModule],
                imports: [SharedModule],
                providers: [{ provide: TOUCH_ENABLED, useValue: ɵ0$4 }]
            }]
    }], null, null); })();
(function () { (typeof ngJitMode === "undefined" || ngJitMode) && ɵngcc0.ɵɵsetNgModuleScope(ComboBoxModule, { declarations: [ComboBoxComponent, MultiColumnComboBoxComponent, ComboBoxColumnComponent, ColumnHeaderTemplateDirective, ColumnCellTemplateDirective], imports: [SharedModule], exports: [ComboBoxComponent, MultiColumnComboBoxComponent, ComboBoxColumnComponent, ColumnHeaderTemplateDirective, ColumnCellTemplateDirective, SharedDirectivesModule] }); })();
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(DropDownListModule, [{
        type: NgModule,
        args: [{
                declarations: [DROPDOWNLIST_DIRECTIVES],
                exports: [DROPDOWNLIST_DIRECTIVES, SharedDirectivesModule],
                imports: [SharedModule]
            }]
    }], null, null); })();
(function () { (typeof ngJitMode === "undefined" || ngJitMode) && ɵngcc0.ɵɵsetNgModuleScope(DropDownListModule, { declarations: [DropDownListComponent], imports: [SharedModule], exports: [DropDownListComponent, SharedDirectivesModule] }); })();
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(MultiSelectModule, [{
        type: NgModule,
        args: [{
                declarations: [MULTISELECT_DIRECTIVES],
                exports: [MULTISELECT_DIRECTIVES, SharedDirectivesModule],
                imports: [SharedModule],
                providers: [{ provide: TOUCH_ENABLED, useValue: ɵ0$5 }]
            }]
    }], null, null); })();
(function () { (typeof ngJitMode === "undefined" || ngJitMode) && ɵngcc0.ɵɵsetNgModuleScope(MultiSelectModule, { declarations: [MultiSelectComponent, SummaryTagDirective, CustomItemTemplateDirective], imports: [SharedModule], exports: [MultiSelectComponent, SummaryTagDirective, CustomItemTemplateDirective, SharedDirectivesModule] }); })();
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(DropDownsModule, [{
        type: NgModule,
        args: [{
                exports: [AutoCompleteModule, ComboBoxModule, DropDownListModule, MultiSelectModule, DropDownTreesModule]
            }]
    }], null, null); })();
(function () { (typeof ngJitMode === "undefined" || ngJitMode) && ɵngcc0.ɵɵsetNgModuleScope(DropDownsModule, { exports: [AutoCompleteModule, ComboBoxModule, DropDownListModule, MultiSelectModule, DropDownTreesModule] }); })();

/**
 * Generated bundle index. Do not edit.
 */

export { AUTOCOMPLETE_VALUE_ACCESSOR, COMBOBOX_VALUE_ACCESSOR, TOUCH_ENABLED, DataService, DisabledItemsService, FilterInputDirective, FilterableComponent, ListItemDirective, CustomMessagesComponent, LocalizedMessagesDirective, Messages, NavigationService, SearchBarComponent, SelectionService, TagListComponent, NoDataTemplateDirective, TagTemplateDirective, DROPDOWNLIST_VALUE_ACCESSOR, BaseCheckDirective, CheckAllDirective, CheckDirective, MultiSelectTreeSummaryTagDirective, AutoCompleteComponent, ComboBoxComponent, DropDownListComponent, MultiSelectComponent, MultiColumnComboBoxComponent, ComboBoxColumnComponent, ColumnCellTemplateDirective, ColumnHeaderTemplateDirective, DropDownTreeComponent, MultiSelectTreeComponent, DropDownTreeFlatBindingDirective, DropDownTreeHierarchyBindingDirective, MultiSelectTreeFlatBindingDirective, MultiSelectTreeHierarchyBindingDirective, DropDownTreesExpandDirective, DropDownTreesModule, NodeTemplateDirective, ItemTemplateDirective, GroupTemplateDirective, FixedGroupTemplateDirective, CustomItemTemplateDirective, HeaderTemplateDirective, FooterTemplateDirective, ValueTemplateDirective, TemplateContextDirective, GroupTagTemplateDirective, SelectableDirective, SummaryTagDirective, FilterDirective, DropDownsModule, MultiSelectModule, SharedModule, AutoCompleteModule, ComboBoxModule, DropDownListModule, SharedDirectivesModule, ListComponent, PreventableEvent, RemoveTagEvent };

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7Ozs7Ozs7aUZBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlDQWdDRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O3lSQUFFO0FBQ0Ysb0NBSUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztzYkFBRTtBQUNGLHNDQUlHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7c2JBQUU7QUFDRixzQ0FJRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O2tWQUFFO0FBQ0YscUNBSUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztxWEFBRTtBQUNGLDBDQUlHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7MEpBR3FCO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzsySUFHZ0I7QUFDaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7c0tBQUU7QUFDRixtQ0FFRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7NkpBQUU7QUFDRixnQ0FFRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7c2JBQUU7QUFDRixzQ0FJRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OzZKQUFFO0FBQ0YsZ0NBSUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O2dPQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBNEhHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozt1TUFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4REFrSEc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs2UEFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNEQWdJRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs0TUFBRTtBQUNGLHFDQUlHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozt5VkFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4REFnS0c7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs4S0FBRTtBQUNGLDBDQUlHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7c01BQUU7QUFDRixtQ0FJRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7ME5BQUU7QUFDRix3Q0FJRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OFBBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNERBeUpHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O3NMQUFFO0FBQ0YsMENBSUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs0TEFBRTtBQUNGLDRDQUlHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7d1NBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVEQU00QjtBQUM1QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7NlJBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0RUFvUEc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzsyTUFBRTtBQUNGLG9DQUlHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OzZWQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhEQTJLRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztzV0FBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9FQTJNRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O21VQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtDQUlHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztpVEFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvREFJRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzsrVUFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrREFJRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7NlRBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdURBSUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OFRBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJDQUlHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7OzswSUFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQTRERztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OzhQQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7O2tEQUFFO0FBQ0Ysd0VBa0JHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7eUpBQUU7QUFDRixrRUFXRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O2dQQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4QkFJRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzttT0FBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUNBSUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O3dFQU0yQjtBQUMzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7OzJIQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtDQUlHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O3FNQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVDQUlHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O21LQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OzhXQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFJRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztvU0FBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdDQUlHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OytRQU9pQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzt5U0FBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaURBSUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozt3SUFPd0I7QUFDeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O21RQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQ0FJRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O3VIQU91QjtBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OzRLQVFtQjtBQUNuQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozt1SEFPdUI7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OzsrS0FRc0I7QUFDdEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7a09BS29CO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZXNDb250ZW50IjpbIi8qKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4qIENvcHlyaWdodCDCqSAyMDIxIFByb2dyZXNzIFNvZnR3YXJlIENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuKiBMaWNlbnNlZCB1bmRlciBjb21tZXJjaWFsIGxpY2Vuc2UuIFNlZSBMSUNFTlNFLm1kIGluIHRoZSBwcm9qZWN0IHJvb3QgZm9yIG1vcmUgaW5mb3JtYXRpb25cbiotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cbmltcG9ydCB7IF9fZGVjb3JhdGUsIF9fbWV0YWRhdGEsIF9fcGFyYW0gfSBmcm9tICd0c2xpYic7XG5pbXBvcnQgeyBFdmVudEVtaXR0ZXIsIElucHV0LCBPdXRwdXQsIFZpZXdDaGlsZCwgRWxlbWVudFJlZiwgSG9zdEJpbmRpbmcsIENvbXBvbmVudCwgUmVuZGVyZXIyLCBEaXJlY3RpdmUsIFRlbXBsYXRlUmVmLCBJbmplY3RhYmxlLCBWaWV3Q2hpbGRyZW4sIFF1ZXJ5TGlzdCwgQ2hhbmdlRGV0ZWN0b3JSZWYsIE5nWm9uZSwgSW5qZWN0aW9uVG9rZW4sIGZvcndhcmRSZWYsIGlzRGV2TW9kZSwgQ29udGVudENoaWxkLCBWaWV3Q29udGFpbmVyUmVmLCBPcHRpb25hbCwgSW5qZWN0LCBIb3N0TGlzdGVuZXIsIEtleVZhbHVlRGlmZmVycywgQ29udGVudENoaWxkcmVuLCBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneSwgTmdNb2R1bGUgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IGlzRG9jdW1lbnRBdmFpbGFibGUsIEtleXMsIGlzQ2hhbmdlZCwgaGFzT2JzZXJ2ZXJzLCBLZW5kb0lucHV0LCBhbnlDaGFuZ2VkLCBndWlkLCBSZXNpemVTZW5zb3JNb2R1bGUsIEV2ZW50c01vZHVsZSB9IGZyb20gJ0Bwcm9ncmVzcy9rZW5kby1hbmd1bGFyLWNvbW1vbic7XG5pbXBvcnQgeyBOR19WQUxVRV9BQ0NFU1NPUiwgRm9ybXNNb2R1bGUgfSBmcm9tICdAYW5ndWxhci9mb3Jtcyc7XG5pbXBvcnQgeyB2YWxpZGF0ZVBhY2thZ2UgfSBmcm9tICdAcHJvZ3Jlc3Mva2VuZG8tbGljZW5zaW5nJztcbmltcG9ydCB7IGdldHRlciwgcG9pbnRlcnMsIHRvdWNoRW5hYmxlZCB9IGZyb20gJ0Bwcm9ncmVzcy9rZW5kby1jb21tb24nO1xuaW1wb3J0IHsgTG9jYWxpemF0aW9uU2VydmljZSwgTDEwTl9QUkVGSVgsIENvbXBvbmVudE1lc3NhZ2VzIH0gZnJvbSAnQHByb2dyZXNzL2tlbmRvLWFuZ3VsYXItbDEwbic7XG5pbXBvcnQgeyBtZXJnZSwgZnJvbUV2ZW50LCBTdWJqZWN0LCBTdWJzY3JpcHRpb24sIG9mLCBpbnRlcnZhbCB9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHsgUG9wdXBTZXJ2aWNlLCBQb3B1cE1vZHVsZSB9IGZyb20gJ0Bwcm9ncmVzcy9rZW5kby1hbmd1bGFyLXBvcHVwJztcbmV4cG9ydCB7IFBvcHVwQ29tcG9uZW50IH0gZnJvbSAnQHByb2dyZXNzL2tlbmRvLWFuZ3VsYXItcG9wdXAnO1xuaW1wb3J0IHsgbWFwLCBzd2l0Y2hNYXAsIHRha2UsIGF1ZGl0VGltZSwgdGFwLCBmaWx0ZXIsIHBhcnRpdGlvbiwgdGhyb3R0bGVUaW1lLCBjYXRjaEVycm9yLCBza2lwV2hpbGUsIGNvbmNhdE1hcCwgdGFrZVVudGlsIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xuaW1wb3J0IHsgVHJlZVZpZXdDb21wb25lbnQsIERhdGFCb3VuZENvbXBvbmVudCwgRXhwYW5kYWJsZUNvbXBvbmVudCwgRmxhdERhdGFCaW5kaW5nRGlyZWN0aXZlLCBIaWVyYXJjaHlCaW5kaW5nRGlyZWN0aXZlLCBFeHBhbmREaXJlY3RpdmUsIFRyZWVWaWV3TW9kdWxlIH0gZnJvbSAnQHByb2dyZXNzL2tlbmRvLWFuZ3VsYXItdHJlZXZpZXcnO1xuaW1wb3J0IHsgQ29tbW9uTW9kdWxlIH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uJztcblxuLyoqXG4gKiBAaGlkZGVuXG4gKi9cbmNvbnN0IHBhY2thZ2VNZXRhZGF0YSA9IHtcbiAgICBuYW1lOiAnQHByb2dyZXNzL2tlbmRvLWFuZ3VsYXItZHJvcGRvd25zJyxcbiAgICBwcm9kdWN0TmFtZTogJ0tlbmRvIFVJIGZvciBBbmd1bGFyJyxcbiAgICBwcm9kdWN0Q29kZXM6IFsnS0VORE9VSUFOR1VMQVInLCAnS0VORE9VSUNPTVBMRVRFJ10sXG4gICAgcHVibGlzaERhdGU6IDE2NDY2NDA2MzgsXG4gICAgdmVyc2lvbjogJycsXG4gICAgbGljZW5zaW5nRG9jc1VybDogJ2h0dHBzOi8vd3d3LnRlbGVyaWsuY29tL2tlbmRvLWFuZ3VsYXItdWkvbXktbGljZW5zZS8/dXRtX21lZGl1bT1wcm9kdWN0JnV0bV9zb3VyY2U9a2VuZG9hbmd1bGFyJnV0bV9jYW1wYWlnbj1rZW5kby11aS1hbmd1bGFyLXB1cmNoYXNlLWxpY2Vuc2Uta2V5cy13YXJuaW5nJ1xufTtcblxuLyogdHNsaW50OmRpc2FibGU6bm8tYml0d2lzZSAqL1xuLyoqXG4gKiBAaGlkZGVuXG4gKi9cbmNvbnN0IGlzUHJlc2VudCA9ICh2YWx1ZSkgPT4gdmFsdWUgIT09IG51bGwgJiYgdmFsdWUgIT09IHVuZGVmaW5lZDtcbi8qKlxuICogQGhpZGRlblxuICovXG5jb25zdCBpc051bWJlciA9ICh2YWx1ZSkgPT4gIWlzTmFOKHZhbHVlKTtcbi8qKlxuICogQGhpZGRlblxuICovXG5jb25zdCBndWlkJDEgPSAoKSA9PiB7XG4gICAgbGV0IGlkID0gXCJcIjtcbiAgICBsZXQgaTtcbiAgICBsZXQgcmFuZG9tO1xuICAgIGZvciAoaSA9IDA7IGkgPCAzMjsgaSsrKSB7XG4gICAgICAgIHJhbmRvbSA9IE1hdGgucmFuZG9tKCkgKiAxNiB8IDA7XG4gICAgICAgIGlmIChpID09PSA4IHx8IGkgPT09IDEyIHx8IGkgPT09IDE2IHx8IGkgPT09IDIwKSB7XG4gICAgICAgICAgICBpZCArPSBcIi1cIjtcbiAgICAgICAgfVxuICAgICAgICBpZCArPSAoaSA9PT0gMTIgPyA0IDogKGkgPT09IDE2ID8gKHJhbmRvbSAmIDMgfCA4KSA6IHJhbmRvbSkpLnRvU3RyaW5nKDE2KTtcbiAgICB9XG4gICAgcmV0dXJuIGlkO1xufTtcbi8qKlxuICogQGhpZGRlblxuICovXG5jb25zdCBjb21iaW5lU3RyID0gKGJlZ2luLCBlbmQpID0+IHtcbiAgICByZXR1cm4gYmVnaW4uY29uY2F0KGVuZC5zdWJzdHIoZW5kLnRvTG93ZXJDYXNlKCkuaW5kZXhPZihiZWdpbi50b0xvd2VyQ2FzZSgpKSArIGJlZ2luLmxlbmd0aCkpO1xufTtcbi8qKlxuICogQGhpZGRlblxuICovXG5jb25zdCBpc0FycmF5ID0gKHZhbHVlKSA9PiBBcnJheS5pc0FycmF5KHZhbHVlKTtcbi8qKlxuICogQGhpZGRlblxuICovXG5jb25zdCBpc09iamVjdCA9ICh2YWx1ZSkgPT4gaXNQcmVzZW50KHZhbHVlKSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnO1xuLyoqXG4gKiBAaGlkZGVuXG4gKi9cbmNvbnN0IGlzRW1wdHlTdHJpbmcgPSAodmFsdWUpID0+IHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycgJiYgdmFsdWUubGVuZ3RoID09PSAwO1xuLyoqXG4gKiBAaGlkZGVuXG4gKi9cbmNvbnN0IHJlc29sdmVWYWx1ZXNJbkFycmF5ID0gKHZhbHVlcywgZGF0YSA9IFtdLCB2YWx1ZUZpZWxkKSA9PiB2YWx1ZXNcbiAgICAubWFwKHZhbHVlID0+IHtcbiAgICByZXR1cm4gZGF0YS5maW5kKGl0ZW0gPT4gZ2V0dGVyJDEoaXRlbSwgdmFsdWVGaWVsZCkgPT09IHZhbHVlKTtcbn0pXG4gICAgLmZpbHRlcih2YWx1ZSA9PiB2YWx1ZSAhPT0gdW5kZWZpbmVkKTtcbi8qKlxuICogQGhpZGRlblxuICovXG5jb25zdCB2YWxpZGF0ZUNvbXBsZXhWYWx1ZXMgPSAodmFsdWVzLCB2YWx1ZUZpZWxkKSA9PiBpc0FycmF5KHZhbHVlcykgJiYgdmFsdWVzLmZpbHRlcihpdGVtID0+IHtcbiAgICByZXR1cm4gaXNPYmplY3QoaXRlbSkgJiYgaXNQcmVzZW50KGdldHRlciQxKGl0ZW0sIHZhbHVlRmllbGQpKTtcbn0pO1xuLyoqXG4gKiBAaGlkZGVuXG4gKi9cbmNvbnN0IHJlc29sdmVBbGxWYWx1ZXMgPSAodmFsdWUsIGRhdGEsIHZhbHVlRmllbGQpID0+IHtcbiAgICBjb25zdCBjdXN0b21WYWx1ZXMgPSB2YWxpZGF0ZUNvbXBsZXhWYWx1ZXModmFsdWUsIHZhbHVlRmllbGQpIHx8IFtdO1xuICAgIGNvbnN0IHJlc29sdmVkVmFsdWVzID0gcmVzb2x2ZVZhbHVlc0luQXJyYXkodmFsdWUsIGRhdGEsIHZhbHVlRmllbGQpIHx8IFtdO1xuICAgIHJldHVybiByZXNvbHZlZFZhbHVlcy5jb25jYXQoY3VzdG9tVmFsdWVzKTtcbn07XG4vKipcbiAqIEBoaWRkZW5cbiAqL1xuY29uc3QgaXNPYmplY3RBcnJheSA9ICh2YWx1ZXMpID0+IHtcbiAgICByZXR1cm4gaXNBcnJheSh2YWx1ZXMpICYmIHZhbHVlcy5ldmVyeShpdGVtID0+IGlzT2JqZWN0KGl0ZW0pKTtcbn07XG4vKipcbiAqIEBoaWRkZW5cbiAqL1xuY29uc3Qgc2VsZWN0ZWRJbmRpY2VzID0gKHZhbHVlcywgZGF0YSwgdmFsdWVGaWVsZCkgPT4ge1xuICAgIGNvbnN0IGV4dHJhY3RlZFZhbHVlcyA9IGRhdGEubWFwKGl0ZW0gPT4ge1xuICAgICAgICByZXR1cm4gaXNQcmVzZW50KGl0ZW0pICYmIGlzUHJlc2VudChnZXR0ZXIkMShpdGVtLCB2YWx1ZUZpZWxkKSkgPyBnZXR0ZXIkMShpdGVtLCB2YWx1ZUZpZWxkKSA6IGl0ZW07XG4gICAgfSk7XG4gICAgcmV0dXJuIHZhbHVlcy5yZWR1Y2UoKGFyciwgaXRlbSkgPT4ge1xuICAgICAgICBjb25zdCB2YWx1ZSA9IGlzUHJlc2VudChpdGVtKSAmJiBpc1ByZXNlbnQoZ2V0dGVyJDEoaXRlbSwgdmFsdWVGaWVsZCkpID8gZ2V0dGVyJDEoaXRlbSwgdmFsdWVGaWVsZCkgOiBpdGVtO1xuICAgICAgICBjb25zdCBpbmRleCA9IGV4dHJhY3RlZFZhbHVlcy5pbmRleE9mKHZhbHVlKTtcbiAgICAgICAgaWYgKGluZGV4ICE9PSAtMSkge1xuICAgICAgICAgICAgYXJyLnB1c2goaW5kZXgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhcnI7XG4gICAgfSwgW10pO1xufTtcbi8qKlxuICogQGhpZGRlblxuICovXG5jb25zdCBnZXR0ZXIkMSA9IChkYXRhSXRlbSwgZmllbGQpID0+IHtcbiAgICBpZiAoIWlzUHJlc2VudChkYXRhSXRlbSkpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIGlmICghaXNQcmVzZW50KGZpZWxkKSB8fCAhaXNPYmplY3QoZGF0YUl0ZW0pKSB7XG4gICAgICAgIHJldHVybiBkYXRhSXRlbTtcbiAgICB9XG4gICAgLy8gY3JlYXRlcyBhIGZpZWxkIGFjY2Vzc29yIHN1cHBvcnRpbmcgbmVzdGVkIGZpZWxkcyBwcm9jZXNzaW5nXG4gICAgY29uc3QgdmFsdWVGcm9tID0gZ2V0dGVyKGZpZWxkKTtcbiAgICByZXR1cm4gdmFsdWVGcm9tKGRhdGFJdGVtKTtcbn07XG4vKipcbiAqIEBoaWRkZW5cbiAqL1xuY29uc3Qgc2FtZUNoYXJzT25seSA9ICh3b3JkLCBjaGFyYWN0ZXIpID0+IHtcbiAgICBmb3IgKGxldCBpZHggPSAwOyBpZHggPCB3b3JkLmxlbmd0aDsgaWR4KyspIHtcbiAgICAgICAgaWYgKHdvcmQuY2hhckF0KGlkeCkgIT09IGNoYXJhY3Rlcikge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0cnVlO1xufTtcbi8qKlxuICogQGhpZGRlblxuICovXG5jb25zdCBzaHVmZmxlRGF0YSA9IChkYXRhLCBzcGxpdEluZGV4LCBkZWZhdWx0SXRlbSkgPT4ge1xuICAgIGxldCByZXN1bHQgPSBkYXRhO1xuICAgIGlmIChkZWZhdWx0SXRlbSkge1xuICAgICAgICByZXN1bHQgPSBbZGVmYXVsdEl0ZW1dLmNvbmNhdChyZXN1bHQpO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0LnNsaWNlKHNwbGl0SW5kZXgpLmNvbmNhdChyZXN1bHQuc2xpY2UoMCwgc3BsaXRJbmRleCkpO1xufTtcbi8qKlxuICogQGhpZGRlblxuICovXG5jb25zdCBtYXRjaFRleHQgPSAodGV4dCwgd29yZCwgaWdub3JlQ2FzZSkgPT4ge1xuICAgIGlmICghaXNQcmVzZW50KHRleHQpKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgbGV0IHRlbXAgPSBTdHJpbmcodGV4dCk7XG4gICAgaWYgKGlnbm9yZUNhc2UpIHtcbiAgICAgICAgdGVtcCA9IHRlbXAudG9Mb3dlckNhc2UoKTtcbiAgICB9XG4gICAgcmV0dXJuIHRlbXAuaW5kZXhPZih3b3JkKSA9PT0gMDtcbn07XG4vKipcbiAqIEBoaWRkZW5cbiAqXG4gKiBDaGVja3Mgd2hldGhlciB0aGUgcGFzc2VkIG9iamVjdCBoYXMgYWxsIG9mIHRoZSBsaXN0ZWQgcHJvcGVydGllcy5cbiAqL1xuY29uc3QgaGFzUHJvcHMgPSAob2JqLCBwcm9wcykgPT4ge1xuICAgIGlmICghaXNQcmVzZW50KG9iaikpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICByZXR1cm4gcHJvcHMuZXZlcnkocHJvcCA9PiBvYmouaGFzT3duUHJvcGVydHkocHJvcCkpO1xufTtcbi8qKlxuICogQGhpZGRlblxuICpcbiAqIENoZWNrcyB3aGV0aGVyIGFuIGVsZW1lbnQgaXMgdW50b3VjaGVkIGJ5IGxvb2tpbmcgZm9yIHRoZSBuZy11bnRvdWNoZWQgY3NzIGNsYXNzXG4gKi9cbmNvbnN0IGlzVW50b3VjaGVkID0gKGVsZW1lbnQpID0+IGVsZW1lbnQuY2xhc3NOYW1lLmluY2x1ZGVzKCduZy11bnRvdWNoZWQnKTtcbi8qKlxuICogQGhpZGRlblxuICovXG5jb25zdCBub29wID0gKF8pID0+IHsgfTtcbi8qKlxuICogSUUgZWxlbWVudCBgbWF0Y2hlc2AgcG9seWZpbGwuXG4gKiBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvRWxlbWVudC9tYXRjaGVzXG4gKi9cbmNvbnN0IG1hdGNoZXMgPSAoZWxlbWVudCwgc2VsZWN0b3IpID0+IHtcbiAgICBjb25zdCBtYXRjaGVyID0gZWxlbWVudC5tYXRjaGVzIHx8IGVsZW1lbnQubXNNYXRjaGVzU2VsZWN0b3IgfHwgZWxlbWVudC53ZWJraXRNYXRjaGVzU2VsZWN0b3I7XG4gICAgaWYgKCFtYXRjaGVyKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgcmV0dXJuIG1hdGNoZXIuY2FsbChlbGVtZW50LCBzZWxlY3Rvcik7XG59O1xuLyoqXG4gKiBAaGlkZGVuXG4gKlxuICogSUUgZWxlbWVudCBgY2xvc2VzdGAgcG9seWZpbGwuXG4gKiBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvRWxlbWVudC9jbG9zZXN0XG4gKi9cbmNvbnN0IGNsb3Nlc3QgPSAoZWxlbWVudCwgc2VsZWN0b3IpID0+IHtcbiAgICBsZXQgcGFyZW50ID0gZWxlbWVudDtcbiAgICB3aGlsZSAocGFyZW50ICE9PSBudWxsICYmIHBhcmVudC5ub2RlVHlwZSA9PT0gMSkge1xuICAgICAgICBpZiAobWF0Y2hlcyhwYXJlbnQsIHNlbGVjdG9yKSkge1xuICAgICAgICAgICAgcmV0dXJuIHBhcmVudDtcbiAgICAgICAgfVxuICAgICAgICBwYXJlbnQgPSBwYXJlbnQucGFyZW50RWxlbWVudCB8fCBwYXJlbnQucGFyZW50Tm9kZTtcbiAgICB9XG4gICAgcmV0dXJuIG51bGw7XG59O1xuLyoqXG4gKiBAaGlkZGVuXG4gKlxuICogUGFyc2VzIGEgcHJvdmlkZWQgdmFsdWUgdG8gaXRzIHR5cGUgJ251bWJlcicgcmVwcmVzZW50YXRpb24uXG4gKiBJZiB0aGUgcGFyc2VkIHZhbHVlICh2aWEgTnVtYmVyKHZhbHVlKSkgaXMgTmFOLCB0aGUgcHJvdmlkZWQgZGVmYXVsdCB2YWx1ZSBpcyByZXR1cm5lZC5cbiAqIFVzZXMgMCBhcyBkZWZhdWx0IHZhbHVlIGlmIGEgc2Vjb25kIHBhcmFtIGlzIG5vdCBwcm92aWRlZC5cbiAqL1xuY29uc3QgcGFyc2VOdW1iZXIgPSAobnVtLCBkZWZhdWx0VmFsdWUgPSAwKSA9PiB7XG4gICAgY29uc3Qgbm9ybWFsaXplZFZhbHVlID0gTnVtYmVyKG51bSk7XG4gICAgcmV0dXJuIGlzTmFOKG5vcm1hbGl6ZWRWYWx1ZSkgPyBkZWZhdWx0VmFsdWUgOiBub3JtYWxpemVkVmFsdWU7XG59O1xuLyoqXG4gKiBAaGlkZGVuXG4gKlxuICogQ2hlY2tzIHdoZXRoZXIgdGhlIHBhc3NlZCB0YXJnZXQgZWxlbWVudCBpcyBpbnNpZGUgdGhlIHByb3ZpZGVkIGhvc3Qgb3IgcG9wdXBSZWYuXG4gKi9cbmNvbnN0IGluRHJvcERvd24gPSAoaG9zdCwgdGFyZ2V0LCBwb3B1cFJlZikgPT4ge1xuICAgIHJldHVybiBob3N0Lm5hdGl2ZUVsZW1lbnQuY29udGFpbnModGFyZ2V0KSB8fCAocG9wdXBSZWYgJiYgcG9wdXBSZWYucG9wdXBFbGVtZW50LmNvbnRhaW5zKHRhcmdldCkpO1xufTtcbi8qKlxuICogQGhpZGRlblxuICpcbiAqIENhbGN1bGF0ZXMgdGhlIGhpZXJhcmNoaWNhbCBsZXZlbCBvZiBhbiBpdGVtLCBiYXNlZCBvbiB0aGUgcHJvdmlkZWQgaW5kZXguXG4gKiBUaGUgcmVzdWx0IGxldmVsIGlzIHplcm8tYmFzZWQgKHN0YXJ0cyBmcm9tIDApLlxuICovXG5jb25zdCBnZXRIaWVyYXJjaGljYWxJdGVtTGV2ZWwgPSAoaW5kZXgpID0+IHtcbiAgICByZXR1cm4gKGluZGV4IHx8ICcnKS5zcGxpdCgnXycpLmxlbmd0aCAtIDE7XG59O1xuLyoqXG4gKiBAaGlkZGVuXG4gKlxuICogUmV0cmlldmVzIGFsbCBkZXNjZW5kYW50IG5vZGVzJyBsb29rdXBzIHdoaWNoIGFyZSBjdXJyZW50bHkgcmVnaXN0ZXJlZCBpbiB0aGUgcHJvdmlkZWQgbG9va3VwIGl0ZW0gYXMgYSBmbGF0IGFycmF5LlxuICovXG5jb25zdCBmZXRjaERlc2NlbmRlbnROb2RlcyA9IChsb29rdXAsIGZpbHRlckV4cHJlc3Npb24pID0+IHtcbiAgICBpZiAoIWlzUHJlc2VudChsb29rdXApIHx8IGxvb2t1cC5jaGlsZHJlbi5sZW5ndGggPT09IDApIHtcbiAgICAgICAgcmV0dXJuIFtdO1xuICAgIH1cbiAgICBsZXQgZGVzY2VuZGFudHMgPSBsb29rdXAuY2hpbGRyZW47XG4gICAgaWYgKGlzUHJlc2VudChmaWx0ZXJFeHByZXNzaW9uKSkge1xuICAgICAgICBkZXNjZW5kYW50cyA9IGRlc2NlbmRhbnRzLmZpbHRlcihkZXNjZW5kZW50ID0+IGZpbHRlckV4cHJlc3Npb24oZGVzY2VuZGVudC5pdGVtKSk7XG4gICAgfVxuICAgIGRlc2NlbmRhbnRzLmZvckVhY2goY2hpbGQgPT4gZGVzY2VuZGFudHMgPSBkZXNjZW5kYW50cy5jb25jYXQoZmV0Y2hEZXNjZW5kZW50Tm9kZXMoY2hpbGQsIGZpbHRlckV4cHJlc3Npb24pKSk7XG4gICAgcmV0dXJuIGRlc2NlbmRhbnRzO1xufTtcbi8qKlxuICogQGhpZGRlblxuICpcbiAqIFJldHJpZXZlcyB0aGUgY29ycmVjdCB2YWx1ZSBiYXNlZCBvbiB0aGUgaXRlbSdzIGxldmVsIGFuZCB0aGUgcHJvdmlkZWQgdmFsdWUgZmllbGQvcy5cbiAqIFVzZWQgaW4gdGhlIE11bHRpU2VsZWN0VHJlZSBjb21wb25lbnQuXG4gKi9cbmNvbnN0IHZhbHVlRnJvbSA9ICh7IGRhdGFJdGVtLCBpbmRleCwgbGV2ZWwgfSwgdmFsdWVGaWVsZCkgPT4ge1xuICAgIGNvbnN0IGZpZWxkcyA9IEFycmF5LmlzQXJyYXkodmFsdWVGaWVsZCkgPyB2YWx1ZUZpZWxkIDogW3ZhbHVlRmllbGRdO1xuICAgIC8vIGVpdGhlciB1c2UgdGhlIGV4cGxpY2l0bHkgcHJvdmlkZWQgdmFsdWUgbGV2ZWwsIG9yIGluZmVyIGl0IGZyb20gdGhlIGl0ZW0gaW5kZXhcbiAgICBjb25zdCB2YWx1ZUxldmVsID0gaXNQcmVzZW50KGxldmVsKSA/IGxldmVsIDogZ2V0SGllcmFyY2hpY2FsSXRlbUxldmVsKGluZGV4KTtcbiAgICAvLyBmYWxsLWJhY2sgdG8gdGhlIGxhc3QgYXZhaWxhYmxlIG9uZSwgaWYgdGhlIGN1cnJlbnQgbm9kZSBpcyBpbiBhIGRlZXBlciBsZXZlbFxuICAgIGNvbnN0IG5vcm1hbGl6ZWRMZXZlbCA9IE1hdGgubWluKHZhbHVlTGV2ZWwsIGZpZWxkcy5sZW5ndGggLSAxKTtcbiAgICBjb25zdCBmaWVsZCA9IGZpZWxkc1tub3JtYWxpemVkTGV2ZWxdO1xuICAgIHJldHVybiBnZXR0ZXIoZmllbGQpKGRhdGFJdGVtKTtcbn07XG4vKipcbiAqIEBoaWRkZW5cbiAqIFJldHVybnMgdGhlIHNpemUgY2xhc3MgYmFzZWQgb24gdGhlIGNvbXBvbmVudCBhbmQgc2l6ZSBpbnB1dC5cbiAqL1xuY29uc3QgZ2V0U2l6ZUNsYXNzID0gKGNvbXBvbmVudCwgc2l6ZSkgPT4ge1xuICAgIGNvbnN0IFNJWkVfQ0xBU1NFUyA9IHtcbiAgICAgICAgJ3NtYWxsJzogYGstJHtjb21wb25lbnR9LXNtYCxcbiAgICAgICAgJ21lZGl1bSc6IGBrLSR7Y29tcG9uZW50fS1tZGAsXG4gICAgICAgICdsYXJnZSc6IGBrLSR7Y29tcG9uZW50fS1sZ2BcbiAgICB9O1xuICAgIHJldHVybiBTSVpFX0NMQVNTRVNbc2l6ZV07XG59O1xuLyoqXG4gKiBAaGlkZGVuXG4gKiBSZXR1cm5zIHRoZSByb3VuZGVkIGNsYXNzIGJhc2VkIG9uIHRoZSByb3VuZGVkIGlucHV0LlxuICovXG5jb25zdCBnZXRSb3VuZGVkQ2xhc3MgPSAocm91bmRlZCkgPT4ge1xuICAgIGNvbnN0IFJPVU5ERURfQ0xBU1NFUyA9IHtcbiAgICAgICAgJ3NtYWxsJzogJ2stcm91bmRlZC1zbScsXG4gICAgICAgICdtZWRpdW0nOiAnay1yb3VuZGVkLW1kJyxcbiAgICAgICAgJ2xhcmdlJzogJ2stcm91bmRlZC1sZycsXG4gICAgICAgICdmdWxsJzogJ2stcm91bmRlZC1mdWxsJ1xuICAgIH07XG4gICAgcmV0dXJuIFJPVU5ERURfQ0xBU1NFU1tyb3VuZGVkXTtcbn07XG4vKipcbiAqIEBoaWRkZW5cbiAqIFJldHVybiB0aGUgZmlsbE1vZGUgY2xhc3MgYmFzZWQgb24gdGhlIGNvbXBvbmVudCBhbmQgZmlsbE1vZGUgaW5wdXQuXG4gKi9cbmNvbnN0IGdldEZpbGxNb2RlQ2xhc3MgPSAoY29tcG9uZW50LCBmaWxsTW9kZSkgPT4ge1xuICAgIGNvbnN0IEZJTExNT0RFX0NMQVNTRVMgPSB7XG4gICAgICAgICdzb2xpZCc6IGBrLSR7Y29tcG9uZW50fS1zb2xpZGAsXG4gICAgICAgICdmbGF0JzogYGstJHtjb21wb25lbnR9LWZsYXRgLFxuICAgICAgICAnb3V0bGluZSc6IGBrLSR7Y29tcG9uZW50fS1vdXRsaW5lYFxuICAgIH07XG4gICAgcmV0dXJuIEZJTExNT0RFX0NMQVNTRVNbZmlsbE1vZGVdO1xufTtcblxuLyogdHNsaW50OmRpc2FibGU6bWVtYmVyLW9yZGVyaW5nICovXG4vKipcbiAqIEBoaWRkZW5cbiAqL1xubGV0IFNlYXJjaEJhckNvbXBvbmVudCA9IGNsYXNzIFNlYXJjaEJhckNvbXBvbmVudCB7XG4gICAgY29uc3RydWN0b3IobG9jYWxpemF0aW9uLCByZW5kZXJlcikge1xuICAgICAgICB0aGlzLmxvY2FsaXphdGlvbiA9IGxvY2FsaXphdGlvbjtcbiAgICAgICAgdGhpcy52YWx1ZUNoYW5nZSA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcbiAgICAgICAgdGhpcy5vbkJsdXIgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gICAgICAgIHRoaXMub25Gb2N1cyA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcbiAgICAgICAgdGhpcy5vbkNsaWNrID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICAgICAgICB0aGlzLm9uTmF2aWdhdGUgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gICAgICAgIHRoaXMuc2VhcmNoQmFyQ2xhc3MgPSB0cnVlO1xuICAgICAgICB0aGlzLl91c2VySW5wdXQgPSBcIlwiO1xuICAgICAgICB0aGlzLl9wcmV2aW91c1ZhbHVlID0gXCJcIjtcbiAgICAgICAgdGhpcy5fcGxhY2Vob2xkZXIgPSBcIlwiO1xuICAgICAgICB0aGlzLmRpcmVjdGlvbiA9IGxvY2FsaXphdGlvbi5ydGwgPyAncnRsJyA6ICdsdHInO1xuICAgICAgICB0aGlzLnJlbmRlcmVyID0gcmVuZGVyZXI7XG4gICAgfVxuICAgIGdldCB1c2VySW5wdXQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl91c2VySW5wdXQ7XG4gICAgfVxuICAgIHNldCB1c2VySW5wdXQodXNlcklucHV0KSB7XG4gICAgICAgIHRoaXMuX3VzZXJJbnB1dCA9IHVzZXJJbnB1dCB8fCBcIlwiO1xuICAgIH1cbiAgICBnZXQgdmFsdWUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmlucHV0Lm5hdGl2ZUVsZW1lbnQudmFsdWU7XG4gICAgfVxuICAgIHNldCBwbGFjZWhvbGRlcih0ZXh0KSB7XG4gICAgICAgIHRoaXMuX3BsYWNlaG9sZGVyID0gdGV4dCB8fCAnJztcbiAgICAgICAgdGhpcy5zZXRJbnB1dFNpemUoKTtcbiAgICB9XG4gICAgZ2V0IHBsYWNlaG9sZGVyKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fcGxhY2Vob2xkZXI7XG4gICAgfVxuICAgIGdldCBhcmlhRXhwYW5kZWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnJvbGUgPT09ICdjb21ib2JveCcgPyB0aGlzLnBvcHVwT3BlbiA6IG51bGw7XG4gICAgfVxuICAgIG5nT25Jbml0KCkge1xuICAgICAgICB0aGlzLmxvY2FsaXphdGlvbkNoYW5nZVN1YnNjcmlwdGlvbiA9IHRoaXMubG9jYWxpemF0aW9uXG4gICAgICAgICAgICAuY2hhbmdlcy5zdWJzY3JpYmUoKHsgcnRsIH0pID0+IHRoaXMuZGlyZWN0aW9uID0gcnRsID8gJ3J0bCcgOiAnbHRyJyk7XG4gICAgfVxuICAgIG5nT25DaGFuZ2VzKGNoYW5nZXMpIHtcbiAgICAgICAgbGV0IHByZXZpb3VzVXNlcklucHV0O1xuICAgICAgICBpZiAodGhpcy5pbnB1dCAmJiAoY2hhbmdlcy51c2VySW5wdXQgfHwgY2hhbmdlcy5zdWdnZXN0ZWRUZXh0KSkge1xuICAgICAgICAgICAgaWYgKGNoYW5nZXMudXNlcklucHV0ICYmIGNoYW5nZXMudXNlcklucHV0LnByZXZpb3VzVmFsdWUpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fcHJldmlvdXNWYWx1ZSA9PT0gY2hhbmdlcy51c2VySW5wdXQucHJldmlvdXNWYWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICBwcmV2aW91c1VzZXJJbnB1dCA9IHRoaXMuX3ByZXZpb3VzVmFsdWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBwcmV2aW91c1VzZXJJbnB1dCA9IGNoYW5nZXMudXNlcklucHV0LmN1cnJlbnRWYWx1ZSB8fCBcIlwiO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHByZXZpb3VzVXNlcklucHV0ID0gdGhpcy5fcHJldmlvdXNWYWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IGNhcmV0SW5kZXggPSB0aGlzLmlucHV0Lm5hdGl2ZUVsZW1lbnQuc2VsZWN0aW9uU3RhcnQ7XG4gICAgICAgICAgICBjb25zdCBjYXJldEF0RW5kID0gcHJldmlvdXNVc2VySW5wdXQubGVuZ3RoID09PSBjYXJldEluZGV4O1xuICAgICAgICAgICAgdGhpcy53cml0ZUlucHV0VmFsdWUodGhpcy5zdWdnZXN0ZWRUZXh0ID8gY29tYmluZVN0cih0aGlzLnVzZXJJbnB1dCwgdGhpcy5zdWdnZXN0ZWRUZXh0KSA6IHRoaXMudXNlcklucHV0KTtcbiAgICAgICAgICAgIGlmICh0aGlzLnN1Z2dlc3RlZFRleHQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNldElucHV0U2VsZWN0aW9uKHRoaXMudXNlcklucHV0Lmxlbmd0aCwgdGhpcy5zdWdnZXN0ZWRUZXh0Lmxlbmd0aCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChjYXJldEF0RW5kKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRJbnB1dFNlbGVjdGlvbih0aGlzLnVzZXJJbnB1dC5sZW5ndGgsIHRoaXMudXNlcklucHV0Lmxlbmd0aCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNldElucHV0U2VsZWN0aW9uKGNhcmV0SW5kZXgsIGNhcmV0SW5kZXgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5fcHJldmlvdXNWYWx1ZSA9IHRoaXMudXNlcklucHV0O1xuICAgICAgICB9XG4gICAgfVxuICAgIG5nT25EZXN0cm95KCkge1xuICAgICAgICBpZiAodGhpcy5sb2NhbGl6YXRpb25DaGFuZ2VTdWJzY3JpcHRpb24pIHtcbiAgICAgICAgICAgIHRoaXMubG9jYWxpemF0aW9uQ2hhbmdlU3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgd3JpdGVJbnB1dFZhbHVlKHRleHQpIHtcbiAgICAgICAgaWYgKGlzRG9jdW1lbnRBdmFpbGFibGUoKSkge1xuICAgICAgICAgICAgdGhpcy5yZW5kZXJlci5zZXRQcm9wZXJ0eSh0aGlzLmlucHV0Lm5hdGl2ZUVsZW1lbnQsICd2YWx1ZScsIHRleHQpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHNldElucHV0U2VsZWN0aW9uKHN0YXJ0LCBlbmQpIHtcbiAgICAgICAgaWYgKGlzRG9jdW1lbnRBdmFpbGFibGUoKSAmJiB0aGlzLmlucHV0Lm5hdGl2ZUVsZW1lbnQgPT09IGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgdGhpcy5pbnB1dC5uYXRpdmVFbGVtZW50LnNldFNlbGVjdGlvblJhbmdlKHN0YXJ0LCBlbmQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAvL01ha2Ugc3VyZSB0aGF0IHRoZSBlbGVtZW50IGlzIGluIHRoZSBET00gYmVmb3JlIHlvdSBpbnZva2UgaXRzIG1ldGhvZHNcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBoYW5kbGVJbnB1dChldmVudCkge1xuICAgICAgICBjb25zdCB2YWx1ZSA9IGV2ZW50LnRhcmdldC52YWx1ZTtcbiAgICAgICAgaWYgKHZhbHVlICE9PSB0aGlzLnVzZXJJbnB1dCkge1xuICAgICAgICAgICAgdGhpcy5fcHJldmlvdXNWYWx1ZSA9IHZhbHVlO1xuICAgICAgICAgICAgdGhpcy52YWx1ZUNoYW5nZS5lbWl0KHZhbHVlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBoYW5kbGVGb2N1cyhldmVudCkge1xuICAgICAgICB0aGlzLm9uRm9jdXMuZW1pdChldmVudCk7XG4gICAgfVxuICAgIGhhbmRsZUJsdXIoZXZlbnQpIHtcbiAgICAgICAgdGhpcy5vbkJsdXIuZW1pdChldmVudCk7XG4gICAgfVxuICAgIGhhbmRsZUtleWRvd24oZXZlbnQpIHtcbiAgICAgICAgY29uc3Qga2V5Q29kZSA9IGV2ZW50LmtleUNvZGU7XG4gICAgICAgIGNvbnN0IGtleXMgPSBbS2V5cy5BcnJvd1VwLCBLZXlzLkFycm93RG93biwgS2V5cy5BcnJvd0xlZnQsIEtleXMuQXJyb3dSaWdodCwgS2V5cy5FbnRlcixcbiAgICAgICAgICAgIEtleXMuRXNjYXBlLCBLZXlzLkRlbGV0ZSwgS2V5cy5CYWNrc3BhY2UsIEtleXMuSG9tZSwgS2V5cy5FbmRdO1xuICAgICAgICBpZiAoa2V5cy5pbmRleE9mKGtleUNvZGUpID4gLTEpIHtcbiAgICAgICAgICAgIHRoaXMub25OYXZpZ2F0ZS5lbWl0KGV2ZW50KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBmb2N1cygpIHtcbiAgICAgICAgaWYgKGlzRG9jdW1lbnRBdmFpbGFibGUoKSkge1xuICAgICAgICAgICAgdGhpcy5pbnB1dC5uYXRpdmVFbGVtZW50LmZvY3VzKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgYmx1cigpIHtcbiAgICAgICAgaWYgKGlzRG9jdW1lbnRBdmFpbGFibGUoKSkge1xuICAgICAgICAgICAgdGhpcy5pbnB1dC5uYXRpdmVFbGVtZW50LmJsdXIoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzZXRJbnB1dFNpemUoKSB7XG4gICAgICAgIGNvbnN0IGxlbmd0aE9mID0geCA9PiB4ID8geC5sZW5ndGggOiAwO1xuICAgICAgICBjb25zdCBpbnB1dCA9IHRoaXMuaW5wdXQubmF0aXZlRWxlbWVudDtcbiAgICAgICAgY29uc3QgcGxhY2Vob2xkZXJMZW5ndGggPSBsZW5ndGhPZih0aGlzLnBsYWNlaG9sZGVyKTtcbiAgICAgICAgY29uc3QgdGV4dExlbmd0aCA9IGxlbmd0aE9mKHRoaXMudmFsdWUpO1xuICAgICAgICBjb25zdCBzaXplID0gTWF0aC5tYXgocGxhY2Vob2xkZXJMZW5ndGgsIHRleHRMZW5ndGgsIDEpO1xuICAgICAgICB0aGlzLnJlbmRlcmVyLnNldEF0dHJpYnV0ZShpbnB1dCwgJ3NpemUnLCBzaXplLnRvU3RyaW5nKCkpO1xuICAgIH1cbn07XG5fX2RlY29yYXRlKFtcbiAgICBJbnB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBTdHJpbmcpXG5dLCBTZWFyY2hCYXJDb21wb25lbnQucHJvdG90eXBlLCBcImlkXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBJbnB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBTdHJpbmcpXG5dLCBTZWFyY2hCYXJDb21wb25lbnQucHJvdG90eXBlLCBcImxpc3RJZFwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgSW5wdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgU3RyaW5nKVxuXSwgU2VhcmNoQmFyQ29tcG9uZW50LnByb3RvdHlwZSwgXCJ0YWdMaXN0SWRcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIFN0cmluZylcbl0sIFNlYXJjaEJhckNvbXBvbmVudC5wcm90b3R5cGUsIFwiYWN0aXZlRGVzY2VuZGFudFwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgSW5wdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgU3RyaW5nKVxuXSwgU2VhcmNoQmFyQ29tcG9uZW50LnByb3RvdHlwZSwgXCJub0RhdGFMYWJlbFwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgSW5wdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgQm9vbGVhbilcbl0sIFNlYXJjaEJhckNvbXBvbmVudC5wcm90b3R5cGUsIFwiZGlzYWJsZWRcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEJvb2xlYW4pXG5dLCBTZWFyY2hCYXJDb21wb25lbnQucHJvdG90eXBlLCBcInJlYWRvbmx5XCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBJbnB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBOdW1iZXIpXG5dLCBTZWFyY2hCYXJDb21wb25lbnQucHJvdG90eXBlLCBcInRhYkluZGV4XCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBJbnB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBCb29sZWFuKVxuXSwgU2VhcmNoQmFyQ29tcG9uZW50LnByb3RvdHlwZSwgXCJwb3B1cE9wZW5cIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIFN0cmluZylcbl0sIFNlYXJjaEJhckNvbXBvbmVudC5wcm90b3R5cGUsIFwicm9sZVwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgSW5wdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgU3RyaW5nKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnBhcmFtdHlwZXNcIiwgW1N0cmluZ10pXG5dLCBTZWFyY2hCYXJDb21wb25lbnQucHJvdG90eXBlLCBcInVzZXJJbnB1dFwiLCBudWxsKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIFN0cmluZylcbl0sIFNlYXJjaEJhckNvbXBvbmVudC5wcm90b3R5cGUsIFwic3VnZ2VzdGVkVGV4dFwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgT3V0cHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEV2ZW50RW1pdHRlcilcbl0sIFNlYXJjaEJhckNvbXBvbmVudC5wcm90b3R5cGUsIFwidmFsdWVDaGFuZ2VcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIE91dHB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBFdmVudEVtaXR0ZXIpXG5dLCBTZWFyY2hCYXJDb21wb25lbnQucHJvdG90eXBlLCBcIm9uQmx1clwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgT3V0cHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEV2ZW50RW1pdHRlcilcbl0sIFNlYXJjaEJhckNvbXBvbmVudC5wcm90b3R5cGUsIFwib25Gb2N1c1wiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgT3V0cHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEV2ZW50RW1pdHRlcilcbl0sIFNlYXJjaEJhckNvbXBvbmVudC5wcm90b3R5cGUsIFwib25DbGlja1wiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgT3V0cHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEV2ZW50RW1pdHRlcilcbl0sIFNlYXJjaEJhckNvbXBvbmVudC5wcm90b3R5cGUsIFwib25OYXZpZ2F0ZVwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgVmlld0NoaWxkKCdpbnB1dCcsIHsgc3RhdGljOiB0cnVlIH0pLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBFbGVtZW50UmVmKVxuXSwgU2VhcmNoQmFyQ29tcG9uZW50LnByb3RvdHlwZSwgXCJpbnB1dFwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgSG9zdEJpbmRpbmcoJ2NsYXNzLmstc2VhcmNoYmFyJyksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEJvb2xlYW4pXG5dLCBTZWFyY2hCYXJDb21wb25lbnQucHJvdG90eXBlLCBcInNlYXJjaEJhckNsYXNzXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBJbnB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBTdHJpbmcpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246cGFyYW10eXBlc1wiLCBbU3RyaW5nXSlcbl0sIFNlYXJjaEJhckNvbXBvbmVudC5wcm90b3R5cGUsIFwicGxhY2Vob2xkZXJcIiwgbnVsbCk7XG5TZWFyY2hCYXJDb21wb25lbnQgPSBfX2RlY29yYXRlKFtcbiAgICBDb21wb25lbnQoe1xuICAgICAgICBzZWxlY3RvcjogJ2tlbmRvLXNlYXJjaGJhcicsXG4gICAgICAgIHRlbXBsYXRlOiBgXG4gICAgICAgIDxpbnB1dCAjaW5wdXRcbiAgICAgICAgICAgIGF1dG9jb21wbGV0ZT1cIm9mZlwiXG4gICAgICAgICAgICBbaWRdPVwiaWRcIlxuICAgICAgICAgICAgW2Rpc2FibGVkXT1cImRpc2FibGVkXCJcbiAgICAgICAgICAgIFtyZWFkb25seV09XCJyZWFkb25seVwiXG4gICAgICAgICAgICBbcGxhY2Vob2xkZXJdPVwicGxhY2Vob2xkZXJcIlxuICAgICAgICAgICAgW2NsYXNzXT1cIidrLWlucHV0LWlubmVyJ1wiXG4gICAgICAgICAgICAoaW5wdXQpPVwiaGFuZGxlSW5wdXQoJGV2ZW50KVwiXG4gICAgICAgICAgICAoa2V5ZG93bik9XCJoYW5kbGVLZXlkb3duKCRldmVudClcIlxuICAgICAgICAgICAgW2tlbmRvRXZlbnRzT3V0c2lkZUFuZ3VsYXJdPVwie1xuICAgICAgICAgICAgICAgIGZvY3VzOiBoYW5kbGVGb2N1cyxcbiAgICAgICAgICAgICAgICBibHVyOiBoYW5kbGVCbHVyXG4gICAgICAgICAgICB9XCJcbiAgICAgICAgICAgIFtzY29wZV09XCJ0aGlzXCJcbiAgICAgICAgICAgIFthdHRyLnRhYkluZGV4XT1cInRhYkluZGV4XCJcbiAgICAgICAgICAgIFthdHRyLmRpcl09XCJkaXJlY3Rpb25cIlxuICAgICAgICAgICAgW2F0dHIucm9sZV09XCJyb2xlXCJcbiAgICAgICAgICAgIFthdHRyLmFyaWEtZGlzYWJsZWRdPVwiZGlzYWJsZWRcIlxuICAgICAgICAgICAgW2F0dHIuYXJpYS1yZWFkb25seV09XCJyZWFkb25seVwiXG4gICAgICAgICAgICBhcmlhLWhhc3BvcHVwPVwibGlzdGJveFwiXG4gICAgICAgICAgICBbYXR0ci5hcmlhLWV4cGFuZGVkXT1cImFyaWFFeHBhbmRlZFwiXG4gICAgICAgICAgICBbYXR0ci5hcmlhLW93bnNdPVwibGlzdElkXCJcbiAgICAgICAgICAgIFthdHRyLmFyaWEtZGVzY3JpYmVkYnldPVwidGFnTGlzdElkXCJcbiAgICAgICAgICAgIFthdHRyLmFyaWEtYWN0aXZlZGVzY2VuZGFudF09XCJhY3RpdmVEZXNjZW5kYW50XCJcbiAgICAgICAgICAgIFthdHRyLmFyaWEtbGFiZWxdPVwibm9EYXRhTGFiZWxcIlxuICAgICAgICAvPlxuICAgYFxuICAgIH0pLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246cGFyYW10eXBlc1wiLCBbTG9jYWxpemF0aW9uU2VydmljZSxcbiAgICAgICAgUmVuZGVyZXIyXSlcbl0sIFNlYXJjaEJhckNvbXBvbmVudCk7XG5cbi8qKlxuICogUmVuZGVycyB0aGUgbGlzdCBpdGVtIGNvbnRlbnQuIFRvIGRlZmluZSB0aGUgaXRlbSB0ZW1wbGF0ZSwgbmVzdCBhbiBgPG5nLXRlbXBsYXRlPmAgdGFnXG4gKiB3aXRoIHRoZSBga2VuZG88Q29tcG9uZW50TmFtZT5JdGVtVGVtcGxhdGVgIGRpcmVjdGl2ZSBpbnNpZGUgdGhlIGNvbXBvbmVudCB0YWcuIFRoZSB0ZW1wbGF0ZSBjb250ZXh0IGlzXG4gKiBzZXQgdG8gdGhlIGN1cnJlbnQgY29tcG9uZW50LiBUbyBnZXQgYSByZWZlcmVuY2UgdG8gdGhlIGN1cnJlbnQgZGF0YSBpdGVtLCB1c2UgdGhlIGBsZXQtZGF0YUl0ZW1gIGRpcmVjdGl2ZS5cbiAqXG4gKiAtIFtVc2luZyBgSXRlbVRlbXBsYXRlYCB3aXRoIHRoZSBBdXRvQ29tcGxldGVdKHslIHNsdWcgdGVtcGxhdGVzX2F1dG9jb21wbGV0ZSAlfSN0b2MtaXRlbS10ZW1wbGF0ZSlcbiAqIC0gW1VzaW5nIGBJdGVtVGVtcGxhdGVgIHdpdGggdGhlIENvbWJvQm94XSh7JSBzbHVnIHRlbXBsYXRlc19jb21ib2JveCAlfSN0b2MtaXRlbS10ZW1wbGF0ZSlcbiAqIC0gW1VzaW5nIGBJdGVtVGVtcGxhdGVgIHdpdGggdGhlIERyb3BEb3duTGlzdF0oeyUgc2x1ZyB0ZW1wbGF0ZXNfZGRsICV9I3RvYy1pdGVtLXRlbXBsYXRlKVxuICogLSBbVXNpbmcgYEl0ZW1UZW1wbGF0ZWAgd2l0aCB0aGUgTXVsdGlTZWxlY3RdKHslIHNsdWcgdGVtcGxhdGVzX211bHRpc2VsZWN0ICV9I3RvYy1pdGVtLXRlbXBsYXRlKVxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGB0c1xuICogX0BDb21wb25lbnQoe1xuICogc2VsZWN0b3I6ICdteS1hcHAnLFxuICogdGVtcGxhdGU6IGBcbiAqICA8a2VuZG8tY29tYm9ib3ggW2RhdGFdPVwibGlzdEl0ZW1zXCI+XG4gKiAgICA8bmctdGVtcGxhdGUga2VuZG9Db21ib0JveEl0ZW1UZW1wbGF0ZSBsZXQtZGF0YUl0ZW0+XG4gKiAgICAgIDxzcGFuPnt7ZGF0YUl0ZW19fSBvcHRpb248L3NwYW4+XG4gKiAgICA8L25nLXRlbXBsYXRlPlxuICogIDwva2VuZG8tY29tYm9ib3g+XG4gKiBgXG4gKiB9KVxuICogY2xhc3MgQXBwQ29tcG9uZW50IHtcbiAqICAgcHVibGljIGxpc3RJdGVtczogQXJyYXk8c3RyaW5nPiA9IFtcIkl0ZW0gMVwiLCBcIkl0ZW0gMlwiLCBcIkl0ZW0gM1wiLCBcIkl0ZW0gNFwiXTtcbiAqIH1cbiAqIGBgYFxuICovXG5sZXQgSXRlbVRlbXBsYXRlRGlyZWN0aXZlID0gY2xhc3MgSXRlbVRlbXBsYXRlRGlyZWN0aXZlIHtcbiAgICBjb25zdHJ1Y3Rvcih0ZW1wbGF0ZVJlZikge1xuICAgICAgICB0aGlzLnRlbXBsYXRlUmVmID0gdGVtcGxhdGVSZWY7XG4gICAgfVxufTtcbkl0ZW1UZW1wbGF0ZURpcmVjdGl2ZSA9IF9fZGVjb3JhdGUoW1xuICAgIERpcmVjdGl2ZSh7XG4gICAgICAgIHNlbGVjdG9yOiAnW2tlbmRvRHJvcERvd25MaXN0SXRlbVRlbXBsYXRlXSxba2VuZG9Db21ib0JveEl0ZW1UZW1wbGF0ZV0sW2tlbmRvQXV0b0NvbXBsZXRlSXRlbVRlbXBsYXRlXSxba2VuZG9NdWx0aVNlbGVjdEl0ZW1UZW1wbGF0ZV0nXG4gICAgfSksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjpwYXJhbXR5cGVzXCIsIFtUZW1wbGF0ZVJlZl0pXG5dLCBJdGVtVGVtcGxhdGVEaXJlY3RpdmUpO1xuXG4vKipcbiAqIFJlbmRlcnMgdGhlIGhlYWRlciBjb250ZW50IG9mIHRoZSBsaXN0LiBUbyBkZWZpbmUgdGhlIGhlYWRlciB0ZW1wbGF0ZSwgbmVzdCBhbiBgPG5nLXRlbXBsYXRlPmAgdGFnXG4gKiB3aXRoIHRoZSBga2VuZG88Q29tcG9uZW50TmFtZT5IZWFkZXJUZW1wbGF0ZWAgZGlyZWN0aXZlIGluc2lkZSB0aGUgY29tcG9uZW50IHRhZy5cbiAqXG4gKiAtIFtVc2luZyBgSGVhZGVyVGVtcGxhdGVgIHdpdGggdGhlIEF1dG9Db21wbGV0ZV0oeyUgc2x1ZyB0ZW1wbGF0ZXNfYXV0b2NvbXBsZXRlICV9I3RvYy1oZWFkZXItdGVtcGxhdGUpXG4gKiAtIFtVc2luZyBgSGVhZGVyVGVtcGxhdGVgIHdpdGggdGhlIENvbWJvQm94XSh7JSBzbHVnIHRlbXBsYXRlc19jb21ib2JveCAlfSN0b2MtaGVhZGVyLXRlbXBsYXRlKVxuICogLSBbVXNpbmcgYEhlYWRlclRlbXBsYXRlYCB3aXRoIHRoZSBNdWx0aUNvbHVtbkNvbWJvQm94XSh7JSBzbHVnIHRlbXBsYXRlc19tdWx0aWNvbHVtbmNvbWJvYm94ICV9I3RvYy1oZWFkZXItdGVtcGxhdGUpXG4gKiAtIFtVc2luZyBgSGVhZGVyVGVtcGxhdGVgIHdpdGggdGhlIERyb3BEb3duTGlzdF0oeyUgc2x1ZyB0ZW1wbGF0ZXNfZGRsICV9I3RvYy1oZWFkZXItdGVtcGxhdGUpXG4gKiAtIFtVc2luZyBgSGVhZGVyVGVtcGxhdGVgIHdpdGggdGhlIERyb3BEb3duVHJlZV0oeyUgc2x1ZyB0ZW1wbGF0ZXNfZGR0ICV9I3RvYy1oZWFkZXItdGVtcGxhdGUpXG4gKiAtIFtVc2luZyBgSGVhZGVyVGVtcGxhdGVgIHdpdGggdGhlIE11bHRpU2VsZWN0XSh7JSBzbHVnIHRlbXBsYXRlc19tdWx0aXNlbGVjdCAlfSN0b2MtaGVhZGVyLXRlbXBsYXRlKVxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGB0c1xuICogX0BDb21wb25lbnQoe1xuICogc2VsZWN0b3I6ICdteS1hcHAnLFxuICogdGVtcGxhdGU6IGBcbiAqICA8a2VuZG8tY29tYm9ib3ggW2RhdGFdPVwibGlzdEl0ZW1zXCI+XG4gKiAgICA8bmctdGVtcGxhdGUga2VuZG9Db21ib0JveEhlYWRlclRlbXBsYXRlPlxuICogICAgICA8aDQ+SGVhZGVyIHRlbXBsYXRlPC9oND5cbiAqICAgIDwvbmctdGVtcGxhdGU+XG4gKiAgPC9rZW5kby1jb21ib2JveD5cbiAqIGBcbiAqIH0pXG4gKiBjbGFzcyBBcHBDb21wb25lbnQge1xuICogICBwdWJsaWMgbGlzdEl0ZW1zOiBBcnJheTxzdHJpbmc+ID0gW1wiSXRlbSAxXCIsIFwiSXRlbSAyXCIsIFwiSXRlbSAzXCIsIFwiSXRlbSA0XCJdO1xuICogfVxuICogYGBgXG4gKi9cbmxldCBIZWFkZXJUZW1wbGF0ZURpcmVjdGl2ZSA9IGNsYXNzIEhlYWRlclRlbXBsYXRlRGlyZWN0aXZlIHtcbiAgICBjb25zdHJ1Y3Rvcih0ZW1wbGF0ZVJlZikge1xuICAgICAgICB0aGlzLnRlbXBsYXRlUmVmID0gdGVtcGxhdGVSZWY7XG4gICAgfVxufTtcbkhlYWRlclRlbXBsYXRlRGlyZWN0aXZlID0gX19kZWNvcmF0ZShbXG4gICAgRGlyZWN0aXZlKHtcbiAgICAgICAgc2VsZWN0b3I6ICdba2VuZG9Ecm9wRG93bkxpc3RIZWFkZXJUZW1wbGF0ZV0sW2tlbmRvQ29tYm9Cb3hIZWFkZXJUZW1wbGF0ZV0sW2tlbmRvRHJvcERvd25UcmVlSGVhZGVyVGVtcGxhdGVdLFtrZW5kb011bHRpQ29sdW1uQ29tYm9Cb3hIZWFkZXJUZW1wbGF0ZV0sW2tlbmRvQXV0b0NvbXBsZXRlSGVhZGVyVGVtcGxhdGVdLFtrZW5kb011bHRpU2VsZWN0SGVhZGVyVGVtcGxhdGVdLFtrZW5kb011bHRpU2VsZWN0VHJlZUhlYWRlclRlbXBsYXRlXSdcbiAgICB9KSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnBhcmFtdHlwZXNcIiwgW1RlbXBsYXRlUmVmXSlcbl0sIEhlYWRlclRlbXBsYXRlRGlyZWN0aXZlKTtcblxuLyoqXG4gKiBSZW5kZXJzIHRoZSBmb290ZXIgY29udGVudCBvZiB0aGUgbGlzdC4gVG8gZGVmaW5lIHRoZSBmb290ZXIgdGVtcGxhdGUsIG5lc3QgYW4gYDxuZy10ZW1wbGF0ZT5gIHRhZ1xuICogd2l0aCB0aGUgYGtlbmRvPENvbXBvbmVudE5hbWU+Rm9vdGVyVGVtcGxhdGVgIGRpcmVjdGl2ZSBpbnNpZGUgdGhlIGNvbXBvbmVudCB0YWcuXG4gKlxuICogLSBbVXNpbmcgYEZvb3RlclRlbXBsYXRlYCB3aXRoIHRoZSBBdXRvQ29tcGxldGVdKHslIHNsdWcgdGVtcGxhdGVzX2F1dG9jb21wbGV0ZSAlfSN0b2MtZm9vdGVyLXRlbXBsYXRlKVxuICogLSBbVXNpbmcgYEZvb3RlclRlbXBsYXRlYCB3aXRoIHRoZSBDb21ib0JveF0oeyUgc2x1ZyB0ZW1wbGF0ZXNfY29tYm9ib3ggJX0jdG9jLWZvb3Rlci10ZW1wbGF0ZSlcbiAqIC0gW1VzaW5nIGBGb290ZXJUZW1wbGF0ZWAgd2l0aCB0aGUgTXVsdGlDb2x1bW5Db21ib0JveF0oeyUgc2x1ZyB0ZW1wbGF0ZXNfbXVsdGljb2x1bW5jb21ib2JveCAlfSN0b2MtZm9vdGVyLXRlbXBsYXRlKVxuICogLSBbVXNpbmcgYEZvb3RlclRlbXBsYXRlYCB3aXRoIHRoZSBEcm9wRG93bkxpc3RdKHslIHNsdWcgdGVtcGxhdGVzX2RkbCAlfSN0b2MtZm9vdGVyLXRlbXBsYXRlKVxuICogLSBbVXNpbmcgYEZvb3RlclRlbXBsYXRlYCB3aXRoIHRoZSBEcm9wRG93blRyZWVdKHslIHNsdWcgdGVtcGxhdGVzX2RkdCAlfSN0b2MtZm9vdGVyLXRlbXBsYXRlKVxuICogLSBbVXNpbmcgYEZvb3RlclRlbXBsYXRlYCB3aXRoIHRoZSBNdWx0aVNlbGVjdF0oeyUgc2x1ZyB0ZW1wbGF0ZXNfbXVsdGlzZWxlY3QgJX0jdG9jLWZvb3Rlci10ZW1wbGF0ZSlcbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgdHNcbiAqIF9AQ29tcG9uZW50KHtcbiAqIHNlbGVjdG9yOiAnbXktYXBwJyxcbiAqIHRlbXBsYXRlOiBgXG4gKiAgPGtlbmRvLWNvbWJvYm94IFtkYXRhXT1cImxpc3RJdGVtc1wiPlxuICogICAgPG5nLXRlbXBsYXRlIGtlbmRvQ29tYm9Cb3hGb290ZXJUZW1wbGF0ZT5cbiAqICAgICAgPGg0PkZvb3RlciB0ZW1wbGF0ZTwvaDQ+XG4gKiAgICA8L25nLXRlbXBsYXRlPlxuICogIDwva2VuZG8tY29tYm9ib3g+XG4gKiBgXG4gKiB9KVxuICogY2xhc3MgQXBwQ29tcG9uZW50IHtcbiAqICAgcHVibGljIGxpc3RJdGVtczogQXJyYXk8c3RyaW5nPiA9IFtcIkl0ZW0gMVwiLCBcIkl0ZW0gMlwiLCBcIkl0ZW0gM1wiLCBcIkl0ZW0gNFwiXTtcbiAqIH1cbiAqIGBgYFxuICovXG5sZXQgRm9vdGVyVGVtcGxhdGVEaXJlY3RpdmUgPSBjbGFzcyBGb290ZXJUZW1wbGF0ZURpcmVjdGl2ZSB7XG4gICAgY29uc3RydWN0b3IodGVtcGxhdGVSZWYpIHtcbiAgICAgICAgdGhpcy50ZW1wbGF0ZVJlZiA9IHRlbXBsYXRlUmVmO1xuICAgIH1cbn07XG5Gb290ZXJUZW1wbGF0ZURpcmVjdGl2ZSA9IF9fZGVjb3JhdGUoW1xuICAgIERpcmVjdGl2ZSh7XG4gICAgICAgIHNlbGVjdG9yOiAnW2tlbmRvRHJvcERvd25MaXN0Rm9vdGVyVGVtcGxhdGVdLFtrZW5kb0NvbWJvQm94Rm9vdGVyVGVtcGxhdGVdLFtrZW5kb0Ryb3BEb3duVHJlZUZvb3RlclRlbXBsYXRlXSxba2VuZG9NdWx0aUNvbHVtbkNvbWJvQm94Rm9vdGVyVGVtcGxhdGVdLFtrZW5kb0F1dG9Db21wbGV0ZUZvb3RlclRlbXBsYXRlXSxba2VuZG9NdWx0aVNlbGVjdEZvb3RlclRlbXBsYXRlXSxba2VuZG9NdWx0aVNlbGVjdFRyZWVGb290ZXJUZW1wbGF0ZV0nXG4gICAgfSksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjpwYXJhbXR5cGVzXCIsIFtUZW1wbGF0ZVJlZl0pXG5dLCBGb290ZXJUZW1wbGF0ZURpcmVjdGl2ZSk7XG5cbi8qKlxuICogUmVuZGVycyB0aGUgZ3JvdXAgaGVhZGVyIGNvbnRlbnQuIFRvIGRlZmluZSB0aGUgZ3JvdXAgdGVtcGxhdGUsIG5lc3QgYW4gYDxuZy10ZW1wbGF0ZT5gIHRhZ1xuICogd2l0aCB0aGUgYGtlbmRvPENvbXBvbmVudE5hbWU+R3JvdXBUZW1wbGF0ZWAgZGlyZWN0aXZlIGluc2lkZSB0aGUgY29tcG9uZW50IHRhZy4gVGhlIHRlbXBsYXRlIGNvbnRleHQgaXNcbiAqIHNldCB0byB0aGUgY3VycmVudCBjb21wb25lbnQuIFRvIGdldCBhIHJlZmVyZW5jZSB0byB0aGUgY3VycmVudCBkYXRhIGl0ZW0sIHVzZSB0aGUgYGxldC1ncm91cE5hbWVgIGRpcmVjdGl2ZS5cbiAqXG4gKiAtIFtVc2luZyBgR3JvdXBUZW1wbGF0ZWAgd2l0aCB0aGUgQXV0b0NvbXBsZXRlXSh7JSBzbHVnIHRlbXBsYXRlc19hdXRvY29tcGxldGUgJX0jdG9jLWdyb3VwLXRlbXBsYXRlKVxuICogLSBbVXNpbmcgYEdyb3VwVGVtcGxhdGVgIHdpdGggdGhlIENvbWJvQm94XSh7JSBzbHVnIHRlbXBsYXRlc19jb21ib2JveCAlfSN0b2MtZ3JvdXAtdGVtcGxhdGUpXG4gKiAtIFtVc2luZyBgR3JvdXBUZW1wbGF0ZWAgd2l0aCB0aGUgTXVsdGlDb2x1bW5Db21ib0JveF0oeyUgc2x1ZyB0ZW1wbGF0ZXNfbXVsdGljb2x1bW5jb21ib2JveCAlfSN0b2MtZ3JvdXAtdGVtcGxhdGUpXG4gKiAtIFtVc2luZyBgR3JvdXBUZW1wbGF0ZWAgd2l0aCB0aGUgRHJvcERvd25MaXN0XSh7JSBzbHVnIHRlbXBsYXRlc19kZGwgJX0jdG9jLWdyb3VwLXRlbXBsYXRlKVxuICogLSBbVXNpbmcgYEdyb3VwVGVtcGxhdGVgIHdpdGggdGhlIE11bHRpU2VsZWN0XSh7JSBzbHVnIHRlbXBsYXRlc19tdWx0aXNlbGVjdCAlfSN0b2MtZ3JvdXAtdGVtcGxhdGUpXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYHRzXG4gKiBpbXBvcnQgeyBncm91cEJ5IH0gZnJvbSAnQHByb2dyZXNzL2tlbmRvLWRhdGEtcXVlcnknO1xuICogX0BDb21wb25lbnQoe1xuICogc2VsZWN0b3I6ICdteS1hcHAnLFxuICogdGVtcGxhdGU6IGBcbiAqICA8a2VuZG8tY29tYm9ib3ggW2RhdGFdPVwiZ3JvdXBlZERhdGFcIiB0ZXh0RmllbGQ9XCJuYW1lXCIgdmFsdWVGaWVsZD1cIm5hbWVcIj5cbiAqICAgIDxuZy10ZW1wbGF0ZSBrZW5kb0NvbWJvQm94R3JvdXBUZW1wbGF0ZSBsZXQtZ3JvdXBOYW1lPlxuICogICAgICA8c3Bhbj5Gb29kIHR5cGU6IHt7Z3JvdXBOYW1lfX0gb3B0aW9uPC9zcGFuPlxuICogICAgPC9uZy10ZW1wbGF0ZT5cbiAqICA8L2tlbmRvLWNvbWJvYm94PlxuICogYFxuICogfSlcbiAqIGNsYXNzIEFwcENvbXBvbmVudCB7XG4gKiAgIHB1YmxpYyBkYXRhID0gW1xuICogICAgICAgeyBuYW1lOiBcIlBvcmtcIiwgY2F0ZWdvcnk6IFwiRm9vZFwiLCBzdWJjYXRlZ29yeTogXCJNZWF0XCIgfSxcbiAqICAgICAgIHsgbmFtZTogXCJQZXBwZXJcIiwgY2F0ZWdvcnk6IFwiRm9vZFwiLCBzdWJjYXRlZ29yeTogXCJWZWdldGFibGVzXCIgfSxcbiAqICAgICAgIHsgbmFtZTogXCJCZWVmXCIsIGNhdGVnb3J5OiBcIkZvb2RcIiwgc3ViY2F0ZWdvcnk6IFwiTWVhdFwiIH1cbiAqICAgXTtcbiAqICAgcHVibGljIGdyb3VwZWREYXRhID0gZ3JvdXBCeSh0aGlzLmRhdGEsIFt7ZmllbGQ6IFwic3ViY2F0ZWdvcnlcIn1dKTtcbiAqIH1cbiAqIGBgYFxuICovXG5sZXQgR3JvdXBUZW1wbGF0ZURpcmVjdGl2ZSA9IGNsYXNzIEdyb3VwVGVtcGxhdGVEaXJlY3RpdmUge1xuICAgIGNvbnN0cnVjdG9yKHRlbXBsYXRlUmVmKSB7XG4gICAgICAgIHRoaXMudGVtcGxhdGVSZWYgPSB0ZW1wbGF0ZVJlZjtcbiAgICB9XG59O1xuR3JvdXBUZW1wbGF0ZURpcmVjdGl2ZSA9IF9fZGVjb3JhdGUoW1xuICAgIERpcmVjdGl2ZSh7XG4gICAgICAgIHNlbGVjdG9yOiAnW2tlbmRvRHJvcERvd25MaXN0R3JvdXBUZW1wbGF0ZV0sW2tlbmRvQ29tYm9Cb3hHcm91cFRlbXBsYXRlXSxba2VuZG9NdWx0aUNvbHVtbkNvbWJvQm94R3JvdXBUZW1wbGF0ZV0sW2tlbmRvQXV0b0NvbXBsZXRlR3JvdXBUZW1wbGF0ZV0sW2tlbmRvTXVsdGlTZWxlY3RHcm91cFRlbXBsYXRlXSdcbiAgICB9KSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnBhcmFtdHlwZXNcIiwgW1RlbXBsYXRlUmVmXSlcbl0sIEdyb3VwVGVtcGxhdGVEaXJlY3RpdmUpO1xuXG4vKipcbiAqIFJlbmRlcnMgdGhlIGZpeGVkIGdyb3VwIGhlYWRlciBjb250ZW50LiBUbyBkZWZpbmUgdGhlIGZpeGVkIGdyb3VwIHRlbXBsYXRlLCBuZXN0IGFuIGA8bmctdGVtcGxhdGU+YCB0YWdcbiAqIHdpdGggdGhlIGBrZW5kbzxDb21wb25lbnROYW1lPkZpeGVkR3JvdXBUZW1wbGF0ZWAgZGlyZWN0aXZlIGluc2lkZSB0aGUgY29tcG9uZW50IHRhZy4gVGhlIHRlbXBsYXRlIGNvbnRleHQgaXNcbiAqIHNldCB0byB0aGUgY3VycmVudCBjb21wb25lbnQuIFRvIGdldCBhIHJlZmVyZW5jZSB0byB0aGUgY3VycmVudCBkYXRhIGl0ZW0sIHVzZSB0aGUgYGxldC1ncm91cE5hbWVgIGRpcmVjdGl2ZS5cbiAqXG4gKiAtIFtVc2luZyBgRml4ZWRHcm91cFRlbXBsYXRlYCB3aXRoIHRoZSBBdXRvQ29tcGxldGVdKHslIHNsdWcgdGVtcGxhdGVzX2F1dG9jb21wbGV0ZSAlfSN0b2MtZml4ZWQtZ3JvdXAtdGVtcGxhdGUpXG4gKiAtIFtVc2luZyBgRml4ZWRHcm91cFRlbXBsYXRlYCB3aXRoIHRoZSBDb21ib0JveF0oeyUgc2x1ZyB0ZW1wbGF0ZXNfY29tYm9ib3ggJX0jdG9jLWZpeGVkLWdyb3VwLXRlbXBsYXRlKVxuICogLSBbVXNpbmcgYEZpeGVkR3JvdXBUZW1wbGF0ZWAgd2l0aCB0aGUgTXVsdGlDb2x1bW5Db21ib0JveF0oeyUgc2x1ZyB0ZW1wbGF0ZXNfbXVsdGljb2x1bW5jb21ib2JveCAlfSN0b2MtZml4ZWQtZ3JvdXAtdGVtcGxhdGUpXG4gKiAtIFtVc2luZyBgRml4ZWRHcm91cFRlbXBsYXRlYCB3aXRoIHRoZSBEcm9wRG93bkxpc3RdKHslIHNsdWcgdGVtcGxhdGVzX2RkbCAlfSN0b2MtZml4ZWQtZ3JvdXAtdGVtcGxhdGUpXG4gKiAtIFtVc2luZyBgRml4ZWRHcm91cFRlbXBsYXRlYCB3aXRoIHRoZSBNdWx0aVNlbGVjdF0oeyUgc2x1ZyB0ZW1wbGF0ZXNfbXVsdGlzZWxlY3QgJX0jdG9jLWZpeGVkLWdyb3VwLXRlbXBsYXRlKVxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGB0c1xuICogaW1wb3J0IHsgZ3JvdXBCeSB9IGZyb20gJ0Bwcm9ncmVzcy9rZW5kby1kYXRhLXF1ZXJ5JztcbiAqIF9AQ29tcG9uZW50KHtcbiAqIHNlbGVjdG9yOiAnbXktYXBwJyxcbiAqIHRlbXBsYXRlOiBgXG4gKiAgPGtlbmRvLWNvbWJvYm94IFtkYXRhXT1cImdyb3VwZWREYXRhXCIgdGV4dEZpZWxkPVwibmFtZVwiIHZhbHVlRmllbGQ9XCJuYW1lXCI+XG4gKiAgICA8bmctdGVtcGxhdGUga2VuZG9Db21ib0JveEZpeGVkR3JvdXBUZW1wbGF0ZSBsZXQtZ3JvdXBOYW1lPlxuICogICAgICA8c3Bhbj5Gb29kIHR5cGU6IHt7Z3JvdXBOYW1lfX0gb3B0aW9uPC9zcGFuPlxuICogICAgPC9uZy10ZW1wbGF0ZT5cbiAqICA8L2tlbmRvLWNvbWJvYm94PlxuICogYFxuICogfSlcbiAqIGNsYXNzIEFwcENvbXBvbmVudCB7XG4gKiAgIHB1YmxpYyBkYXRhID0gW1xuICogICAgICAgeyBuYW1lOiBcIlBvcmtcIiwgY2F0ZWdvcnk6IFwiRm9vZFwiLCBzdWJjYXRlZ29yeTogXCJNZWF0XCIgfSxcbiAqICAgICAgIHsgbmFtZTogXCJQZXBwZXJcIiwgY2F0ZWdvcnk6IFwiRm9vZFwiLCBzdWJjYXRlZ29yeTogXCJWZWdldGFibGVzXCIgfSxcbiAqICAgICAgIHsgbmFtZTogXCJCZWVmXCIsIGNhdGVnb3J5OiBcIkZvb2RcIiwgc3ViY2F0ZWdvcnk6IFwiTWVhdFwiIH1cbiAqICAgXTtcbiAqICAgcHVibGljIGdyb3VwZWREYXRhID0gZ3JvdXBCeSh0aGlzLmRhdGEsIFt7ZmllbGQ6IFwic3ViY2F0ZWdvcnlcIn1dKTtcbiAqIH1cbiAqIGBgYFxuICovXG5sZXQgRml4ZWRHcm91cFRlbXBsYXRlRGlyZWN0aXZlID0gY2xhc3MgRml4ZWRHcm91cFRlbXBsYXRlRGlyZWN0aXZlIHtcbiAgICBjb25zdHJ1Y3Rvcih0ZW1wbGF0ZVJlZikge1xuICAgICAgICB0aGlzLnRlbXBsYXRlUmVmID0gdGVtcGxhdGVSZWY7XG4gICAgfVxufTtcbkZpeGVkR3JvdXBUZW1wbGF0ZURpcmVjdGl2ZSA9IF9fZGVjb3JhdGUoW1xuICAgIERpcmVjdGl2ZSh7XG4gICAgICAgIHNlbGVjdG9yOiAnW2tlbmRvRHJvcERvd25MaXN0Rml4ZWRHcm91cFRlbXBsYXRlXSxba2VuZG9Db21ib0JveEZpeGVkR3JvdXBUZW1wbGF0ZV0sW2tlbmRvTXVsdGlDb2x1bW5Db21ib0JveEZpeGVkR3JvdXBUZW1wbGF0ZV0sW2tlbmRvQXV0b0NvbXBsZXRlRml4ZWRHcm91cFRlbXBsYXRlXSxba2VuZG9NdWx0aVNlbGVjdEZpeGVkR3JvdXBUZW1wbGF0ZV0nXG4gICAgfSksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjpwYXJhbXR5cGVzXCIsIFtUZW1wbGF0ZVJlZl0pXG5dLCBGaXhlZEdyb3VwVGVtcGxhdGVEaXJlY3RpdmUpO1xuXG4vKipcbiAqIEBoaWRkZW5cbiAqL1xubGV0IFNlbGVjdGlvblNlcnZpY2UgPSBjbGFzcyBTZWxlY3Rpb25TZXJ2aWNlIHtcbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMub25TZWxlY3QgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gICAgICAgIHRoaXMub25DaGFuZ2UgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gICAgICAgIHRoaXMub25Gb2N1cyA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcbiAgICAgICAgdGhpcy50b3RhbCA9IDA7XG4gICAgICAgIHRoaXMuc2VsZWN0ZWRJbmRpY2VzID0gW107XG4gICAgfVxuICAgIGdldFRvdGFsKCkge1xuICAgICAgICByZXR1cm4gdGhpcy50b3RhbDtcbiAgICB9XG4gICAgaXNTZWxlY3RlZChpbmRleCkge1xuICAgICAgICByZXR1cm4gaXNQcmVzZW50KHRoaXMuc2VsZWN0ZWRJbmRpY2VzLmZpbmQoY3VycmVudCA9PiBjdXJyZW50ID09PSBpbmRleCkpO1xuICAgIH1cbiAgICBpc0ZvY3VzZWQoaW5kZXgpIHtcbiAgICAgICAgcmV0dXJuIGluZGV4ID09PSB0aGlzLmZvY3VzZWQ7XG4gICAgfVxuICAgIGZvY3VzKGluZGV4KSB7XG4gICAgICAgIGlmICh0aGlzLmlzRm9jdXNlZChpbmRleCkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmZvY3VzZWQgPSBpbmRleDtcbiAgICAgICAgdGhpcy5vbkZvY3VzLmVtaXQoaW5kZXgpO1xuICAgIH1cbiAgICBzZWxlY3QoaW5kZXgpIHtcbiAgICAgICAgaWYgKHRoaXMuaXNTZWxlY3RlZChpbmRleCkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnNlbGVjdGVkSW5kaWNlcyA9IFtpbmRleF07XG4gICAgICAgIHRoaXMuZm9jdXNlZCA9IGluZGV4O1xuICAgICAgICB0aGlzLm9uU2VsZWN0LmVtaXQoe1xuICAgICAgICAgICAgaW5kaWNlczogW2luZGV4XSxcbiAgICAgICAgICAgIG5ld1NlbGVjdGlvbjogaXNQcmVzZW50KGluZGV4KVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgYWRkKGluZGV4KSB7XG4gICAgICAgIGlmICh0aGlzLmlzU2VsZWN0ZWQoaW5kZXgpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zZWxlY3RlZEluZGljZXMucHVzaChpbmRleCk7XG4gICAgICAgIHRoaXMuZm9jdXNlZCA9IGluZGV4O1xuICAgICAgICB0aGlzLm9uQ2hhbmdlLmVtaXQoe1xuICAgICAgICAgICAgYWRkZWQ6IGluZGV4LFxuICAgICAgICAgICAgaW5kaWNlczogdGhpcy5zZWxlY3RlZEluZGljZXMuc2xpY2UoKVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgdW5zZWxlY3QoaW5kZXgpIHtcbiAgICAgICAgaWYgKCF0aGlzLmlzU2VsZWN0ZWQoaW5kZXgpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgcG9zaXRpb24gPSB0aGlzLnNlbGVjdGVkSW5kaWNlcy5pbmRleE9mKGluZGV4KTtcbiAgICAgICAgdGhpcy5zZWxlY3RlZEluZGljZXMuc3BsaWNlKHBvc2l0aW9uLCAxKTtcbiAgICAgICAgdGhpcy5mb2N1c2VkID0gaW5kZXg7XG4gICAgICAgIHRoaXMub25DaGFuZ2UuZW1pdCh7XG4gICAgICAgICAgICBpbmRpY2VzOiB0aGlzLnNlbGVjdGVkSW5kaWNlcy5zbGljZSgpLFxuICAgICAgICAgICAgcmVtb3ZlZDogaW5kZXhcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGNoYW5nZShpbmRleCkge1xuICAgICAgICBjb25zdCBuZXdTZWxlY3Rpb24gPSBpc1ByZXNlbnQoaW5kZXgpICYmICF0aGlzLmlzU2VsZWN0ZWQoaW5kZXgpO1xuICAgICAgICB0aGlzLnNlbGVjdGVkSW5kaWNlcyA9IFtpbmRleF07XG4gICAgICAgIHRoaXMuZm9jdXNlZCA9IGluZGV4O1xuICAgICAgICB0aGlzLm9uQ2hhbmdlLmVtaXQoe1xuICAgICAgICAgICAgaW5kaWNlczogW2luZGV4XSxcbiAgICAgICAgICAgIG5ld1NlbGVjdGlvbjogbmV3U2VsZWN0aW9uXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICByZXNldFNlbGVjdGlvbihpbmRleCkge1xuICAgICAgICB0aGlzLnNlbGVjdGVkSW5kaWNlcyA9IGluZGV4IGluc3RhbmNlb2YgQXJyYXkgPyBpbmRleCA6IFtpbmRleF07XG4gICAgICAgIHRoaXMuZm9jdXNlZCA9IHRoaXMuc2VsZWN0ZWRJbmRpY2VzW3RoaXMuc2VsZWN0ZWRJbmRpY2VzLmxlbmd0aCAtIDFdO1xuICAgIH1cbiAgICBnZXQgc2VsZWN0ZWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNlbGVjdGVkSW5kaWNlcy5zbGljZSgpO1xuICAgIH1cbiAgICBnZXQgZm9jdXNlZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZm9jdXNlZEluZGV4O1xuICAgIH1cbiAgICBzZXQgZm9jdXNlZChpbmRleCkge1xuICAgICAgICBpZiAodGhpcy5mb2N1c2VkSW5kZXggIT09IGluZGV4KSB7XG4gICAgICAgICAgICB0aGlzLmZvY3VzZWRJbmRleCA9IGluZGV4O1xuICAgICAgICAgICAgdGhpcy5vbkZvY3VzLmVtaXQoaW5kZXgpO1xuICAgICAgICB9XG4gICAgfVxufTtcblNlbGVjdGlvblNlcnZpY2UgPSBfX2RlY29yYXRlKFtcbiAgICBJbmplY3RhYmxlKClcbl0sIFNlbGVjdGlvblNlcnZpY2UpO1xuXG4vKipcbiAqIEBoaWRkZW5cbiAqL1xudmFyIE5hdmlnYXRpb25BY3Rpb247XG4oZnVuY3Rpb24gKE5hdmlnYXRpb25BY3Rpb24pIHtcbiAgICBOYXZpZ2F0aW9uQWN0aW9uW05hdmlnYXRpb25BY3Rpb25bXCJVbmRlZmluZWRcIl0gPSAwXSA9IFwiVW5kZWZpbmVkXCI7XG4gICAgTmF2aWdhdGlvbkFjdGlvbltOYXZpZ2F0aW9uQWN0aW9uW1wiT3BlblwiXSA9IDFdID0gXCJPcGVuXCI7XG4gICAgTmF2aWdhdGlvbkFjdGlvbltOYXZpZ2F0aW9uQWN0aW9uW1wiQ2xvc2VcIl0gPSAyXSA9IFwiQ2xvc2VcIjtcbiAgICBOYXZpZ2F0aW9uQWN0aW9uW05hdmlnYXRpb25BY3Rpb25bXCJFbnRlclwiXSA9IDNdID0gXCJFbnRlclwiO1xuICAgIE5hdmlnYXRpb25BY3Rpb25bTmF2aWdhdGlvbkFjdGlvbltcIlRhYlwiXSA9IDRdID0gXCJUYWJcIjtcbiAgICBOYXZpZ2F0aW9uQWN0aW9uW05hdmlnYXRpb25BY3Rpb25bXCJFc2NcIl0gPSA1XSA9IFwiRXNjXCI7XG4gICAgTmF2aWdhdGlvbkFjdGlvbltOYXZpZ2F0aW9uQWN0aW9uW1wiRGVsZXRlXCJdID0gNl0gPSBcIkRlbGV0ZVwiO1xuICAgIE5hdmlnYXRpb25BY3Rpb25bTmF2aWdhdGlvbkFjdGlvbltcIkJhY2tzcGFjZVwiXSA9IDddID0gXCJCYWNrc3BhY2VcIjtcbiAgICBOYXZpZ2F0aW9uQWN0aW9uW05hdmlnYXRpb25BY3Rpb25bXCJIb21lXCJdID0gOF0gPSBcIkhvbWVcIjtcbiAgICBOYXZpZ2F0aW9uQWN0aW9uW05hdmlnYXRpb25BY3Rpb25bXCJFbmRcIl0gPSA5XSA9IFwiRW5kXCI7XG4gICAgTmF2aWdhdGlvbkFjdGlvbltOYXZpZ2F0aW9uQWN0aW9uW1wiVXBcIl0gPSAxMF0gPSBcIlVwXCI7XG4gICAgTmF2aWdhdGlvbkFjdGlvbltOYXZpZ2F0aW9uQWN0aW9uW1wiRG93blwiXSA9IDExXSA9IFwiRG93blwiO1xuICAgIE5hdmlnYXRpb25BY3Rpb25bTmF2aWdhdGlvbkFjdGlvbltcIkxlZnRcIl0gPSAxMl0gPSBcIkxlZnRcIjtcbiAgICBOYXZpZ2F0aW9uQWN0aW9uW05hdmlnYXRpb25BY3Rpb25bXCJSaWdodFwiXSA9IDEzXSA9IFwiUmlnaHRcIjtcbn0pKE5hdmlnYXRpb25BY3Rpb24gfHwgKE5hdmlnYXRpb25BY3Rpb24gPSB7fSkpO1xuXG4vKipcbiAqIEBoaWRkZW5cbiAqL1xubGV0IERhdGFTZXJ2aWNlID0gY2xhc3MgRGF0YVNlcnZpY2Uge1xuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5ncm91cGVkID0gZmFsc2U7XG4gICAgICAgIHRoaXMuZ3JvdXBJbmRpY2VzID0gW107XG4gICAgfVxuICAgIHNldCBkYXRhKGRhdGEpIHtcbiAgICAgICAgdGhpcy5fZGF0YSA9IGRhdGE7XG4gICAgICAgIHRoaXMuZ3JvdXBlZCA9IHRoaXMuaXNHcm91cGVkKGRhdGEpO1xuICAgICAgICBpZiAodGhpcy5ncm91cGVkKSB7XG4gICAgICAgICAgICB0aGlzLmdyb3VwSW5kaWNlcyA9IHRoaXMuZ2V0R3JvdXBJbmRpY2VzKGRhdGEpO1xuICAgICAgICAgICAgdGhpcy5fZmxhdERhdGEgPSB0aGlzLmZsYXR0ZW4oZGF0YSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZ2V0IGRhdGEoKSB7XG4gICAgICAgIGlmICh0aGlzLmdyb3VwZWQpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9mbGF0RGF0YTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5fZGF0YTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqIFVzZWQgdG8gZ2V0IHRoZSBhY3R1YWwgaXRlbXMgY291bnQsIGkuZS4gZXhjbHVkaW5nIHRoZSBoZWFkZXIgaXRlbXMgaW4gY2FzZSBvZiBncm91cGluZy5cbiAgICAgKi9cbiAgICBnZXQgaXRlbXNDb3VudCgpIHtcbiAgICAgICAgaWYgKCFpc1ByZXNlbnQodGhpcy5kYXRhKSB8fCB0aGlzLmRhdGEubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBpdGVtcyA9IHRoaXMuZ3JvdXBlZCA/IHRoaXMuX2ZsYXREYXRhLmZpbHRlcihpdGVtID0+ICFpdGVtLmhlYWRlcikgOiB0aGlzLmRhdGE7XG4gICAgICAgIHJldHVybiBpdGVtcy5sZW5ndGg7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKiBVc2VkIHRvIGRldGVybWluZSBpZiB0aGUgY29tcG9uZW50IHJlY2VpdmVkIGdyb3VwZWQgZGF0YS5cbiAgICAgKi9cbiAgICBpc0dyb3VwZWQoZGF0YSkge1xuICAgICAgICAvLyBHcm91cFJlc3VsdCB7IGFnZ3JlZ2F0ZXM6IEFnZ3JlZ2F0ZVJlc3VsdCwgZmllbGQ6IHN0cmluZywgaXRlbXM6IG9iamVjdFtdLCB2YWx1ZTogYW55IH1cbiAgICAgICAgLy8gaHR0cHM6Ly93d3cudGVsZXJpay5jb20va2VuZG8tYW5ndWxhci11aS9jb21wb25lbnRzL2RhdGFxdWVyeS9hcGkvR3JvdXBSZXN1bHQvXG4gICAgICAgIHJldHVybiAoaXNQcmVzZW50KGRhdGEpICYmIGRhdGEubGVuZ3RoICE9PSAwKSAmJiBpc1ByZXNlbnQoZGF0YVswXSkgJiYgaGFzUHJvcHMoZGF0YVswXSwgWydhZ2dyZWdhdGVzJywgJ2ZpZWxkJywgJ2l0ZW1zJywgJ3ZhbHVlJ10pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICogVXNlZCB0byBjYWxjdWxhdGUgdGhlIGxhc3QgaXRlbSBpbmRleCBvZiBlYWNoIGdyb3VwLlxuICAgICAqL1xuICAgIGdldEdyb3VwSW5kaWNlcyhkYXRhKSB7XG4gICAgICAgIGxldCBncm91cEluZGljZXMgPSBbXTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPD0gZGF0YS5sZW5ndGggLSAxOyBpKyspIHtcbiAgICAgICAgICAgIGdyb3VwSW5kaWNlc1tpXSA9IChncm91cEluZGljZXNbaSAtIDFdIHx8IDApICsgZGF0YVtpXS5pdGVtcy5sZW5ndGg7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGdyb3VwSW5kaWNlcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqIFVzZWQgdG8gZ2V0IGEgZmxhdCBhcnJheSBjb250YWluaW5nIGFsbCBpdGVtcyBtYXRjaGluZyBjZXJ0YWluIGNyaXRlcmlhLlxuICAgICAqL1xuICAgIGZpbHRlcihwcmVkaWNhdGUpIHtcbiAgICAgICAgbGV0IHJlc3VsdCA9IFtdO1xuICAgICAgICBpZiAodGhpcy5pc0dyb3VwZWQodGhpcy5kYXRhKSkge1xuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPD0gdGhpcy5ncm91cEluZGljZXMubGVuZ3RoIC0gMTsgaSsrKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbWF0Y2hlcyA9IHRoaXMuZGF0YVtpXS5pdGVtcy5maWx0ZXIocHJlZGljYXRlKTtcbiAgICAgICAgICAgICAgICBpZiAobWF0Y2hlcykge1xuICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSByZXN1bHQuY29uY2F0KG1hdGNoZXMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJlc3VsdCA9IHRoaXMuZGF0YS5maWx0ZXIocHJlZGljYXRlKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICogVXNlZCB0byBnZXQgdGhlIGluZGV4IG9mIGEgZ2l2ZW4gZGF0YSBpdGVtLlxuICAgICAqL1xuICAgIGluZGV4T2YoaXRlbSwgc3RhcnRGcm9tID0gMCkge1xuICAgICAgICBsZXQgcHJlZGljYXRlID0gKGVsZW1lbnQpID0+IHtcbiAgICAgICAgICAgIHJldHVybiBlbGVtZW50ID09PSBpdGVtO1xuICAgICAgICB9O1xuICAgICAgICBpZiAodGhpcy5ncm91cGVkKSB7XG4gICAgICAgICAgICBwcmVkaWNhdGUgPSAoZWxlbWVudCkgPT4ge1xuICAgICAgICAgICAgICAgIHJldHVybiBlbGVtZW50LnZhbHVlID09PSBpdGVtO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5maW5kSW5kZXgocHJlZGljYXRlLCBzdGFydEZyb20pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICogVXNlZCB0byBnZXQgdGhlIGluZGV4IG9mIGEgZGF0YSBpdGVtIGJhc2VkIG9uIGFuIGV4cHJlc3Npb24uXG4gICAgICovXG4gICAgZmluZEluZGV4KHByZWRpY2F0ZSwgc3RhcnRGcm9tID0gMCkge1xuICAgICAgICBsZXQgaW5kZXggPSAtMTtcbiAgICAgICAgaWYgKHRoaXMuZ3JvdXBlZCkge1xuICAgICAgICAgICAgY29uc3QgZGF0YSA9IHRoaXMuX2ZsYXREYXRhLmZpbHRlcihpdGVtID0+ICFpdGVtLmhlYWRlciAmJiBpdGVtLm9mZnNldEluZGV4ID49IHN0YXJ0RnJvbSk7XG4gICAgICAgICAgICBpbmRleCA9IGRhdGEuZmluZEluZGV4KHByZWRpY2F0ZSk7XG4gICAgICAgICAgICBpbmRleCA9IGRhdGFbaW5kZXhdID8gZGF0YVtpbmRleF0ub2Zmc2V0SW5kZXggOiAtMTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLmRhdGEuc2xpY2Uoc3RhcnRGcm9tKTtcbiAgICAgICAgICAgIGNvbnN0IGl0ZW1JbmRleCA9IGRhdGEuZmluZEluZGV4KHByZWRpY2F0ZSk7XG4gICAgICAgICAgICBpbmRleCA9IGl0ZW1JbmRleCAhPT0gLTEgPyBpdGVtSW5kZXggKyBzdGFydEZyb20gOiAtMTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaW5kZXg7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKiBVc2VkIHRvIGdldCB0aGUgY2xvc2VzdCBncm91cCBoZWFkZXIgcHJpb3IgdG8gYW4gaXRlbSBpbmRleC5cbiAgICAgKi9cbiAgICBjbG9zZXN0R3JvdXAoaW5kZXgpIHtcbiAgICAgICAgZm9yIChsZXQgaSA9IGluZGV4OyBpID49IDA7IGktLSkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX2ZsYXREYXRhW2ldLmhlYWRlcikge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9mbGF0RGF0YVtpXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICogVXNlZCB0byBnZXQgdGhlIGZpcnN0IGl0ZW0gbWF0Y2hpbmcgdGhlIGNyaXRlcmlhLlxuICAgICAqL1xuICAgIGZpbmQocHJlZGljYXRlKSB7XG4gICAgICAgIGNvbnN0IGluZGV4ID0gdGhpcy5maW5kSW5kZXgocHJlZGljYXRlKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuaXRlbUF0KGluZGV4KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqIFVzZWQgdG8gZ2V0IHRoZSB0cnVlIGluZGV4IGluIGEgZmxhdHRlbmVkIGRhdGEgYXJyYXkuXG4gICAgICovXG4gICAgZmxhdEluZGV4KGluZGV4KSB7XG4gICAgICAgIGlmICh0aGlzLml0ZW1zQ291bnQgPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5ncm91cGVkKSB7XG4gICAgICAgICAgICBjb25zdCBtYXRjaCA9IHRoaXMuX2ZsYXREYXRhLmZpbmQoKGl0ZW0pID0+ICFpdGVtLmhlYWRlciAmJiBpdGVtLm9mZnNldEluZGV4ID09PSBpbmRleCk7XG4gICAgICAgICAgICBpZiAobWF0Y2gpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbWF0Y2guaW5kZXg7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gaW5kZXg7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIC0xO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICogVXNlZCB0byBnZXQgdGhlIGl0ZW0gYXQgdGhlIHByb3ZpZGVkIGluZGV4LlxuICAgICAqL1xuICAgIGl0ZW1BdChpbmRleCkge1xuICAgICAgICBsZXQgZGF0YUl0ZW07XG4gICAgICAgIGlmICh0aGlzLml0ZW1zQ291bnQgPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybiBkYXRhSXRlbTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5ncm91cGVkKSB7XG4gICAgICAgICAgICBjb25zdCBtYXRjaCA9IHRoaXMuX2ZsYXREYXRhLmZpbmQoKGl0ZW0pID0+ICFpdGVtLmhlYWRlciAmJiBpdGVtLm9mZnNldEluZGV4ID09PSBpbmRleCk7XG4gICAgICAgICAgICBpZiAobWF0Y2gpIHtcbiAgICAgICAgICAgICAgICBkYXRhSXRlbSA9IG1hdGNoLnZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgZGF0YUl0ZW0gPSB0aGlzLmRhdGFbaW5kZXhdO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBkYXRhSXRlbTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqIFVzZWQgdG8gZ2V0IHRoZSBncm91cCBhdCB0aGUgcHJvdmlkZWQgaW5kZXguXG4gICAgICovXG4gICAgZ3JvdXBBdChpbmRleCkge1xuICAgICAgICBpZiAodGhpcy5pdGVtc0NvdW50ID09PSAwIHx8ICF0aGlzLmlzR3JvdXBlZCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLl9mbGF0RGF0YS5maW5kKChpdGVtKSA9PiBpdGVtLmhlYWRlciAmJiBpdGVtLmluZGV4ID09PSBpbmRleCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKiBVc2VkIHRvIGdldCB0aGUgZmllbGQgYnkgd2hpY2ggdGhlIGRhdGEgaXMgZ3JvdXBlZC5cbiAgICAgKi9cbiAgICBncm91cEZpZWxkKCkge1xuICAgICAgICBpZiAodGhpcy5pdGVtc0NvdW50ID09PSAwIHx8ICF0aGlzLmlzR3JvdXBlZCkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuX2RhdGFbMF0uZmllbGQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKiBVc2VkIHRvIGdldCB0aGUgZ3JvdXAgdG8gd2hpY2ggYSBkYXRhSXRlbSBiZWxvbmdzLlxuICAgICAqL1xuICAgIGl0ZW1Hcm91cChpdGVtKSB7XG4gICAgICAgIGlmICghaXRlbSB8fCB0aGlzLml0ZW1zQ291bnQgPT09IDAgfHwgIXRoaXMuaXNHcm91cGVkKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgZmllbGROYW1lID0gdGhpcy5ncm91cEZpZWxkKCk7XG4gICAgICAgIGlmIChmaWVsZE5hbWUpIHtcbiAgICAgICAgICAgIHJldHVybiBnZXR0ZXIkMShpdGVtLCBmaWVsZE5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGZsYXR0ZW4oZGF0YSwgZ3JvdXAgPSB1bmRlZmluZWQsIG9mZnNldCA9IDAsIGdyb3VwSW5kZXggPSAwKSB7XG4gICAgICAgIGxldCBmbGF0ID0gW107XG4gICAgICAgIGlmIChpc1ByZXNlbnQoZ3JvdXApKSB7XG4gICAgICAgICAgICBmbGF0LnB1c2goe1xuICAgICAgICAgICAgICAgIGhlYWRlcjogdHJ1ZSxcbiAgICAgICAgICAgICAgICBpbmRleDogZ3JvdXBJbmRleCArIG9mZnNldCxcbiAgICAgICAgICAgICAgICBvZmZzZXRJbmRleDogZ3JvdXBJbmRleCxcbiAgICAgICAgICAgICAgICB2YWx1ZTogZ3JvdXBcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZGF0YS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgbGV0IHJlc3VsdCA9IFtdO1xuICAgICAgICAgICAgaWYgKGRhdGFbaV0uaXRlbXMpIHtcbiAgICAgICAgICAgICAgICByZXN1bHQgPSB0aGlzLmZsYXR0ZW4oZGF0YVtpXS5pdGVtcywgZGF0YVtpXS52YWx1ZSwgb2Zmc2V0LCBpKTtcbiAgICAgICAgICAgICAgICBvZmZzZXQgPSBvZmZzZXQgKyBkYXRhW2ldLml0ZW1zLmxlbmd0aDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgaGVhZGVyOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgaW5kZXg6IGdyb3VwSW5kZXggKyBvZmZzZXQgKyBpICsgMSxcbiAgICAgICAgICAgICAgICAgICAgb2Zmc2V0SW5kZXg6IG9mZnNldCArIGksXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBkYXRhW2ldXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmbGF0ID0gZmxhdC5jb25jYXQocmVzdWx0KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmxhdDtcbiAgICB9XG59O1xuRGF0YVNlcnZpY2UgPSBfX2RlY29yYXRlKFtcbiAgICBJbmplY3RhYmxlKClcbl0sIERhdGFTZXJ2aWNlKTtcblxuLyoqXG4gKiBAaGlkZGVuXG4gKi9cbmxldCBEaXNhYmxlZEl0ZW1zU2VydmljZSA9IGNsYXNzIERpc2FibGVkSXRlbXNTZXJ2aWNlIHtcbiAgICBjb25zdHJ1Y3RvcihkYXRhU2VydmljZSkge1xuICAgICAgICB0aGlzLmRhdGFTZXJ2aWNlID0gZGF0YVNlcnZpY2U7XG4gICAgICAgIHRoaXMuaXRlbURpc2FibGVkID0gbnVsbDtcbiAgICB9XG4gICAgaXNJbmRleERpc2FibGVkKGluZGV4KSB7XG4gICAgICAgIGlmICh0aGlzLml0ZW1EaXNhYmxlZCkge1xuICAgICAgICAgICAgY29uc3QgaXRlbSA9IHRoaXMuZGF0YVNlcnZpY2UuaXRlbUF0KGluZGV4KTtcbiAgICAgICAgICAgIGlmIChpc1ByZXNlbnQoaXRlbSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5pdGVtRGlzYWJsZWQoeyBkYXRhSXRlbTogaXRlbSwgaW5kZXggfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChpc1ByZXNlbnQodGhpcy5kZWZhdWx0SXRlbSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5pdGVtRGlzYWJsZWQoeyBkYXRhSXRlbTogdGhpcy5kZWZhdWx0SXRlbSwgaW5kZXg6IC0xIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGlzSXRlbURpc2FibGVkKGl0ZW0pIHtcbiAgICAgICAgaWYgKHRoaXMuaXRlbURpc2FibGVkKSB7XG4gICAgICAgICAgICBjb25zdCBpbmRleCA9IHRoaXMuZGF0YVNlcnZpY2UuaW5kZXhPZihpdGVtKTtcbiAgICAgICAgICAgIGlmIChpbmRleCAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5pdGVtRGlzYWJsZWQoeyBkYXRhSXRlbTogaXRlbSwgaW5kZXggfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChpc1ByZXNlbnQodGhpcy5kZWZhdWx0SXRlbSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5pdGVtRGlzYWJsZWQoeyBkYXRhSXRlbTogdGhpcy5kZWZhdWx0SXRlbSwgaW5kZXg6IC0xIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufTtcbkRpc2FibGVkSXRlbXNTZXJ2aWNlID0gX19kZWNvcmF0ZShbXG4gICAgSW5qZWN0YWJsZSgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246cGFyYW10eXBlc1wiLCBbRGF0YVNlcnZpY2VdKVxuXSwgRGlzYWJsZWRJdGVtc1NlcnZpY2UpO1xuXG5jb25zdCBNSU5fSU5ERVggPSAwO1xuLyoqXG4gKiBAaGlkZGVuXG4gKi9cbmNsYXNzIE5hdmlnYXRpb25FdmVudCB7XG4gICAgLyoqXG4gICAgICogVGhlIGluZGV4IG9mIHRoZSBpdGVtIHRvIHdoaWNoIHRoZSB1c2VyIG5hdmlnYXRlZC5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihpbmRleCwgb3JpZ2luYWxFdmVudCkge1xuICAgICAgICB0aGlzLmluZGV4ID0gaW5kZXg7XG4gICAgICAgIHRoaXMub3JpZ2luYWxFdmVudCA9IG9yaWdpbmFsRXZlbnQ7XG4gICAgfVxufVxuLyoqXG4gKiBAaGlkZGVuXG4gKi9cbmxldCBOYXZpZ2F0aW9uU2VydmljZSA9IGNsYXNzIE5hdmlnYXRpb25TZXJ2aWNlIHtcbiAgICBjb25zdHJ1Y3RvcihkaXNhYmxlZEl0ZW1zU2VydmljZSwgc2VsZWN0aW9uU2VydmljZSkge1xuICAgICAgICB0aGlzLmRpc2FibGVkSXRlbXNTZXJ2aWNlID0gZGlzYWJsZWRJdGVtc1NlcnZpY2U7XG4gICAgICAgIHRoaXMuc2VsZWN0aW9uU2VydmljZSA9IHNlbGVjdGlvblNlcnZpY2U7XG4gICAgICAgIHRoaXMub3BlbiA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcbiAgICAgICAgdGhpcy5jbG9zZSA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcbiAgICAgICAgdGhpcy5lbnRlciA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcbiAgICAgICAgdGhpcy50YWIgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gICAgICAgIHRoaXMuZXNjID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICAgICAgICB0aGlzLnVwID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICAgICAgICB0aGlzLnJpZ2h0ID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICAgICAgICB0aGlzLmRvd24gPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gICAgICAgIHRoaXMubGVmdCA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcbiAgICAgICAgdGhpcy5kZWxldGUgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gICAgICAgIHRoaXMuYmFja3NwYWNlID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICAgICAgICB0aGlzLmhvbWUgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gICAgICAgIHRoaXMuZW5kID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICAgIH1cbiAgICBwcm9jZXNzKGFyZ3MpIHtcbiAgICAgICAgY29uc3Qga2V5Q29kZSA9IGFyZ3Mub3JpZ2luYWxFdmVudC5rZXlDb2RlO1xuICAgICAgICBjb25zdCBhbHRLZXkgPSBhcmdzLm9yaWdpbmFsRXZlbnQuYWx0S2V5O1xuICAgICAgICBsZXQgaW5kZXg7XG4gICAgICAgIGxldCBhY3Rpb24gPSBOYXZpZ2F0aW9uQWN0aW9uLlVuZGVmaW5lZDtcbiAgICAgICAgaWYgKGFsdEtleSAmJiBrZXlDb2RlID09PSBLZXlzLkFycm93RG93bikge1xuICAgICAgICAgICAgYWN0aW9uID0gTmF2aWdhdGlvbkFjdGlvbi5PcGVuO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGFsdEtleSAmJiBrZXlDb2RlID09PSBLZXlzLkFycm93VXApIHtcbiAgICAgICAgICAgIGFjdGlvbiA9IE5hdmlnYXRpb25BY3Rpb24uQ2xvc2U7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoa2V5Q29kZSA9PT0gS2V5cy5FbnRlcikge1xuICAgICAgICAgICAgYWN0aW9uID0gTmF2aWdhdGlvbkFjdGlvbi5FbnRlcjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChrZXlDb2RlID09PSBLZXlzLkVzY2FwZSkge1xuICAgICAgICAgICAgYWN0aW9uID0gTmF2aWdhdGlvbkFjdGlvbi5Fc2M7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoa2V5Q29kZSA9PT0gS2V5cy5UYWIpIHtcbiAgICAgICAgICAgIGFjdGlvbiA9IE5hdmlnYXRpb25BY3Rpb24uVGFiO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGtleUNvZGUgPT09IEtleXMuQXJyb3dVcCkge1xuICAgICAgICAgICAgaW5kZXggPSB0aGlzLm5leHQoeyBjdXJyZW50OiBhcmdzLmN1cnJlbnQsIHN0YXJ0OiBhcmdzLm1pbiwgZW5kOiBhcmdzLm1heCwgc3RlcDogLTEgfSk7XG4gICAgICAgICAgICBhY3Rpb24gPSBOYXZpZ2F0aW9uQWN0aW9uLlVwO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGtleUNvZGUgPT09IEtleXMuQXJyb3dMZWZ0KSB7XG4gICAgICAgICAgICBpbmRleCA9IHRoaXMubmV4dCh7IGN1cnJlbnQ6IGFyZ3MuY3VycmVudCwgc3RhcnQ6IGFyZ3MubWluLCBlbmQ6IGFyZ3MubWF4LCBzdGVwOiAtMSB9KTtcbiAgICAgICAgICAgIGFjdGlvbiA9IE5hdmlnYXRpb25BY3Rpb24uTGVmdDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChrZXlDb2RlID09PSBLZXlzLkFycm93RG93bikge1xuICAgICAgICAgICAgaW5kZXggPSB0aGlzLm5leHQoeyBjdXJyZW50OiBhcmdzLmN1cnJlbnQsIHN0YXJ0OiBhcmdzLm1pbiwgZW5kOiBhcmdzLm1heCwgc3RlcDogMSB9KTtcbiAgICAgICAgICAgIGFjdGlvbiA9IE5hdmlnYXRpb25BY3Rpb24uRG93bjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChrZXlDb2RlID09PSBLZXlzLkFycm93UmlnaHQpIHtcbiAgICAgICAgICAgIGluZGV4ID0gdGhpcy5uZXh0KHsgY3VycmVudDogYXJncy5jdXJyZW50LCBzdGFydDogYXJncy5taW4sIGVuZDogYXJncy5tYXgsIHN0ZXA6IDEgfSk7XG4gICAgICAgICAgICBhY3Rpb24gPSBOYXZpZ2F0aW9uQWN0aW9uLlJpZ2h0O1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGtleUNvZGUgPT09IEtleXMuSG9tZSkge1xuICAgICAgICAgICAgaW5kZXggPSB0aGlzLmlzRGlzYWJsZWQoTUlOX0lOREVYKSA/IGFyZ3MuY3VycmVudCA6IE1JTl9JTkRFWDtcbiAgICAgICAgICAgIGFjdGlvbiA9IE5hdmlnYXRpb25BY3Rpb24uSG9tZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChrZXlDb2RlID09PSBLZXlzLkVuZCkge1xuICAgICAgICAgICAgaW5kZXggPSB0aGlzLmlzRGlzYWJsZWQoYXJncy5tYXgpID8gYXJncy5jdXJyZW50IDogYXJncy5tYXg7XG4gICAgICAgICAgICBhY3Rpb24gPSBOYXZpZ2F0aW9uQWN0aW9uLkVuZDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChrZXlDb2RlID09PSBLZXlzLkRlbGV0ZSkge1xuICAgICAgICAgICAgYWN0aW9uID0gTmF2aWdhdGlvbkFjdGlvbi5EZWxldGU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoa2V5Q29kZSA9PT0gS2V5cy5CYWNrc3BhY2UpIHtcbiAgICAgICAgICAgIGFjdGlvbiA9IE5hdmlnYXRpb25BY3Rpb24uQmFja3NwYWNlO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGV2ZW50RGF0YSA9IG5ldyBOYXZpZ2F0aW9uRXZlbnQoaW5kZXgsIGFyZ3Mub3JpZ2luYWxFdmVudCk7XG4gICAgICAgIGlmIChhY3Rpb24gIT09IE5hdmlnYXRpb25BY3Rpb24uVW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aGlzW05hdmlnYXRpb25BY3Rpb25bYWN0aW9uXS50b0xvd2VyQ2FzZSgpXS5lbWl0KGV2ZW50RGF0YSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGFjdGlvbjtcbiAgICB9XG4gICAgbmV4dChhcmdzKSB7XG4gICAgICAgIGNvbnN0IHsgY3VycmVudCwgc3RhcnQsIGVuZCwgc3RlcCB9ID0gYXJncztcbiAgICAgICAgY29uc3QgbmV4dEluZGV4ID0gIWlzUHJlc2VudChjdXJyZW50KSA/IHN0YXJ0IDogdGhpcy5jbGFtcEluZGV4KGN1cnJlbnQgKyBzdGVwLCBzdGFydCwgZW5kKTtcbiAgICAgICAgY29uc3QgZmlyc3RGb2N1c2FibGVJbmRleCA9IHRoaXMuZmlyc3RGb2N1c2FibGVJbmRleChuZXh0SW5kZXgsIHN0YXJ0LCBlbmQsIHN0ZXApO1xuICAgICAgICBpZiAoaXNQcmVzZW50KGZpcnN0Rm9jdXNhYmxlSW5kZXgpKSB7XG4gICAgICAgICAgICByZXR1cm4gZmlyc3RGb2N1c2FibGVJbmRleDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5zZWxlY3Rpb25TZXJ2aWNlLmlzU2VsZWN0ZWQoY3VycmVudCkgJiYgY3VycmVudCA+PSBzdGFydCkge1xuICAgICAgICAgICAgcmV0dXJuIGN1cnJlbnQ7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgaW52ZXJzZWRTdGVwID0gLTEgKiBzdGVwO1xuICAgICAgICByZXR1cm4gdGhpcy5maXJzdEZvY3VzYWJsZUluZGV4KG5leHRJbmRleCwgc3RhcnQsIGVuZCwgaW52ZXJzZWRTdGVwKTtcbiAgICB9XG4gICAgY2xhbXBJbmRleChpbmRleCwgbWluLCBtYXgpIHtcbiAgICAgICAgaWYgKCFpc1ByZXNlbnQoaW5kZXgpIHx8IGluZGV4IDwgbWluKSB7XG4gICAgICAgICAgICByZXR1cm4gbWluO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpbmRleCA+IG1heCkge1xuICAgICAgICAgICAgcmV0dXJuIG1heDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaW5kZXg7XG4gICAgfVxuICAgIGZpcnN0Rm9jdXNhYmxlSW5kZXgoc3RhcnRJbmRleCwgbWluLCBtYXgsIHN0ZXApIHtcbiAgICAgICAgd2hpbGUgKG1pbiA8PSBzdGFydEluZGV4ICYmIHN0YXJ0SW5kZXggPD0gbWF4KSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuaXNEaXNhYmxlZChzdGFydEluZGV4KSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBzdGFydEluZGV4O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc3RhcnRJbmRleCArPSBzdGVwO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuICAgIGlzRGlzYWJsZWQoaW5kZXgpIHtcbiAgICAgICAgaWYgKHRoaXMuZGlzYWJsZWRJdGVtc1NlcnZpY2UpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmRpc2FibGVkSXRlbXNTZXJ2aWNlLmlzSW5kZXhEaXNhYmxlZChpbmRleCk7XG4gICAgICAgIH1cbiAgICB9XG59O1xuTmF2aWdhdGlvblNlcnZpY2UgPSBfX2RlY29yYXRlKFtcbiAgICBJbmplY3RhYmxlKCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjpwYXJhbXR5cGVzXCIsIFtEaXNhYmxlZEl0ZW1zU2VydmljZSxcbiAgICAgICAgU2VsZWN0aW9uU2VydmljZV0pXG5dLCBOYXZpZ2F0aW9uU2VydmljZSk7XG5cbi8qKlxuICogUmVuZGVycyBjb250ZW50IHdoZW4gbm8gZGF0YSBpcyBhdmFpbGFibGUuIFRvIGRlZmluZSB0aGUgbm8tZGF0YSB0ZW1wbGF0ZSwgbmVzdCBhIGA8bmctdGVtcGxhdGU+YCB0YWdcbiAqIHdpdGggdGhlIGBrZW5kbzxDb21wb25lbnROYW1lPk5vRGF0YVRlbXBsYXRlYCBkaXJlY3RpdmUgaW5zaWRlIHRoZSBjb21wb25lbnQgdGFnLlxuICpcbiAqIC0gW1VzaW5nIGBOb0RhdGFUZW1wbGF0ZWAgd2l0aCB0aGUgQXV0b0NvbXBsZXRlXSh7JSBzbHVnIHRlbXBsYXRlc19hdXRvY29tcGxldGUgJX0jdG9jLW5vLWRhdGEtdGVtcGxhdGUpXG4gKiAtIFtVc2luZyBgTm9EYXRhVGVtcGxhdGVgIHdpdGggdGhlIENvbWJvQm94XSh7JSBzbHVnIHRlbXBsYXRlc19jb21ib2JveCAlfSN0b2Mtbm8tZGF0YS10ZW1wbGF0ZSlcbiAqIC0gW1VzaW5nIGBOb0RhdGFUZW1wbGF0ZWAgd2l0aCB0aGUgTXVsdGlDb2x1bW5Db21ib0JveF0oeyUgc2x1ZyB0ZW1wbGF0ZXNfbXVsdGljb2x1bW5jb21ib2JveCAlfSN0b2Mtbm8tZGF0YS10ZW1wbGF0ZSlcbiAqIC0gW1VzaW5nIGBOb0RhdGFUZW1wbGF0ZWAgd2l0aCB0aGUgRHJvcERvd25MaXN0XSh7JSBzbHVnIHRlbXBsYXRlc19kZGwgJX0jdG9jLW5vLWRhdGEtdGVtcGxhdGUpXG4gKiAtIFtVc2luZyBgTm9EYXRhVGVtcGxhdGVgIHdpdGggdGhlIERyb3BEb3duVHJlZV0oeyUgc2x1ZyB0ZW1wbGF0ZXNfZGR0ICV9I3RvYy1uby1kYXRhLXRlbXBsYXRlKVxuICogLSBbVXNpbmcgYE5vRGF0YVRlbXBsYXRlYCB3aXRoIHRoZSBNdWx0aVNlbGVjdF0oeyUgc2x1ZyB0ZW1wbGF0ZXNfbXVsdGlzZWxlY3QgJX0jdG9jLW5vLWRhdGEtdGVtcGxhdGUpXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYHRzXG4gKiBfQENvbXBvbmVudCh7XG4gKiBzZWxlY3RvcjogJ215LWFwcCcsXG4gKiB0ZW1wbGF0ZTogYFxuICogIDxrZW5kby1jb21ib2JveCBbZGF0YV09XCJsaXN0SXRlbXNcIj5cbiAqICAgIDxuZy10ZW1wbGF0ZSBrZW5kb0NvbWJvQm94Tm9EYXRhVGVtcGxhdGU+XG4gKiAgICAgIDxoND5ObyBkYXRhITwvaDQ+XG4gKiAgICA8L25nLXRlbXBsYXRlPlxuICogIDwva2VuZG8tY29tYm9ib3g+XG4gKiBgXG4gKiB9KVxuICogY2xhc3MgQXBwQ29tcG9uZW50IHtcbiAqICAgcHVibGljIGxpc3RJdGVtczogQXJyYXk8c3RyaW5nPiA9IFtdO1xuICogfVxuICogYGBgXG4gKi9cbmxldCBOb0RhdGFUZW1wbGF0ZURpcmVjdGl2ZSA9IGNsYXNzIE5vRGF0YVRlbXBsYXRlRGlyZWN0aXZlIHtcbiAgICBjb25zdHJ1Y3Rvcih0ZW1wbGF0ZVJlZikge1xuICAgICAgICB0aGlzLnRlbXBsYXRlUmVmID0gdGVtcGxhdGVSZWY7XG4gICAgfVxufTtcbk5vRGF0YVRlbXBsYXRlRGlyZWN0aXZlID0gX19kZWNvcmF0ZShbXG4gICAgRGlyZWN0aXZlKHtcbiAgICAgICAgc2VsZWN0b3I6ICdba2VuZG9Ecm9wRG93bkxpc3ROb0RhdGFUZW1wbGF0ZV0sW2tlbmRvRHJvcERvd25UcmVlTm9EYXRhVGVtcGxhdGVdLFtrZW5kb0NvbWJvQm94Tm9EYXRhVGVtcGxhdGVdLFtrZW5kb011bHRpQ29sdW1uQ29tYm9Cb3hOb0RhdGFUZW1wbGF0ZV0sW2tlbmRvQXV0b0NvbXBsZXRlTm9EYXRhVGVtcGxhdGVdLFtrZW5kb011bHRpU2VsZWN0Tm9EYXRhVGVtcGxhdGVdLFtrZW5kb011bHRpU2VsZWN0VHJlZU5vRGF0YVRlbXBsYXRlXSdcbiAgICB9KSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnBhcmFtdHlwZXNcIiwgW1RlbXBsYXRlUmVmXSlcbl0sIE5vRGF0YVRlbXBsYXRlRGlyZWN0aXZlKTtcblxuLyoqXG4gKiBAaGlkZGVuXG4gKi9cbmNsYXNzIFByZXZlbnRhYmxlRXZlbnQge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLnByZXZlbnRlZCA9IGZhbHNlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBQcmV2ZW50cyB0aGUgZGVmYXVsdCBhY3Rpb24gZm9yIGEgc3BlY2lmaWVkIGV2ZW50LlxuICAgICAqIEluIHRoaXMgd2F5LCB0aGUgc291cmNlIGNvbXBvbmVudCBzdXBwcmVzc2VzIHRoZSBidWlsdC1pbiBiZWhhdmlvciB0aGF0IGZvbGxvd3MgdGhlIGV2ZW50LlxuICAgICAqL1xuICAgIHByZXZlbnREZWZhdWx0KCkge1xuICAgICAgICB0aGlzLnByZXZlbnRlZCA9IHRydWU7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIElmIHRoZSBldmVudCBpcyBwcmV2ZW50ZWQgYnkgYW55IG9mIGl0cyBzdWJzY3JpYmVycywgcmV0dXJucyBgdHJ1ZWAuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyBgdHJ1ZWAgaWYgdGhlIGRlZmF1bHQgYWN0aW9uIHdhcyBwcmV2ZW50ZWQuIE90aGVyd2lzZSwgcmV0dXJucyBgZmFsc2VgLlxuICAgICAqL1xuICAgIGlzRGVmYXVsdFByZXZlbnRlZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJldmVudGVkO1xuICAgIH1cbn1cblxuLyoqXG4gKiBEZWZpbmVzIHRoZSBtYW5kYXRvcnkgcHJvcGVydGllcyBvZiB0aGUgYGtlbmRvRHJvcERvd25GaWx0ZXJgIGRpcmVjdGl2ZVxuICogc28gdGhhdCBga2VuZG9Ecm9wRG93bkZpbHRlcmAgY2FuIGJlIHVzZWQgd2l0aCBhbnkgb2YgdGhlIERyb3BEb3ducyBjb21wb25lbnRzXG4gKiB3aGljaCBpbXBsZW1lbnQgdGhlIGBGaWx0ZXJhYmxlRHJvcERvd25Db21wb25lbnRCYXNlYCBjbGFzcy5cbiAqXG4gKiBAaGlkZGVuXG4gKi9cbmNsYXNzIEZpbHRlcmFibGVDb21wb25lbnQge1xufVxuXG4vKipcbiAqIEBoaWRkZW5cbiAqL1xubGV0IExpc3RJdGVtRGlyZWN0aXZlID0gY2xhc3MgTGlzdEl0ZW1EaXJlY3RpdmUge1xuICAgIGNvbnN0cnVjdG9yKGVsZW1lbnQpIHtcbiAgICAgICAgdGhpcy5lbGVtZW50ID0gZWxlbWVudDtcbiAgICB9XG59O1xuTGlzdEl0ZW1EaXJlY3RpdmUgPSBfX2RlY29yYXRlKFtcbiAgICBEaXJlY3RpdmUoe1xuICAgICAgICBzZWxlY3RvcjogJ1wibGlbcm9sZT1vcHRpb25dLCBsaVtyb2xlPWdyb3VwXVwiJyAvLyB0c2xpbnQ6ZGlzYWJsZS1saW5lXG4gICAgfSksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjpwYXJhbXR5cGVzXCIsIFtFbGVtZW50UmVmXSlcbl0sIExpc3RJdGVtRGlyZWN0aXZlKTtcblxuLyoqXG4gKiBAaGlkZGVuXG4gKi9cbmxldCBMaXN0Q29tcG9uZW50ID0gY2xhc3MgTGlzdENvbXBvbmVudCB7XG4gICAgLyogdHNsaW50OmRpc2FibGU6bWVtYmVyLW9yZGVyaW5nICovXG4gICAgY29uc3RydWN0b3IoZGF0YVNlcnZpY2UsIHdyYXBwZXIsIHNlbGVjdGlvblNlcnZpY2UsIGRpc2FibGVkSXRlbXNTZXJ2aWNlLCBjZHIsIHpvbmUsIHJlbmRlcmVyKSB7XG4gICAgICAgIHRoaXMuZGF0YVNlcnZpY2UgPSBkYXRhU2VydmljZTtcbiAgICAgICAgdGhpcy53cmFwcGVyID0gd3JhcHBlcjtcbiAgICAgICAgdGhpcy5zZWxlY3Rpb25TZXJ2aWNlID0gc2VsZWN0aW9uU2VydmljZTtcbiAgICAgICAgdGhpcy5kaXNhYmxlZEl0ZW1zU2VydmljZSA9IGRpc2FibGVkSXRlbXNTZXJ2aWNlO1xuICAgICAgICB0aGlzLmNkciA9IGNkcjtcbiAgICAgICAgdGhpcy56b25lID0gem9uZTtcbiAgICAgICAgdGhpcy5yZW5kZXJlciA9IHJlbmRlcmVyO1xuICAgICAgICB0aGlzLnNlbGVjdGVkID0gW107XG4gICAgICAgIHRoaXMuZm9jdXNlZCA9IC0xO1xuICAgICAgICB0aGlzLnNob3cgPSB0cnVlO1xuICAgICAgICB0aGlzLm11bHRpcGxlU2VsZWN0aW9uID0gZmFsc2U7XG4gICAgICAgIHRoaXMudHlwZSA9ICdsaXN0JztcbiAgICAgICAgdGhpcy5jaGVja2JveGVzID0geyBlbmFibGVkOiBmYWxzZSB9O1xuICAgICAgICB0aGlzLnJvdW5kZWQgPSAnbWVkaXVtJztcbiAgICAgICAgdGhpcy5vbkNsaWNrID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICAgICAgICB0aGlzLnBhZ2VDaGFuZ2UgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gICAgICAgIHRoaXMubGlzdFJlc2l6ZSA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcbiAgICAgICAgdGhpcy5zdGFydEZyb20gPSAwO1xuICAgICAgICB0aGlzLmxhc3RMb2FkZWQgPSAwO1xuICAgICAgICB0aGlzLmxhc3RTY3JvbGxUb3AgPSAwO1xuICAgICAgICB0aGlzLnNjcm9sbFRvRm9jdXNlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLl9zaXplID0gJ21lZGl1bSc7XG4gICAgICAgIHRoaXMuc2VsZWN0U3Vic2NyaXB0aW9uID0gbWVyZ2UodGhpcy5zZWxlY3Rpb25TZXJ2aWNlLm9uU2VsZWN0LnBpcGUobWFwKChhcmdzKSA9PiBhcmdzLmluZGljZXNbMF0pKSwgdGhpcy5zZWxlY3Rpb25TZXJ2aWNlLm9uRm9jdXMpXG4gICAgICAgICAgICAucGlwZShcbiAgICAgICAgLy8gaGFuZGxlIG9ubHkgdGhlIHZlcnkgbGFzdCBvblNlbGVjdC9vbkZvY3VzIGVtaXNzaW9uXG4gICAgICAgIHN3aXRjaE1hcChldmVudCA9PiB0aGlzLnpvbmUub25TdGFibGUucGlwZSh0YWtlKDEpLCBtYXAoKCkgPT4gZXZlbnQpKSkpXG4gICAgICAgICAgICAuc3Vic2NyaWJlKHRoaXMuc2Nyb2xsVG9JdGVtLmJpbmQodGhpcykpO1xuICAgICAgICB0aGlzLnByZXBhcmVDbGFzc2VzKCk7XG4gICAgfVxuICAgIHNldCBkYXRhKGRhdGEpIHtcbiAgICAgICAgdGhpcy5fZGF0YSA9IGRhdGFbMF0gJiYgZGF0YVswXS5oZWFkZXIgPyBkYXRhLnNsaWNlKDApIDogZGF0YTtcbiAgICB9XG4gICAgZ2V0IGRhdGEoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9kYXRhO1xuICAgIH1cbiAgICBzZXQgc2l6ZShzaXplKSB7XG4gICAgICAgIGlmICh0aGlzLnR5cGUgPT09ICdsaXN0Jykge1xuICAgICAgICAgICAgdGhpcy5yZW5kZXJlci5yZW1vdmVDbGFzcyh0aGlzLndyYXBwZXIubmF0aXZlRWxlbWVudCwgZ2V0U2l6ZUNsYXNzKCdsaXN0JywgdGhpcy5zaXplKSk7XG4gICAgICAgICAgICBpZiAoc2l6ZSkge1xuICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyZXIuYWRkQ2xhc3ModGhpcy53cmFwcGVyLm5hdGl2ZUVsZW1lbnQsIGdldFNpemVDbGFzcygnbGlzdCcsIHNpemUpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuX3NpemUgPSBzaXplO1xuICAgICAgICB9XG4gICAgfVxuICAgIGdldCBzaXplKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fc2l6ZTtcbiAgICB9XG4gICAgZ2V0IHBhZ2VTaXplKCkge1xuICAgICAgICBpZiAodGhpcy52aXJ0dWFsLnBhZ2VTaXplKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy52aXJ0dWFsLnBhZ2VTaXplO1xuICAgICAgICB9XG4gICAgICAgIGxldCBzaXplID0gTWF0aC5yb3VuZCh0aGlzLmhlaWdodCAvIHRoaXMudmlydHVhbC5pdGVtSGVpZ2h0KTtcbiAgICAgICAgcmV0dXJuIHNpemU7XG4gICAgfVxuICAgIGdldCBzY3JvbGxIZWlnaHQoKSB7XG4gICAgICAgIHJldHVybiAodGhpcy5kYXRhU2VydmljZS5ncm91cGVkID8gdGhpcy52aXJ0dWFsLnRvdGFsIC0gMSA6IHRoaXMudmlydHVhbC50b3RhbCkgKiB0aGlzLnZpcnR1YWwuaXRlbUhlaWdodDtcbiAgICB9XG4gICAgZ2V0IG92ZXJmbG93WSgpIHtcbiAgICAgICAgaWYgKGlzUHJlc2VudCh0aGlzLnZpcnR1YWwpKSB7XG4gICAgICAgICAgICBjb25zdCBvdmVyZmxvdyA9IHRoaXMuaGFzVmlydHVhbFNjcm9sbGJhcigpID8gJ3Njcm9sbCcgOiAnaGlkZGVuJztcbiAgICAgICAgICAgIHJldHVybiBvdmVyZmxvdztcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgZ2V0IGNoZWNrYm94Q2xhc3NlcygpIHtcbiAgICAgICAgcmV0dXJuIGAke3RoaXMuc2l6ZSA/IGdldFNpemVDbGFzcygnY2hlY2tib3gnLCB0aGlzLnNpemUpIDogJyd9ICR7dGhpcy5yb3VuZGVkID8gZ2V0Um91bmRlZENsYXNzKHRoaXMucm91bmRlZCkgOiAnJ31gO1xuICAgIH1cbiAgICBuZ09uQ2hhbmdlcyhjaGFuZ2VzKSB7XG4gICAgICAgIGlmIChpc0NoYW5nZWQoJ2RhdGEnLCBjaGFuZ2VzLCBmYWxzZSkpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmxhc3RMb2FkZWQgPD0gMCkge1xuICAgICAgICAgICAgICAgIHRoaXMubGFzdExvYWRlZCA9IHRoaXMuZGF0YS5sZW5ndGggLSAxO1xuICAgICAgICAgICAgICAgIHRoaXMuc2Nyb2xsVG9Gb2N1c2VkID0gIWNoYW5nZXMuZGF0YS5pc0ZpcnN0Q2hhbmdlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnNldE92ZXJmbG93KCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlzQ2hhbmdlZCgndmlydHVhbCcsIGNoYW5nZXMsIGZhbHNlKSkge1xuICAgICAgICAgICAgdGhpcy5zZXRPdmVyZmxvdygpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpc0NoYW5nZWQoJ3R5cGUnLCBjaGFuZ2VzLCBmYWxzZSkpIHtcbiAgICAgICAgICAgIHRoaXMucHJlcGFyZUNsYXNzZXMoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBuZ0FmdGVyVmlld0luaXQoKSB7XG4gICAgICAgIHRoaXMuc2V0Q29tcG9uZW50Q2xhc3NlcygpO1xuICAgICAgICB0aGlzLnpvbmUucnVuT3V0c2lkZUFuZ3VsYXIoKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5zY3JvbGxTdWJzY3JpcHRpb24gPSBmcm9tRXZlbnQodGhpcy5jb250ZW50Lm5hdGl2ZUVsZW1lbnQsIFwic2Nyb2xsXCIpLnBpcGUoYXVkaXRUaW1lKDEwMCksIHRhcCh0aGlzLnByZWZldGNoRGF0YS5iaW5kKHRoaXMpKSwgdGFwKHRoaXMuZmluZEN1cnJlbnRHcm91cC5iaW5kKHRoaXMpKSkuc3Vic2NyaWJlKCgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmxhc3RTY3JvbGxUb3AgPSB0aGlzLmNvbnRlbnQubmF0aXZlRWxlbWVudC5zY3JvbGxUb3A7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuc2V0T3ZlcmZsb3coKTtcbiAgICB9XG4gICAgbmdBZnRlclZpZXdDaGVja2VkKCkge1xuICAgICAgICBpZiAodGhpcy52aXJ0dWFsKSB7XG4gICAgICAgICAgICB0aGlzLnBvc2l0aW9uSXRlbXMoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5pdGVtcyAmJiB0aGlzLnNjcm9sbFRvRm9jdXNlZCkge1xuICAgICAgICAgICAgdGhpcy5zY3JvbGxUb0ZvY3VzZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIGNvbnN0IHNjcm9sbFRhcmdldCA9IHRoaXMuaXRlbXMubGVuZ3RoICYmIHRoaXMuc2VsZWN0aW9uU2VydmljZS5mb2N1c2VkID09PSAtMSA/IDAgOiB0aGlzLnNlbGVjdGlvblNlcnZpY2UuZm9jdXNlZDtcbiAgICAgICAgICAgIHRoaXMuc2Nyb2xsVG9JdGVtKHNjcm9sbFRhcmdldCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuZGF0YVNlcnZpY2UuZ3JvdXBlZCkge1xuICAgICAgICAgICAgdGhpcy5maW5kQ3VycmVudEdyb3VwKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgbmdPbkRlc3Ryb3koKSB7XG4gICAgICAgIHRoaXMuc2VsZWN0U3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7XG4gICAgICAgIGlmICh0aGlzLnNjcm9sbFN1YnNjcmlwdGlvbikge1xuICAgICAgICAgICAgdGhpcy5zY3JvbGxTdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBvbkNoZWNrZWRDaGFuZ2UoZSwgaW5kZXgpIHtcbiAgICAgICAgY29uc3QgaXNDaGVja2VkID0gZS50YXJnZXRbJ2NoZWNrZWQnXTtcbiAgICAgICAgaWYgKGlzQ2hlY2tlZCAmJiAhdGhpcy5zZWxlY3Rpb25TZXJ2aWNlLmlzU2VsZWN0ZWQoaW5kZXgpKSB7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdGlvblNlcnZpY2UuYWRkKGluZGV4KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIWlzQ2hlY2tlZCAmJiB0aGlzLnNlbGVjdGlvblNlcnZpY2UuaXNTZWxlY3RlZChpbmRleCkpIHtcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0aW9uU2VydmljZS51bnNlbGVjdChpbmRleCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcHJlcGFyZUNsYXNzZXMoKSB7XG4gICAgICAgIGlmICh0aGlzLnR5cGUgPT09ICdsaXN0Jykge1xuICAgICAgICAgICAgdGhpcy5saXN0Q29udGVudENsYXNzID0gJ2stbGlzdC1jb250ZW50JztcbiAgICAgICAgICAgIHRoaXMubGlzdENsYXNzID0gJ2stbGlzdC11bCc7XG4gICAgICAgICAgICB0aGlzLmxpc3RJdGVtQ2xhc3MgPSAnay1saXN0LWl0ZW0nO1xuICAgICAgICAgICAgdGhpcy5saXN0VmlydHVhbENsYXNzID0gJ2stdmlydHVhbC1saXN0JztcbiAgICAgICAgICAgIHRoaXMubGlzdEdyb3VwU3RpY2t5SGVhZGVyQ2xhc3MgPSAnay1saXN0LWdyb3VwLXN0aWNreS1oZWFkZXInO1xuICAgICAgICAgICAgdGhpcy5saXN0R3JvdXBTdGlja3lIZWFkZXJUZXh0Q2xhc3MgPSAnay1saXN0LWhlYWRlci10ZXh0JztcbiAgICAgICAgICAgIHRoaXMubGlzdEdyb3VwSXRlbUNsYXNzID0gJ2stbGlzdC1ncm91cC1pdGVtJztcbiAgICAgICAgICAgIHRoaXMubGlzdEdyb3VwSXRlbVRleHRDbGFzcyA9ICdrLWxpc3QtaXRlbS10ZXh0JztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMubGlzdENvbnRlbnRDbGFzcyA9ICdrLXRhYmxlLWJvZHkgay10YWJsZS1zY3JvbGxlcic7XG4gICAgICAgICAgICB0aGlzLmxpc3RDbGFzcyA9ICdrLXRhYmxlIGstdGFibGUtbGlzdCc7XG4gICAgICAgICAgICB0aGlzLmxpc3RJdGVtQ2xhc3MgPSAnay10YWJsZS1yb3cnO1xuICAgICAgICAgICAgdGhpcy5saXN0VmlydHVhbENsYXNzID0gJ2stdmlydHVhbC10YWJsZSc7XG4gICAgICAgICAgICB0aGlzLmxpc3RHcm91cFN0aWNreUhlYWRlckNsYXNzID0gJ2stdGFibGUtZ3JvdXAtc3RpY2t5LWhlYWRlcic7XG4gICAgICAgICAgICB0aGlzLmxpc3RHcm91cFN0aWNreUhlYWRlclRleHRDbGFzcyA9ICdrLXRhYmxlLXRoJztcbiAgICAgICAgICAgIHRoaXMubGlzdEdyb3VwSXRlbUNsYXNzID0gJ2stdGFibGUtZ3JvdXAtcm93JztcbiAgICAgICAgICAgIHRoaXMubGlzdEdyb3VwSXRlbVRleHRDbGFzcyA9ICdrLXRhYmxlLXRoJztcbiAgICAgICAgfVxuICAgIH1cbiAgICBpc0NoZWNrZWQoaW5kZXgpIHtcbiAgICAgICAgY29uc3Qgbm9ybWFsaXplZEluZGV4ID0gdGhpcy52aXJ0dWFsID8gaW5kZXggKyB0aGlzLnZpcnR1YWwuc2tpcCA6IGluZGV4O1xuICAgICAgICByZXR1cm4gdGhpcy5zZWxlY3Rpb25TZXJ2aWNlLmlzU2VsZWN0ZWQobm9ybWFsaXplZEluZGV4KTtcbiAgICB9XG4gICAgZmlyc3RWaXNpYmxlSXRlbSgpIHtcbiAgICAgICAgY29uc3QgY29udGVudCA9IHRoaXMuY29udGVudC5uYXRpdmVFbGVtZW50O1xuICAgICAgICBjb25zdCByZWN0ID0gY29udGVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgICAgLy8gSUU5IGhhY2tcbiAgICAgICAgY29uc3QgZGlzYWJsZWQgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChjb250ZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuay1kaXNhYmxlZFwiKSk7XG4gICAgICAgIC8vIFRoaXMgaXMgYSB3b3JrYXJvdW5kIGZvciBmaW5kaW5nIGVsZW1lbnRzIHdpdGggcG9pbnRlci1ldmVudHM6IG5vbmU7XG4gICAgICAgIGRpc2FibGVkLmZvckVhY2goKGVsKSA9PiB0aGlzLnJlbmRlcmVyLnNldFN0eWxlKGVsLCBcInBvaW50ZXItZXZlbnRzXCIsIFwiYXV0b1wiKSk7XG4gICAgICAgIGNvbnN0IGl0ZW0gPSBkb2N1bWVudC5lbGVtZW50RnJvbVBvaW50KHJlY3QubGVmdCArIDEsIHJlY3QudG9wICsgMSk7XG4gICAgICAgIGRpc2FibGVkLmZvckVhY2goKGVsKSA9PiB0aGlzLnJlbmRlcmVyLnNldFN0eWxlKGVsLCBcInBvaW50ZXItZXZlbnRzXCIsIFwibm9uZVwiKSk7XG4gICAgICAgIC8vIHJldHVybiB0aGUgY2xvc2VzdCBgbGlgIGl0ZW0gdG8gY292ZXIgdGhlIGN1c3RvbSB0ZW1wbGF0ZSBzY2VuYXJpb1xuICAgICAgICByZXR1cm4gY2xvc2VzdChpdGVtLCAnbGknKTtcbiAgICB9XG4gICAgZmluZEN1cnJlbnRHcm91cCgpIHtcbiAgICAgICAgaWYgKCF0aGlzLmRhdGFTZXJ2aWNlLmdyb3VwZWQpIHtcbiAgICAgICAgICAgIHRoaXMuY3VycmVudEdyb3VwID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGl0ZW0gPSB0aGlzLmZpcnN0VmlzaWJsZUl0ZW0oKTtcbiAgICAgICAgaWYgKGl0ZW0pIHtcbiAgICAgICAgICAgIGxldCBpbmRleDtcbiAgICAgICAgICAgIGlmIChpdGVtLmdldEF0dHJpYnV0ZShcInJvbGVcIikgPT09IFwiZ3JvdXBcIikge1xuICAgICAgICAgICAgICAgIGluZGV4ID0gcGFyc2VJbnQoaXRlbS5nZXRBdHRyaWJ1dGUoXCJncm91cC1pbmRleFwiKSwgMTApO1xuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudEdyb3VwID0gdGhpcy5kYXRhU2VydmljZS5ncm91cEF0KGluZGV4KS52YWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGluZGV4ID0gcGFyc2VJbnQoaXRlbS5nZXRBdHRyaWJ1dGUoXCJpbmRleFwiKSwgMTApO1xuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudEdyb3VwID0gdGhpcy5kYXRhU2VydmljZS5pdGVtR3JvdXAodGhpcy5kYXRhU2VydmljZS5pdGVtQXQoaW5kZXgpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuY3VycmVudEdyb3VwID0gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuY2RyLmRldGVjdENoYW5nZXMoKTtcbiAgICB9XG4gICAgcHJlZmV0Y2hEYXRhKCkge1xuICAgICAgICBpZiAoIXRoaXMudmlydHVhbCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHZpc2libGVJdGVtcyA9IE1hdGgudHJ1bmModGhpcy5jb250ZW50Lm5hdGl2ZUVsZW1lbnQuY2xpZW50SGVpZ2h0IC8gdGhpcy52aXJ0dWFsLml0ZW1IZWlnaHQpO1xuICAgICAgICBjb25zdCBvZmZzZXRZID0gdGhpcy5jb250ZW50Lm5hdGl2ZUVsZW1lbnQuc2Nyb2xsVG9wO1xuICAgICAgICBjb25zdCBzdGFydCA9IE1hdGgudHJ1bmMob2Zmc2V0WSAvIHRoaXMudmlydHVhbC5pdGVtSGVpZ2h0KTtcbiAgICAgICAgY29uc3QgZG93biA9IG9mZnNldFkgPiB0aGlzLmxhc3RTY3JvbGxUb3A7XG4gICAgICAgIGNvbnN0IG5leHRQYWdlID0gKHN0YXJ0ICsgdmlzaWJsZUl0ZW1zID49IHRoaXMubGFzdExvYWRlZCkgJiYgdGhpcy5sYXN0TG9hZGVkIDwgdGhpcy52aXJ0dWFsLnRvdGFsIC0gMTtcbiAgICAgICAgY29uc3QgbGVmdE92ZXIgPSB0aGlzLnBhZ2VTaXplIC0gKHRoaXMubGFzdExvYWRlZCAtIHRoaXMuc3RhcnRGcm9tKTtcbiAgICAgICAgY29uc3QgcHJldlBhZ2UgPSB0aGlzLmxhc3RMb2FkZWQgLSB0aGlzLnBhZ2VTaXplICsgdmlzaWJsZUl0ZW1zID49IHN0YXJ0IC0gbGVmdE92ZXI7XG4gICAgICAgIGlmIChkb3duICYmIG5leHRQYWdlKSB7XG4gICAgICAgICAgICB0aGlzLmNoYW5nZVBhZ2Uoc3RhcnQpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghZG93biAmJiBwcmV2UGFnZSkge1xuICAgICAgICAgICAgdGhpcy5jaGFuZ2VQYWdlKHN0YXJ0IC0gdGhpcy5wYWdlU2l6ZSArIHZpc2libGVJdGVtcyArIDEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGNoYW5nZVBhZ2Uoc3RhcnQpIHtcbiAgICAgICAgdGhpcy56b25lLnJ1bigoKSA9PiB7XG4gICAgICAgICAgICBsZXQgZW5kID0gdGhpcy5wYWdlU2l6ZSArIHN0YXJ0O1xuICAgICAgICAgICAgaWYgKGVuZCA+IHRoaXMudmlydHVhbC50b3RhbCkge1xuICAgICAgICAgICAgICAgIHN0YXJ0LS07XG4gICAgICAgICAgICAgICAgZW5kID0gdGhpcy52aXJ0dWFsLnRvdGFsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHN0YXJ0IDwgMCkge1xuICAgICAgICAgICAgICAgIHN0YXJ0ID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuc3RhcnRGcm9tID0gc3RhcnQ7XG4gICAgICAgICAgICB0aGlzLmxhc3RMb2FkZWQgPSBlbmQ7XG4gICAgICAgICAgICB0aGlzLnBhZ2VDaGFuZ2UuZW1pdCh7IHNraXA6IHN0YXJ0LCB0YWtlOiB0aGlzLnBhZ2VTaXplIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgaW5kZXgoZ3JvdXBJbmRleCwgaXRlbUluZGV4KSB7XG4gICAgICAgIHJldHVybiBncm91cEluZGV4ID4gMCA/ICh0aGlzLmRhdGFTZXJ2aWNlLmdyb3VwSW5kaWNlc1tncm91cEluZGV4IC0gMV0gKyBpdGVtSW5kZXgpIDogaXRlbUluZGV4O1xuICAgIH1cbiAgICBnZXRUZXh0KGRhdGFJdGVtKSB7XG4gICAgICAgIHJldHVybiBnZXR0ZXIkMShkYXRhSXRlbSwgdGhpcy50ZXh0RmllbGQpO1xuICAgIH1cbiAgICBnZXRWYWx1ZShkYXRhSXRlbSkge1xuICAgICAgICByZXR1cm4gZ2V0dGVyJDEoZGF0YUl0ZW0sIHRoaXMudmFsdWVGaWVsZCk7XG4gICAgfVxuICAgIGlzRGlzYWJsZWQoaW5kZXgpIHtcbiAgICAgICAgaWYgKGlzUHJlc2VudCh0aGlzLnZpcnR1YWwpKSB7XG4gICAgICAgICAgICBpbmRleCArPSB0aGlzLnZpcnR1YWwuc2tpcDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5kaXNhYmxlZEl0ZW1zU2VydmljZS5pc0luZGV4RGlzYWJsZWQoaW5kZXgpO1xuICAgIH1cbiAgICBpc0FsdFJvdyhpbmRleCkge1xuICAgICAgICByZXR1cm4gdGhpcy50eXBlID09PSAnZHJvcGRvd25ncmlkJyAmJiBpbmRleCAlIDIgIT09IDA7XG4gICAgfVxuICAgIHNjcm9sbFRvSXRlbShpbmRleCkge1xuICAgICAgICBsZXQgZmxhdEluZGV4ID0gaW5kZXg7XG4gICAgICAgIGlmICh0aGlzLmRhdGFTZXJ2aWNlLmdyb3VwZWQpIHtcbiAgICAgICAgICAgIC8vIHRha2VzIGludG8gYWNjb3VudCB0aGUgZ3JvdXAgaGVhZGVyIGl0ZW1zXG4gICAgICAgICAgICBmbGF0SW5kZXggPSB0aGlzLmRhdGFTZXJ2aWNlLmZsYXRJbmRleChpbmRleCk7XG4gICAgICAgICAgICAvKiBUaGUgZmlyc3QgZ3JvdXAgaGVhZGVyIGl0ZW0gaXMgbm90IHJlbmRlcmVkIGluIHRoZSBsaXN0IChzZWUgdGVtcGxhdGUpLCBzbyBzdWJ0cmFjdCAxIHdoZW4gY2FsdWxhdGluZyB0aGUgZmxhdCBpbmRleC5cbiAgICAgICAgICAgICAgIFdpdGggdmlydHVhbGl6YXRpb24gZW5hYmxlZCwgdGhlIGZpcnN0IGdyb3VwIGhlYWRlciBjb3VsZCBiZSBpbiBhIHByZXZpb3VzIHBhZ2UsIGluIHdoaWNoIGNhc2UgZG9uJ3Qgc3VidHJhY3QgYW55dGhpbmcuICovXG4gICAgICAgICAgICBjb25zdCBncm91cEhlYWRlck9mZnNldCA9IHRoaXMuZmlyc3RHcm91cEhlYWRlckluVGFyZ2V0ZWRQYWdlKGZsYXRJbmRleCkgPyAtMSA6IDA7XG4gICAgICAgICAgICBmbGF0SW5kZXggKz0gZ3JvdXBIZWFkZXJPZmZzZXQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMudmlydHVhbCAmJiBmbGF0SW5kZXggPiAtMSkge1xuICAgICAgICAgICAgdGhpcy5zY3JvbGxUb0luZGV4KGZsYXRJbmRleCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgaXRlbXMgPSB0aGlzLml0ZW1zLnRvQXJyYXkoKTtcbiAgICAgICAgaWYgKGlzUHJlc2VudChpdGVtc1tmbGF0SW5kZXhdKSAmJiBmbGF0SW5kZXggIT09IC0xKSB7XG4gICAgICAgICAgICB0aGlzLnNjcm9sbChpdGVtc1tmbGF0SW5kZXhdLmVsZW1lbnQpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHNjcm9sbFRvSW5kZXgoaW5kZXgpIHtcbiAgICAgICAgbGV0IGNvbnRlbnQgPSB0aGlzLmNvbnRlbnQubmF0aXZlRWxlbWVudDtcbiAgICAgICAgbGV0IGNvbnRlbnRTY3JvbGxUb3AgPSBjb250ZW50LnNjcm9sbFRvcDtcbiAgICAgICAgY29uc3QgaXRlbU9mZnNldFRvcCA9IGluZGV4ICogdGhpcy52aXJ0dWFsLml0ZW1IZWlnaHQ7XG4gICAgICAgIGNvbnN0IGl0ZW1PZmZzZXRIZWlnaHQgPSB0aGlzLnZpcnR1YWwuaXRlbUhlaWdodDtcbiAgICAgICAgY29uc3QgY29udGVudE9mZnNldEhlaWdodCA9IGNvbnRlbnQuY2xpZW50SGVpZ2h0O1xuICAgICAgICBjb25zdCBib3R0b21EaXN0YW5jZSA9IGl0ZW1PZmZzZXRUb3AgKyBpdGVtT2Zmc2V0SGVpZ2h0O1xuICAgICAgICBpZiAoY29udGVudFNjcm9sbFRvcCA+IGl0ZW1PZmZzZXRUb3ApIHtcbiAgICAgICAgICAgIGNvbnRlbnRTY3JvbGxUb3AgPSBpdGVtT2Zmc2V0VG9wO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGJvdHRvbURpc3RhbmNlID4gKGNvbnRlbnRTY3JvbGxUb3AgKyBjb250ZW50T2Zmc2V0SGVpZ2h0KSkge1xuICAgICAgICAgICAgY29udGVudFNjcm9sbFRvcCA9IChib3R0b21EaXN0YW5jZSAtIGNvbnRlbnRPZmZzZXRIZWlnaHQpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnRlbnQuc2Nyb2xsVG9wID0gY29udGVudFNjcm9sbFRvcDtcbiAgICB9XG4gICAgc2Nyb2xsKGl0ZW0pIHtcbiAgICAgICAgaWYgKCFpdGVtKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgbmF0aXZlRWxlbWVudCA9IGl0ZW0ubmF0aXZlRWxlbWVudDtcbiAgICAgICAgbGV0IGNvbnRlbnQgPSB0aGlzLmNvbnRlbnQubmF0aXZlRWxlbWVudCwgaXRlbU9mZnNldFRvcCA9IG5hdGl2ZUVsZW1lbnQub2Zmc2V0VG9wLCBpdGVtT2Zmc2V0SGVpZ2h0ID0gbmF0aXZlRWxlbWVudC5vZmZzZXRIZWlnaHQsIGNvbnRlbnRTY3JvbGxUb3AgPSBjb250ZW50LnNjcm9sbFRvcCwgY29udGVudE9mZnNldEhlaWdodCA9IGNvbnRlbnQuY2xpZW50SGVpZ2h0LCBib3R0b21EaXN0YW5jZSA9IGl0ZW1PZmZzZXRUb3AgKyBpdGVtT2Zmc2V0SGVpZ2h0O1xuICAgICAgICBpZiAoY29udGVudFNjcm9sbFRvcCA+IGl0ZW1PZmZzZXRUb3ApIHtcbiAgICAgICAgICAgIGNvbnRlbnRTY3JvbGxUb3AgPSBpdGVtT2Zmc2V0VG9wO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGJvdHRvbURpc3RhbmNlID4gKGNvbnRlbnRTY3JvbGxUb3AgKyBjb250ZW50T2Zmc2V0SGVpZ2h0KSkge1xuICAgICAgICAgICAgY29udGVudFNjcm9sbFRvcCA9IChib3R0b21EaXN0YW5jZSAtIGNvbnRlbnRPZmZzZXRIZWlnaHQpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnRlbnQuc2Nyb2xsVG9wID0gY29udGVudFNjcm9sbFRvcDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogSW5kaWNhdGVzIHdoZXRoZXIgYSBzY3JvbGxiYXIgaXMgY3VycmVudGx5IHJlbmRlcmVkIGluIHRoZSBsaXN0LlxuICAgICAqL1xuICAgIGhhc1Njcm9sbGJhcigpIHtcbiAgICAgICAgaWYgKCEoaXNQcmVzZW50KHRoaXMuaXRlbXMpICYmIHRoaXMuaXRlbXMubGVuZ3RoICYmIGlzUHJlc2VudCh0aGlzLmxpc3QpICYmIGlzUHJlc2VudCh0aGlzLmNvbnRlbnQpKSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGhhc1ZpcnR1YWxTY3JvbGwgPSBpc1ByZXNlbnQodGhpcy52aXJ0dWFsKSAmJiB0aGlzLmhhc1ZpcnR1YWxTY3JvbGxiYXIoKTtcbiAgICAgICAgcmV0dXJuIGhhc1ZpcnR1YWxTY3JvbGwgfHwgdGhpcy5saXN0Lm5hdGl2ZUVsZW1lbnQuc2Nyb2xsSGVpZ2h0ID4gdGhpcy5jb250ZW50Lm5hdGl2ZUVsZW1lbnQub2Zmc2V0SGVpZ2h0O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZXRzIHRoZSBsaXN0J3MgY29udGVudCBvdmVyZmxvdyAoaGlkZXMvc2hvd3Mgc2Nyb2xsYmFyKVxuICAgICAqL1xuICAgIHNldE92ZXJmbG93KCkge1xuICAgICAgICBpZiAodGhpcy52aXJ0dWFsKSB7XG4gICAgICAgICAgICBjb25zdCBvdmVyZmxvdyA9IHRoaXMuaGFzVmlydHVhbFNjcm9sbGJhcigpID8gJ3Njcm9sbCcgOiAnaGlkZGVuJztcbiAgICAgICAgICAgIHRoaXMucmVuZGVyZXIuc2V0U3R5bGUodGhpcy5jb250ZW50Lm5hdGl2ZUVsZW1lbnQsICdvdmVyZmxvdy15Jywgb3ZlcmZsb3cpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEluZGljYXRlcyB3aGV0aGVyIHRoZSBzY3JvbGxiYXIgc2hvdWxkIGJlIHZpc2libGUgaW4gdmlydHVhbCBtb2RlLlxuICAgICAqL1xuICAgIGhhc1ZpcnR1YWxTY3JvbGxiYXIoKSB7XG4gICAgICAgIGNvbnN0IGNvbnRlbnRPZmZzZXRIZWlnaHQgPSB0aGlzLmNvbnRlbnQubmF0aXZlRWxlbWVudC5vZmZzZXRIZWlnaHQ7XG4gICAgICAgIGNvbnN0IHZpcnR1YWxPZmZzZXRIZWlnaHQgPSB0aGlzLnZpcnR1YWxDb250YWluZXIgJiYgdGhpcy52aXJ0dWFsQ29udGFpbmVyLm5hdGl2ZUVsZW1lbnQub2Zmc2V0SGVpZ2h0O1xuICAgICAgICByZXR1cm4gdGhpcy52aXJ0dWFsQ29udGFpbmVyICYmIHZpcnR1YWxPZmZzZXRIZWlnaHQgPiBjb250ZW50T2Zmc2V0SGVpZ2h0O1xuICAgIH1cbiAgICBwb3NpdGlvbkl0ZW1zKCkge1xuICAgICAgICB0aGlzLml0ZW1zLmZvckVhY2goKGl0ZW0sIGluZGV4KSA9PiB7XG4gICAgICAgICAgICBjb25zdCBvZmZzZXRZID0gKGluZGV4ICsgdGhpcy5zdGFydEZyb20pICogdGhpcy52aXJ0dWFsLml0ZW1IZWlnaHQ7XG4gICAgICAgICAgICB0aGlzLnJlbmRlcmVyLnNldFN0eWxlKGl0ZW0uZWxlbWVudC5uYXRpdmVFbGVtZW50LCBcInRyYW5zZm9ybVwiLCBgdHJhbnNsYXRlWSgke29mZnNldFl9cHhgKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEluZGljYXRlcyB3aGV0aGVyIHRoZSBmaXJzdCBncm91cCBoZWFkZXIgZnJvbSB0aGUgZGF0YSBzZXQgaXMgaW4gdGhlIHRhcmdldGVkIHZpcnR1YWwgcGFnZS5cbiAgICAgKi9cbiAgICBmaXJzdEdyb3VwSGVhZGVySW5UYXJnZXRlZFBhZ2UoaXRlbUluZGV4KSB7XG4gICAgICAgIGlmICghaXNQcmVzZW50KHRoaXMudmlydHVhbCkpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLnZpcnR1YWwuc2tpcCA9PT0gMCAmJiAodGhpcy52aXJ0dWFsLnBhZ2VTaXplID4gaXRlbUluZGV4KTtcbiAgICB9XG4gICAgc2V0Q29tcG9uZW50Q2xhc3NlcygpIHtcbiAgICAgICAgaWYgKHRoaXMudHlwZSA9PT0gJ2xpc3QnKSB7XG4gICAgICAgICAgICB0aGlzLnJlbmRlcmVyLmFkZENsYXNzKHRoaXMud3JhcHBlci5uYXRpdmVFbGVtZW50LCAnay1saXN0Jyk7XG4gICAgICAgICAgICBpZiAodGhpcy5zaXplKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJlci5hZGRDbGFzcyh0aGlzLndyYXBwZXIubmF0aXZlRWxlbWVudCwgZ2V0U2l6ZUNsYXNzKCdsaXN0JywgdGhpcy5zaXplKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlzUHJlc2VudCh0aGlzLnZpcnR1YWwpKSB7XG4gICAgICAgICAgICB0aGlzLnJlbmRlcmVyLmFkZENsYXNzKHRoaXMud3JhcHBlci5uYXRpdmVFbGVtZW50LCB0aGlzLmxpc3RWaXJ0dWFsQ2xhc3MpO1xuICAgICAgICB9XG4gICAgfVxufTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEFycmF5KVxuXSwgTGlzdENvbXBvbmVudC5wcm90b3R5cGUsIFwic2VsZWN0ZWRcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIE51bWJlcilcbl0sIExpc3RDb21wb25lbnQucHJvdG90eXBlLCBcImZvY3VzZWRcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIFN0cmluZylcbl0sIExpc3RDb21wb25lbnQucHJvdG90eXBlLCBcInRleHRGaWVsZFwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgSW5wdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgU3RyaW5nKVxuXSwgTGlzdENvbXBvbmVudC5wcm90b3R5cGUsIFwidmFsdWVGaWVsZFwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgSW5wdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgTnVtYmVyKVxuXSwgTGlzdENvbXBvbmVudC5wcm90b3R5cGUsIFwiaGVpZ2h0XCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBJbnB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBJdGVtVGVtcGxhdGVEaXJlY3RpdmUpXG5dLCBMaXN0Q29tcG9uZW50LnByb3RvdHlwZSwgXCJ0ZW1wbGF0ZVwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgSW5wdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgR3JvdXBUZW1wbGF0ZURpcmVjdGl2ZSlcbl0sIExpc3RDb21wb25lbnQucHJvdG90eXBlLCBcImdyb3VwVGVtcGxhdGVcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEZpeGVkR3JvdXBUZW1wbGF0ZURpcmVjdGl2ZSlcbl0sIExpc3RDb21wb25lbnQucHJvdG90eXBlLCBcImZpeGVkR3JvdXBUZW1wbGF0ZVwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgSW5wdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgQm9vbGVhbilcbl0sIExpc3RDb21wb25lbnQucHJvdG90eXBlLCBcInNob3dcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIFN0cmluZylcbl0sIExpc3RDb21wb25lbnQucHJvdG90eXBlLCBcImlkXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBJbnB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBTdHJpbmcpXG5dLCBMaXN0Q29tcG9uZW50LnByb3RvdHlwZSwgXCJvcHRpb25QcmVmaXhcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEJvb2xlYW4pXG5dLCBMaXN0Q29tcG9uZW50LnByb3RvdHlwZSwgXCJtdWx0aXBsZVNlbGVjdGlvblwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgSW5wdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgT2JqZWN0KVxuXSwgTGlzdENvbXBvbmVudC5wcm90b3R5cGUsIFwidmlydHVhbFwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgSW5wdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgU3RyaW5nKVxuXSwgTGlzdENvbXBvbmVudC5wcm90b3R5cGUsIFwidHlwZVwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgSW5wdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgT2JqZWN0KVxuXSwgTGlzdENvbXBvbmVudC5wcm90b3R5cGUsIFwiY2hlY2tib3hlc1wiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgSW5wdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgQXJyYXkpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246cGFyYW10eXBlc1wiLCBbQXJyYXldKVxuXSwgTGlzdENvbXBvbmVudC5wcm90b3R5cGUsIFwiZGF0YVwiLCBudWxsKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIFN0cmluZyksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjpwYXJhbXR5cGVzXCIsIFtTdHJpbmddKVxuXSwgTGlzdENvbXBvbmVudC5wcm90b3R5cGUsIFwic2l6ZVwiLCBudWxsKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIFN0cmluZylcbl0sIExpc3RDb21wb25lbnQucHJvdG90eXBlLCBcInJvdW5kZWRcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIE91dHB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBFdmVudEVtaXR0ZXIpXG5dLCBMaXN0Q29tcG9uZW50LnByb3RvdHlwZSwgXCJvbkNsaWNrXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBPdXRwdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgRXZlbnRFbWl0dGVyKVxuXSwgTGlzdENvbXBvbmVudC5wcm90b3R5cGUsIFwicGFnZUNoYW5nZVwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgT3V0cHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEV2ZW50RW1pdHRlcilcbl0sIExpc3RDb21wb25lbnQucHJvdG90eXBlLCBcImxpc3RSZXNpemVcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIFZpZXdDaGlsZHJlbihMaXN0SXRlbURpcmVjdGl2ZSksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIFF1ZXJ5TGlzdClcbl0sIExpc3RDb21wb25lbnQucHJvdG90eXBlLCBcIml0ZW1zXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBWaWV3Q2hpbGQoJ2NvbnRlbnQnLCB7IHN0YXRpYzogdHJ1ZSB9KSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgRWxlbWVudFJlZilcbl0sIExpc3RDb21wb25lbnQucHJvdG90eXBlLCBcImNvbnRlbnRcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIFZpZXdDaGlsZCgnbGlzdCcsIHsgc3RhdGljOiB0cnVlIH0pLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBFbGVtZW50UmVmKVxuXSwgTGlzdENvbXBvbmVudC5wcm90b3R5cGUsIFwibGlzdFwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgVmlld0NoaWxkKCd2aXJ0dWFsQ29udGFpbmVyJywgeyBzdGF0aWM6IGZhbHNlIH0pLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBFbGVtZW50UmVmKVxuXSwgTGlzdENvbXBvbmVudC5wcm90b3R5cGUsIFwidmlydHVhbENvbnRhaW5lclwiLCB2b2lkIDApO1xuTGlzdENvbXBvbmVudCA9IF9fZGVjb3JhdGUoW1xuICAgIENvbXBvbmVudCh7XG4gICAgICAgIHNlbGVjdG9yOiAna2VuZG8tbGlzdCcsXG4gICAgICAgIHRlbXBsYXRlOiBgXG4gICAgPGRpdiAqbmdJZj1cImRhdGFTZXJ2aWNlLmdyb3VwZWRcIlxuICAgICAgICBbY2xhc3NdPVwibGlzdEdyb3VwU3RpY2t5SGVhZGVyQ2xhc3NcIlxuICAgICAgICBbbmdTdHlsZV09XCJ7XG4gICAgICAgICAgICAnaGVpZ2h0LnB4JzogdmlydHVhbD8uaXRlbUhlaWdodCxcbiAgICAgICAgICAgICdtaW5IZWlnaHQucHgnIDogdmlydHVhbD8uaXRlbUhlaWdodCxcbiAgICAgICAgICAgICdib3hTaXppbmcnIDogdmlydHVhbCA/ICdib3JkZXItYm94JyA6ICdpbmhlcml0J31cIlxuICAgICAgICA+XG4gICAgICAgIDxuZy10ZW1wbGF0ZSAqbmdJZj1cImZpeGVkR3JvdXBUZW1wbGF0ZVwiXG4gICAgICAgICAgICBbdGVtcGxhdGVDb250ZXh0XT1cIntcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVJlZjogZml4ZWRHcm91cFRlbXBsYXRlLnRlbXBsYXRlUmVmLFxuICAgICAgICAgICAgICAgICRpbXBsaWNpdDogY3VycmVudEdyb3VwXG4gICAgICAgICAgICB9XCI+XG4gICAgICAgIDwvbmctdGVtcGxhdGU+XG4gICAgICAgIDxuZy10ZW1wbGF0ZSBbbmdJZl09XCIhZml4ZWRHcm91cFRlbXBsYXRlXCI+PHNwYW4gW2NsYXNzXT1cImxpc3RHcm91cFN0aWNreUhlYWRlclRleHRDbGFzc1wiPnt7IGN1cnJlbnRHcm91cCB9fTwvc3Bhbj48L25nLXRlbXBsYXRlPlxuICAgIDwvZGl2PlxuICAgIDxkaXYgI2NvbnRlbnRcbiAgICAgICAgW2NsYXNzXT1cImxpc3RDb250ZW50Q2xhc3NcIlxuICAgICAgICBbc3R5bGUub3ZlcnNjcm9sbEJlaGF2aW9yXT1cIidub25lJ1wiXG4gICAgICAgIFtzdHlsZS5tYXhIZWlnaHQucHhdPVwiaGVpZ2h0XCJcbiAgICAgICAgdW5zZWxlY3RhYmxlPVwib25cIj5cbiAgICA8dWwgI2xpc3RcbiAgICAgICAgcm9sZT1cImxpc3Rib3hcIlxuICAgICAgICBbY2xhc3NdPVwibGlzdENsYXNzXCJcbiAgICAgICAgW2F0dHIuaWRdPVwiaWRcIlxuICAgICAgICBbYXR0ci5hcmlhLWhpZGRlbl09XCIhc2hvd1wiPlxuICAgICAgICAgPG5nLXRlbXBsYXRlICpuZ0lmPVwiIWRhdGFTZXJ2aWNlLmdyb3VwZWQgJiYgc2hvd1wiIG5nRm9yIGxldC1kYXRhSXRlbSBsZXQtaXRlbUluZGV4PVwiaW5kZXhcIiBbbmdGb3JPZl09XCJkYXRhXCI+XG4gICAgICAgICAgICA8bGlcbiAgICAgICAgICAgICAgICByb2xlPVwib3B0aW9uXCJcbiAgICAgICAgICAgICAgICBrZW5kb0Ryb3BEb3duc1NlbGVjdGFibGVcbiAgICAgICAgICAgICAgICBbY2hlY2tib3hlc109XCJjaGVja2JveGVzXCJcbiAgICAgICAgICAgICAgICBbaGVpZ2h0XT1cInZpcnR1YWw/Lml0ZW1IZWlnaHRcIlxuICAgICAgICAgICAgICAgIFtpbmRleF09XCJpdGVtSW5kZXggKyBzdGFydEZyb21cIlxuICAgICAgICAgICAgICAgIFttdWx0aXBsZVNlbGVjdGlvbl09XCJtdWx0aXBsZVNlbGVjdGlvblwiXG4gICAgICAgICAgICAgICAgW2F0dHIuaWRdPVwib3B0aW9uUHJlZml4ICsgJy0nICsgZ2V0VmFsdWUoZGF0YUl0ZW0pXCJcbiAgICAgICAgICAgICAgICBbYXR0ci50YWJJbmRleF09XCItMVwiXG4gICAgICAgICAgICAgICAgW2NsYXNzXT1cImxpc3RJdGVtQ2xhc3NcIlxuICAgICAgICAgICAgICAgIFtuZ0NsYXNzXT1cIntcbiAgICAgICAgICAgICAgICAgICAgJ2stZGlzYWJsZWQnOiBpc0Rpc2FibGVkKGl0ZW1JbmRleCksXG4gICAgICAgICAgICAgICAgICAgICdrLXRhYmxlLWFsdC1yb3cnOiBpc0FsdFJvdyhpdGVtSW5kZXgpXG4gICAgICAgICAgICAgICAgfVwiXG4gICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgPGlucHV0XG4gICAgICAgICAgICAgICAgICAgICpuZ0lmPVwiY2hlY2tib3hlcy5lbmFibGVkXCJcbiAgICAgICAgICAgICAgICAgICAgdHlwZT1cImNoZWNrYm94XCJcbiAgICAgICAgICAgICAgICAgICAgY2xhc3M9XCJrLWNoZWNrYm94XCJcbiAgICAgICAgICAgICAgICAgICAgW25nQ2xhc3NdPVwiY2hlY2tib3hDbGFzc2VzXCJcbiAgICAgICAgICAgICAgICAgICAgKGNoYW5nZSk9XCJvbkNoZWNrZWRDaGFuZ2UoJGV2ZW50LCBpdGVtSW5kZXgpXCJcbiAgICAgICAgICAgICAgICAgICAgW2NoZWNrZWRdPVwiaXNDaGVja2VkKGl0ZW1JbmRleClcIlxuICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgPG5nLXRlbXBsYXRlICpuZ0lmPVwidGVtcGxhdGVcIlxuICAgICAgICAgICAgICAgICAgICBbdGVtcGxhdGVDb250ZXh0XT1cIntcbiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlUmVmOiB0ZW1wbGF0ZS50ZW1wbGF0ZVJlZixcbiAgICAgICAgICAgICAgICAgICAgICAgICRpbXBsaWNpdDogZGF0YUl0ZW1cbiAgICAgICAgICAgICAgICAgICAgfVwiPlxuICAgICAgICAgICAgICAgIDwvbmctdGVtcGxhdGU+XG4gICAgICAgICAgICAgICAgPG5nLXRlbXBsYXRlIFtuZ0lmXT1cIiF0ZW1wbGF0ZVwiPjxzcGFuIGNsYXNzPVwiay1saXN0LWl0ZW0tdGV4dFwiPnt7IGdldFRleHQoZGF0YUl0ZW0pIH19PC9zcGFuPjwvbmctdGVtcGxhdGU+XG4gICAgICAgICAgICA8L2xpPlxuICAgICAgICAgPC9uZy10ZW1wbGF0ZT5cbiAgICAgICAgIDxuZy10ZW1wbGF0ZSAqbmdJZj1cImRhdGFTZXJ2aWNlLmdyb3VwZWRcIiBuZ0ZvciBsZXQtZGF0YUl0ZW0gbGV0LWl0ZW1JbmRleD1cImluZGV4XCIgW25nRm9yT2ZdPVwiZGF0YVwiPlxuICAgICAgICAgICAgPGxpXG4gICAgICAgICAgICAgICAgKm5nSWY9XCJkYXRhSXRlbS5oZWFkZXIgJiYgZGF0YUl0ZW0uaW5kZXggPiAwXCJcbiAgICAgICAgICAgICAgICByb2xlPVwiZ3JvdXBcIlxuICAgICAgICAgICAgICAgIFtjbGFzc109XCJsaXN0R3JvdXBJdGVtQ2xhc3NcIlxuICAgICAgICAgICAgICAgIFtjbGFzcy5rLXRhYmxlLWFsdC1yb3ddPVwiaXNBbHRSb3coaXRlbUluZGV4IC0gMSlcIlxuICAgICAgICAgICAgICAgIFtuZ1N0eWxlXT1cIntcbiAgICAgICAgICAgICAgICAgICAgJ2hlaWdodC5weCc6IHZpcnR1YWw/Lml0ZW1IZWlnaHQsXG4gICAgICAgICAgICAgICAgICAgICdtaW5IZWlnaHQucHgnIDogdmlydHVhbD8uaXRlbUhlaWdodCxcbiAgICAgICAgICAgICAgICAgICAgJ2JveFNpemluZycgOiB2aXJ0dWFsID8gJ2JvcmRlci1ib3gnIDogJ2luaGVyaXQnfVwiXG4gICAgICAgICAgICAgICAgW2F0dHIuZ3JvdXAtaW5kZXhdPVwiZGF0YUl0ZW0uaW5kZXhcIlxuICAgICAgICAgICAgICAgIFthdHRyLmlkXT1cIm9wdGlvblByZWZpeCArICctJyArIGdldFZhbHVlKGRhdGFJdGVtLnZhbHVlKVwiXG4gICAgICAgICAgICAgICAgW2F0dHIudGFiSW5kZXhdPVwiLTFcIj5cbiAgICAgICAgICAgICAgICAgICAgPHNwYW4gW2NsYXNzXT1cImxpc3RHcm91cEl0ZW1UZXh0Q2xhc3NcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxuZy10ZW1wbGF0ZSAqbmdJZj1cImdyb3VwVGVtcGxhdGVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFt0ZW1wbGF0ZUNvbnRleHRdPVwie1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVJlZjogZ3JvdXBUZW1wbGF0ZS50ZW1wbGF0ZVJlZixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJGltcGxpY2l0OiBkYXRhSXRlbS52YWx1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgfVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9uZy10ZW1wbGF0ZT5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxuZy10ZW1wbGF0ZSBbbmdJZl09XCIhZ3JvdXBUZW1wbGF0ZVwiPnt7IGRhdGFJdGVtLnZhbHVlIH19PC9uZy10ZW1wbGF0ZT5cbiAgICAgICAgICAgICAgICAgICAgPC9zcGFuPlxuICAgICAgICAgICAgPC9saT5cbiAgICAgICAgICAgIDxsaVxuICAgICAgICAgICAgICAgICpuZ0lmPVwiIWRhdGFJdGVtLmhlYWRlclwiXG4gICAgICAgICAgICAgICAgcm9sZT1cIm9wdGlvblwiXG4gICAgICAgICAgICAgICAga2VuZG9Ecm9wRG93bnNTZWxlY3RhYmxlXG4gICAgICAgICAgICAgICAgW2hlaWdodF09XCJ2aXJ0dWFsPy5pdGVtSGVpZ2h0XCJcbiAgICAgICAgICAgICAgICBbaW5kZXhdPVwiZGF0YUl0ZW0ub2Zmc2V0SW5kZXhcIlxuICAgICAgICAgICAgICAgIFttdWx0aXBsZVNlbGVjdGlvbl09XCJtdWx0aXBsZVNlbGVjdGlvblwiXG4gICAgICAgICAgICAgICAgW2F0dHIuYWJzb2x1dGUtaW5kZXhdPVwiZGF0YUl0ZW0uaW5kZXhcIlxuICAgICAgICAgICAgICAgIFthdHRyLmlkXT1cIm9wdGlvblByZWZpeCArICctJyArIGdldFZhbHVlKGRhdGFJdGVtLnZhbHVlKVwiXG4gICAgICAgICAgICAgICAgW2F0dHIudGFiSW5kZXhdPVwiLTFcIlxuICAgICAgICAgICAgICAgIFtjbGFzc109XCJsaXN0SXRlbUNsYXNzXCJcbiAgICAgICAgICAgICAgICBbbmdDbGFzc109XCJ7XG4gICAgICAgICAgICAgICAgICAgICdrLWRpc2FibGVkJzogaXNEaXNhYmxlZChkYXRhSXRlbS5vZmZzZXRJbmRleCksXG4gICAgICAgICAgICAgICAgICAgICdrLXRhYmxlLWFsdC1yb3cnOiBpc0FsdFJvdyhpdGVtSW5kZXggLSAxKVxuICAgICAgICAgICAgICAgIH1cIlxuICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgIDxuZy10ZW1wbGF0ZSAqbmdJZj1cInRlbXBsYXRlXCJcbiAgICAgICAgICAgICAgICAgICAgW3RlbXBsYXRlQ29udGV4dF09XCJ7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVJlZjogdGVtcGxhdGUudGVtcGxhdGVSZWYsXG4gICAgICAgICAgICAgICAgICAgICAgICAkaW1wbGljaXQ6IGRhdGFJdGVtLnZhbHVlXG4gICAgICAgICAgICAgICAgICAgIH1cIj5cbiAgICAgICAgICAgICAgICA8L25nLXRlbXBsYXRlPlxuICAgICAgICAgICAgICAgIDxuZy10ZW1wbGF0ZSBbbmdJZl09XCIhdGVtcGxhdGVcIj48c3BhbiBjbGFzcz1cImstbGlzdC1pdGVtLXRleHRcIj57eyBnZXRUZXh0KGRhdGFJdGVtLnZhbHVlKSB9fTwvc3Bhbj48L25nLXRlbXBsYXRlPlxuICAgICAgICAgICAgPC9saT5cbiAgICAgICAgPC9uZy10ZW1wbGF0ZT5cbiAgICAgICAgPGtlbmRvLXJlc2l6ZS1zZW5zb3JcbiAgICAgICAgICAgICpuZ0lmPVwiIXZpcnR1YWxcIlxuICAgICAgICAgICAgKHJlc2l6ZSk9XCJsaXN0UmVzaXplLmVtaXQoKVwiXG4gICAgICAgID5cbiAgICAgICAgPC9rZW5kby1yZXNpemUtc2Vuc29yPlxuICAgIDwvdWw+XG4gICAgPGRpdiAqbmdJZj1cInZpcnR1YWxcIiAjdmlydHVhbENvbnRhaW5lciBjbGFzcz1cImstaGVpZ2h0LWNvbnRhaW5lclwiIHJvbGU9XCJwcmVzZW50YXRpb25cIj5cbiAgICAgICAgPGRpdiBbc3R5bGUuaGVpZ2h0LnB4XT1cInNjcm9sbEhlaWdodFwiPlxuICAgICAgICAgICAgPGtlbmRvLXJlc2l6ZS1zZW5zb3IgKHJlc2l6ZSk9XCJsaXN0UmVzaXplLmVtaXQoKVwiPjwva2VuZG8tcmVzaXplLXNlbnNvcj5cbiAgICAgICAgPC9kaXY+XG4gICAgPC9kaXY+XG4gICAgPC9kaXY+XG4gIGBcbiAgICB9KSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnBhcmFtdHlwZXNcIiwgW0RhdGFTZXJ2aWNlLFxuICAgICAgICBFbGVtZW50UmVmLFxuICAgICAgICBTZWxlY3Rpb25TZXJ2aWNlLFxuICAgICAgICBEaXNhYmxlZEl0ZW1zU2VydmljZSxcbiAgICAgICAgQ2hhbmdlRGV0ZWN0b3JSZWYsXG4gICAgICAgIE5nWm9uZSxcbiAgICAgICAgUmVuZGVyZXIyXSlcbl0sIExpc3RDb21wb25lbnQpO1xuXG4vKipcbiAqIEBoaWRkZW5cbiAqL1xuY29uc3QgREVGQVVMVFMgPSB7XG4gICAgcGFnZVNpemU6IDUwLFxuICAgIGl0ZW1IZWlnaHQ6IDI4XG59O1xuLyoqXG4gKiBAaGlkZGVuXG4gKi9cbmNvbnN0IG5vcm1hbGl6ZVZpcnR1YWxpemF0aW9uU2V0dGluZ3MgPSAoc2V0dGluZ3MsIGRlZmF1bHRPdmVycmlkZXMpID0+IHtcbiAgICBjb25zdCBkZWZhdWx0cyA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRTLCBkZWZhdWx0T3ZlcnJpZGVzKTtcbiAgICBpZiAoc2V0dGluZ3MgPT09IHRydWUpIHtcbiAgICAgICAgcmV0dXJuIGRlZmF1bHRzO1xuICAgIH1cbiAgICBpZiAoIXNldHRpbmdzKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICByZXR1cm4gT2JqZWN0LmFzc2lnbih7IHBhZ2VTaXplOiBERUZBVUxUUy5wYWdlU2l6ZSB9LCBzZXR0aW5ncyk7XG59O1xuXG4vKipcbiAqIEBoaWRkZW5cbiAqL1xuY29uc3QgVE9VQ0hfRU5BQkxFRCA9IG5ldyBJbmplY3Rpb25Ub2tlbignZHJvcGRvd25zLXRvdWNoLWVuYWJsZWQnKTtcblxuLyogdHNsaW50OmRpc2FibGU6bWVtYmVyLW9yZGVyaW5nICovXG52YXIgQXV0b0NvbXBsZXRlQ29tcG9uZW50XzE7XG5jb25zdCBOT19WQUxVRSA9IFwiXCI7XG4vKipcbiAqIEBoaWRkZW5cbiAqL1xuY29uc3QgQVVUT0NPTVBMRVRFX1ZBTFVFX0FDQ0VTU09SID0ge1xuICAgIG11bHRpOiB0cnVlLFxuICAgIHByb3ZpZGU6IE5HX1ZBTFVFX0FDQ0VTU09SLFxuICAgIHVzZUV4aXN0aW5nOiBmb3J3YXJkUmVmKCgpID0+IEF1dG9Db21wbGV0ZUNvbXBvbmVudClcbn07XG4vKipcbiAqIFJlcHJlc2VudHMgdGhlIFtLZW5kbyBVSSBBdXRvQ29tcGxldGUgY29tcG9uZW50IGZvciBBbmd1bGFyXSh7JSBzbHVnIG92ZXJ2aWV3X2F1dG9jb21wbGV0ZSAlfSkuXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYHRzXG4gKiBfQENvbXBvbmVudCh7XG4gKiBzZWxlY3RvcjogJ215LWFwcCcsXG4gKiB0ZW1wbGF0ZTogYFxuICogIDxrZW5kby1hdXRvY29tcGxldGVcbiAqICAgICAgW2RhdGFdPVwibGlzdEl0ZW1zXCJcbiAqICAgICAgW3BsYWNlaG9sZGVyXT1cInBsYWNlaG9sZGVyXCJcbiAqICA+XG4gKiBgXG4gKiB9KVxuICogY2xhc3MgQXBwQ29tcG9uZW50IHtcbiAqICAgcHVibGljIHBsYWNlaG9sZGVyOiBzdHJpbmcgPSAnVHlwZSBcIml0XCIgZm9yIHN1Z2dlc3Rpb25zJztcbiAqICAgcHVibGljIGxpc3RJdGVtczogQXJyYXk8c3RyaW5nPiA9IFtcIkl0ZW0gMVwiLCBcIkl0ZW0gMlwiLCBcIkl0ZW0gM1wiLCBcIkl0ZW0gNFwiXTtcbiAqIH1cbiAqIGBgYFxuICovXG5sZXQgQXV0b0NvbXBsZXRlQ29tcG9uZW50ID0gQXV0b0NvbXBsZXRlQ29tcG9uZW50XzEgPSBjbGFzcyBBdXRvQ29tcGxldGVDb21wb25lbnQge1xuICAgIGNvbnN0cnVjdG9yKGxvY2FsaXphdGlvbiwgZGF0YVNlcnZpY2UsIHBvcHVwU2VydmljZSwgc2VsZWN0aW9uU2VydmljZSwgbmF2aWdhdGlvblNlcnZpY2UsIGRpc2FibGVkSXRlbXNTZXJ2aWNlLCBfem9uZSwgY2RyLCByZW5kZXJlciwgaG9zdEVsZW1lbnQsIHRvdWNoRW5hYmxlZCQkMSkge1xuICAgICAgICB0aGlzLmxvY2FsaXphdGlvbiA9IGxvY2FsaXphdGlvbjtcbiAgICAgICAgdGhpcy5kYXRhU2VydmljZSA9IGRhdGFTZXJ2aWNlO1xuICAgICAgICB0aGlzLnBvcHVwU2VydmljZSA9IHBvcHVwU2VydmljZTtcbiAgICAgICAgdGhpcy5zZWxlY3Rpb25TZXJ2aWNlID0gc2VsZWN0aW9uU2VydmljZTtcbiAgICAgICAgdGhpcy5uYXZpZ2F0aW9uU2VydmljZSA9IG5hdmlnYXRpb25TZXJ2aWNlO1xuICAgICAgICB0aGlzLmRpc2FibGVkSXRlbXNTZXJ2aWNlID0gZGlzYWJsZWRJdGVtc1NlcnZpY2U7XG4gICAgICAgIHRoaXMuX3pvbmUgPSBfem9uZTtcbiAgICAgICAgdGhpcy5jZHIgPSBjZHI7XG4gICAgICAgIHRoaXMucmVuZGVyZXIgPSByZW5kZXJlcjtcbiAgICAgICAgdGhpcy5ob3N0RWxlbWVudCA9IGhvc3RFbGVtZW50O1xuICAgICAgICB0aGlzLnRvdWNoRW5hYmxlZCA9IHRvdWNoRW5hYmxlZCQkMTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIERlZmluZXMgd2hldGhlciB0aGUgZmlyc3QgbWF0Y2ggZnJvbSB0aGUgc3VnZ2VzdGlvbnMgbGlzdCB3aWxsIGJlIGF1dG9tYXRpY2FsbHkgZm9jdXNlZC5cbiAgICAgICAgICogQnkgZGVmYXVsdCwgYGhpZ2hsaWdodEZpcnN0YCBpcyBzZXQgdG8gYHRydWVgLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5oaWdobGlnaHRGaXJzdCA9IHRydWU7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAaGlkZGVuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmZvY3VzYWJsZUlkID0gYGstJHtndWlkJDEoKX1gO1xuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIGhpbnQgd2hpY2ggaXMgZGlzcGxheWVkIHdoZW4gdGhlIGNvbXBvbmVudCBpcyBlbXB0eS5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMucGxhY2Vob2xkZXIgPSBcIlwiO1xuICAgICAgICAvKipcbiAgICAgICAgICogU2V0cyB0aGUgaGVpZ2h0IG9mIHRoZSBzdWdnZXN0aW9ucyBsaXN0LiBCeSBkZWZhdWx0LCBgbGlzdEhlaWdodGAgaXMgMjAwcHguXG4gICAgICAgICAqXG4gICAgICAgICAqID4gVGhlIGBsaXN0SGVpZ2h0YCBwcm9wZXJ0eSBhZmZlY3RzIG9ubHkgdGhlIGxpc3Qgb2Ygc3VnZ2VzdGlvbnMgYW5kIG5vdCB0aGUgd2hvbGUgcG9wdXAgY29udGFpbmVyLlxuICAgICAgICAgKiA+IFRvIHNldCB0aGUgaGVpZ2h0IG9mIHRoZSBwb3B1cCBjb250YWluZXIsIHVzZSBgcG9wdXBTZXR0aW5ncy5oZWlnaHRgLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5saXN0SGVpZ2h0ID0gMjAwO1xuICAgICAgICAvKipcbiAgICAgICAgICogQGhpZGRlblxuICAgICAgICAgKlxuICAgICAgICAgKiBJZiBzZXQgdG8gYHRydWVgLCByZW5kZXJzIGEgYnV0dG9uIG9uIGhvdmVyaW5nIG92ZXIgdGhlIGNvbXBvbmVudC5cbiAgICAgICAgICogQ2xpY2tpbmcgdGhpcyBidXR0b24gcmVzZXRzIHRoZSB2YWx1ZSBvZiB0aGUgY29tcG9uZW50IHRvIGB1bmRlZmluZWRgIGFuZCB0cmlnZ2VycyB0aGUgYGNoYW5nZWAgZXZlbnQuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmNsZWFyQnV0dG9uID0gdHJ1ZTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFNldHMgdGhlIGRpc2FibGVkIHN0YXRlIG9mIHRoZSBjb21wb25lbnQuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmRpc2FibGVkID0gZmFsc2U7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBTZXRzIHRoZSByZWFkLW9ubHkgc3RhdGUgb2YgdGhlIGNvbXBvbmVudC5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMucmVhZG9ubHkgPSBmYWxzZTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFNwZWNpZmllcyB0aGUgW2B0YWJpbmRleGBdKGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0hUTUwvR2xvYmFsX2F0dHJpYnV0ZXMvdGFiaW5kZXgpIG9mIHRoZSBjb21wb25lbnQuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnRhYmluZGV4ID0gMDtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEVuYWJsZXMgdGhlIFtmaWx0ZXJpbmddKHslIHNsdWcgZmlsdGVyaW5nX2F1dG9jb21wbGV0ZSAlfSkgZnVuY3Rpb25hbGl0eS5cbiAgICAgICAgICogSWYgc2V0IHRvIGB0cnVlYCwgdGhlIGNvbXBvbmVudCBlbWl0cyB0aGUgYGZpbHRlckNoYW5nZWAgZXZlbnQuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmZpbHRlcmFibGUgPSBmYWxzZTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEZpcmVzIGVhY2ggdGltZSB0aGUgdmFsdWUgaXMgY2hhbmdlZCZtZGFzaDtcbiAgICAgICAgICogd2hlbiB0aGUgY29tcG9uZW50IGlzIGJsdXJyZWQgb3IgdGhlIHZhbHVlIGlzIGNsZWFyZWQgdGhyb3VnaCB0aGUgKipDbGVhcioqIGJ1dHRvblxuICAgICAgICAgKiAoW3NlZSBleGFtcGxlXSh7JSBzbHVnIG92ZXJ2aWV3X2F1dG9jb21wbGV0ZSAlfSN0b2MtZXZlbnRzKSkuXG4gICAgICAgICAqIFdoZW4gdGhlIHZhbHVlIG9mIHRoZSBjb21wb25lbnQgaXMgcHJvZ3JhbW1hdGljYWxseSBjaGFuZ2VkIHRvIGBuZ01vZGVsYCBvciBgZm9ybUNvbnRyb2xgXG4gICAgICAgICAqIHRocm91Z2ggaXRzIEFQSSBvciBmb3JtIGJpbmRpbmcsIHRoZSBgdmFsdWVDaGFuZ2VgIGV2ZW50IGlzIG5vdCB0cmlnZ2VyZWQgYmVjYXVzZSBpdFxuICAgICAgICAgKiBtaWdodCBjYXVzZSBhIG1peC11cCB3aXRoIHRoZSBidWlsdC1pbiBgdmFsdWVDaGFuZ2VgIG1lY2hhbmlzbXMgb2YgdGhlIGBuZ01vZGVsYCBvciBgZm9ybUNvbnRyb2xgIGJpbmRpbmdzLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy52YWx1ZUNoYW5nZSA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEZpcmVzIGVhY2ggdGltZSB0aGUgdXNlciB0eXBlcyBpbiB0aGUgaW5wdXQgZmllbGQuXG4gICAgICAgICAqIFlvdSBjYW4gZmlsdGVyIHRoZSBzb3VyY2UgYmFzZWQgb24gdGhlIHBhc3NlZCBmaWx0cmF0aW9uIHZhbHVlXG4gICAgICAgICAqIChbc2VlIGV4YW1wbGVdKHslIHNsdWcgb3ZlcnZpZXdfYXV0b2NvbXBsZXRlICV9I3RvYy1ldmVudHMpKS5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuZmlsdGVyQ2hhbmdlID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICAgICAgICAvKipcbiAgICAgICAgICogRmlyZXMgZWFjaCB0aW1lIHRoZSBwb3B1cCBpcyBhYm91dCB0byBvcGVuLlxuICAgICAgICAgKiBUaGlzIGV2ZW50IGlzIHByZXZlbnRhYmxlLiBJZiB5b3UgY2FuY2VsIGl0LCB0aGUgcG9wdXAgd2lsbCByZW1haW4gY2xvc2VkLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5vcGVuID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICAgICAgICAvKipcbiAgICAgICAgICogRmlyZXMgYWZ0ZXIgdGhlIHBvcHVwIGhhcyBiZWVuIG9wZW5lZC5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMub3BlbmVkID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICAgICAgICAvKipcbiAgICAgICAgICogRmlyZXMgZWFjaCB0aW1lIHRoZSBwb3B1cCBpcyBhYm91dCB0byBjbG9zZS5cbiAgICAgICAgICogVGhpcyBldmVudCBpcyBwcmV2ZW50YWJsZS4gSWYgeW91IGNhbmNlbCBpdCwgdGhlIHBvcHVwIHdpbGwgcmVtYWluIG9wZW4uXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmNsb3NlID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICAgICAgICAvKipcbiAgICAgICAgICogRmlyZXMgYWZ0ZXIgdGhlIHBvcHVwIGhhcyBiZWVuIGNsb3NlZC5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuY2xvc2VkID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICAgICAgICAvKipcbiAgICAgICAgICogRmlyZXMgZWFjaCB0aW1lIHRoZSB1c2VyIGZvY3VzZXMgdGhlIEF1dG9Db21wbGV0ZS5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMub25Gb2N1cyA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEZpcmVzIGVhY2ggdGltZSB0aGUgQXV0b0NvbXBsZXRlIGdldHMgYmx1cnJlZC5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMub25CbHVyID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICAgICAgICB0aGlzLndpZGdldENsYXNzZXMgPSB0cnVlO1xuICAgICAgICB0aGlzLmxpc3RCb3hJZCA9IGd1aWQkMSgpO1xuICAgICAgICB0aGlzLm9wdGlvblByZWZpeCA9IGd1aWQkMSgpO1xuICAgICAgICB0aGlzLm9uQ2hhbmdlQ2FsbGJhY2sgPSBub29wO1xuICAgICAgICB0aGlzLm9uVG91Y2hlZENhbGxiYWNrID0gbm9vcDtcbiAgICAgICAgdGhpcy5wb3B1cE1vdXNlRG93bkhhbmRsZXIgPSAoZXZlbnQpID0+IGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIHRoaXMuX3BvcHVwU2V0dGluZ3MgPSB7IGFuaW1hdGU6IHRydWUgfTtcbiAgICAgICAgdGhpcy5fb3BlbiA9IGZhbHNlO1xuICAgICAgICB0aGlzLl92YWx1ZSA9IFwiXCI7XG4gICAgICAgIHRoaXMudmFsdWVDaGFuZ2VTdWJqZWN0ID0gbmV3IFN1YmplY3QoKTtcbiAgICAgICAgdGhpcy5faXNGb2N1c2VkID0gZmFsc2U7XG4gICAgICAgIHRoaXMuX3NpemUgPSAnbWVkaXVtJztcbiAgICAgICAgdGhpcy5fcm91bmRlZCA9ICdtZWRpdW0nO1xuICAgICAgICB0aGlzLl9maWxsTW9kZSA9ICdzb2xpZCc7XG4gICAgICAgIHZhbGlkYXRlUGFja2FnZShwYWNrYWdlTWV0YWRhdGEpO1xuICAgICAgICB0aGlzLmRpcmVjdGlvbiA9IGxvY2FsaXphdGlvbi5ydGwgPyAncnRsJyA6ICdsdHInO1xuICAgICAgICB0aGlzLndyYXBwZXIgPSB0aGlzLmhvc3RFbGVtZW50Lm5hdGl2ZUVsZW1lbnQ7XG4gICAgICAgIHRoaXMuZGF0YSA9IFtdO1xuICAgICAgICB0aGlzLnN1YnNjcmliZUV2ZW50cygpO1xuICAgICAgICB0aGlzLnN1YnNjcmliZVRvdWNoRXZlbnRzKCk7XG4gICAgICAgIHRoaXMuc2VsZWN0aW9uU2VydmljZS5yZXNldFNlbGVjdGlvbihbLTFdKTtcbiAgICB9XG4gICAgZ2V0IHdpZHRoKCkge1xuICAgICAgICBsZXQgd3JhcHBlck9mZnNldFdpZHRoID0gMDtcbiAgICAgICAgaWYgKGlzRG9jdW1lbnRBdmFpbGFibGUoKSkge1xuICAgICAgICAgICAgd3JhcHBlck9mZnNldFdpZHRoID0gdGhpcy53cmFwcGVyLm9mZnNldFdpZHRoO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHdpZHRoID0gdGhpcy5wb3B1cFNldHRpbmdzLndpZHRoIHx8IHdyYXBwZXJPZmZzZXRXaWR0aDtcbiAgICAgICAgY29uc3QgbWluV2lkdGggPSBpc05hTih3cmFwcGVyT2Zmc2V0V2lkdGgpID8gd3JhcHBlck9mZnNldFdpZHRoIDogYCR7d3JhcHBlck9mZnNldFdpZHRofXB4YDtcbiAgICAgICAgY29uc3QgbWF4V2lkdGggPSBpc05hTih3aWR0aCkgPyB3aWR0aCA6IGAke3dpZHRofXB4YDtcbiAgICAgICAgcmV0dXJuIHsgbWluOiBtaW5XaWR0aCwgbWF4OiBtYXhXaWR0aCB9O1xuICAgIH1cbiAgICBnZXQgaGVpZ2h0KCkge1xuICAgICAgICBjb25zdCBwb3B1cEhlaWdodCA9IHRoaXMucG9wdXBTZXR0aW5ncy5oZWlnaHQ7XG4gICAgICAgIHJldHVybiBpc1ByZXNlbnQocG9wdXBIZWlnaHQpID8gYCR7cG9wdXBIZWlnaHR9cHhgIDogJ2F1dG8nO1xuICAgIH1cbiAgICBnZXQgbGlzdENvbnRhaW5lckNsYXNzZXMoKSB7XG4gICAgICAgIGNvbnN0IGNvbnRhaW5lckNsYXNzZXMgPSBbJ2stbGlzdC1jb250YWluZXInLCAnay1yZXNldCddO1xuICAgICAgICBpZiAodGhpcy5wb3B1cFNldHRpbmdzLnBvcHVwQ2xhc3MpIHtcbiAgICAgICAgICAgIGNvbnRhaW5lckNsYXNzZXMucHVzaCh0aGlzLnBvcHVwU2V0dGluZ3MucG9wdXBDbGFzcyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNvbnRhaW5lckNsYXNzZXM7XG4gICAgfVxuICAgIGdldCBzdWdnZXN0aW9uKCkge1xuICAgICAgICBpZiAoIXRoaXMudGV4dCB8fCAhdGhpcy5zdWdnZXN0ZWRUZXh0KSB7XG4gICAgICAgICAgICB0aGlzLnN1Z2dlc3RlZFRleHQgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgaGFzTWF0Y2ggPSB0aGlzLnN1Z2dlc3RlZFRleHQudG9Mb3dlckNhc2UoKS5zdGFydHNXaXRoKHRoaXMudGV4dC50b0xvd2VyQ2FzZSgpKTtcbiAgICAgICAgY29uc3Qgc2hvdWxkU3VnZ2VzdCA9IHRoaXMuc3VnZ2VzdCAmJiAhdGhpcy5iYWNrc3BhY2VQcmVzc2VkO1xuICAgICAgICBpZiAoc2hvdWxkU3VnZ2VzdCAmJiBoYXNNYXRjaCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3VnZ2VzdGVkVGV4dDtcbiAgICAgICAgfVxuICAgIH1cbiAgICBnZXQgYXBwZW5kVG8oKSB7XG4gICAgICAgIGNvbnN0IHsgYXBwZW5kVG8gfSA9IHRoaXMucG9wdXBTZXR0aW5ncztcbiAgICAgICAgaWYgKCFhcHBlbmRUbyB8fCBhcHBlbmRUbyA9PT0gJ3Jvb3QnKSB7XG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhcHBlbmRUbyA9PT0gJ2NvbXBvbmVudCcgPyB0aGlzLmNvbnRhaW5lciA6IGFwcGVuZFRvO1xuICAgIH1cbiAgICBnZXQgY2xlYXJCdXR0b25WaXNpYmxpdHkoKSB7XG4gICAgICAgIGlmICh0aGlzLnRvdWNoRW5hYmxlZCkge1xuICAgICAgICAgICAgcmV0dXJuICd2aXNpYmxlJztcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBUb2dnbGVzIHRoZSB2aXNpYmlsaXR5IG9mIHRoZSBwb3B1cC5cbiAgICAgKiBJZiB5b3UgdXNlIHRoZSBgdG9nZ2xlYCBtZXRob2QgdG8gb3BlbiBvciBjbG9zZSB0aGUgcG9wdXAsIHRoZSBgb3BlbmAgYW5kIGBjbG9zZWAgZXZlbnRzIHdpbGwgbm90IGJlIGZpcmVkLlxuICAgICAqXG4gICAgICogQHBhcmFtIG9wZW4gLSBUaGUgc3RhdGUgb2YgdGhlIHBvcHVwLlxuICAgICAqL1xuICAgIHRvZ2dsZShvcGVuKSB7XG4gICAgICAgIFByb21pc2UucmVzb2x2ZShudWxsKS50aGVuKCgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHNob3VsZE9wZW4gPSBpc1ByZXNlbnQob3BlbikgPyBvcGVuIDogIXRoaXMuX29wZW47XG4gICAgICAgICAgICB0aGlzLl90b2dnbGUoc2hvdWxkT3Blbik7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRoZSBjdXJyZW50IG9wZW4gc3RhdGUgb2YgdGhlIHBvcHVwLlxuICAgICAqL1xuICAgIGdldCBpc09wZW4oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9vcGVuO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgdG9nZ2xlUG9wdXAob3Blbikge1xuICAgICAgICBjb25zdCBpc0Rpc2FibGVkID0gdGhpcy5kaXNhYmxlZCB8fCB0aGlzLnJlYWRvbmx5O1xuICAgICAgICBjb25zdCBzYW1lU3RhdGUgPSB0aGlzLmlzT3BlbiA9PT0gb3BlbjtcbiAgICAgICAgaWYgKGlzRGlzYWJsZWQgfHwgc2FtZVN0YXRlKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgaXNEZWZhdWx0UHJldmVudGVkID0gdGhpcy50cmlnZ2VyUG9wdXBFdmVudHMob3Blbik7XG4gICAgICAgIGlmICghaXNEZWZhdWx0UHJldmVudGVkKSB7XG4gICAgICAgICAgICB0aGlzLl90b2dnbGUob3Blbik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZ2V0IGFjdGl2ZURlc2NlbmRhbnQoKSB7XG4gICAgICAgIGlmICghdGhpcy5pc09wZW4gfHwgIWlzUHJlc2VudCh0aGlzLnNlbGVjdGlvblNlcnZpY2UuZm9jdXNlZCkgfHwgdGhpcy5zZWxlY3Rpb25TZXJ2aWNlLmZvY3VzZWQgPT09IC0xKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBkYXRhSXRlbSA9IHRoaXMuZGF0YVNlcnZpY2UuaXRlbUF0KHRoaXMuc2VsZWN0aW9uU2VydmljZS5mb2N1c2VkKTtcbiAgICAgICAgcmV0dXJuIHRoaXMub3B0aW9uUHJlZml4ICsgXCItXCIgKyBnZXR0ZXIkMShkYXRhSXRlbSwgdGhpcy52YWx1ZUZpZWxkKTtcbiAgICB9XG4gICAgZ2V0IG5vRGF0YUxhYmVsKCkge1xuICAgICAgICBpZiAodGhpcy5kYXRhLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMubWVzc2FnZUZvcignbm9EYXRhVGV4dCcpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNldHMgdGhlIGRhdGEgb2YgdGhlIEF1dG9Db21wbGV0ZS5cbiAgICAgKlxuICAgICAqID4gVGhlIGRhdGEgaGFzIHRvIGJlIHByb3ZpZGVkIGluIGFuIGFycmF5LWxpa2UgbGlzdC5cbiAgICAgKi9cbiAgICBzZXQgZGF0YShkYXRhKSB7XG4gICAgICAgIHRoaXMuZGF0YVNlcnZpY2UuZGF0YSA9IGRhdGEgfHwgW107XG4gICAgICAgIGlmICh0aGlzLnZpcnR1YWwpIHtcbiAgICAgICAgICAgIHRoaXMudmlydHVhbC5za2lwID0gMDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5maWx0ZXJhYmxlKSB7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdGlvblNlcnZpY2UuZm9jdXNlZCA9IHRoaXMuaXNPcGVuICYmIHRoaXMuZGF0YS5sZW5ndGggJiYgdGhpcy5oaWdobGlnaHRGaXJzdCA/IHRoaXMuZmlyc3RGb2N1c2FibGVJbmRleCgwKSA6IC0xO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnN1Z2dlc3QgJiYgdGhpcy5kYXRhU2VydmljZS5pdGVtc0NvdW50ID4gMCkge1xuICAgICAgICAgICAgdGhpcy5zdWdnZXN0ZWRUZXh0ID0gZ2V0dGVyJDEodGhpcy5kYXRhU2VydmljZS5pdGVtQXQoMCksIHRoaXMudmFsdWVGaWVsZCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZ2V0IGRhdGEoKSB7XG4gICAgICAgIGNvbnN0IHZpcnR1YWwgPSB0aGlzLnZpcnR1YWw7XG4gICAgICAgIGlmICh2aXJ0dWFsKSB7XG4gICAgICAgICAgICBjb25zdCBzdGFydCA9IHZpcnR1YWwuc2tpcCB8fCAwO1xuICAgICAgICAgICAgY29uc3QgZW5kID0gc3RhcnQgKyB2aXJ0dWFsLnBhZ2VTaXplO1xuICAgICAgICAgICAgLy8gVXNlIGxlbmd0aCBpbnN0ZWFkIG9mIGl0ZW1zQ291bnQgYmVjYXVzZSBvZiB0aGUgZ3JvdXBpbmcuXG4gICAgICAgICAgICB2aXJ0dWFsLnRvdGFsID0gdGhpcy5kYXRhU2VydmljZS5kYXRhLmxlbmd0aDtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmRhdGFTZXJ2aWNlLmRhdGEuc2xpY2Uoc3RhcnQsIGVuZCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuZGF0YVNlcnZpY2UuZGF0YTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2V0cyB0aGUgdmFsdWUgb2YgdGhlIEF1dG9Db21wbGV0ZS5cbiAgICAgKi9cbiAgICBzZXQgdmFsdWUobmV3VmFsdWUpIHtcbiAgICAgICAgdGhpcy52ZXJpZnlTZXR0aW5ncyhuZXdWYWx1ZSk7XG4gICAgICAgIHRoaXMuX3ZhbHVlID0gbmV3VmFsdWUgfHwgTk9fVkFMVUU7XG4gICAgICAgIHRoaXMudGV4dCA9IHRoaXMudmFsdWU7XG4gICAgICAgIHRoaXMuY2RyLm1hcmtGb3JDaGVjaygpO1xuICAgIH1cbiAgICBnZXQgdmFsdWUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl92YWx1ZSB8fCBOT19WQUxVRTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ29uZmlndXJlcyB0aGUgcG9wdXAgb2YgdGhlIEF1dG9Db21wbGV0ZS5cbiAgICAgKlxuICAgICAqIFRoZSBhdmFpbGFibGUgb3B0aW9ucyBhcmU6XG4gICAgICogLSBgYW5pbWF0ZTogQm9vbGVhbmAmbWRhc2g7Q29udHJvbHMgdGhlIHBvcHVwIGFuaW1hdGlvbi4gQnkgZGVmYXVsdCwgdGhlIG9wZW4gYW5kIGNsb3NlIGFuaW1hdGlvbnMgYXJlIGVuYWJsZWQuXG4gICAgICogLSBgd2lkdGg6IE51bWJlciB8IFN0cmluZ2AmbWRhc2g7U2V0cyB0aGUgd2lkdGggb2YgdGhlIHBvcHVwIGNvbnRhaW5lci4gQnkgZGVmYXVsdCwgdGhlIHdpZHRoIG9mIHRoZSBob3N0IGVsZW1lbnQgaXMgdXNlZC4gSWYgc2V0IHRvIGBhdXRvYCwgdGhlIGNvbXBvbmVudCBhdXRvbWF0aWNhbGx5IGFkanVzdHMgdGhlIHdpZHRoIG9mIHRoZSBwb3B1cCBhbmQgbm8gaXRlbSBsYWJlbHMgYXJlIHdyYXBwZWQuIFRoZSBgYXV0b2AgbW9kZSBpcyBub3Qgc3VwcG9ydGVkIHdoZW4gdmlydHVhbCBzY3JvbGxpbmcgaXMgZW5hYmxlZC5cbiAgICAgKiAtIGBoZWlnaHQ6IE51bWJlcmAmbWRhc2g7U2V0cyB0aGUgaGVpZ2h0IG9mIHRoZSBwb3B1cCBjb250YWluZXIuXG4gICAgICogLSBgcG9wdXBDbGFzczogU3RyaW5nYCZtZGFzaDtTcGVjaWZpZXMgYSBsaXN0IG9mIENTUyBjbGFzc2VzIHRoYXQgYXJlIHVzZWQgdG8gc3R5bGUgdGhlIHBvcHVwLlxuICAgICAqIC0gYGFwcGVuZFRvOiBcInJvb3RcIiB8IFwiY29tcG9uZW50XCIgfCBWaWV3Q29udGFpbmVyUmVmYCZtZGFzaDtTcGVjaWZpZXMgdGhlIGNvbXBvbmVudCB0byB3aGljaCB0aGUgcG9wdXAgd2lsbCBiZSBhcHBlbmRlZC5cbiAgICAgKi9cbiAgICBzZXQgcG9wdXBTZXR0aW5ncyhzZXR0aW5ncykge1xuICAgICAgICB0aGlzLl9wb3B1cFNldHRpbmdzID0gT2JqZWN0LmFzc2lnbih7IGFuaW1hdGU6IHRydWUgfSwgc2V0dGluZ3MpO1xuICAgIH1cbiAgICBnZXQgcG9wdXBTZXR0aW5ncygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3BvcHVwU2V0dGluZ3M7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIERlZmluZXMgYSBCb29sZWFuIGZ1bmN0aW9uIHRoYXQgaXMgZXhlY3V0ZWQgZm9yIGVhY2ggZGF0YSBpdGVtIGluIHRoZSBjb21wb25lbnRcbiAgICAgKiAoW3NlZSBleGFtcGxlc10oeyUgc2x1ZyBkaXNhYmxlZGl0ZW1zX2F1dG9jb21wbGV0ZSAlfSkpLlxuICAgICAqIERldGVybWluZXMgd2hldGhlciB0aGUgaXRlbSB3aWxsIGJlIGRpc2FibGVkLlxuICAgICAqL1xuICAgIHNldCBpdGVtRGlzYWJsZWQoZm4pIHtcbiAgICAgICAgaWYgKHR5cGVvZiBmbiAhPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBpdGVtRGlzYWJsZWQgbXVzdCBiZSBhIGZ1bmN0aW9uLCBidXQgcmVjZWl2ZWQgJHtKU09OLnN0cmluZ2lmeShmbil9LmApO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZGlzYWJsZWRJdGVtc1NlcnZpY2UuaXRlbURpc2FibGVkID0gZm47XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBzZXQgdGFiSW5kZXgodGFiSW5kZXgpIHtcbiAgICAgICAgdGhpcy50YWJpbmRleCA9IHRhYkluZGV4O1xuICAgIH1cbiAgICBnZXQgdGFiSW5kZXgoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnRhYmluZGV4O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBFbmFibGVzIHRoZSBbdmlydHVhbGl6YXRpb25dKHslIHNsdWcgdmlydHVhbGl6YXRpb25fYXV0b2NvbXBsZXRlICV9KSBmdW5jdGlvbmFsaXR5LlxuICAgICAqL1xuICAgIHNldCB2aXJ0dWFsKHNldHRpbmdzKSB7XG4gICAgICAgIHRoaXMuX3ZpcnR1YWxTZXR0aW5ncyA9IG5vcm1hbGl6ZVZpcnR1YWxpemF0aW9uU2V0dGluZ3Moc2V0dGluZ3MpO1xuICAgIH1cbiAgICBnZXQgdmlydHVhbCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3ZpcnR1YWxTZXR0aW5ncztcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2V0cyB0aGUgc2l6ZSBvZiB0aGUgY29tcG9uZW50LlxuICAgICAqXG4gICAgICogVGhlIHBvc3NpYmxlIHZhbHVlcyBhcmU6XG4gICAgICogKiBgJ3NtYWxsJ2BcbiAgICAgKiAqIGAnbWVkaXVtJ2AgKGRlZmF1bHQpXG4gICAgICogKiBgJ2xhcmdlJ2BcbiAgICAgKiAqIGBudWxsYFxuICAgICAqXG4gICAgICovXG4gICAgc2V0IHNpemUoc2l6ZSkge1xuICAgICAgICB0aGlzLnJlbmRlcmVyLnJlbW92ZUNsYXNzKHRoaXMud3JhcHBlciwgZ2V0U2l6ZUNsYXNzKCdpbnB1dCcsIHRoaXMuc2l6ZSkpO1xuICAgICAgICBpZiAoc2l6ZSkge1xuICAgICAgICAgICAgdGhpcy5yZW5kZXJlci5hZGRDbGFzcyh0aGlzLndyYXBwZXIsIGdldFNpemVDbGFzcygnaW5wdXQnLCBzaXplKSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fc2l6ZSA9IHNpemU7XG4gICAgfVxuICAgIGdldCBzaXplKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fc2l6ZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2V0cyB0aGUgYm9yZGVyIHJhZGl1cyBvZiB0aGUgY29tcG9uZW50LlxuICAgICAqXG4gICAgICogVGhlIHBvc3NpYmxlIHZhbHVlcyBhcmU6XG4gICAgICogKiBgJ3NtYWxsJ2BcbiAgICAgKiAqIGAnbWVkaXVtJ2AgKGRlZmF1bHQpXG4gICAgICogKiBgJ2xhcmdlJ2BcbiAgICAgKiAqIGAnZnVsbCdgXG4gICAgICogKiBgbnVsbGBcbiAgICAgKlxuICAgICAqL1xuICAgIHNldCByb3VuZGVkKHJvdW5kZWQpIHtcbiAgICAgICAgdGhpcy5yZW5kZXJlci5yZW1vdmVDbGFzcyh0aGlzLndyYXBwZXIsIGdldFJvdW5kZWRDbGFzcyh0aGlzLnJvdW5kZWQpKTtcbiAgICAgICAgaWYgKHJvdW5kZWQpIHtcbiAgICAgICAgICAgIHRoaXMucmVuZGVyZXIuYWRkQ2xhc3ModGhpcy53cmFwcGVyLCBnZXRSb3VuZGVkQ2xhc3Mocm91bmRlZCkpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3JvdW5kZWQgPSByb3VuZGVkO1xuICAgIH1cbiAgICBnZXQgcm91bmRlZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3JvdW5kZWQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNldHMgdGhlIGZpbGxNb2RlIG9mIHRoZSBjb21wb25lbnQuXG4gICAgICpcbiAgICAgKiBUaGUgcG9zc2libGUgdmFsdWVzIGFyZTpcbiAgICAgKiAqIGAnZmxhdCdgXG4gICAgICogKiBgJ3NvbGlkJ2AgKGRlZmF1bHQpXG4gICAgICogKiBgJ291dGxpbmUnYFxuICAgICAqICogYG51bGxgXG4gICAgICpcbiAgICAgKi9cbiAgICBzZXQgZmlsbE1vZGUoZmlsbE1vZGUpIHtcbiAgICAgICAgdGhpcy5yZW5kZXJlci5yZW1vdmVDbGFzcyh0aGlzLndyYXBwZXIsIGdldEZpbGxNb2RlQ2xhc3MoJ2lucHV0JywgdGhpcy5maWxsTW9kZSkpO1xuICAgICAgICBpZiAoZmlsbE1vZGUpIHtcbiAgICAgICAgICAgIHRoaXMucmVuZGVyZXIuYWRkQ2xhc3ModGhpcy53cmFwcGVyLCBnZXRGaWxsTW9kZUNsYXNzKCdpbnB1dCcsIGZpbGxNb2RlKSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fZmlsbE1vZGUgPSBmaWxsTW9kZTtcbiAgICB9XG4gICAgZ2V0IGZpbGxNb2RlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fZmlsbE1vZGU7XG4gICAgfVxuICAgIGdldCBpc0ZvY3VzZWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9pc0ZvY3VzZWQ7XG4gICAgfVxuICAgIHNldCBpc0ZvY3VzZWQoaXNGb2N1c2VkKSB7XG4gICAgICAgIHRoaXMucmVuZGVyZXJbaXNGb2N1c2VkID8gJ2FkZENsYXNzJyA6ICdyZW1vdmVDbGFzcyddKHRoaXMud3JhcHBlciwgXCJrLWZvY3VzXCIpO1xuICAgICAgICB0aGlzLl9pc0ZvY3VzZWQgPSBpc0ZvY3VzZWQ7XG4gICAgfVxuICAgIGdldCBpc0Rpc2FibGVkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kaXNhYmxlZDtcbiAgICB9XG4gICAgZ2V0IGlzTG9hZGluZygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubG9hZGluZztcbiAgICB9XG4gICAgZ2V0IGRpcigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGlyZWN0aW9uO1xuICAgIH1cbiAgICBuZ09uSW5pdCgpIHtcbiAgICAgICAgdGhpcy5yZW5kZXJlci5yZW1vdmVBdHRyaWJ1dGUodGhpcy53cmFwcGVyLCBcInRhYmluZGV4XCIpO1xuICAgICAgICB0aGlzLmxvY2FsaXphdGlvbkNoYW5nZVN1YnNjcmlwdGlvbiA9IHRoaXMubG9jYWxpemF0aW9uXG4gICAgICAgICAgICAuY2hhbmdlc1xuICAgICAgICAgICAgLnN1YnNjcmliZSgoeyBydGwgfSkgPT4ge1xuICAgICAgICAgICAgdGhpcy5kaXJlY3Rpb24gPSBydGwgPyAncnRsJyA6ICdsdHInO1xuICAgICAgICAgICAgdGhpcy5jZHIuZGV0ZWN0Q2hhbmdlcygpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5zZXRDb21wb25lbnRDbGFzc2VzKCk7XG4gICAgfVxuICAgIG5nT25EZXN0cm95KCkge1xuICAgICAgICB0aGlzLmRlc3Ryb3lQb3B1cCgpO1xuICAgICAgICB0aGlzLnVuc3Vic2NyaWJlRXZlbnRzKCk7XG4gICAgICAgIGlmICh0aGlzLmxvY2FsaXphdGlvbkNoYW5nZVN1YnNjcmlwdGlvbikge1xuICAgICAgICAgICAgdGhpcy5sb2NhbGl6YXRpb25DaGFuZ2VTdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBuZ09uQ2hhbmdlcyhjaGFuZ2VzKSB7XG4gICAgICAgIGNvbnN0IHZpcnR1YWwgPSB0aGlzLnZpcnR1YWw7XG4gICAgICAgIGNvbnN0IHJlcXVlc3RJbml0aWFsRGF0YSA9IHZpcnR1YWwgJiYgY2hhbmdlcy5kYXRhICYmIGNoYW5nZXMuZGF0YS5pc0ZpcnN0Q2hhbmdlKCk7XG4gICAgICAgIGlmIChyZXF1ZXN0SW5pdGlhbERhdGEpIHtcbiAgICAgICAgICAgIHRoaXMucGFnZUNoYW5nZSh7IHNraXA6IDAsIHRha2U6IHZpcnR1YWwucGFnZVNpemUgfSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVzZXRzIHRoZSB2YWx1ZSBvZiB0aGUgQXV0b0NvbXBsZXRlLlxuICAgICAqIElmIHlvdSB1c2UgdGhlIGByZXNldGAgbWV0aG9kIHRvIGNsZWFyIHRoZSB2YWx1ZSBvZiB0aGUgY29tcG9uZW50LFxuICAgICAqIHRoZSBtb2RlbCB3aWxsIG5vdCB1cGRhdGUgYXV0b21hdGljYWxseSBhbmQgdGhlIGBzZWxlY3Rpb25DaGFuZ2VgIGFuZCBgdmFsdWVDaGFuZ2VgIGV2ZW50cyB3aWxsIG5vdCBiZSBmaXJlZC5cbiAgICAgKi9cbiAgICByZXNldCgpIHtcbiAgICAgICAgdGhpcy52YWx1ZSA9IE5PX1ZBTFVFO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgbWVzc2FnZUZvcihrZXkpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubG9jYWxpemF0aW9uLmdldChrZXkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgY2xlYXJWYWx1ZShldmVudCkge1xuICAgICAgICBldmVudC5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKTtcbiAgICAgICAgdGhpcy5mb2N1cygpO1xuICAgICAgICB0aGlzLmNoYW5nZShOT19WQUxVRSk7XG4gICAgICAgIGlmICh0aGlzLmZpbHRlcmFibGUpIHtcbiAgICAgICAgICAgIHRoaXMuZmlsdGVyQ2hhbmdlLmVtaXQoJycpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc2VsZWN0aW9uU2VydmljZS5yZXNldFNlbGVjdGlvbihbXSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICB3cml0ZVZhbHVlKHZhbHVlKSB7XG4gICAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIHJlZ2lzdGVyT25DaGFuZ2UoZm4pIHtcbiAgICAgICAgdGhpcy5vbkNoYW5nZUNhbGxiYWNrID0gZm47XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICByZWdpc3Rlck9uVG91Y2hlZChmbikge1xuICAgICAgICB0aGlzLm9uVG91Y2hlZENhbGxiYWNrID0gZm47XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBzZXREaXNhYmxlZFN0YXRlKGlzRGlzYWJsZWQpIHtcbiAgICAgICAgdGhpcy5kaXNhYmxlZCA9IGlzRGlzYWJsZWQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEZvY3VzZXMgYSBzcGVjaWZpYyBpdGVtIG9mIHRoZSBBdXRvQ29tcGxldGUgYmFzZWQgb24gYSBwcm92aWRlZCBpbmRleC5cbiAgICAgKiBJZiBudWxsIG9yIGludmFsaWQgaW5kZXggaXMgcHJvdmlkZWQgdGhlIGZvY3VzIHdpbGwgYmUgcmVtb3ZlZC5cbiAgICAgKi9cbiAgICBmb2N1c0l0ZW1BdChpbmRleCkge1xuICAgICAgICBjb25zdCBpc0luUmFuZ2UgPSBpbmRleCA+PSAwICYmIGluZGV4IDwgdGhpcy5kYXRhLmxlbmd0aDtcbiAgICAgICAgaWYgKGlzUHJlc2VudChpbmRleCkgJiYgaXNJblJhbmdlICYmICF0aGlzLmRpc2FibGVkSXRlbXNTZXJ2aWNlLmlzSW5kZXhEaXNhYmxlZChpbmRleCkpIHtcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0aW9uU2VydmljZS5mb2N1cyhpbmRleCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdGlvblNlcnZpY2UuZm9jdXMoLTEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEZvY3VzZXMgdGhlIEF1dG9Db21wbGV0ZS5cbiAgICAgKi9cbiAgICBmb2N1cygpIHtcbiAgICAgICAgaWYgKCF0aGlzLmRpc2FibGVkKSB7XG4gICAgICAgICAgICB0aGlzLnNlYXJjaGJhci5mb2N1cygpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEJsdXJzIHRoZSBBdXRvQ29tcGxldGUuXG4gICAgICovXG4gICAgYmx1cigpIHtcbiAgICAgICAgaWYgKCF0aGlzLmRpc2FibGVkKSB7XG4gICAgICAgICAgICB0aGlzLnNlYXJjaGJhci5ibHVyKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIG9uUmVzaXplKCkge1xuICAgICAgICBpZiAodGhpcy5fb3Blbikge1xuICAgICAgICAgICAgY29uc3QgcG9wdXBXcmFwcGVyID0gdGhpcy5wb3B1cFJlZi5wb3B1cEVsZW1lbnQ7XG4gICAgICAgICAgICBjb25zdCB7IG1pbiwgbWF4IH0gPSB0aGlzLndpZHRoO1xuICAgICAgICAgICAgcG9wdXBXcmFwcGVyLnN0eWxlLm1pbldpZHRoID0gbWluO1xuICAgICAgICAgICAgcG9wdXBXcmFwcGVyLnN0eWxlLndpZHRoID0gbWF4O1xuICAgICAgICB9XG4gICAgfVxuICAgIGVtaXRDaGFuZ2UodmFsdWUpIHtcbiAgICAgICAgdGhpcy5vbkNoYW5nZUNhbGxiYWNrKHZhbHVlKTtcbiAgICAgICAgdGhpcy52YWx1ZUNoYW5nZS5lbWl0KHZhbHVlKTtcbiAgICB9XG4gICAgdmVyaWZ5U2V0dGluZ3MobmV3VmFsdWUpIHtcbiAgICAgICAgaWYgKCFpc0Rldk1vZGUoKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpc1ByZXNlbnQobmV3VmFsdWUpICYmIHR5cGVvZiBuZXdWYWx1ZSAhPT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiRXhwZWN0ZWQgdmFsdWUgb2YgdHlwZSBzdHJpbmcuIFNlZSBodHRwczovL3d3dy50ZWxlcmlrLmNvbS9rZW5kby1hbmd1bGFyLXVpL2NvbXBvbmVudHMvZHJvcGRvd25zL2F1dG9jb21wbGV0ZS92YWx1ZS1iaW5kaW5nL1wiKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzZWFyY2godGV4dCwgc3RhcnRGcm9tID0gMCkge1xuICAgICAgICBsZXQgaW5kZXg7XG4gICAgICAgIGlmICh0ZXh0Lmxlbmd0aCAmJiB0aGlzLmRhdGFTZXJ2aWNlLml0ZW1zQ291bnQpIHtcbiAgICAgICAgICAgIGluZGV4ID0gdGhpcy5kYXRhU2VydmljZS5maW5kSW5kZXgodGhpcy5maW5kSW5kZXhQcmVkaWNhdGUodGV4dCksIHN0YXJ0RnJvbSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBpbmRleCA9IC0xO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmRpc2FibGVkSXRlbXNTZXJ2aWNlLmlzSW5kZXhEaXNhYmxlZChpbmRleCkpIHtcbiAgICAgICAgICAgIGlmIChpbmRleCArIDEgPCB0aGlzLmRhdGFTZXJ2aWNlLml0ZW1zQ291bnQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNlYXJjaCh0ZXh0LCBpbmRleCArIDEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3Rpb25TZXJ2aWNlLmZvY3VzKC0xKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0aW9uU2VydmljZS5mb2N1cyhpbmRleCk7XG4gICAgICAgICAgICBpZiAodGhpcy5zdWdnZXN0KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zdWdnZXN0ZWRUZXh0ID0gZ2V0dGVyJDEodGhpcy5kYXRhU2VydmljZS5pdGVtQXQoaW5kZXgpLCB0aGlzLnZhbHVlRmllbGQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIG5hdmlnYXRlKGluZGV4KSB7XG4gICAgICAgIGlmICghdGhpcy5pc09wZW4pIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnNlbGVjdGlvblNlcnZpY2UuZm9jdXMoaW5kZXgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgaGFuZGxlTmF2aWdhdGUoZXZlbnQpIHtcbiAgICAgICAgY29uc3QgZm9jdXNlZCA9IGlzTmFOKHRoaXMuc2VsZWN0aW9uU2VydmljZS5mb2N1c2VkKSA/IHRoaXMuZmlyc3RGb2N1c2FibGVJbmRleCgwKSA6IHRoaXMuc2VsZWN0aW9uU2VydmljZS5mb2N1c2VkO1xuICAgICAgICBpZiAodGhpcy5kaXNhYmxlZCB8fCB0aGlzLnJlYWRvbmx5IHx8IGlzTmFOKGZvY3VzZWQpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgYWN0aW9uID0gdGhpcy5uYXZpZ2F0aW9uU2VydmljZS5wcm9jZXNzKHtcbiAgICAgICAgICAgIGN1cnJlbnQ6IGZvY3VzZWQsXG4gICAgICAgICAgICBtYXg6IHRoaXMuZGF0YVNlcnZpY2UuaXRlbXNDb3VudCAtIDEsXG4gICAgICAgICAgICBtaW46IDAsXG4gICAgICAgICAgICBvcmlnaW5hbEV2ZW50OiBldmVudFxuICAgICAgICB9KTtcbiAgICAgICAgaWYgKGFjdGlvbiAhPT0gTmF2aWdhdGlvbkFjdGlvbi5VbmRlZmluZWQgJiZcbiAgICAgICAgICAgIGFjdGlvbiAhPT0gTmF2aWdhdGlvbkFjdGlvbi5CYWNrc3BhY2UgJiZcbiAgICAgICAgICAgIGFjdGlvbiAhPT0gTmF2aWdhdGlvbkFjdGlvbi5EZWxldGUgJiZcbiAgICAgICAgICAgIGFjdGlvbiAhPT0gTmF2aWdhdGlvbkFjdGlvbi5Ib21lICYmXG4gICAgICAgICAgICBhY3Rpb24gIT09IE5hdmlnYXRpb25BY3Rpb24uRW5kICYmXG4gICAgICAgICAgICBhY3Rpb24gIT09IE5hdmlnYXRpb25BY3Rpb24uTGVmdCAmJlxuICAgICAgICAgICAgYWN0aW9uICE9PSBOYXZpZ2F0aW9uQWN0aW9uLlJpZ2h0ICYmXG4gICAgICAgICAgICAoKGFjdGlvbiA9PT0gTmF2aWdhdGlvbkFjdGlvbi5FbnRlciAmJiB0aGlzLmlzT3BlbikgfHwgYWN0aW9uICE9PSBOYXZpZ2F0aW9uQWN0aW9uLkVudGVyKSkge1xuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBoYW5kbGVFbnRlcihldmVudCkge1xuICAgICAgICBjb25zdCBmb2N1c2VkID0gdGhpcy5zZWxlY3Rpb25TZXJ2aWNlLmZvY3VzZWQ7XG4gICAgICAgIGxldCB2YWx1ZTtcbiAgICAgICAgaWYgKHRoaXMuaXNPcGVuKSB7XG4gICAgICAgICAgICBldmVudC5vcmlnaW5hbEV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGZvY3VzZWQgPj0gMCkge1xuICAgICAgICAgICAgdmFsdWUgPSBnZXR0ZXIkMSh0aGlzLmRhdGFTZXJ2aWNlLml0ZW1BdChmb2N1c2VkKSwgdGhpcy52YWx1ZUZpZWxkKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IG1hdGNoID0gdGhpcy5zdWdnZXN0ICYmIHRoaXMuc3VnZ2VzdGVkVGV4dCAmJiB0aGlzLmRhdGEubGVuZ3RoICYmXG4gICAgICAgICAgICAgICAgZ2V0dGVyJDEodGhpcy5kYXRhU2VydmljZS5pdGVtQXQoMCksIHRoaXMudmFsdWVGaWVsZCkudG9Mb3dlckNhc2UoKSA9PT0gdGhpcy5zZWFyY2hiYXIudmFsdWUudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICAgIGlmICh0aGlzLmlzT3BlbiAmJiBtYXRjaCkge1xuICAgICAgICAgICAgICAgIHZhbHVlID0gdGhpcy5zdWdnZXN0ZWRUZXh0O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdmFsdWUgPSB0aGlzLnNlYXJjaGJhci52YWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLmNoYW5nZSh2YWx1ZSk7XG4gICAgfVxuICAgIGhhbmRsZUVzY2FwZSgpIHtcbiAgICAgICAgdGhpcy50b2dnbGVQb3B1cChmYWxzZSk7XG4gICAgICAgIHRoaXMuc2VsZWN0aW9uU2VydmljZS5mb2N1c2VkID0gLTE7XG4gICAgICAgIHRoaXMuc3VnZ2VzdGVkVGV4dCA9IG51bGw7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBzZWFyY2hCYXJDaGFuZ2UodGV4dCkge1xuICAgICAgICBjb25zdCBjdXJyZW50VGV4dExlbmd0aCA9IGlzUHJlc2VudCh0aGlzLnRleHQpID8gdGhpcy50ZXh0Lmxlbmd0aCA6IDA7XG4gICAgICAgIHRoaXMuYmFja3NwYWNlUHJlc3NlZCA9ICh0ZXh0Lmxlbmd0aCA8IGN1cnJlbnRUZXh0TGVuZ3RoKSA/IHRydWUgOiBmYWxzZTtcbiAgICAgICAgdGhpcy50ZXh0ID0gdGV4dDtcbiAgICAgICAgdGhpcy50b2dnbGVQb3B1cCh0ZXh0Lmxlbmd0aCA+IDApO1xuICAgICAgICBpZiAoIXRoaXMuaGlnaGxpZ2h0Rmlyc3QpIHtcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0aW9uU2VydmljZS5mb2N1c2VkID0gLTE7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuZmlsdGVyYWJsZSkge1xuICAgICAgICAgICAgdGhpcy5maWx0ZXJDaGFuZ2UuZW1pdCh0ZXh0KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0aGlzLmhpZ2hsaWdodEZpcnN0KSB7XG4gICAgICAgICAgICB0aGlzLnNlYXJjaCh0ZXh0KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgaGFuZGxlRm9jdXMoKSB7XG4gICAgICAgIHRoaXMuaXNGb2N1c2VkID0gdHJ1ZTtcbiAgICAgICAgaWYgKGhhc09ic2VydmVycyh0aGlzLm9uRm9jdXMpKSB7XG4gICAgICAgICAgICB0aGlzLl96b25lLnJ1bigoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5vbkZvY3VzLmVtaXQoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBoYW5kbGVCbHVyKCkge1xuICAgICAgICBjb25zdCBmb2N1c2VkID0gdGhpcy5maWx0ZXJhYmxlID8gdGhpcy5zZWxlY3Rpb25TZXJ2aWNlLmZvY3VzZWQgOiAtMTtcbiAgICAgICAgdGhpcy5zZWFyY2hiYXIuaW5wdXQubmF0aXZlRWxlbWVudC5zY3JvbGxMZWZ0ID0gMDsgLy8gRmlyZWZveCBkb2Vzbid0IGF1dG8tc2Nyb2xsIHRvIHRoZSBsZWZ0IG9uIGJsdXIgbGlrZSBvdGhlciBicm93c2Vyc1xuICAgICAgICBsZXQgZGF0YUl0ZW07XG4gICAgICAgIGxldCB0ZXh0O1xuICAgICAgICBpZiAoZm9jdXNlZCAhPT0gLTEpIHtcbiAgICAgICAgICAgIGRhdGFJdGVtID0gdGhpcy5kYXRhU2VydmljZS5pdGVtQXQoZm9jdXNlZCk7XG4gICAgICAgICAgICB0ZXh0ID0gZ2V0dGVyJDEoZGF0YUl0ZW0sIHRoaXMudmFsdWVGaWVsZCkgfHwgXCJcIjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRleHQgPSB0aGlzLnNlYXJjaGJhci52YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBleGFjdE1hdGNoID0gdGV4dCA9PT0gdGhpcy5zZWFyY2hiYXIudmFsdWU7XG4gICAgICAgIGNvbnN0IGluc2Vuc2l0aXZlTWF0Y2ggPSB0ZXh0LnRvTG93ZXJDYXNlKCkgPT09IHRoaXMuc2VhcmNoYmFyLnZhbHVlLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIGlmICghZXhhY3RNYXRjaCAmJiBpbnNlbnNpdGl2ZU1hdGNoKSB7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdGlvblNlcnZpY2UucmVzZXRTZWxlY3Rpb24oW10pO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuaXNGb2N1c2VkID0gZmFsc2U7XG4gICAgICAgIGNvbnN0IHZhbHVlSGFzQ2hhbmdlZCA9IHRoaXMudmFsdWUgIT09IHRoaXMudGV4dDtcbiAgICAgICAgY29uc3QgcnVuSW5ab25lID0gaGFzT2JzZXJ2ZXJzKHRoaXMub25CbHVyKSB8fCBoYXNPYnNlcnZlcnModGhpcy5jbG9zZSkgfHwgaXNVbnRvdWNoZWQodGhpcy53cmFwcGVyKSB8fCB2YWx1ZUhhc0NoYW5nZWQ7XG4gICAgICAgIGlmIChydW5JblpvbmUpIHtcbiAgICAgICAgICAgIHRoaXMuX3pvbmUucnVuKCgpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAodmFsdWVIYXNDaGFuZ2VkKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2hhbmdlKHRoaXMuc2VhcmNoYmFyLnZhbHVlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5vbkJsdXIuZW1pdCgpO1xuICAgICAgICAgICAgICAgIHRoaXMub25Ub3VjaGVkQ2FsbGJhY2soKTtcbiAgICAgICAgICAgICAgICB0aGlzLnRvZ2dsZVBvcHVwKGZhbHNlKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy50b2dnbGVQb3B1cChmYWxzZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIHBhZ2VDaGFuZ2UoZXZlbnQpIHtcbiAgICAgICAgY29uc3QgdmlydHVhbCA9IHRoaXMudmlydHVhbDtcbiAgICAgICAgdmlydHVhbC5za2lwID0gZXZlbnQuc2tpcDtcbiAgICB9XG4gICAgY2hhbmdlKHZhbHVlKSB7XG4gICAgICAgIHRoaXMudG9nZ2xlUG9wdXAoZmFsc2UpO1xuICAgICAgICB0aGlzLnZhbHVlQ2hhbmdlU3ViamVjdC5uZXh0KHZhbHVlKTtcbiAgICB9XG4gICAgc3Vic2NyaWJlRXZlbnRzKCkge1xuICAgICAgICBpZiAoIWlzRG9jdW1lbnRBdmFpbGFibGUoKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMudmFsdWVDaGFuZ2VTdWJzY3JpcHRpb24gPSB0aGlzLnZhbHVlQ2hhbmdlU3ViamVjdFxuICAgICAgICAgICAgLnN1YnNjcmliZSh2YWx1ZSA9PiB7XG4gICAgICAgICAgICBjb25zdCBoYXNDaGFuZ2UgPSB0aGlzLnZhbHVlICE9PSB2YWx1ZTtcbiAgICAgICAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgICAgIHRoaXMudGV4dCA9IHZhbHVlO1xuICAgICAgICAgICAgLy8gZW1pdCBjaGFuZ2UgYWZ0ZXIgYXNzaWduaW5nIGB0aGlzLnZhbHVlYCA9PiBhbGxvd3MgdGhlIHVzZXIgdG8gbW9kaWZ5IHRoZSBjb21wb25lbnQgdmFsdWUgb24gYHZhbHVlQ2hhbmdlYFxuICAgICAgICAgICAgaWYgKGhhc0NoYW5nZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuZW1pdENoYW5nZSh2YWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmNoYW5nZVN1YnNjcmlwdGlvbiA9IHRoaXMuc2VsZWN0aW9uU2VydmljZS5vbkNoYW5nZS5zdWJzY3JpYmUodGhpcy5oYW5kbGVJdGVtQ2hhbmdlLmJpbmQodGhpcykpO1xuICAgICAgICB0aGlzLmZvY3VzU3Vic2NyaXB0aW9uID0gdGhpcy5zZWxlY3Rpb25TZXJ2aWNlLm9uRm9jdXMuc3Vic2NyaWJlKHRoaXMuaGFuZGxlSXRlbUZvY3VzLmJpbmQodGhpcykpO1xuICAgICAgICB0aGlzLm5hdmlnYXRpb25TdWJzY3JpcHRpb24gPSBtZXJnZSh0aGlzLm5hdmlnYXRpb25TZXJ2aWNlLnVwLCB0aGlzLm5hdmlnYXRpb25TZXJ2aWNlLmRvd24pLnN1YnNjcmliZSgoZXZlbnQpID0+IHRoaXMubmF2aWdhdGUoZXZlbnQuaW5kZXgpKTtcbiAgICAgICAgdGhpcy5jbG9zZVN1YnNjcmlwdGlvbiA9IHRoaXMubmF2aWdhdGlvblNlcnZpY2UuY2xvc2Uuc3Vic2NyaWJlKCgpID0+IHRoaXMudG9nZ2xlUG9wdXAoZmFsc2UpKTtcbiAgICAgICAgdGhpcy5lbnRlclN1YnNjcmlwdGlvbiA9IHRoaXMubmF2aWdhdGlvblNlcnZpY2UuZW50ZXIuc3Vic2NyaWJlKHRoaXMuaGFuZGxlRW50ZXIuYmluZCh0aGlzKSk7XG4gICAgICAgIHRoaXMuZXNjU3Vic2NyaXB0aW9uID0gdGhpcy5uYXZpZ2F0aW9uU2VydmljZS5lc2Muc3Vic2NyaWJlKHRoaXMuaGFuZGxlRXNjYXBlLmJpbmQodGhpcykpO1xuICAgIH1cbiAgICBzdWJzY3JpYmVUb3VjaEV2ZW50cygpIHtcbiAgICAgICAgaWYgKCFpc0RvY3VtZW50QXZhaWxhYmxlKCkgfHwgIXRoaXMudG91Y2hFbmFibGVkKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fem9uZS5ydW5PdXRzaWRlQW5ndWxhcigoKSA9PiBcbiAgICAgICAgLy8gUm9sbCB1cCBBdXRvQ29tcGxldGUgb24gaU9TIHdoZW4gdGFwcGVkIG91dHNpZGVcbiAgICAgICAgdGhpcy50b3VjaHN0YXJ0RGlzcG9zZUhhbmRsZXIgPSB0aGlzLnJlbmRlcmVyLmxpc3Rlbihkb2N1bWVudCwgJ3RvdWNoc3RhcnQnLCAoZSkgPT4ge1xuICAgICAgICAgICAgY29uc3QgdGFyZ2V0ID0gZS50YXJnZXQ7XG4gICAgICAgICAgICBpZiAodGhpcy5pc0ZvY3VzZWQgJiYgIWluRHJvcERvd24odGhpcy5ob3N0RWxlbWVudCwgdGFyZ2V0LCB0aGlzLnBvcHVwUmVmKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX3pvbmUucnVuKCgpID0+IHRoaXMuYmx1cigpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICB1bnN1YnNjcmliZUV2ZW50cygpIHtcbiAgICAgICAgaWYgKCFpc0RvY3VtZW50QXZhaWxhYmxlKCkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmNoYW5nZVN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpO1xuICAgICAgICB0aGlzLm5hdmlnYXRpb25TdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcbiAgICAgICAgdGhpcy5jbG9zZVN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpO1xuICAgICAgICB0aGlzLmVudGVyU3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7XG4gICAgICAgIHRoaXMuZXNjU3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7XG4gICAgICAgIHRoaXMudmFsdWVDaGFuZ2VTdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcbiAgICAgICAgdGhpcy5mb2N1c1N1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpO1xuICAgICAgICBpZiAodGhpcy50b3VjaHN0YXJ0RGlzcG9zZUhhbmRsZXIpIHtcbiAgICAgICAgICAgIHRoaXMudG91Y2hzdGFydERpc3Bvc2VIYW5kbGVyKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaGFuZGxlSXRlbUNoYW5nZShldmVudCkge1xuICAgICAgICBjb25zdCBpbmRleCA9IGV2ZW50LmluZGljZXMubGVuZ3RoID8gZXZlbnQuaW5kaWNlc1swXSA6IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5zZWxlY3Rpb25TZXJ2aWNlLnJlc2V0U2VsZWN0aW9uKFstMV0pO1xuICAgICAgICBpZiAoIWlzUHJlc2VudChpbmRleCkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBsZXQgdGV4dCA9IGdldHRlciQxKHRoaXMuZGF0YVNlcnZpY2UuaXRlbUF0KGluZGV4KSwgdGhpcy52YWx1ZUZpZWxkKTtcbiAgICAgICAgdGhpcy5jaGFuZ2UodGV4dCk7XG4gICAgfVxuICAgIGhhbmRsZUl0ZW1Gb2N1cyhfZXZlbnQpIHtcbiAgICAgICAgY29uc3QgZm9jdXNlZCA9IHRoaXMuc2VsZWN0aW9uU2VydmljZS5mb2N1c2VkO1xuICAgICAgICBjb25zdCBzaG91bGRTdWdnZXN0ID0gQm9vbGVhbih0aGlzLnN1Z2dlc3QgJiYgdGhpcy5kYXRhICYmIHRoaXMuZGF0YS5sZW5ndGggJiYgZm9jdXNlZCA+PSAwKTtcbiAgICAgICAgaWYgKHNob3VsZFN1Z2dlc3QpIHtcbiAgICAgICAgICAgIHRoaXMuc3VnZ2VzdGVkVGV4dCA9IGdldHRlciQxKHRoaXMuZGF0YVNlcnZpY2UuaXRlbUF0KGZvY3VzZWQpLCB0aGlzLnZhbHVlRmllbGQpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGNyZWF0ZVBvcHVwKCkge1xuICAgICAgICBpZiAodGhpcy52aXJ0dWFsKSB7XG4gICAgICAgICAgICB0aGlzLnZpcnR1YWwuc2tpcCA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgaG9yaXpvbnRhbEFsaWduID0gdGhpcy5kaXJlY3Rpb24gPT09IFwicnRsXCIgPyBcInJpZ2h0XCIgOiBcImxlZnRcIjtcbiAgICAgICAgY29uc3QgYW5jaG9yUG9zaXRpb24gPSB7IGhvcml6b250YWw6IGhvcml6b250YWxBbGlnbiwgdmVydGljYWw6IFwiYm90dG9tXCIgfTtcbiAgICAgICAgY29uc3QgcG9wdXBQb3NpdGlvbiA9IHsgaG9yaXpvbnRhbDogaG9yaXpvbnRhbEFsaWduLCB2ZXJ0aWNhbDogXCJ0b3BcIiB9O1xuICAgICAgICB0aGlzLnBvcHVwUmVmID0gdGhpcy5wb3B1cFNlcnZpY2Uub3Blbih7XG4gICAgICAgICAgICBhbmNob3I6IHRoaXMud3JhcHBlcixcbiAgICAgICAgICAgIGFuaW1hdGU6IHRoaXMucG9wdXBTZXR0aW5ncy5hbmltYXRlLFxuICAgICAgICAgICAgYXBwZW5kVG86IHRoaXMuYXBwZW5kVG8sXG4gICAgICAgICAgICBjb250ZW50OiB0aGlzLnBvcHVwVGVtcGxhdGUsXG4gICAgICAgICAgICBwb3B1cENsYXNzOiB0aGlzLmxpc3RDb250YWluZXJDbGFzc2VzLFxuICAgICAgICAgICAgcG9zaXRpb25Nb2RlOiAnYWJzb2x1dGUnLFxuICAgICAgICAgICAgcG9wdXBBbGlnbjogcG9wdXBQb3NpdGlvbixcbiAgICAgICAgICAgIGFuY2hvckFsaWduOiBhbmNob3JQb3NpdGlvblxuICAgICAgICB9KTtcbiAgICAgICAgY29uc3QgcG9wdXBXcmFwcGVyID0gdGhpcy5wb3B1cFJlZi5wb3B1cEVsZW1lbnQ7XG4gICAgICAgIGNvbnN0IHsgbWluLCBtYXggfSA9IHRoaXMud2lkdGg7XG4gICAgICAgIHBvcHVwV3JhcHBlci5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCB0aGlzLnBvcHVwTW91c2VEb3duSGFuZGxlcik7XG4gICAgICAgIHBvcHVwV3JhcHBlci5zdHlsZS5taW5XaWR0aCA9IG1pbjtcbiAgICAgICAgcG9wdXBXcmFwcGVyLnN0eWxlLndpZHRoID0gbWF4O1xuICAgICAgICBwb3B1cFdyYXBwZXIuc3R5bGUuaGVpZ2h0ID0gdGhpcy5oZWlnaHQ7XG4gICAgICAgIHBvcHVwV3JhcHBlci5zZXRBdHRyaWJ1dGUoXCJkaXJcIiwgdGhpcy5kaXJlY3Rpb24pO1xuICAgICAgICB0aGlzLnBvcHVwUmVmLnBvcHVwT3Blbi5zdWJzY3JpYmUoKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5jZHIuZGV0ZWN0Q2hhbmdlcygpO1xuICAgICAgICAgICAgdGhpcy5vcHRpb25zTGlzdC5zY3JvbGxUb0l0ZW0odGhpcy5zZWxlY3Rpb25TZXJ2aWNlLmZvY3VzZWQpO1xuICAgICAgICAgICAgdGhpcy5vcGVuZWQuZW1pdCgpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5wb3B1cFJlZi5wb3B1cENsb3NlLnN1YnNjcmliZSgoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmNsb3NlZC5lbWl0KCk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnBvcHVwUmVmLnBvcHVwQW5jaG9yVmlld3BvcnRMZWF2ZS5zdWJzY3JpYmUoKCkgPT4gdGhpcy50b2dnbGVQb3B1cChmYWxzZSkpO1xuICAgIH1cbiAgICBkZXN0cm95UG9wdXAoKSB7XG4gICAgICAgIGlmICh0aGlzLnBvcHVwUmVmKSB7XG4gICAgICAgICAgICB0aGlzLnBvcHVwUmVmLnBvcHVwRWxlbWVudFxuICAgICAgICAgICAgICAgIC5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCB0aGlzLnBvcHVwTW91c2VEb3duSGFuZGxlcik7XG4gICAgICAgICAgICB0aGlzLnBvcHVwUmVmLmNsb3NlKCk7XG4gICAgICAgICAgICB0aGlzLnBvcHVwUmVmID0gbnVsbDtcbiAgICAgICAgfVxuICAgIH1cbiAgICBfdG9nZ2xlKG9wZW4pIHtcbiAgICAgICAgdGhpcy5fb3BlbiA9IG9wZW47XG4gICAgICAgIHRoaXMuZGVzdHJveVBvcHVwKCk7XG4gICAgICAgIGlmICh0aGlzLl9vcGVuKSB7XG4gICAgICAgICAgICB0aGlzLmNyZWF0ZVBvcHVwKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdHJpZ2dlclBvcHVwRXZlbnRzKG9wZW4pIHtcbiAgICAgICAgY29uc3QgZXZlbnRBcmdzID0gbmV3IFByZXZlbnRhYmxlRXZlbnQoKTtcbiAgICAgICAgaWYgKG9wZW4pIHtcbiAgICAgICAgICAgIHRoaXMub3Blbi5lbWl0KGV2ZW50QXJncyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmNsb3NlLmVtaXQoZXZlbnRBcmdzKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZXZlbnRBcmdzLmlzRGVmYXVsdFByZXZlbnRlZCgpO1xuICAgIH1cbiAgICBmaXJzdEZvY3VzYWJsZUluZGV4KGluZGV4KSB7XG4gICAgICAgIGNvbnN0IG1heEluZGV4ID0gdGhpcy5kYXRhLmxlbmd0aCAtIDE7XG4gICAgICAgIGlmICh0aGlzLmRpc2FibGVkSXRlbXNTZXJ2aWNlLmlzSW5kZXhEaXNhYmxlZChpbmRleCkpIHtcbiAgICAgICAgICAgIHJldHVybiAoaW5kZXggPCBtYXhJbmRleCkgPyB0aGlzLmZpcnN0Rm9jdXNhYmxlSW5kZXgoaW5kZXggKyAxKSA6IHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBpbmRleDtcbiAgICAgICAgfVxuICAgIH1cbiAgICBmaW5kSW5kZXhQcmVkaWNhdGUodGV4dCkge1xuICAgICAgICBpZiAodGhpcy5kYXRhU2VydmljZS5ncm91cGVkKSB7XG4gICAgICAgICAgICByZXR1cm4gKGl0ZW0pID0+IHtcbiAgICAgICAgICAgICAgICBsZXQgaXRlbVRleHQgPSBnZXR0ZXIkMShpdGVtLnZhbHVlLCB0aGlzLnZhbHVlRmllbGQpO1xuICAgICAgICAgICAgICAgIGl0ZW1UZXh0ID0gIWlzUHJlc2VudChpdGVtVGV4dCkgPyBcIlwiIDogaXRlbVRleHQudG9TdHJpbmcoKS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgICAgIHJldHVybiBpdGVtVGV4dC5zdGFydHNXaXRoKHRleHQudG9Mb3dlckNhc2UoKSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIChpdGVtKSA9PiB7XG4gICAgICAgICAgICAgICAgbGV0IGl0ZW1UZXh0ID0gZ2V0dGVyJDEoaXRlbSwgdGhpcy52YWx1ZUZpZWxkKTtcbiAgICAgICAgICAgICAgICBpdGVtVGV4dCA9ICFpc1ByZXNlbnQoaXRlbVRleHQpID8gXCJcIiA6IGl0ZW1UZXh0LnRvU3RyaW5nKCkudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gaXRlbVRleHQuc3RhcnRzV2l0aCh0ZXh0LnRvTG93ZXJDYXNlKCkpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzZXRDb21wb25lbnRDbGFzc2VzKCkge1xuICAgICAgICBpZiAodGhpcy5zaXplKSB7XG4gICAgICAgICAgICB0aGlzLnJlbmRlcmVyLmFkZENsYXNzKHRoaXMud3JhcHBlciwgZ2V0U2l6ZUNsYXNzKCdpbnB1dCcsIHRoaXMuc2l6ZSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnJvdW5kZWQpIHtcbiAgICAgICAgICAgIHRoaXMucmVuZGVyZXIuYWRkQ2xhc3ModGhpcy53cmFwcGVyLCBnZXRSb3VuZGVkQ2xhc3ModGhpcy5yb3VuZGVkKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuZmlsbE1vZGUpIHtcbiAgICAgICAgICAgIHRoaXMucmVuZGVyZXIuYWRkQ2xhc3ModGhpcy53cmFwcGVyLCBnZXRGaWxsTW9kZUNsYXNzKCdpbnB1dCcsIHRoaXMuZmlsbE1vZGUpKTtcbiAgICAgICAgfVxuICAgIH1cbn07XG5fX2RlY29yYXRlKFtcbiAgICBJbnB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBCb29sZWFuKVxuXSwgQXV0b0NvbXBsZXRlQ29tcG9uZW50LnByb3RvdHlwZSwgXCJoaWdobGlnaHRGaXJzdFwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgSW5wdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgU3RyaW5nKVxuXSwgQXV0b0NvbXBsZXRlQ29tcG9uZW50LnByb3RvdHlwZSwgXCJmb2N1c2FibGVJZFwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgSW5wdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgT2JqZWN0KSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnBhcmFtdHlwZXNcIiwgW09iamVjdF0pXG5dLCBBdXRvQ29tcGxldGVDb21wb25lbnQucHJvdG90eXBlLCBcImRhdGFcIiwgbnVsbCk7XG5fX2RlY29yYXRlKFtcbiAgICBJbnB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBTdHJpbmcpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246cGFyYW10eXBlc1wiLCBbU3RyaW5nXSlcbl0sIEF1dG9Db21wbGV0ZUNvbXBvbmVudC5wcm90b3R5cGUsIFwidmFsdWVcIiwgbnVsbCk7XG5fX2RlY29yYXRlKFtcbiAgICBJbnB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBTdHJpbmcpXG5dLCBBdXRvQ29tcGxldGVDb21wb25lbnQucHJvdG90eXBlLCBcInZhbHVlRmllbGRcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIFN0cmluZylcbl0sIEF1dG9Db21wbGV0ZUNvbXBvbmVudC5wcm90b3R5cGUsIFwicGxhY2Vob2xkZXJcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIE9iamVjdCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjpwYXJhbXR5cGVzXCIsIFtPYmplY3RdKVxuXSwgQXV0b0NvbXBsZXRlQ29tcG9uZW50LnByb3RvdHlwZSwgXCJwb3B1cFNldHRpbmdzXCIsIG51bGwpO1xuX19kZWNvcmF0ZShbXG4gICAgSW5wdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgTnVtYmVyKVxuXSwgQXV0b0NvbXBsZXRlQ29tcG9uZW50LnByb3RvdHlwZSwgXCJsaXN0SGVpZ2h0XCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBJbnB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBCb29sZWFuKVxuXSwgQXV0b0NvbXBsZXRlQ29tcG9uZW50LnByb3RvdHlwZSwgXCJsb2FkaW5nXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBJbnB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBCb29sZWFuKVxuXSwgQXV0b0NvbXBsZXRlQ29tcG9uZW50LnByb3RvdHlwZSwgXCJjbGVhckJ1dHRvblwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgSW5wdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgQm9vbGVhbilcbl0sIEF1dG9Db21wbGV0ZUNvbXBvbmVudC5wcm90b3R5cGUsIFwic3VnZ2VzdFwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgSW5wdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgQm9vbGVhbilcbl0sIEF1dG9Db21wbGV0ZUNvbXBvbmVudC5wcm90b3R5cGUsIFwiZGlzYWJsZWRcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEZ1bmN0aW9uKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnBhcmFtdHlwZXNcIiwgW0Z1bmN0aW9uXSlcbl0sIEF1dG9Db21wbGV0ZUNvbXBvbmVudC5wcm90b3R5cGUsIFwiaXRlbURpc2FibGVkXCIsIG51bGwpO1xuX19kZWNvcmF0ZShbXG4gICAgSW5wdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgQm9vbGVhbilcbl0sIEF1dG9Db21wbGV0ZUNvbXBvbmVudC5wcm90b3R5cGUsIFwicmVhZG9ubHlcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIE51bWJlcilcbl0sIEF1dG9Db21wbGV0ZUNvbXBvbmVudC5wcm90b3R5cGUsIFwidGFiaW5kZXhcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KFwidGFiSW5kZXhcIiksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIE51bWJlciksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjpwYXJhbXR5cGVzXCIsIFtOdW1iZXJdKVxuXSwgQXV0b0NvbXBsZXRlQ29tcG9uZW50LnByb3RvdHlwZSwgXCJ0YWJJbmRleFwiLCBudWxsKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEJvb2xlYW4pXG5dLCBBdXRvQ29tcGxldGVDb21wb25lbnQucHJvdG90eXBlLCBcImZpbHRlcmFibGVcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIE9iamVjdCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjpwYXJhbXR5cGVzXCIsIFtPYmplY3RdKVxuXSwgQXV0b0NvbXBsZXRlQ29tcG9uZW50LnByb3RvdHlwZSwgXCJ2aXJ0dWFsXCIsIG51bGwpO1xuX19kZWNvcmF0ZShbXG4gICAgSW5wdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgU3RyaW5nKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnBhcmFtdHlwZXNcIiwgW1N0cmluZ10pXG5dLCBBdXRvQ29tcGxldGVDb21wb25lbnQucHJvdG90eXBlLCBcInNpemVcIiwgbnVsbCk7XG5fX2RlY29yYXRlKFtcbiAgICBJbnB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBTdHJpbmcpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246cGFyYW10eXBlc1wiLCBbU3RyaW5nXSlcbl0sIEF1dG9Db21wbGV0ZUNvbXBvbmVudC5wcm90b3R5cGUsIFwicm91bmRlZFwiLCBudWxsKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIFN0cmluZyksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjpwYXJhbXR5cGVzXCIsIFtTdHJpbmddKVxuXSwgQXV0b0NvbXBsZXRlQ29tcG9uZW50LnByb3RvdHlwZSwgXCJmaWxsTW9kZVwiLCBudWxsKTtcbl9fZGVjb3JhdGUoW1xuICAgIE91dHB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBFdmVudEVtaXR0ZXIpXG5dLCBBdXRvQ29tcGxldGVDb21wb25lbnQucHJvdG90eXBlLCBcInZhbHVlQ2hhbmdlXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBPdXRwdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgRXZlbnRFbWl0dGVyKVxuXSwgQXV0b0NvbXBsZXRlQ29tcG9uZW50LnByb3RvdHlwZSwgXCJmaWx0ZXJDaGFuZ2VcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIE91dHB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBFdmVudEVtaXR0ZXIpXG5dLCBBdXRvQ29tcGxldGVDb21wb25lbnQucHJvdG90eXBlLCBcIm9wZW5cIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIE91dHB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBFdmVudEVtaXR0ZXIpXG5dLCBBdXRvQ29tcGxldGVDb21wb25lbnQucHJvdG90eXBlLCBcIm9wZW5lZFwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgT3V0cHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEV2ZW50RW1pdHRlcilcbl0sIEF1dG9Db21wbGV0ZUNvbXBvbmVudC5wcm90b3R5cGUsIFwiY2xvc2VcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIE91dHB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBFdmVudEVtaXR0ZXIpXG5dLCBBdXRvQ29tcGxldGVDb21wb25lbnQucHJvdG90eXBlLCBcImNsb3NlZFwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgT3V0cHV0KCdmb2N1cycpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBFdmVudEVtaXR0ZXIpXG5dLCBBdXRvQ29tcGxldGVDb21wb25lbnQucHJvdG90eXBlLCBcIm9uRm9jdXNcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIE91dHB1dCgnYmx1cicpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBFdmVudEVtaXR0ZXIpXG5dLCBBdXRvQ29tcGxldGVDb21wb25lbnQucHJvdG90eXBlLCBcIm9uQmx1clwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgQ29udGVudENoaWxkKEl0ZW1UZW1wbGF0ZURpcmVjdGl2ZSwgeyBzdGF0aWM6IGZhbHNlIH0pLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBJdGVtVGVtcGxhdGVEaXJlY3RpdmUpXG5dLCBBdXRvQ29tcGxldGVDb21wb25lbnQucHJvdG90eXBlLCBcInRlbXBsYXRlXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBDb250ZW50Q2hpbGQoSGVhZGVyVGVtcGxhdGVEaXJlY3RpdmUsIHsgc3RhdGljOiBmYWxzZSB9KSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgSGVhZGVyVGVtcGxhdGVEaXJlY3RpdmUpXG5dLCBBdXRvQ29tcGxldGVDb21wb25lbnQucHJvdG90eXBlLCBcImhlYWRlclRlbXBsYXRlXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBDb250ZW50Q2hpbGQoRm9vdGVyVGVtcGxhdGVEaXJlY3RpdmUsIHsgc3RhdGljOiBmYWxzZSB9KSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgRm9vdGVyVGVtcGxhdGVEaXJlY3RpdmUpXG5dLCBBdXRvQ29tcGxldGVDb21wb25lbnQucHJvdG90eXBlLCBcImZvb3RlclRlbXBsYXRlXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBDb250ZW50Q2hpbGQoTm9EYXRhVGVtcGxhdGVEaXJlY3RpdmUsIHsgc3RhdGljOiBmYWxzZSB9KSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgTm9EYXRhVGVtcGxhdGVEaXJlY3RpdmUpXG5dLCBBdXRvQ29tcGxldGVDb21wb25lbnQucHJvdG90eXBlLCBcIm5vRGF0YVRlbXBsYXRlXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBDb250ZW50Q2hpbGQoR3JvdXBUZW1wbGF0ZURpcmVjdGl2ZSwgeyBzdGF0aWM6IGZhbHNlIH0pLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBHcm91cFRlbXBsYXRlRGlyZWN0aXZlKVxuXSwgQXV0b0NvbXBsZXRlQ29tcG9uZW50LnByb3RvdHlwZSwgXCJncm91cFRlbXBsYXRlXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBDb250ZW50Q2hpbGQoRml4ZWRHcm91cFRlbXBsYXRlRGlyZWN0aXZlLCB7IHN0YXRpYzogZmFsc2UgfSksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEZpeGVkR3JvdXBUZW1wbGF0ZURpcmVjdGl2ZSlcbl0sIEF1dG9Db21wbGV0ZUNvbXBvbmVudC5wcm90b3R5cGUsIFwiZml4ZWRHcm91cFRlbXBsYXRlXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBWaWV3Q2hpbGQoJ2NvbnRhaW5lcicsIHsgcmVhZDogVmlld0NvbnRhaW5lclJlZiwgc3RhdGljOiB0cnVlIH0pLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBWaWV3Q29udGFpbmVyUmVmKVxuXSwgQXV0b0NvbXBsZXRlQ29tcG9uZW50LnByb3RvdHlwZSwgXCJjb250YWluZXJcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIFZpZXdDaGlsZCgncG9wdXBUZW1wbGF0ZScsIHsgc3RhdGljOiB0cnVlIH0pLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBUZW1wbGF0ZVJlZilcbl0sIEF1dG9Db21wbGV0ZUNvbXBvbmVudC5wcm90b3R5cGUsIFwicG9wdXBUZW1wbGF0ZVwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgVmlld0NoaWxkKFNlYXJjaEJhckNvbXBvbmVudCwgeyBzdGF0aWM6IHRydWUgfSksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIFNlYXJjaEJhckNvbXBvbmVudClcbl0sIEF1dG9Db21wbGV0ZUNvbXBvbmVudC5wcm90b3R5cGUsIFwic2VhcmNoYmFyXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBWaWV3Q2hpbGQoJ29wdGlvbnNMaXN0JywgeyBzdGF0aWM6IGZhbHNlIH0pLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBMaXN0Q29tcG9uZW50KVxuXSwgQXV0b0NvbXBsZXRlQ29tcG9uZW50LnByb3RvdHlwZSwgXCJvcHRpb25zTGlzdFwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgSG9zdEJpbmRpbmcoJ2NsYXNzLmstYXV0b2NvbXBsZXRlJyksXG4gICAgSG9zdEJpbmRpbmcoJ2NsYXNzLmstaW5wdXQnKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgQm9vbGVhbilcbl0sIEF1dG9Db21wbGV0ZUNvbXBvbmVudC5wcm90b3R5cGUsIFwid2lkZ2V0Q2xhc3Nlc1wiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgSG9zdEJpbmRpbmcoJ2NsYXNzLmstZGlzYWJsZWQnKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgQm9vbGVhbiksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjpwYXJhbXR5cGVzXCIsIFtdKVxuXSwgQXV0b0NvbXBsZXRlQ29tcG9uZW50LnByb3RvdHlwZSwgXCJpc0Rpc2FibGVkXCIsIG51bGwpO1xuX19kZWNvcmF0ZShbXG4gICAgSG9zdEJpbmRpbmcoJ2NsYXNzLmstbG9hZGluZycpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBCb29sZWFuKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnBhcmFtdHlwZXNcIiwgW10pXG5dLCBBdXRvQ29tcGxldGVDb21wb25lbnQucHJvdG90eXBlLCBcImlzTG9hZGluZ1wiLCBudWxsKTtcbl9fZGVjb3JhdGUoW1xuICAgIEhvc3RCaW5kaW5nKCdhdHRyLmRpcicpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBPYmplY3QpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246cGFyYW10eXBlc1wiLCBbXSlcbl0sIEF1dG9Db21wbGV0ZUNvbXBvbmVudC5wcm90b3R5cGUsIFwiZGlyXCIsIG51bGwpO1xuQXV0b0NvbXBsZXRlQ29tcG9uZW50ID0gQXV0b0NvbXBsZXRlQ29tcG9uZW50XzEgPSBfX2RlY29yYXRlKFtcbiAgICBDb21wb25lbnQoe1xuICAgICAgICBleHBvcnRBczogJ2tlbmRvQXV0b0NvbXBsZXRlJyxcbiAgICAgICAgcHJvdmlkZXJzOiBbXG4gICAgICAgICAgICBBVVRPQ09NUExFVEVfVkFMVUVfQUNDRVNTT1IsXG4gICAgICAgICAgICBEYXRhU2VydmljZSxcbiAgICAgICAgICAgIFNlbGVjdGlvblNlcnZpY2UsXG4gICAgICAgICAgICBOYXZpZ2F0aW9uU2VydmljZSxcbiAgICAgICAgICAgIERpc2FibGVkSXRlbXNTZXJ2aWNlLFxuICAgICAgICAgICAgTG9jYWxpemF0aW9uU2VydmljZSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBwcm92aWRlOiBMMTBOX1BSRUZJWCxcbiAgICAgICAgICAgICAgICB1c2VWYWx1ZTogJ2tlbmRvLmF1dG9jb21wbGV0ZSdcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcHJvdmlkZTogRmlsdGVyYWJsZUNvbXBvbmVudCxcbiAgICAgICAgICAgICAgICB1c2VFeGlzdGluZzogZm9yd2FyZFJlZigoKSA9PiBBdXRvQ29tcGxldGVDb21wb25lbnRfMSlcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcHJvdmlkZTogS2VuZG9JbnB1dCxcbiAgICAgICAgICAgICAgICB1c2VFeGlzdGluZzogZm9yd2FyZFJlZigoKSA9PiBBdXRvQ29tcGxldGVDb21wb25lbnRfMSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgXSxcbiAgICAgICAgc2VsZWN0b3I6ICdrZW5kby1hdXRvY29tcGxldGUnLFxuICAgICAgICB0ZW1wbGF0ZTogYFxuICAgICAgICA8bmctY29udGFpbmVyIGtlbmRvQXV0b0NvbXBsZXRlTG9jYWxpemVkTWVzc2FnZXNcbiAgICAgICAgICAgIGkxOG4tbm9EYXRhVGV4dD1cImtlbmRvLmF1dG9jb21wbGV0ZS5ub0RhdGFUZXh0fFRoZSB0ZXh0IGRpc3BsYXllZCBpbiB0aGUgcG9wdXAgd2hlbiB0aGVyZSBhcmUgbm8gaXRlbXNcIlxuICAgICAgICAgICAgbm9EYXRhVGV4dD1cIk5PIERBVEEgRk9VTkRcIlxuXG4gICAgICAgICAgICBpMThuLWNsZWFyVGl0bGU9XCJrZW5kby5hdXRvY29tcGxldGUuY2xlYXJUaXRsZXxUaGUgdGl0bGUgb2YgdGhlIGNsZWFyIGJ1dHRvblwiXG4gICAgICAgICAgICBjbGVhclRpdGxlPVwiY2xlYXJcIlxuICAgICAgICA+XG4gICAgICAgIDwvbmctY29udGFpbmVyPlxuICAgICAgICA8a2VuZG8tc2VhcmNoYmFyICNzZWFyY2hiYXJcbiAgICAgICAgICAgIFtyb2xlXT1cIidjb21ib2JveCdcIlxuICAgICAgICAgICAgW2lkXT1cImZvY3VzYWJsZUlkXCJcbiAgICAgICAgICAgIFtsaXN0SWRdPVwibGlzdEJveElkXCJcbiAgICAgICAgICAgIFthY3RpdmVEZXNjZW5kYW50XT1cImFjdGl2ZURlc2NlbmRhbnRcIlxuICAgICAgICAgICAgW25vRGF0YUxhYmVsXT1cIm5vRGF0YUxhYmVsXCJcbiAgICAgICAgICAgIFt1c2VySW5wdXRdPVwidGV4dFwiXG4gICAgICAgICAgICBbc3VnZ2VzdGVkVGV4dF09XCJzdWdnZXN0aW9uXCJcbiAgICAgICAgICAgIFtkaXNhYmxlZF09XCJkaXNhYmxlZFwiXG4gICAgICAgICAgICBbcmVhZG9ubHldPVwicmVhZG9ubHlcIlxuICAgICAgICAgICAgW3RhYkluZGV4XT1cInRhYkluZGV4XCJcbiAgICAgICAgICAgIFtwb3B1cE9wZW5dPVwiaXNPcGVuXCJcbiAgICAgICAgICAgIFtwbGFjZWhvbGRlcl09XCJwbGFjZWhvbGRlclwiXG4gICAgICAgICAgICAob25OYXZpZ2F0ZSk9XCJoYW5kbGVOYXZpZ2F0ZSgkZXZlbnQpXCJcbiAgICAgICAgICAgICh2YWx1ZUNoYW5nZSk9XCJzZWFyY2hCYXJDaGFuZ2UoJGV2ZW50KVwiXG4gICAgICAgICAgICAob25CbHVyKT1cImhhbmRsZUJsdXIoKVwiXG4gICAgICAgICAgICAob25Gb2N1cyk9XCJoYW5kbGVGb2N1cygpXCJcbiAgICAgICAgPjwva2VuZG8tc2VhcmNoYmFyPlxuICAgICAgICA8c3BhblxuICAgICAgICAgICAgKm5nSWY9XCIhbG9hZGluZyAmJiAhcmVhZG9ubHkgJiYgKGNsZWFyQnV0dG9uICYmIHRleHQ/Lmxlbmd0aClcIlxuICAgICAgICAgICAgY2xhc3M9XCJrLWNsZWFyLXZhbHVlXCJcbiAgICAgICAgICAgIFtzdHlsZS52aXNpYmlsaXR5XT1cImNsZWFyQnV0dG9uVmlzaWJsaXR5XCJcbiAgICAgICAgICAgIFthdHRyLnRpdGxlXT1cIm1lc3NhZ2VGb3IoJ2NsZWFyVGl0bGUnKVwiXG4gICAgICAgICAgICByb2xlPVwiYnV0dG9uXCJcbiAgICAgICAgICAgIHRhYmluZGV4PVwiLTFcIlxuICAgICAgICAgICAgKGNsaWNrKT1cImNsZWFyVmFsdWUoJGV2ZW50KVwiXG4gICAgICAgICAgICAobW91c2Vkb3duKT1cIiRldmVudC5wcmV2ZW50RGVmYXVsdCgpXCJcbiAgICAgICAgPlxuICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJrLWljb24gay1pLXhcIj48L3NwYW4+XG4gICAgICAgIDwvc3Bhbj5cbiAgICAgICAgPHNwYW4gKm5nSWY9XCJsb2FkaW5nXCIgY2xhc3M9XCJrLWljb24gay1pLWxvYWRpbmdcIj48L3NwYW4+XG4gICAgICAgIDxuZy10ZW1wbGF0ZSAjcG9wdXBUZW1wbGF0ZT5cbiAgICAgICAgICAgIDwhLS1oZWFkZXIgdGVtcGxhdGUtLT5cbiAgICAgICAgICAgIDxuZy10ZW1wbGF0ZSAqbmdJZj1cImhlYWRlclRlbXBsYXRlXCJcbiAgICAgICAgICAgICAgICBbdGVtcGxhdGVDb250ZXh0XT1cIntcbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVSZWY6IGhlYWRlclRlbXBsYXRlLnRlbXBsYXRlUmVmXG4gICAgICAgICAgICAgICAgfVwiPlxuICAgICAgICAgICAgPC9uZy10ZW1wbGF0ZT5cbiAgICAgICAgICAgIDwhLS1saXN0LS0+XG4gICAgICAgICAgICA8a2VuZG8tbGlzdFxuICAgICAgICAgICAgICAgICNvcHRpb25zTGlzdFxuICAgICAgICAgICAgICAgIFtzaXplXT1cInNpemVcIlxuICAgICAgICAgICAgICAgIFtyb3VuZGVkXT1cInJvdW5kZWRcIlxuICAgICAgICAgICAgICAgIFtpZF09XCJsaXN0Qm94SWRcIlxuICAgICAgICAgICAgICAgIFtvcHRpb25QcmVmaXhdPVwib3B0aW9uUHJlZml4XCJcbiAgICAgICAgICAgICAgICBbZGF0YV09XCJkYXRhXCJcbiAgICAgICAgICAgICAgICBbdGV4dEZpZWxkXT1cInZhbHVlRmllbGRcIlxuICAgICAgICAgICAgICAgIFt2YWx1ZUZpZWxkXT1cInZhbHVlRmllbGRcIlxuICAgICAgICAgICAgICAgIFt0ZW1wbGF0ZV09XCJ0ZW1wbGF0ZVwiXG4gICAgICAgICAgICAgICAgW2dyb3VwVGVtcGxhdGVdPVwiZ3JvdXBUZW1wbGF0ZVwiXG4gICAgICAgICAgICAgICAgW2ZpeGVkR3JvdXBUZW1wbGF0ZV09XCJmaXhlZEdyb3VwVGVtcGxhdGVcIlxuICAgICAgICAgICAgICAgIFtoZWlnaHRdPVwibGlzdEhlaWdodFwiXG4gICAgICAgICAgICAgICAgW3Nob3ddPVwiaXNPcGVuXCJcbiAgICAgICAgICAgICAgICBbdmlydHVhbF09XCJ2aXJ0dWFsXCJcbiAgICAgICAgICAgICAgICAocGFnZUNoYW5nZSk9XCJwYWdlQ2hhbmdlKCRldmVudClcIlxuICAgICAgICAgICAgPlxuICAgICAgICAgICAgPC9rZW5kby1saXN0PlxuICAgICAgICAgICAgPCEtLW5vLWRhdGEgdGVtcGxhdGUtLT5cbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJrLW5vLWRhdGFcIiAqbmdJZj1cImRhdGEubGVuZ3RoID09PSAwXCI+XG4gICAgICAgICAgICAgICAgPG5nLXRlbXBsYXRlIFtuZ0lmXT1cIm5vRGF0YVRlbXBsYXRlXCJcbiAgICAgICAgICAgICAgICAgICAgW3RlbXBsYXRlQ29udGV4dF09XCJ7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVJlZjogbm9EYXRhVGVtcGxhdGU/LnRlbXBsYXRlUmVmXG4gICAgICAgICAgICAgICAgICAgIH1cIj5cbiAgICAgICAgICAgICAgICA8L25nLXRlbXBsYXRlPlxuICAgICAgICAgICAgICAgIDxuZy10ZW1wbGF0ZSBbbmdJZl09XCIhbm9EYXRhVGVtcGxhdGVcIj5cbiAgICAgICAgICAgICAgICAgICAgPGRpdj57eyBtZXNzYWdlRm9yKCdub0RhdGFUZXh0JykgfX08L2Rpdj5cbiAgICAgICAgICAgICAgICA8L25nLXRlbXBsYXRlPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8IS0tZm9vdGVyIHRlbXBsYXRlLS0+XG4gICAgICAgICAgICA8bmctdGVtcGxhdGUgKm5nSWY9XCJmb290ZXJUZW1wbGF0ZVwiXG4gICAgICAgICAgICAgICAgW3RlbXBsYXRlQ29udGV4dF09XCJ7XG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlUmVmOiBmb290ZXJUZW1wbGF0ZS50ZW1wbGF0ZVJlZlxuICAgICAgICAgICAgICAgIH1cIj5cbiAgICAgICAgICAgIDwvbmctdGVtcGxhdGU+XG4gICAgICAgIDwvbmctdGVtcGxhdGU+XG4gICAgICAgIDxuZy10ZW1wbGF0ZSBbbmdJZl09XCJpc09wZW5cIj5cbiAgICAgICAgICAgIDxrZW5kby1yZXNpemUtc2Vuc29yIChyZXNpemUpPVwib25SZXNpemUoKVwiPjwva2VuZG8tcmVzaXplLXNlbnNvcj5cbiAgICAgICAgPC9uZy10ZW1wbGF0ZT5cbiAgICAgICAgPG5nLWNvbnRhaW5lciAjY29udGFpbmVyPjwvbmctY29udGFpbmVyPlxuICBgXG4gICAgfSksXG4gICAgX19wYXJhbSgxMCwgT3B0aW9uYWwoKSksIF9fcGFyYW0oMTAsIEluamVjdChUT1VDSF9FTkFCTEVEKSksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjpwYXJhbXR5cGVzXCIsIFtMb2NhbGl6YXRpb25TZXJ2aWNlLFxuICAgICAgICBEYXRhU2VydmljZSxcbiAgICAgICAgUG9wdXBTZXJ2aWNlLFxuICAgICAgICBTZWxlY3Rpb25TZXJ2aWNlLFxuICAgICAgICBOYXZpZ2F0aW9uU2VydmljZSxcbiAgICAgICAgRGlzYWJsZWRJdGVtc1NlcnZpY2UsXG4gICAgICAgIE5nWm9uZSxcbiAgICAgICAgQ2hhbmdlRGV0ZWN0b3JSZWYsXG4gICAgICAgIFJlbmRlcmVyMixcbiAgICAgICAgRWxlbWVudFJlZiwgQm9vbGVhbl0pXG5dLCBBdXRvQ29tcGxldGVDb21wb25lbnQpO1xuXG4vKiB0c2xpbnQ6ZGlzYWJsZTp2YXJpYWJsZS1uYW1lICovXG4vKipcbiAqIEBoaWRkZW5cbiAqL1xuY29uc3QgTXVsdGlzZWxlY3RNZXNzYWdlcyA9IHtcbiAgICAnYXJyYXknOiAnRXhwZWN0ZWQgdmFsdWVzIG9mIGFycmF5IHR5cGUuIFNlZSBodHRwOi8vd3d3LnRlbGVyaWsuY29tL2tlbmRvLWFuZ3VsYXItdWkvY29tcG9uZW50cy9kcm9wZG93bnMvbXVsdGlzZWxlY3QvI3ZhbHVlLXNlbGVjdGlvbicsXG4gICAgJ29iamVjdCc6ICdFeHBlY3RlZCB2YWx1ZXMgb2YgT2JqZWN0IHR5cGUuIFNlZSBodHRwOi8vd3d3LnRlbGVyaWsuY29tL2tlbmRvLWFuZ3VsYXItdWkvY29tcG9uZW50cy9kcm9wZG93bnMvbXVsdGlzZWxlY3QvI3ZhbHVlLXNlbGVjdGlvbicsXG4gICAgJ3ByaW1pdGl2ZSc6ICdFeHBlY3RlZCB2YWx1ZXMgb2YgcHJpbWl0aXZlIHR5cGUuIFNlZSBodHRwOi8vd3d3LnRlbGVyaWsuY29tL2tlbmRvLWFuZ3VsYXItdWkvY29tcG9uZW50cy9kcm9wZG93bnMvbXVsdGlzZWxlY3QvI3ZhbHVlLXNlbGVjdGlvbicsXG4gICAgJ3RleHRBbmRWYWx1ZSc6ICdFeHBlY3RlZCB0ZXh0RmllbGQgYW5kIHZhbHVlRmllbGQgb3B0aW9ucyB0byBiZSBzZXQuIFNlZSBodHRwOi8vd3d3LnRlbGVyaWsuY29tL2tlbmRvLWFuZ3VsYXItdWkvY29tcG9uZW50cy9kcm9wZG93bnMvbXVsdGlzZWxlY3QvI3RvYy1iaW5kLXRvLWFycmF5cy1vZi1jb21wbGV4LWRhdGEnXG59O1xuLyoqXG4gKiBAaGlkZGVuXG4gKi9cbmNvbnN0IE11bHRpU2VsZWN0VHJlZU1lc3NhZ2VzID0ge1xuICAgICdhcnJheSc6ICdFeHBlY3RlZCB2YWx1ZXMgb2YgYXJyYXkgdHlwZS4gU2VlIGh0dHA6Ly93d3cudGVsZXJpay5jb20va2VuZG8tYW5ndWxhci11aS9jb21wb25lbnRzL2Ryb3Bkb3ducy9tdWx0aXNlbGVjdHRyZWUvI3ZhbHVlLXNlbGVjdGlvbicsXG4gICAgJ3ByaW1pdGl2ZSc6ICdFeHBlY3RlZCB2YWx1ZXMgb2YgcHJpbWl0aXZlIHR5cGUuIFNlZSBodHRwOi8vd3d3LnRlbGVyaWsuY29tL2tlbmRvLWFuZ3VsYXItdWkvY29tcG9uZW50cy9kcm9wZG93bnMvbXVsdGlzZWxlY3R0cmVlL3ZhbHVlLWJpbmRpbmcvI3RvYy1wcmltaXRpdmUtdmFsdWVzJyxcbiAgICAnb2JqZWN0JzogJ0V4cGVjdGVkIHZhbHVlcyBvZiB0eXBlIE9iamVjdC4gU2VlIGh0dHA6Ly93d3cudGVsZXJpay5jb20va2VuZG8tYW5ndWxhci11aS9jb21wb25lbnRzL2Ryb3Bkb3ducy9tdWx0aXNlbGVjdHRyZWUvdmFsdWUtYmluZGluZy8jdG9jLW9iamVjdC12YWx1ZXMnLFxuICAgICdkYXRhSXRlbXMnOiAnRXhwZWN0ZWQgZGF0YUl0ZW1zIG9mIHR5cGUgT2JqZWN0W10gdG8gYmUgc2V0LiBTZWUgaHR0cHM6Ly93d3cudGVsZXJpay5jb20va2VuZG8tYW5ndWxhci11aS9jb21wb25lbnRzL2Ryb3Bkb3ducy9hcGkvTXVsdGlTZWxlY3RUcmVlQ29tcG9uZW50LyN0b2MtZGF0YWl0ZW1zJyxcbiAgICAnZGF0YUl0ZW1zTGVuZ3RoJzogJ0V4cGVjdGVkIGRhdGFJdGVtcyBsZW5ndGggdG8gbWF0Y2ggdGhlIG51bWJlciBvZiBwcm92aWRlZCB2YWx1ZXMuIFNlZSBodHRwczovL3d3dy50ZWxlcmlrLmNvbS9rZW5kby1hbmd1bGFyLXVpL2NvbXBvbmVudHMvZHJvcGRvd25zL2FwaS9NdWx0aVNlbGVjdFRyZWVDb21wb25lbnQvI3RvYy1kYXRhaXRlbXMnLFxuICAgICd0ZXh0QW5kVmFsdWUnOiAnRXhwZWN0ZWQgdGV4dEZpZWxkIGFuZCB2YWx1ZUZpZWxkIG9wdGlvbnMgdG8gYmUgc2V0LiBTZWUgaHR0cHM6Ly93d3cudGVsZXJpay5jb20va2VuZG8tYW5ndWxhci11aS9jb21wb25lbnRzL2Ryb3Bkb3ducy9tdWx0aXNlbGVjdHRyZWUvdmFsdWUtYmluZGluZycsXG4gICAgJ3ZhbHVlRGVwdGgnOiAnRXhwZWN0ZWQgdmFsdWVEZXB0aCBvZiB0eXBlIG51bWJlcltdIHRvIGJlIHNldC4gU2VlIGh0dHBzOi8vd3d3LnRlbGVyaWsuY29tL2tlbmRvLWFuZ3VsYXItdWktZGV2ZWxvcC9jb21wb25lbnRzL2Ryb3Bkb3ducy9hcGkvTXVsdGlTZWxlY3RUcmVlQ29tcG9uZW50LyN0b2MtdmFsdWVkZXB0aCcsXG4gICAgJ3ZhbHVlRGVwdGhMZW5ndGgnOiAnRXhwZWN0ZWQgdmFsdWVEZXB0aCBsZW5ndGggdG8gbWF0Y2ggdGhlIG51bWJlciBvZiBwcm92aWRlZCB2YWx1ZXMuIFNlZSBodHRwczovL3d3dy50ZWxlcmlrLmNvbS9rZW5kby1hbmd1bGFyLXVpLWRldmVsb3AvY29tcG9uZW50cy9kcm9wZG93bnMvYXBpL011bHRpU2VsZWN0VHJlZUNvbXBvbmVudC8jdG9jLXZhbHVlZGVwdGgnXG59O1xuLyoqXG4gKiBAaGlkZGVuXG4gKi9cbmNvbnN0IENvbWJvQm94TWVzc2FnZXMgPSB7XG4gICAgJ29iamVjdCc6ICdFeHBlY3RlZCB2YWx1ZSBvZiB0eXBlIE9iamVjdC4gU2VlIGh0dHA6Ly93d3cudGVsZXJpay5jb20va2VuZG8tYW5ndWxhci11aS9jb21wb25lbnRzL2Ryb3Bkb3ducy9jb21ib2JveC8jdG9jLXZhbHVlLXNlbGVjdGlvbicsXG4gICAgJ3ByaW1pdGl2ZSc6ICdFeHBlY3RlZCB2YWx1ZSBvZiBwcmltaXRpdmUgdHlwZS4gU2VlIGh0dHA6Ly93d3cudGVsZXJpay5jb20va2VuZG8tYW5ndWxhci11aS9jb21wb25lbnRzL2Ryb3Bkb3ducy9jb21ib2JveC8jdG9jLXZhbHVlLXNlbGVjdGlvbicsXG4gICAgJ3RleHRBbmRWYWx1ZSc6ICdFeHBlY3RlZCB0ZXh0RmllbGQgYW5kIHZhbHVlRmllbGQgb3B0aW9ucyB0byBiZSBzZXQuIFNlZSBodHRwOi8vd3d3LnRlbGVyaWsuY29tL2tlbmRvLWFuZ3VsYXItdWkvY29tcG9uZW50cy9kcm9wZG93bnMvY29tYm9ib3gvI3RvYy1iaW5kLXRvLWFycmF5cy1vZi1jb21wbGV4LWRhdGEnLFxuICAgICdub0l0ZW1IZWlnaHQnOiAnRXhwZWN0ZWQgdmlydHVhbC5pdGVtSGVpZ2h0IG9mIHR5cGUgbnVtYmVyLidcbn07XG4vKipcbiAqIEBoaWRkZW5cbiAqL1xuY29uc3QgTXVsdGlDb2x1bW5Db21ib0JveE1lc3NhZ2VzID0ge1xuICAgICdkYXRhJzogJ1Byb3ZpZGVkIGRhdGEgbXVzdCBjb25zaXN0IG9ubHkgb2Ygb2JqZWN0cy4gU2VlIGh0dHBzOi8vd3d3LnRlbGVyaWsuY29tL2tlbmRvLWFuZ3VsYXItdWkvY29tcG9uZW50cy9kcm9wZG93bnMvbXVsdGljb2x1bW5jb21ib2JveC9kYXRhLWJpbmRpbmcvJyxcbiAgICAndGV4dEFuZFZhbHVlJzogJ0V4cGVjdGVkIHRleHRGaWVsZCBhbmQgdmFsdWVGaWVsZCBvcHRpb25zIHRvIGJlIHNldC4gU2VlIGh0dHBzOi8vd3d3LnRlbGVyaWsuY29tL2tlbmRvLWFuZ3VsYXItdWkvY29tcG9uZW50cy9kcm9wZG93bnMvbXVsdGljb2x1bW5jb21ib2JveC9kYXRhLWJpbmRpbmcvI3RvYy1maWVsZHMtY29uZmlndXJhdGlvbidcbn07XG4vKipcbiAqIEBoaWRkZW5cbiAqL1xuY29uc3QgRHJvcERvd25MaXN0TWVzc2FnZXMgPSB7XG4gICAgJ2RlZmF1bHRJdGVtJzogJ2RlZmF1bHRJdGVtIGFuZCBkYXRhIGl0ZW1zIG11c3QgYmUgb2Ygc2FtZSB0eXBlLiBTZWUgaHR0cDovL3d3dy50ZWxlcmlrLmNvbS9rZW5kby1hbmd1bGFyLXVpL2NvbXBvbmVudHMvZHJvcGRvd25zL2FwaS9Ecm9wRG93bkxpc3RDb21wb25lbnQvI3RvYy1kZWZhdWx0aXRlbScsXG4gICAgJ29iamVjdCc6ICdFeHBlY3RlZCB2YWx1ZSBvZiB0eXBlIE9iamVjdC4gU2VlIGh0dHA6Ly93d3cudGVsZXJpay5jb20va2VuZG8tYW5ndWxhci11aS9jb21wb25lbnRzL2Ryb3Bkb3ducy9kcm9wZG93bmxpc3QvI3RvYy12YWx1ZS1zZWxlY3Rpb24nLFxuICAgICdwcmltaXRpdmUnOiAnRXhwZWN0ZWQgdmFsdWUgb2YgcHJpbWl0aXZlIHR5cGUuIFNlZSBodHRwOi8vd3d3LnRlbGVyaWsuY29tL2tlbmRvLWFuZ3VsYXItdWkvY29tcG9uZW50cy9kcm9wZG93bnMvZHJvcGRvd25saXN0LyN0b2MtdmFsdWUtc2VsZWN0aW9uJyxcbiAgICAndGV4dEFuZFZhbHVlJzogJ0V4cGVjdGVkIHRleHRGaWVsZCBhbmQgdmFsdWVGaWVsZCBvcHRpb25zIHRvIGJlIHNldC4gU2VlIGh0dHA6Ly93d3cudGVsZXJpay5jb20va2VuZG8tYW5ndWxhci11aS9jb21wb25lbnRzL2Ryb3Bkb3ducy9kcm9wZG93bmxpc3QvI3RvYy1iaW5kLXRvLWFycmF5cy1vZi1jb21wbGV4LWRhdGEnXG59O1xuLyoqXG4gKiBAaGlkZGVuXG4gKi9cbmNvbnN0IERyb3BEb3duVHJlZU1lc3NhZ2VzID0ge1xuICAgICdwcmltaXRpdmUnOiAnRXhwZWN0ZWQgdmFsdWUgb2YgcHJpbWl0aXZlIHR5cGUuIFNlZSBodHRwOi8vd3d3LnRlbGVyaWsuY29tL2tlbmRvLWFuZ3VsYXItdWkvY29tcG9uZW50cy9kcm9wZG93bnMvZHJvcGRvd250cmVlL3ZhbHVlLWJpbmRpbmcvI3RvYy1wcmltaXRpdmUtdmFsdWVzJyxcbiAgICAnb2JqZWN0JzogJ0V4cGVjdGVkIHZhbHVlIG9mIHR5cGUgT2JqZWN0LiBTZWUgaHR0cDovL3d3dy50ZWxlcmlrLmNvbS9rZW5kby1hbmd1bGFyLXVpL2NvbXBvbmVudHMvZHJvcGRvd25zL2Ryb3Bkb3dudHJlZS92YWx1ZS1iaW5kaW5nLyN0b2Mtb2JqZWN0LXZhbHVlcycsXG4gICAgJ2RhdGFJdGVtJzogJ0V4cGVjdGVkIGRhdGFJdGVtIG9mIHR5cGUgT2JqZWN0IHRvIGJlIHNldC4gU2VlIGh0dHBzOi8vd3d3LnRlbGVyaWsuY29tL2tlbmRvLWFuZ3VsYXItdWkvY29tcG9uZW50cy9kcm9wZG93bnMvYXBpL0Ryb3BEb3duVHJlZUNvbXBvbmVudC8jdG9jLWRhdGFpdGVtJyxcbiAgICAndGV4dEFuZFZhbHVlJzogJ0V4cGVjdGVkIHRleHRGaWVsZCBhbmQgdmFsdWVGaWVsZCBvcHRpb25zIHRvIGJlIHNldC4gU2VlIGh0dHBzOi8vd3d3LnRlbGVyaWsuY29tL2tlbmRvLWFuZ3VsYXItdWkvY29tcG9uZW50cy9kcm9wZG93bnMvZHJvcGRvd250cmVlL3ZhbHVlLWJpbmRpbmcnLFxuICAgICd2YWx1ZURlcHRoJzogJ0V4cGVjdGVkIHZhbHVlRGVwdGggdG8gYmUgc2V0LiBTZWUgaHR0cHM6Ly93d3cudGVsZXJpay5jb20va2VuZG8tYW5ndWxhci11aS1kZXZlbG9wL2NvbXBvbmVudHMvZHJvcGRvd25zL2FwaS9Ecm9wRG93blRyZWVDb21wb25lbnQvI3RvYy12YWx1ZWRlcHRoJ1xufTtcblxuLyogdHNsaW50OmRpc2FibGU6bWVtYmVyLW9yZGVyaW5nICovXG52YXIgQ29tYm9Cb3hDb21wb25lbnRfMTtcbi8qKlxuICogQGhpZGRlblxuICovXG5jb25zdCBDT01CT0JPWF9WQUxVRV9BQ0NFU1NPUiA9IHtcbiAgICBtdWx0aTogdHJ1ZSxcbiAgICBwcm92aWRlOiBOR19WQUxVRV9BQ0NFU1NPUixcbiAgICB1c2VFeGlzdGluZzogZm9yd2FyZFJlZigoKSA9PiBDb21ib0JveENvbXBvbmVudClcbn07XG4vKipcbiAqIFJlcHJlc2VudHMgdGhlIFtLZW5kbyBVSSBDb21ib0JveCBjb21wb25lbnQgZm9yIEFuZ3VsYXJdKHslIHNsdWcgb3ZlcnZpZXdfY29tYm9ib3ggJX0pLlxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGB0c1xuICogX0BDb21wb25lbnQoe1xuICogc2VsZWN0b3I6ICdteS1hcHAnLFxuICogdGVtcGxhdGU6IGBcbiAqICA8a2VuZG8tY29tYm9ib3ggW2RhdGFdPVwibGlzdEl0ZW1zXCI+XG4gKiAgPC9rZW5kby1jb21ib2JveD5cbiAqIGBcbiAqIH0pXG4gKiBjbGFzcyBBcHBDb21wb25lbnQge1xuICogICBwdWJsaWMgbGlzdEl0ZW1zOiBBcnJheTxzdHJpbmc+ID0gW1wiSXRlbSAxXCIsIFwiSXRlbSAyXCIsIFwiSXRlbSAzXCIsIFwiSXRlbSA0XCJdO1xuICogfVxuICogYGBgXG4gKi9cbmxldCBDb21ib0JveENvbXBvbmVudCA9IENvbWJvQm94Q29tcG9uZW50XzEgPSBjbGFzcyBDb21ib0JveENvbXBvbmVudCB7XG4gICAgY29uc3RydWN0b3Iod3JhcHBlciwgbG9jYWxpemF0aW9uLCBwb3B1cFNlcnZpY2UsIHNlbGVjdGlvblNlcnZpY2UsIG5hdmlnYXRpb25TZXJ2aWNlLCBkaXNhYmxlZEl0ZW1zU2VydmljZSwgZGF0YVNlcnZpY2UsIHpvbmUsIGNkciwgcmVuZGVyZXIsIHRvdWNoRW5hYmxlZCQkMSkge1xuICAgICAgICB0aGlzLndyYXBwZXIgPSB3cmFwcGVyO1xuICAgICAgICB0aGlzLmxvY2FsaXphdGlvbiA9IGxvY2FsaXphdGlvbjtcbiAgICAgICAgdGhpcy5wb3B1cFNlcnZpY2UgPSBwb3B1cFNlcnZpY2U7XG4gICAgICAgIHRoaXMuc2VsZWN0aW9uU2VydmljZSA9IHNlbGVjdGlvblNlcnZpY2U7XG4gICAgICAgIHRoaXMubmF2aWdhdGlvblNlcnZpY2UgPSBuYXZpZ2F0aW9uU2VydmljZTtcbiAgICAgICAgdGhpcy5kaXNhYmxlZEl0ZW1zU2VydmljZSA9IGRpc2FibGVkSXRlbXNTZXJ2aWNlO1xuICAgICAgICB0aGlzLmRhdGFTZXJ2aWNlID0gZGF0YVNlcnZpY2U7XG4gICAgICAgIHRoaXMuem9uZSA9IHpvbmU7XG4gICAgICAgIHRoaXMuY2RyID0gY2RyO1xuICAgICAgICB0aGlzLnJlbmRlcmVyID0gcmVuZGVyZXI7XG4gICAgICAgIHRoaXMudG91Y2hFbmFibGVkID0gdG91Y2hFbmFibGVkJCQxO1xuICAgICAgICB0aGlzLnNlbGVjdGVkID0gW107XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAaGlkZGVuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmZvY3VzYWJsZUlkID0gYGstJHtndWlkJDEoKX1gO1xuICAgICAgICAvKipcbiAgICAgICAgICogU3BlY2lmaWVzIHdoZXRoZXIgdGhlIENvbWJvQm94IGFsbG93cyB1c2VyLWRlZmluZWQgdmFsdWVzIHRoYXQgYXJlIG5vdCBwcmVzZW50IGluIHRoZSBkYXRhc2V0XG4gICAgICAgICAqIChbbW9yZSBpbmZvcm1hdGlvbiBhbmQgZXhhbXBsZXNdKHslIHNsdWcgY3VzdG9tX3ZhbHVlc19jb21ib2JveCAlfSkpLlxuICAgICAgICAgKiBEZWZhdWx0cyB0byBgZmFsc2VgLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5hbGxvd0N1c3RvbSA9IGZhbHNlO1xuICAgICAgICAvKipcbiAgICAgICAgICogQSB1c2VyLWRlZmluZWQgY2FsbGJhY2sgd2hpY2ggcmV0dXJucyBub3JtYWxpemVkIGN1c3RvbSB2YWx1ZXMuXG4gICAgICAgICAqIFR5cGljYWxseSB1c2VkIHdoZW4gdGhlIGRhdGEgaXRlbXMgYXJlIGRpZmZlcmVudCBmcm9tIHR5cGUgYHN0cmluZ2AuXG4gICAgICAgICAqIEBwYXJhbSB7IEFueSB9IHZhbHVlIC0gVGhlIGN1c3RvbSB2YWx1ZSBkZWZpbmVkIGJ5IHRoZSB1c2VyLlxuICAgICAgICAgKiBAcmV0dXJucyB7IEFueSB9XG4gICAgICAgICAqXG4gICAgICAgICAqIEBleGFtcGxlXG4gICAgICAgICAqIGBgYHRzXG4gICAgICAgICAqIGltcG9ydCB7IG1hcCB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcbiAgICAgICAgICpcbiAgICAgICAgICogX0BDb21wb25lbnQoe1xuICAgICAgICAgKiBzZWxlY3RvcjogJ215LWFwcCcsXG4gICAgICAgICAqIHRlbXBsYXRlOiBgXG4gICAgICAgICAqICAgPGtlbmRvLWNvbWJvYm94XG4gICAgICAgICAqICAgICAgIFthbGxvd0N1c3RvbV09XCJ0cnVlXCJcbiAgICAgICAgICogICAgICAgW2RhdGFdPVwibGlzdEl0ZW1zXCJcbiAgICAgICAgICogICAgICAgdGV4dEZpZWxkPVwidGV4dFwiXG4gICAgICAgICAqICAgICAgIHZhbHVlRmllbGQ9XCJ2YWx1ZVwiXG4gICAgICAgICAqICAgICAgIFt2YWx1ZU5vcm1hbGl6ZXJdPVwidmFsdWVOb3JtYWxpemVyXCJcbiAgICAgICAgICogICAgICAgKHZhbHVlQ2hhbmdlKT1cIm9uVmFsdWVDaGFuZ2UoJGV2ZW50KVwiXG4gICAgICAgICAqICAgPlxuICAgICAgICAgKiAgIDwva2VuZG8tY29tYm9ib3g+XG4gICAgICAgICAqIGBcbiAgICAgICAgICogfSlcbiAgICAgICAgICpcbiAgICAgICAgICogY2xhc3MgQXBwQ29tcG9uZW50IHtcbiAgICAgICAgICogICBwdWJsaWMgbGlzdEl0ZW1zOiBBcnJheTx7IHRleHQ6IHN0cmluZywgdmFsdWU6IG51bWJlciB9PiA9IFtcbiAgICAgICAgICogICAgICAgeyB0ZXh0OiBcIlNtYWxsXCIsIHZhbHVlOiAxIH0sXG4gICAgICAgICAqICAgICAgIHsgdGV4dDogXCJNZWRpdW1cIiwgdmFsdWU6IDIgfSxcbiAgICAgICAgICogICAgICAgeyB0ZXh0OiBcIkxhcmdlXCIsIHZhbHVlOiAzIH1cbiAgICAgICAgICogICBdO1xuICAgICAgICAgKlxuICAgICAgICAgKiAgIHB1YmxpYyBvblZhbHVlQ2hhbmdlKHZhbHVlKSB7XG4gICAgICAgICAqICAgICAgIGNvbnNvbGUubG9nKFwidmFsdWVDaGFuZ2UgOiBcIiwgdmFsdWUpO1xuICAgICAgICAgKiAgIH1cbiAgICAgICAgICpcbiAgICAgICAgICogICBwdWJsaWMgdmFsdWVOb3JtYWxpemVyID0gKHRleHQkOiBPYnNlcnZhYmxlPHN0cmluZz4pID0+IHRleHQkLnBpcGUobWFwKCh0ZXh0OiBzdHJpbmcpID0+IHtcbiAgICAgICAgICogICAgICByZXR1cm4geyBQcm9kdWN0SUQ6IG51bGwsIFByb2R1Y3ROYW1lOiB0ZXh0IH07XG4gICAgICAgICAqICAgfSkpO1xuICAgICAgICAgKlxuICAgICAgICAgKiB9XG4gICAgICAgICAqIGBgYFxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy52YWx1ZU5vcm1hbGl6ZXIgPSAodGV4dCkgPT4gdGV4dC5waXBlKG1hcCgodXNlcklucHV0KSA9PiB1c2VySW5wdXQpKTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBoaW50IHRoYXQgaXMgZGlzcGxheWVkIHdoZW4gdGhlIGNvbXBvbmVudCBpcyBlbXB0eS5cbiAgICAgICAgICpcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMucGxhY2Vob2xkZXIgPSBcIlwiO1xuICAgICAgICAvKipcbiAgICAgICAgICogU2V0cyB0aGUgaGVpZ2h0IG9mIHRoZSBzdWdnZXN0aW9ucyBsaXN0LiBCeSBkZWZhdWx0LCBgbGlzdEhlaWdodGAgaXMgMjAwcHguXG4gICAgICAgICAqXG4gICAgICAgICAqID4gVGhlIGBsaXN0SGVpZ2h0YCBwcm9wZXJ0eSBhZmZlY3RzIG9ubHkgdGhlIGxpc3Qgb2Ygc3VnZ2VzdGlvbnMgYW5kIG5vdCB0aGUgd2hvbGUgcG9wdXAgY29udGFpbmVyLlxuICAgICAgICAgKiA+IFRvIHNldCB0aGUgaGVpZ2h0IG9mIHRoZSBwb3B1cCBjb250YWluZXIsIHVzZSBgcG9wdXBTZXR0aW5ncy5oZWlnaHRgLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5saXN0SGVpZ2h0ID0gMjAwO1xuICAgICAgICAvKipcbiAgICAgICAgICogRW5hYmxlcyB0aGUgYXV0by1jb21wbGV0aW9uIG9mIHRoZSB0ZXh0IGJhc2VkIG9uIHRoZSBmaXJzdCBkYXRhIGl0ZW0uXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnN1Z2dlc3QgPSBmYWxzZTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIElmIHNldCB0byBgdHJ1ZWAsIHJlbmRlcnMgYSBidXR0b24gb24gaG92ZXJpbmcgb3ZlciB0aGUgY29tcG9uZW50LlxuICAgICAgICAgKiBDbGlja2luZyB0aGlzIGJ1dHRvbiByZXNldHMgdGhlIHZhbHVlIG9mIHRoZSBjb21wb25lbnQgdG8gYHVuZGVmaW5lZGAgYW5kIHRyaWdnZXJzIHRoZSBgY2hhbmdlYCBldmVudC5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuY2xlYXJCdXR0b24gPSB0cnVlO1xuICAgICAgICAvKipcbiAgICAgICAgICogU2V0cyB0aGUgZGlzYWJsZWQgc3RhdGUgb2YgdGhlIGNvbXBvbmVudC5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuZGlzYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFNldHMgdGhlIHJlYWQtb25seSBzdGF0ZSBvZiB0aGUgY29tcG9uZW50LlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5yZWFkb25seSA9IGZhbHNlO1xuICAgICAgICAvKipcbiAgICAgICAgICogU3BlY2lmaWVzIHRoZSBbYHRhYmluZGV4YF0oaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvSFRNTC9HbG9iYWxfYXR0cmlidXRlcy90YWJpbmRleCkgb2YgdGhlIGNvbXBvbmVudC5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMudGFiaW5kZXggPSAwO1xuICAgICAgICAvKipcbiAgICAgICAgICogRW5hYmxlcyB0aGUgW2ZpbHRlcmluZ10oeyUgc2x1ZyBmaWx0ZXJpbmdfY29tYm9ib3ggJX0pIGZ1bmN0aW9uYWxpdHkuXG4gICAgICAgICAqIElmIHNldCB0byBgdHJ1ZWAsIHRoZSBjb21wb25lbnQgZW1pdHMgdGhlIGBmaWx0ZXJDaGFuZ2VgIGV2ZW50LlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5maWx0ZXJhYmxlID0gZmFsc2U7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBGaXJlcyBlYWNoIHRpbWUgdGhlIHZhbHVlIGlzIGNoYW5nZWQmbWRhc2g7XG4gICAgICAgICAqIHdoZW4gdGhlIGNvbXBvbmVudCBpcyBibHVycmVkIG9yIHRoZSB2YWx1ZSBpcyBjbGVhcmVkIHRocm91Z2ggdGhlICoqQ2xlYXIqKiBidXR0b25cbiAgICAgICAgICogKFtzZWUgZXhhbXBsZV0oeyUgc2x1ZyBvdmVydmlld19jb21ib2JveCAlfSN0b2MtZXZlbnRzKSkuXG4gICAgICAgICAqIFdoZW4gdGhlIHZhbHVlIG9mIHRoZSBjb21wb25lbnQgaXMgcHJvZ3JhbW1hdGljYWxseSBjaGFuZ2VkIHRvIGBuZ01vZGVsYCBvciBgZm9ybUNvbnRyb2xgXG4gICAgICAgICAqIHRocm91Z2ggaXRzIEFQSSBvciBmb3JtIGJpbmRpbmcsIHRoZSBgdmFsdWVDaGFuZ2VgIGV2ZW50IGlzIG5vdCB0cmlnZ2VyZWQgYmVjYXVzZSBpdFxuICAgICAgICAgKiBtaWdodCBjYXVzZSBhIG1peC11cCB3aXRoIHRoZSBidWlsdC1pbiBgdmFsdWVDaGFuZ2VgIG1lY2hhbmlzbXMgb2YgdGhlIGBuZ01vZGVsYCBvciBgZm9ybUNvbnRyb2xgIGJpbmRpbmdzLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy52YWx1ZUNoYW5nZSA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEZpcmVzIGVhY2ggdGltZSBhbiBpdGVtIHNlbGVjdGlvbiBpcyBjaGFuZ2VkXG4gICAgICAgICAqIChbc2VlIGV4YW1wbGVdKHslIHNsdWcgb3ZlcnZpZXdfY29tYm9ib3ggJX0jdG9jLWV2ZW50cykpLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5zZWxlY3Rpb25DaGFuZ2UgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBGaXJlcyBlYWNoIHRpbWUgdGhlIHVzZXIgdHlwZXMgaW4gdGhlIGlucHV0IGZpZWxkLlxuICAgICAgICAgKiBZb3UgY2FuIGZpbHRlciB0aGUgc291cmNlIGJhc2VkIG9uIHRoZSBwYXNzZWQgZmlsdHJhdGlvbiB2YWx1ZVxuICAgICAgICAgKiAoW3NlZSBleGFtcGxlXSh7JSBzbHVnIG92ZXJ2aWV3X2NvbWJvYm94ICV9I3RvYy1ldmVudHMpKS5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuZmlsdGVyQ2hhbmdlID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICAgICAgICAvKipcbiAgICAgICAgICogRmlyZXMgZWFjaCB0aW1lIHRoZSBwb3B1cCBpcyBhYm91dCB0byBvcGVuLlxuICAgICAgICAgKiBUaGlzIGV2ZW50IGlzIHByZXZlbnRhYmxlLiBJZiB5b3UgY2FuY2VsIGl0LCB0aGUgcG9wdXAgd2lsbCByZW1haW4gY2xvc2VkLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5vcGVuID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICAgICAgICAvKipcbiAgICAgICAgICogRmlyZXMgYWZ0ZXIgdGhlIHBvcHVwIGhhcyBiZWVuIG9wZW5lZC5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMub3BlbmVkID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICAgICAgICAvKipcbiAgICAgICAgICogRmlyZXMgZWFjaCB0aW1lIHRoZSBwb3B1cCBpcyBhYm91dCB0byBjbG9zZS5cbiAgICAgICAgICogVGhpcyBldmVudCBpcyBwcmV2ZW50YWJsZS4gSWYgeW91IGNhbmNlbCBpdCwgdGhlIHBvcHVwIHdpbGwgcmVtYWluIG9wZW4uXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmNsb3NlID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICAgICAgICAvKipcbiAgICAgICAgICogRmlyZXMgYWZ0ZXIgdGhlIHBvcHVwIGhhcyBiZWVuIGNsb3NlZC5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuY2xvc2VkID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICAgICAgICAvKipcbiAgICAgICAgICogRmlyZXMgZWFjaCB0aW1lIHRoZSB1c2VyIGZvY3VzZXMgdGhlIENvbWJvQm94LlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5vbkZvY3VzID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICAgICAgICAvKipcbiAgICAgICAgICogRmlyZXMgZWFjaCB0aW1lIHRoZSBDb21ib0JveCBnZXRzIGJsdXJyZWQuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLm9uQmx1ciA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcbiAgICAgICAgdGhpcy53aWRnZXRDbGFzc2VzID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5faXNGb2N1c2VkID0gZmFsc2U7XG4gICAgICAgIHRoaXMubGlzdEJveElkID0gZ3VpZCQxKCk7XG4gICAgICAgIHRoaXMub3B0aW9uUHJlZml4ID0gZ3VpZCQxKCk7XG4gICAgICAgIHRoaXMub25DaGFuZ2VDYWxsYmFjayA9IChfKSA9PiB7IH07XG4gICAgICAgIHRoaXMub25Ub3VjaGVkQ2FsbGJhY2sgPSAoXykgPT4geyB9O1xuICAgICAgICAvKipcbiAgICAgICAgICogVXNlZCBmb3IgdGhlIGRlZmF1bHQgdmlydHVhbGl6YXRpb24gc2V0dGluZ3MgY29uZmlnLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5kZWZhdWx0VmlydHVhbEl0ZW1IZWlnaHQgPSAyODtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFVzZWQgZm9yIHRoZSBkZWZhdWx0IHZpcnR1YWxpemF0aW9uIHNldHRpbmdzIGNvbmZpZy5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuZGVmYXVsdFZpcnR1YWxQYWdlU2l6ZSA9IDUwO1xuICAgICAgICB0aGlzLl9maWx0ZXJpbmcgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5fdGV4dCA9ICcnO1xuICAgICAgICB0aGlzLmZpbHRlclRleHQgPSAnJztcbiAgICAgICAgdGhpcy5fb3BlbiA9IGZhbHNlO1xuICAgICAgICB0aGlzLl9wb3B1cFNldHRpbmdzID0geyBhbmltYXRlOiB0cnVlIH07XG4gICAgICAgIHRoaXMucG9wdXBNb3VzZURvd25IYW5kbGVyID0gKGV2ZW50KSA9PiBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICB0aGlzLmN1c3RvbVZhbHVlU3ViamVjdCA9IG5ldyBTdWJqZWN0KCk7XG4gICAgICAgIHRoaXMudmFsdWVTdWJqZWN0ID0gbmV3IFN1YmplY3QoKTtcbiAgICAgICAgdGhpcy5jbGVhclZhbHVlU3ViamVjdCA9IG5ldyBTdWJqZWN0KCk7XG4gICAgICAgIHRoaXMuc3VicyA9IG5ldyBTdWJzY3JpcHRpb24oKTtcbiAgICAgICAgdGhpcy5fc2l6ZSA9ICdtZWRpdW0nO1xuICAgICAgICB0aGlzLl9yb3VuZGVkID0gJ21lZGl1bSc7XG4gICAgICAgIHRoaXMuX2ZpbGxNb2RlID0gJ3NvbGlkJztcbiAgICAgICAgdmFsaWRhdGVQYWNrYWdlKHBhY2thZ2VNZXRhZGF0YSk7XG4gICAgICAgIHRoaXMuZGlyZWN0aW9uID0gbG9jYWxpemF0aW9uLnJ0bCA/ICdydGwnIDogJ2x0cic7XG4gICAgICAgIHRoaXMuZGF0YSA9IFtdO1xuICAgIH1cbiAgICBzZXQgdGV4dCh0ZXh0KSB7XG4gICAgICAgIHRoaXMuX3RleHQgPSBpc1ByZXNlbnQodGV4dCkgPyB0ZXh0LnRvU3RyaW5nKCkgOiBcIlwiO1xuICAgIH1cbiAgICBnZXQgdGV4dCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3RleHQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICB0b2dnbGVQb3B1cChvcGVuKSB7XG4gICAgICAgIGNvbnN0IGlzRGlzYWJsZWQgPSB0aGlzLmRpc2FibGVkIHx8IHRoaXMucmVhZG9ubHk7XG4gICAgICAgIGNvbnN0IHNhbWVTdGF0ZSA9IHRoaXMuaXNPcGVuID09PSBvcGVuO1xuICAgICAgICBpZiAoaXNEaXNhYmxlZCB8fCBzYW1lU3RhdGUpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBpc0RlZmF1bHRQcmV2ZW50ZWQgPSB0aGlzLnRyaWdnZXJQb3B1cEV2ZW50cyhvcGVuKTtcbiAgICAgICAgaWYgKCFpc0RlZmF1bHRQcmV2ZW50ZWQpIHtcbiAgICAgICAgICAgIHRoaXMuX3RvZ2dsZShvcGVuKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBnZXQgYWN0aXZlRGVzY2VuZGFudCgpIHtcbiAgICAgICAgaWYgKCF0aGlzLmlzT3BlbiB8fCAhaXNQcmVzZW50KHRoaXMuc2VsZWN0aW9uU2VydmljZS5mb2N1c2VkKSB8fCB0aGlzLnNlbGVjdGlvblNlcnZpY2UuZm9jdXNlZCA9PT0gLTEpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGRhdGFJdGVtID0gdGhpcy5kYXRhU2VydmljZS5pdGVtQXQodGhpcy5zZWxlY3Rpb25TZXJ2aWNlLmZvY3VzZWQpO1xuICAgICAgICByZXR1cm4gdGhpcy5vcHRpb25QcmVmaXggKyBcIi1cIiArIChkYXRhSXRlbSA/IGdldHRlciQxKGRhdGFJdGVtLCB0aGlzLnZhbHVlRmllbGQpIDogXCJcIik7XG4gICAgfVxuICAgIGdldCBub0RhdGFMYWJlbCgpIHtcbiAgICAgICAgaWYgKHRoaXMuZGF0YS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm1lc3NhZ2VGb3IoJ25vRGF0YVRleHQnKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBnZXQgYXBwZW5kVG8oKSB7XG4gICAgICAgIGNvbnN0IHsgYXBwZW5kVG8gfSA9IHRoaXMucG9wdXBTZXR0aW5ncztcbiAgICAgICAgaWYgKCFhcHBlbmRUbyB8fCBhcHBlbmRUbyA9PT0gJ3Jvb3QnKSB7XG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhcHBlbmRUbyA9PT0gJ2NvbXBvbmVudCcgPyB0aGlzLmNvbnRhaW5lciA6IGFwcGVuZFRvO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZXRzIHRoZSBkYXRhIG9mIHRoZSBDb21ib0JveC5cbiAgICAgKlxuICAgICAqID4gVGhlIGRhdGEgaGFzIHRvIGJlIHByb3ZpZGVkIGluIGFuIGFycmF5LWxpa2UgbGlzdC5cbiAgICAgKi9cbiAgICBzZXQgZGF0YShkYXRhKSB7XG4gICAgICAgIHRoaXMuZGF0YVNlcnZpY2UuZGF0YSA9IGRhdGEgfHwgW107XG4gICAgICAgIGlmICh0aGlzLnZpcnR1YWwpIHtcbiAgICAgICAgICAgIHRoaXMudmlydHVhbC5za2lwID0gMDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnNldFN0YXRlKCk7XG4gICAgICAgIGlmICh0aGlzLl9maWx0ZXJpbmcpIHtcbiAgICAgICAgICAgIGNvbnN0IHF1ZXJ5QW5kRGF0YVByZXNlbnQgPSB0aGlzLnRleHQubGVuZ3RoID4gMCAmJiB0aGlzLmRhdGFTZXJ2aWNlLml0ZW1zQ291bnQgPiAwO1xuICAgICAgICAgICAgY29uc3QgaW5kZXggPSBxdWVyeUFuZERhdGFQcmVzZW50ID8gdGhpcy5maXJzdEZvY3VzYWJsZUluZGV4KDApIDogLTE7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdGlvblNlcnZpY2UuZm9jdXNlZCA9IGluZGV4O1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnN1Z2dlc3QgJiYgdGhpcy5kYXRhU2VydmljZS5pdGVtc0NvdW50ICYmIHRoaXMudGV4dCkge1xuICAgICAgICAgICAgdGhpcy5zdWdnZXN0ZWRUZXh0ID0gZ2V0dGVyJDEodGhpcy5kYXRhU2VydmljZS5pdGVtQXQoMCksIHRoaXMudGV4dEZpZWxkKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBnZXQgZGF0YSgpIHtcbiAgICAgICAgY29uc3QgdmlydHVhbCA9IHRoaXMudmlydHVhbDtcbiAgICAgICAgaWYgKHZpcnR1YWwpIHtcbiAgICAgICAgICAgIGNvbnN0IHN0YXJ0ID0gdmlydHVhbC5za2lwIHx8IDA7XG4gICAgICAgICAgICBjb25zdCBlbmQgPSBzdGFydCArIHZpcnR1YWwucGFnZVNpemU7XG4gICAgICAgICAgICAvLyBVc2UgbGVuZ3RoIGluc3RlYWQgb2YgaXRlbXNDb3VudCBiZWNhdXNlIG9mIHRoZSBncm91cGluZy5cbiAgICAgICAgICAgIHZpcnR1YWwudG90YWwgPSB0aGlzLmRhdGFTZXJ2aWNlLmRhdGEubGVuZ3RoO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZGF0YVNlcnZpY2UuZGF0YS5zbGljZShzdGFydCwgZW5kKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5kYXRhU2VydmljZS5kYXRhO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZXRzIHRoZSB2YWx1ZSBvZiB0aGUgQ29tYm9Cb3guXG4gICAgICogSXQgY2FuIGVpdGhlciBiZSBvZiB0aGUgcHJpbWl0aXZlIChzdHJpbmcsIG51bWJlcnMpIG9yIG9mIHRoZSBjb21wbGV4IChvYmplY3RzKSB0eXBlLlxuICAgICAqIFRvIGRlZmluZSB0aGUgdHlwZSwgdXNlIHRoZSBgdmFsdWVQcmltaXRpdmVgIG9wdGlvbi5cbiAgICAgKlxuICAgICAqID4gQWxsIHNlbGVjdGVkIHZhbHVlcyB3aGljaCBhcmUgbm90IHByZXNlbnQgaW4gdGhlIGRhdGFzZXQgYXJlIGNvbnNpZGVyZWQgY3VzdG9tIHZhbHVlcy5cbiAgICAgKiA+IFdoZW4gdGhlIGBFbnRlcmAga2V5IGlzIHByZXNzZWQgb3IgdGhlIGNvbXBvbmVudCBsb3NlcyBmb2N1cywgY3VzdG9tIHZhbHVlcyBnZXQgZGlzbWlzc2VkIHVubGVzcyBgYWxsb3dDdXN0b21gIGlzIHNldCB0byBgdHJ1ZWAuXG4gICAgICovXG4gICAgc2V0IHZhbHVlKG5ld1ZhbHVlKSB7XG4gICAgICAgIHRoaXMuX3ZhbHVlID0gbmV3VmFsdWU7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoKTtcbiAgICAgICAgdGhpcy5jZHIubWFya0ZvckNoZWNrKCk7XG4gICAgfVxuICAgIGdldCB2YWx1ZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3ZhbHVlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTcGVjaWZpZXMgdGhlIHR5cGUgb2YgdGhlIHNlbGVjdGVkIHZhbHVlLlxuICAgICAqIElmIHNldCB0byBgdHJ1ZWAsIHRoZSBzZWxlY3RlZCB2YWx1ZSBoYXMgdG8gYmUgb2YgdGhlIHByaW1pdGl2ZSB0eXBlXG4gICAgICogKFttb3JlIGluZm9ybWF0aW9uIGFuZCBleGFtcGxlXSh7JSBzbHVnIHZhbHVlYmluZGluZ19jb21ib2JveCAlfSN0b2MtcHJpbWl0aXZlLXZhbHVlcy1mcm9tLW9iamVjdC1maWVsZHMpKS5cbiAgICAgKi9cbiAgICBzZXQgdmFsdWVQcmltaXRpdmUoaXNQcmltaXRpdmUpIHtcbiAgICAgICAgdGhpcy5fdmFsdWVQcmltaXRpdmUgPSBpc1ByaW1pdGl2ZTtcbiAgICB9XG4gICAgZ2V0IHZhbHVlUHJpbWl0aXZlKCkge1xuICAgICAgICBpZiAoIWlzUHJlc2VudCh0aGlzLl92YWx1ZVByaW1pdGl2ZSkpIHtcbiAgICAgICAgICAgIHJldHVybiAhaXNQcmVzZW50KHRoaXMudmFsdWVGaWVsZCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuX3ZhbHVlUHJpbWl0aXZlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDb25maWd1cmVzIHRoZSBwb3B1cCBvZiB0aGUgQ29tYm9Cb3guXG4gICAgICpcbiAgICAgKiBUaGUgYXZhaWxhYmxlIG9wdGlvbnMgYXJlOlxuICAgICAqIC0gYGFuaW1hdGU6IEJvb2xlYW5gJm1kYXNoO0NvbnRyb2xzIHRoZSBwb3B1cCBhbmltYXRpb24uIEJ5IGRlZmF1bHQsIHRoZSBvcGVuIGFuZCBjbG9zZSBhbmltYXRpb25zIGFyZSBlbmFibGVkLlxuICAgICAqIC0gYHdpZHRoOiBOdW1iZXIgfCBTdHJpbmdgJm1kYXNoO1NldHMgdGhlIHdpZHRoIG9mIHRoZSBwb3B1cCBjb250YWluZXIuIEJ5IGRlZmF1bHQsIHRoZSB3aWR0aCBvZiB0aGUgaG9zdCBlbGVtZW50IGlzIHVzZWQuIElmIHNldCB0byBgYXV0b2AsIHRoZSBjb21wb25lbnQgYXV0b21hdGljYWxseSBhZGp1c3RzIHRoZSB3aWR0aCBvZiB0aGUgcG9wdXAgYW5kIG5vIGl0ZW0gbGFiZWxzIGFyZSB3cmFwcGVkLiBUaGUgYGF1dG9gIG1vZGUgaXMgbm90IHN1cHBvcnRlZCB3aGVuIHZpcnR1YWwgc2Nyb2xsaW5nIGlzIGVuYWJsZWQuXG4gICAgICogLSBgaGVpZ2h0OiBOdW1iZXJgJm1kYXNoO1NldHMgdGhlIGhlaWdodCBvZiB0aGUgcG9wdXAgY29udGFpbmVyLlxuICAgICAqIC0gYHBvcHVwQ2xhc3M6IFN0cmluZ2AmbWRhc2g7U3BlY2lmaWVzIGEgbGlzdCBvZiBDU1MgY2xhc3NlcyB0aGF0IGFyZSB1c2VkIHRvIHN0eWxlIHRoZSBwb3B1cC5cbiAgICAgKiAtIGBhcHBlbmRUbzogXCJyb290XCIgfCBcImNvbXBvbmVudFwiIHwgVmlld0NvbnRhaW5lclJlZmAmbWRhc2g7U3BlY2lmaWVzIHRoZSBjb21wb25lbnQgdG8gd2hpY2ggdGhlIHBvcHVwIHdpbGwgYmUgYXBwZW5kZWQuXG4gICAgICovXG4gICAgc2V0IHBvcHVwU2V0dGluZ3Moc2V0dGluZ3MpIHtcbiAgICAgICAgdGhpcy5fcG9wdXBTZXR0aW5ncyA9IE9iamVjdC5hc3NpZ24oeyBhbmltYXRlOiB0cnVlIH0sIHNldHRpbmdzKTtcbiAgICB9XG4gICAgZ2V0IHBvcHVwU2V0dGluZ3MoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9wb3B1cFNldHRpbmdzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBEZWZpbmVzIGEgQm9vbGVhbiBmdW5jdGlvbiB0aGF0IGlzIGV4ZWN1dGVkIGZvciBlYWNoIGRhdGEgaXRlbSBpbiB0aGUgY29tcG9uZW50XG4gICAgICogKFtzZWUgZXhhbXBsZXNdKHslIHNsdWcgZGlzYWJsZWRpdGVtc19jb21ib2JveCAlfSkpLiBEZXRlcm1pbmVzIHdoZXRoZXIgdGhlIGl0ZW0gd2lsbCBiZSBkaXNhYmxlZC5cbiAgICAgKi9cbiAgICBzZXQgaXRlbURpc2FibGVkKGZuKSB7XG4gICAgICAgIGlmICh0eXBlb2YgZm4gIT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgaXRlbURpc2FibGVkIG11c3QgYmUgYSBmdW5jdGlvbiwgYnV0IHJlY2VpdmVkICR7SlNPTi5zdHJpbmdpZnkoZm4pfS5gKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmRpc2FibGVkSXRlbXNTZXJ2aWNlLml0ZW1EaXNhYmxlZCA9IGZuO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgc2V0IHRhYkluZGV4KHRhYkluZGV4KSB7XG4gICAgICAgIHRoaXMudGFiaW5kZXggPSB0YWJJbmRleDtcbiAgICB9XG4gICAgZ2V0IHRhYkluZGV4KCkge1xuICAgICAgICByZXR1cm4gdGhpcy50YWJpbmRleDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogRW5hYmxlcyB0aGUgW3ZpcnR1YWxpemF0aW9uXSh7JSBzbHVnIHZpcnR1YWxpemF0aW9uX2NvbWJvYm94ICV9KSBmdW5jdGlvbmFsaXR5LlxuICAgICAqL1xuICAgIHNldCB2aXJ0dWFsKHNldHRpbmdzKSB7XG4gICAgICAgIHRoaXMuX3ZpcnR1YWxTZXR0aW5ncyA9IG5vcm1hbGl6ZVZpcnR1YWxpemF0aW9uU2V0dGluZ3Moc2V0dGluZ3MsIHtcbiAgICAgICAgICAgIGl0ZW1IZWlnaHQ6IHRoaXMuZGVmYXVsdFZpcnR1YWxJdGVtSGVpZ2h0LFxuICAgICAgICAgICAgcGFnZVNpemU6IHRoaXMuZGVmYXVsdFZpcnR1YWxQYWdlU2l6ZVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgZ2V0IHZpcnR1YWwoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl92aXJ0dWFsU2V0dGluZ3M7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNldHMgdGhlIHNpemUgb2YgdGhlIGNvbXBvbmVudC5cbiAgICAgKlxuICAgICAqIFRoZSBwb3NzaWJsZSB2YWx1ZXMgYXJlOlxuICAgICAqICogYCdzbWFsbCdgXG4gICAgICogKiBgJ21lZGl1bSdgIChkZWZhdWx0KVxuICAgICAqICogYCdsYXJnZSdgXG4gICAgICogKiBgbnVsbGBcbiAgICAgKlxuICAgICAqL1xuICAgIHNldCBzaXplKHNpemUpIHtcbiAgICAgICAgdGhpcy5yZW5kZXJlci5yZW1vdmVDbGFzcyh0aGlzLndyYXBwZXIubmF0aXZlRWxlbWVudCwgZ2V0U2l6ZUNsYXNzKCdpbnB1dCcsIHRoaXMuc2l6ZSkpO1xuICAgICAgICBpZiAoc2l6ZSkge1xuICAgICAgICAgICAgdGhpcy5yZW5kZXJlci5hZGRDbGFzcyh0aGlzLndyYXBwZXIubmF0aXZlRWxlbWVudCwgZ2V0U2l6ZUNsYXNzKCdpbnB1dCcsIHNpemUpKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9zaXplID0gc2l6ZTtcbiAgICB9XG4gICAgZ2V0IHNpemUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9zaXplO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZXRzIHRoZSBib3JkZXIgcmFkaXVzIG9mIHRoZSBjb21wb25lbnQuXG4gICAgICpcbiAgICAgKiBUaGUgcG9zc2libGUgdmFsdWVzIGFyZTpcbiAgICAgKiAqIGAnc21hbGwnYFxuICAgICAqICogYCdtZWRpdW0nYCAoZGVmYXVsdClcbiAgICAgKiAqIGAnbGFyZ2UnYFxuICAgICAqICogYCdmdWxsJ2BcbiAgICAgKiAqIGBudWxsYFxuICAgICAqXG4gICAgICovXG4gICAgc2V0IHJvdW5kZWQocm91bmRlZCkge1xuICAgICAgICB0aGlzLnJlbmRlcmVyLnJlbW92ZUNsYXNzKHRoaXMud3JhcHBlci5uYXRpdmVFbGVtZW50LCBnZXRSb3VuZGVkQ2xhc3ModGhpcy5yb3VuZGVkKSk7XG4gICAgICAgIGlmIChyb3VuZGVkKSB7XG4gICAgICAgICAgICB0aGlzLnJlbmRlcmVyLmFkZENsYXNzKHRoaXMud3JhcHBlci5uYXRpdmVFbGVtZW50LCBnZXRSb3VuZGVkQ2xhc3Mocm91bmRlZCkpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3JvdW5kZWQgPSByb3VuZGVkO1xuICAgIH1cbiAgICBnZXQgcm91bmRlZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3JvdW5kZWQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNldHMgdGhlIGZpbGxNb2RlIG9mIHRoZSBjb21wb25lbnQuXG4gICAgICpcbiAgICAgKiBUaGUgcG9zc2libGUgdmFsdWVzIGFyZTpcbiAgICAgKiAqIGAnZmxhdCdgXG4gICAgICogKiBgJ3NvbGlkJ2AgKGRlZmF1bHQpXG4gICAgICogKiBgJ291dGxpbmUnYFxuICAgICAqICogYG51bGxgXG4gICAgICpcbiAgICAgKi9cbiAgICBzZXQgZmlsbE1vZGUoZmlsbE1vZGUpIHtcbiAgICAgICAgdGhpcy5yZW5kZXJlci5yZW1vdmVDbGFzcyh0aGlzLndyYXBwZXIubmF0aXZlRWxlbWVudCwgZ2V0RmlsbE1vZGVDbGFzcygnaW5wdXQnLCB0aGlzLmZpbGxNb2RlKSk7XG4gICAgICAgIGlmIChmaWxsTW9kZSkge1xuICAgICAgICAgICAgdGhpcy5yZW5kZXJlci5hZGRDbGFzcyh0aGlzLndyYXBwZXIubmF0aXZlRWxlbWVudCwgZ2V0RmlsbE1vZGVDbGFzcygnaW5wdXQnLCBmaWxsTW9kZSkpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2ZpbGxNb2RlID0gZmlsbE1vZGU7XG4gICAgfVxuICAgIGdldCBmaWxsTW9kZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2ZpbGxNb2RlO1xuICAgIH1cbiAgICBnZXQgaXNEaXNhYmxlZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGlzYWJsZWQ7XG4gICAgfVxuICAgIGdldCBpc0xvYWRpbmcoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmxvYWRpbmc7XG4gICAgfVxuICAgIGdldCBkaXIoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRpcmVjdGlvbjtcbiAgICB9XG4gICAgZ2V0IGlzRm9jdXNlZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2lzRm9jdXNlZDtcbiAgICB9XG4gICAgc2V0IGlzRm9jdXNlZCh2YWx1ZSkge1xuICAgICAgICB0aGlzLnJlbmRlcmVyW3ZhbHVlID8gJ2FkZENsYXNzJyA6ICdyZW1vdmVDbGFzcyddKHRoaXMud3JhcHBlci5uYXRpdmVFbGVtZW50LCBcImstZm9jdXNcIik7XG4gICAgICAgIHRoaXMuX2lzRm9jdXNlZCA9IHZhbHVlO1xuICAgIH1cbiAgICBnZXQgY2xlYXJCdXR0b25WaXNpYmxpdHkoKSB7XG4gICAgICAgIGlmICh0aGlzLnRvdWNoRW5hYmxlZCkge1xuICAgICAgICAgICAgcmV0dXJuICd2aXNpYmxlJztcbiAgICAgICAgfVxuICAgIH1cbiAgICBnZXQgcG9wdXBXaWR0aCgpIHtcbiAgICAgICAgbGV0IHdyYXBwZXJPZmZzZXRXaWR0aCA9IDA7XG4gICAgICAgIGlmIChpc0RvY3VtZW50QXZhaWxhYmxlKCkpIHtcbiAgICAgICAgICAgIHdyYXBwZXJPZmZzZXRXaWR0aCA9IHRoaXMud3JhcHBlci5uYXRpdmVFbGVtZW50Lm9mZnNldFdpZHRoO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHdpZHRoID0gdGhpcy5wb3B1cFNldHRpbmdzLndpZHRoIHx8IHdyYXBwZXJPZmZzZXRXaWR0aDtcbiAgICAgICAgY29uc3QgbWluV2lkdGggPSBpc05hTih3cmFwcGVyT2Zmc2V0V2lkdGgpID8gd3JhcHBlck9mZnNldFdpZHRoIDogYCR7d3JhcHBlck9mZnNldFdpZHRofXB4YDtcbiAgICAgICAgY29uc3QgbWF4V2lkdGggPSBpc05hTih3aWR0aCkgPyB3aWR0aCA6IGAke3dpZHRofXB4YDtcbiAgICAgICAgcmV0dXJuIHsgbWluOiBtaW5XaWR0aCwgbWF4OiBtYXhXaWR0aCB9O1xuICAgIH1cbiAgICBnZXQgcG9wdXBIZWlnaHQoKSB7XG4gICAgICAgIGNvbnN0IHBvcHVwSGVpZ2h0ID0gdGhpcy5wb3B1cFNldHRpbmdzLmhlaWdodDtcbiAgICAgICAgcmV0dXJuIGlzUHJlc2VudChwb3B1cEhlaWdodCkgPyBgJHtwb3B1cEhlaWdodH1weGAgOiAnYXV0byc7XG4gICAgfVxuICAgIG5nT25Jbml0KCkge1xuICAgICAgICB0aGlzLnJlbmRlcmVyLnJlbW92ZUF0dHJpYnV0ZSh0aGlzLndyYXBwZXIubmF0aXZlRWxlbWVudCwgJ3RhYmluZGV4Jyk7XG4gICAgICAgIHRoaXMuYXR0YWNoU3RyZWFtcygpO1xuICAgICAgICB0aGlzLmNyZWF0ZVZhbHVlU3RyZWFtKCk7XG4gICAgICAgIHRoaXMuc3Vic2NyaWJlVG91Y2hFdmVudHMoKTtcbiAgICAgICAgdGhpcy5hdHRhY2hTZWxlY3RDbGlja0hhbmRsZXIoKTtcbiAgICAgICAgdGhpcy5zZXRDb21wb25lbnRDbGFzc2VzKCk7XG4gICAgfVxuICAgIGNyZWF0ZVZhbHVlU3RyZWFtKCkge1xuICAgICAgICBjb25zdCB2YWx1ZVN0cmVhbSA9IHRoaXMudmFsdWVTdWJqZWN0LnBpcGUoZmlsdGVyKChjYW5kaWRhdGUpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGN1cnJlbnQgPSBnZXR0ZXIkMSh0aGlzLnZhbHVlLCB0aGlzLnZhbHVlRmllbGQpO1xuICAgICAgICAgICAgY29uc3QgbmV3VmFsdWUgPSBnZXR0ZXIkMShjYW5kaWRhdGUsIHRoaXMudmFsdWVGaWVsZCk7XG4gICAgICAgICAgICBsZXQgbmV3VGV4dCA9IGdldHRlciQxKGNhbmRpZGF0ZSwgdGhpcy50ZXh0RmllbGQpO1xuICAgICAgICAgICAgaWYgKCFpc1ByZXNlbnQodGhpcy52YWx1ZSkgJiYgIWlzUHJlc2VudChuZXdWYWx1ZSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoaXNQcmVzZW50KG5ld1RleHQpKSB7XG4gICAgICAgICAgICAgICAgbmV3VGV4dCA9IG5ld1RleHQudG9TdHJpbmcoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChjdXJyZW50ID09PSBuZXdWYWx1ZSAmJiB0aGlzLnRleHQgPT09IG5ld1RleHQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNsZWFyRmlsdGVyKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pLCBtYXAoKGNhbmRpZGF0ZSkgPT4ge1xuICAgICAgICAgICAgY29uc3QgbmV3VmFsdWUgPSBnZXR0ZXIkMShjYW5kaWRhdGUsIHRoaXMudmFsdWVGaWVsZCk7XG4gICAgICAgICAgICBjb25zdCBuZXdUZXh0ID0gZ2V0dGVyJDEoY2FuZGlkYXRlLCB0aGlzLnRleHRGaWVsZCk7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGRhdGFJdGVtOiBjYW5kaWRhdGUsXG4gICAgICAgICAgICAgICAgdGV4dDogbmV3VGV4dCxcbiAgICAgICAgICAgICAgICB2YWx1ZTogdGhpcy52YWx1ZVByaW1pdGl2ZSA/IG5ld1ZhbHVlIDogY2FuZGlkYXRlXG4gICAgICAgICAgICB9O1xuICAgICAgICB9KSk7XG4gICAgICAgIGNvbnN0IGN1c3RvbVZhbHVlU3RyZWFtcyA9IHBhcnRpdGlvbigoKSA9PiB0aGlzLmFsbG93Q3VzdG9tKSh0aGlzLmN1c3RvbVZhbHVlU3ViamVjdC5waXBlKHRocm90dGxlVGltZSgzMDApKSk7XG4gICAgICAgIGNvbnN0IGFsbG93Q3VzdG9tVmFsdWVTdHJlYW0gPSBjdXN0b21WYWx1ZVN0cmVhbXNbMF0ucGlwZSh0YXAoKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5sb2FkaW5nID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMuZGlzYWJsZWQgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5jZHIuZGV0ZWN0Q2hhbmdlcygpO1xuICAgICAgICB9KSwgZmlsdGVyKCgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGhhc0NoYW5nZSA9IHRoaXMudGV4dCAhPT0gZ2V0dGVyJDEodGhpcy52YWx1ZSwgdGhpcy52YWx1ZUZpZWxkKTtcbiAgICAgICAgICAgIHRoaXMubG9hZGluZyA9IGhhc0NoYW5nZTtcbiAgICAgICAgICAgIHRoaXMuZGlzYWJsZWQgPSBoYXNDaGFuZ2U7XG4gICAgICAgICAgICBpZiAoIWhhc0NoYW5nZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuY2xlYXJGaWx0ZXIoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBoYXNDaGFuZ2U7XG4gICAgICAgIH0pLCB0aGlzLnZhbHVlTm9ybWFsaXplciwgbWFwKChub3JtYWxpemVkVmFsdWUpID0+IHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgY3VzdG9tOiB0cnVlLFxuICAgICAgICAgICAgICAgIGRhdGFJdGVtOiBub3JtYWxpemVkVmFsdWUsXG4gICAgICAgICAgICAgICAgdGV4dDogdGhpcy50ZXh0LFxuICAgICAgICAgICAgICAgIHZhbHVlOiBub3JtYWxpemVkVmFsdWVcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0pKTtcbiAgICAgICAgY29uc3QgZGlzYWJsZUN1c3RvbVZhbHVlU3RyZWFtID0gY3VzdG9tVmFsdWVTdHJlYW1zWzFdLnBpcGUobWFwKCgpID0+IHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgY3VzdG9tOiB0cnVlLFxuICAgICAgICAgICAgICAgIGRhdGFJdGVtOiB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgdGV4dDogdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgIHZhbHVlOiB1bmRlZmluZWRcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0pKTtcbiAgICAgICAgY29uc3QgY2xlYXJWYWx1ZVN0cmVhbSA9IHRoaXMuY2xlYXJWYWx1ZVN1YmplY3QucGlwZShtYXAoKCkgPT4gKHtcbiAgICAgICAgICAgIGRhdGFJdGVtOiB1bmRlZmluZWQsXG4gICAgICAgICAgICB0ZXh0OiB1bmRlZmluZWQsXG4gICAgICAgICAgICB2YWx1ZTogdW5kZWZpbmVkXG4gICAgICAgIH0pKSk7XG4gICAgICAgIGlmICh0aGlzLnZhbHVlU3Vic2NyaXB0aW9uKSB7XG4gICAgICAgICAgICB0aGlzLnZhbHVlU3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgbWVyZ2VkID0gbWVyZ2UodmFsdWVTdHJlYW0sIGFsbG93Q3VzdG9tVmFsdWVTdHJlYW0sIGRpc2FibGVDdXN0b21WYWx1ZVN0cmVhbSwgY2xlYXJWYWx1ZVN0cmVhbSk7XG4gICAgICAgIHRoaXMudmFsdWVTdWJzY3JpcHRpb24gPSBtZXJnZWQucGlwZShjYXRjaEVycm9yKCgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHNlbGVjdGlvbkNoYW5nZWQgPSBnZXR0ZXIkMSh0aGlzLmRhdGFJdGVtLCB0aGlzLnZhbHVlRmllbGQpICE9PSB1bmRlZmluZWQ7XG4gICAgICAgICAgICB0aGlzLmRhdGFJdGVtID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgdGhpcy52YWx1ZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIHRoaXMudGV4dCA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5kaXNhYmxlZCA9IGZhbHNlO1xuICAgICAgICAgICAgaWYgKHNlbGVjdGlvbkNoYW5nZWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGlvbkNoYW5nZS5lbWl0KHVuZGVmaW5lZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmVtaXRWYWx1ZUNoYW5nZSgpO1xuICAgICAgICAgICAgdGhpcy5jcmVhdGVWYWx1ZVN0cmVhbSgpO1xuICAgICAgICAgICAgcmV0dXJuIG9mKG51bGwpO1xuICAgICAgICB9KSlcbiAgICAgICAgICAgIC5zdWJzY3JpYmUoKHN0YXRlKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBzZWxlY3Rpb25DaGFuZ2VkID0gZ2V0dGVyJDEodGhpcy5kYXRhSXRlbSwgdGhpcy52YWx1ZUZpZWxkKSAhPT0gZ2V0dGVyJDEoc3RhdGUuZGF0YUl0ZW0sIHRoaXMudmFsdWVGaWVsZCk7XG4gICAgICAgICAgICB0aGlzLmRhdGFJdGVtID0gc3RhdGUuZGF0YUl0ZW07XG4gICAgICAgICAgICB0aGlzLnZhbHVlID0gc3RhdGUudmFsdWU7XG4gICAgICAgICAgICB0aGlzLnRleHQgPSBzdGF0ZS50ZXh0O1xuICAgICAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLmRpc2FibGVkID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLmNsZWFyRmlsdGVyKCk7XG4gICAgICAgICAgICBpZiAoc3RhdGUuY3VzdG9tKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3Rpb25TZXJ2aWNlLmZvY3VzZWQgPSAtMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChzZWxlY3Rpb25DaGFuZ2VkKSB7XG4gICAgICAgICAgICAgICAgY29uc3Qgc2VsZWN0aW9uQXJncyA9IHN0YXRlLmN1c3RvbSA/IHVuZGVmaW5lZCA6IHRoaXMuZGF0YUl0ZW07XG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3Rpb25DaGFuZ2UuZW1pdChzZWxlY3Rpb25BcmdzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuZW1pdFZhbHVlQ2hhbmdlKCk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBhdHRhY2hTdHJlYW1zKCkge1xuICAgICAgICBpZiAoIWlzRG9jdW1lbnRBdmFpbGFibGUoKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc3Vicy5hZGQodGhpcy5sb2NhbGl6YXRpb25cbiAgICAgICAgICAgIC5jaGFuZ2VzLnN1YnNjcmliZSgoeyBydGwgfSkgPT4ge1xuICAgICAgICAgICAgdGhpcy5kaXJlY3Rpb24gPSBydGwgPyAncnRsJyA6ICdsdHInO1xuICAgICAgICAgICAgdGhpcy5jZHIuZGV0ZWN0Q2hhbmdlcygpO1xuICAgICAgICB9KSk7XG4gICAgICAgIHRoaXMuc3Vicy5hZGQobWVyZ2UodGhpcy5uYXZpZ2F0aW9uU2VydmljZS51cCwgdGhpcy5uYXZpZ2F0aW9uU2VydmljZS5kb3duLCB0aGlzLm5hdmlnYXRpb25TZXJ2aWNlLmhvbWUsIHRoaXMubmF2aWdhdGlvblNlcnZpY2UuZW5kKVxuICAgICAgICAgICAgLnBpcGUoZmlsdGVyKChldmVudCkgPT4gaXNQcmVzZW50KGV2ZW50LmluZGV4KSkpXG4gICAgICAgICAgICAuc3Vic2NyaWJlKChldmVudCkgPT4gdGhpcy5uYXZpZ2F0ZShldmVudC5pbmRleCkpKTtcbiAgICAgICAgdGhpcy5zdWJzLmFkZCh0aGlzLm5hdmlnYXRpb25TZXJ2aWNlLm9wZW4uc3Vic2NyaWJlKHRoaXMuaGFuZGxlTmF2aWdhdGlvbk9wZW4uYmluZCh0aGlzKSkpO1xuICAgICAgICB0aGlzLnN1YnMuYWRkKHRoaXMubmF2aWdhdGlvblNlcnZpY2UuY2xvc2Uuc3Vic2NyaWJlKCgpID0+IHRoaXMudG9nZ2xlUG9wdXAoZmFsc2UpKSk7XG4gICAgICAgIHRoaXMuc3Vicy5hZGQodGhpcy5uYXZpZ2F0aW9uU2VydmljZS5lc2Muc3Vic2NyaWJlKHRoaXMuaGFuZGxlRXNjYXBlLmJpbmQodGhpcykpKTtcbiAgICAgICAgdGhpcy5zdWJzLmFkZCh0aGlzLm5hdmlnYXRpb25TZXJ2aWNlLmVudGVyLnBpcGUodGFwKChldmVudCkgPT4ge1xuICAgICAgICAgICAgaWYgKHRoaXMuaXNPcGVuKSB7XG4gICAgICAgICAgICAgICAgZXZlbnQub3JpZ2luYWxFdmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KSlcbiAgICAgICAgICAgIC5zdWJzY3JpYmUodGhpcy5oYW5kbGVFbnRlci5iaW5kKHRoaXMpKSk7XG4gICAgICAgIHRoaXMuc3Vicy5hZGQobWVyZ2UodGhpcy5zZWxlY3Rpb25TZXJ2aWNlLm9uQ2hhbmdlLCB0aGlzLnNlbGVjdGlvblNlcnZpY2Uub25TZWxlY3QucGlwZShmaWx0ZXIoXyA9PiAhdGhpcy5pc09wZW4pKSlcbiAgICAgICAgICAgIC5waXBlKHRhcChfID0+IHtcbiAgICAgICAgICAgIHRoaXMuX2ZpbHRlcmluZyA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy50b2dnbGVQb3B1cChmYWxzZSk7XG4gICAgICAgIH0pLCBtYXAoKGV2ZW50KSA9PiB0aGlzLmRhdGFTZXJ2aWNlLml0ZW1BdChldmVudC5pbmRpY2VzWzBdKSkpXG4gICAgICAgICAgICAuc3Vic2NyaWJlKGRhdGFJdGVtID0+IHtcbiAgICAgICAgICAgIHRoaXMuY2hhbmdlKGRhdGFJdGVtKTtcbiAgICAgICAgfSkpO1xuICAgICAgICB0aGlzLnN1YnMuYWRkKHRoaXMuc2VsZWN0aW9uU2VydmljZS5vblNlbGVjdC5waXBlKGZpbHRlcihfID0+IHRoaXMuaXNPcGVuKSwgdGFwKF8gPT4gdGhpcy5fZmlsdGVyaW5nID0gZmFsc2UpLCBtYXAoKGV2ZW50KSA9PiB0aGlzLmRhdGFTZXJ2aWNlLml0ZW1BdChldmVudC5pbmRpY2VzWzBdKSkpXG4gICAgICAgICAgICAuc3Vic2NyaWJlKGRhdGFJdGVtID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHNlbGVjdGlvbkNoYW5nZWQgPSBnZXR0ZXIkMShkYXRhSXRlbSwgdGhpcy52YWx1ZUZpZWxkKSAhPT0gZ2V0dGVyJDEodGhpcy5kYXRhSXRlbSwgdGhpcy52YWx1ZUZpZWxkKTtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlU3RhdGUoeyBkYXRhSXRlbSB9KTtcbiAgICAgICAgICAgIGlmIChzZWxlY3Rpb25DaGFuZ2VkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3Rpb25DaGFuZ2UuZW1pdChkYXRhSXRlbSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgbmdPbkRlc3Ryb3koKSB7XG4gICAgICAgIHRoaXMuZGVzdHJveVBvcHVwKCk7XG4gICAgICAgIHRoaXMuc3Vicy51bnN1YnNjcmliZSgpO1xuICAgICAgICBpZiAoaXNQcmVzZW50KHRoaXMudmFsdWVTdWJzY3JpcHRpb24pKSB7XG4gICAgICAgICAgICB0aGlzLnZhbHVlU3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMudG91Y2hzdGFydERpc3Bvc2VIYW5kbGVyKSB7XG4gICAgICAgICAgICB0aGlzLnRvdWNoc3RhcnREaXNwb3NlSGFuZGxlcigpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnNlbGVjdENsaWNrRGlzcG9zZUhhbmRsZXIpIHtcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0Q2xpY2tEaXNwb3NlSGFuZGxlcigpO1xuICAgICAgICB9XG4gICAgfVxuICAgIG5nT25DaGFuZ2VzKGNoYW5nZXMpIHtcbiAgICAgICAgY29uc3QgdmlydHVhbCA9IHRoaXMudmlydHVhbDtcbiAgICAgICAgY29uc3QgcmVxdWVzdEluaXRpYWxEYXRhID0gdmlydHVhbCAmJiBjaGFuZ2VzLmRhdGEgJiYgY2hhbmdlcy5kYXRhLmlzRmlyc3RDaGFuZ2UoKTtcbiAgICAgICAgaWYgKHJlcXVlc3RJbml0aWFsRGF0YSkge1xuICAgICAgICAgICAgdGhpcy5wYWdlQ2hhbmdlKHsgc2tpcDogMCwgdGFrZTogdmlydHVhbC5wYWdlU2l6ZSB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaXNDaGFuZ2VkKCd2YWx1ZU5vcm1hbGl6ZXInLCBjaGFuZ2VzKSkge1xuICAgICAgICAgICAgdGhpcy5jcmVhdGVWYWx1ZVN0cmVhbSgpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChhbnlDaGFuZ2VkKFsndGV4dEZpZWxkJywgJ3ZhbHVlRmllbGQnLCAndmFsdWVQcmltaXRpdmUnXSwgY2hhbmdlcywgZmFsc2UpKSB7XG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgbmdBZnRlckNvbnRlbnRDaGVja2VkKCkge1xuICAgICAgICB0aGlzLnZlcmlmeVNldHRpbmdzKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEZvY3VzZXMgYSBzcGVjaWZpYyBpdGVtIG9mIHRoZSBDb21ib0JveCBiYXNlZCBvbiBhIHByb3ZpZGVkIGluZGV4LlxuICAgICAqIElmIG51bGwgb3IgaW52YWxpZCBpbmRleCBpcyBwcm92aWRlZCB0aGUgZm9jdXMgd2lsbCBiZSByZW1vdmVkLlxuICAgICAqL1xuICAgIGZvY3VzSXRlbUF0KGluZGV4KSB7XG4gICAgICAgIGNvbnN0IGlzSW5SYW5nZSA9IGluZGV4ID49IDAgJiYgaW5kZXggPCB0aGlzLmRhdGEubGVuZ3RoO1xuICAgICAgICBpZiAoaXNQcmVzZW50KGluZGV4KSAmJiBpc0luUmFuZ2UgJiYgIXRoaXMuZGlzYWJsZWRJdGVtc1NlcnZpY2UuaXNJbmRleERpc2FibGVkKGluZGV4KSkge1xuICAgICAgICAgICAgdGhpcy5zZWxlY3Rpb25TZXJ2aWNlLmZvY3VzKGluZGV4KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0aW9uU2VydmljZS5mb2N1cygtMSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogRm9jdXNlcyB0aGUgQ29tYm9Cb3guXG4gICAgICovXG4gICAgZm9jdXMoKSB7XG4gICAgICAgIGlmICghdGhpcy5kaXNhYmxlZCkge1xuICAgICAgICAgICAgdGhpcy5zZWFyY2hiYXIuZm9jdXMoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBCbHVycyB0aGUgQ29tYm9Cb3guXG4gICAgICovXG4gICAgYmx1cigpIHtcbiAgICAgICAgaWYgKCF0aGlzLmRpc2FibGVkKSB7XG4gICAgICAgICAgICB0aGlzLnNlYXJjaGJhci5ibHVyKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogVG9nZ2xlcyB0aGUgdmlzaWJpbGl0eSBvZiB0aGUgcG9wdXAuIElmIHlvdSB1c2UgdGhlIGB0b2dnbGVgIG1ldGhvZCB0byBvcGVuIG9yIGNsb3NlIHRoZSBwb3B1cCxcbiAgICAgKiB0aGUgYG9wZW5gIGFuZCBgY2xvc2VgIGV2ZW50cyB3aWxsIG5vdCBiZSBmaXJlZC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBvcGVuIC0gVGhlIHN0YXRlIG9mIHRoZSBwb3B1cC5cbiAgICAgKi9cbiAgICB0b2dnbGUob3Blbikge1xuICAgICAgICBQcm9taXNlLnJlc29sdmUobnVsbCkudGhlbigoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBzaG91bGRPcGVuID0gaXNQcmVzZW50KG9wZW4pID8gb3BlbiA6ICF0aGlzLl9vcGVuO1xuICAgICAgICAgICAgdGhpcy5fdG9nZ2xlKHNob3VsZE9wZW4pO1xuICAgICAgICAgICAgdGhpcy5jZHIubWFya0ZvckNoZWNrKCk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRoZSBjdXJyZW50IG9wZW4gc3RhdGUgb2YgdGhlIHBvcHVwLlxuICAgICAqL1xuICAgIGdldCBpc09wZW4oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9vcGVuO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXNldHMgdGhlIHZhbHVlIG9mIHRoZSBDb21ib0JveC5cbiAgICAgKiBJZiB5b3UgdXNlIHRoZSBgcmVzZXRgIG1ldGhvZCB0byBjbGVhciB0aGUgdmFsdWUgb2YgdGhlIGNvbXBvbmVudCxcbiAgICAgKiB0aGUgbW9kZWwgd2lsbCBub3QgdXBkYXRlIGF1dG9tYXRpY2FsbHkgYW5kIHRoZSBgc2VsZWN0aW9uQ2hhbmdlYCBhbmQgYHZhbHVlQ2hhbmdlYCBldmVudHMgd2lsbCBub3QgYmUgZmlyZWQuXG4gICAgICovXG4gICAgcmVzZXQoKSB7XG4gICAgICAgIHRoaXMudmFsdWUgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMuY2xlYXJTdGF0ZSgpO1xuICAgICAgICB0aGlzLnJlc2V0U2VsZWN0aW9uKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKlxuICAgICAqIFVzZWQgYnkgdGhlIFRleHRCb3hDb250YWluZXIgdG8gZGV0ZXJtaW5lIGlmIHRoZSBmbG9hdGluZyBsYWJlbFxuICAgICAqIHNob3VsZCBiZSByZW5kZXJlZCBpbiB0aGUgaW5wdXQgd2hlbiB0aGUgY29tcG9uZW50IGlzIG5vdCBmb2N1c2VkLlxuICAgICAqL1xuICAgIGlzRW1wdHkoKSB7XG4gICAgICAgIGNvbnN0IHRleHRFbXB0eSA9ICFpc1ByZXNlbnQodGhpcy50ZXh0KSB8fCBpc0VtcHR5U3RyaW5nKHRoaXMudGV4dCk7XG4gICAgICAgIGNvbnN0IHZhbHVlRW1wdHkgPSAhaXNQcmVzZW50KHRoaXMudmFsdWUpIHx8IGlzRW1wdHlTdHJpbmcodGhpcy52YWx1ZSk7XG4gICAgICAgIHJldHVybiB0ZXh0RW1wdHkgJiYgdmFsdWVFbXB0eTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIG1lc3NhZ2VGb3Ioa2V5KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmxvY2FsaXphdGlvbi5nZXQoa2V5KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIGNsZWFyVmFsdWUoZXZlbnQpIHtcbiAgICAgICAgZXZlbnQuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7XG4gICAgICAgIHRoaXMuZm9jdXMoKTtcbiAgICAgICAgdGhpcy5fZmlsdGVyaW5nID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5fcHJldmlvdXNEYXRhSXRlbSA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5zZWxlY3Rpb25TZXJ2aWNlLnJlc2V0U2VsZWN0aW9uKFtdKTtcbiAgICAgICAgdGhpcy5jbGVhclZhbHVlU3ViamVjdC5uZXh0KCk7XG4gICAgICAgIHRoaXMuX2ZpbHRlcmluZyA9IGZhbHNlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgd3JpdGVWYWx1ZSh2YWx1ZSkge1xuICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWUgPT09IG51bGwgPyB1bmRlZmluZWQgOiB2YWx1ZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIHJlZ2lzdGVyT25DaGFuZ2UoZm4pIHtcbiAgICAgICAgdGhpcy5vbkNoYW5nZUNhbGxiYWNrID0gZm47XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICByZWdpc3Rlck9uVG91Y2hlZChmbikge1xuICAgICAgICB0aGlzLm9uVG91Y2hlZENhbGxiYWNrID0gZm47XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBzZXREaXNhYmxlZFN0YXRlKGlzRGlzYWJsZWQpIHtcbiAgICAgICAgdGhpcy5kaXNhYmxlZCA9IGlzRGlzYWJsZWQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBnZXQgYnV0dG9uQ2xhc3NlcygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubG9hZGluZyA/ICdrLWktbG9hZGluZycgOiB0aGlzLmljb25DbGFzcyB8fCAnay1pLWFycm93LXMnO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgZ2V0IHNlbGVjdEJ1dHRvbkNsYXNzZXMoKSB7XG4gICAgICAgIHJldHVybiBgJHt0aGlzLnNpemUgPyBnZXRTaXplQ2xhc3MoJ2J1dHRvbicsIHRoaXMuc2l6ZSkgOiAnJ30gJHt0aGlzLmZpbGxNb2RlID8gJ2stYnV0dG9uLScgKyB0aGlzLmZpbGxNb2RlIDogJyd9ICR7dGhpcy5maWxsTW9kZSA/ICdrLWJ1dHRvbi0nICsgdGhpcy5maWxsTW9kZSArICctYmFzZScgOiAnJ31cbiAgICAgICAgYDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIG9uUmVzaXplKCkge1xuICAgICAgICBpZiAodGhpcy5pc09wZW4pIHtcbiAgICAgICAgICAgIGNvbnN0IHBvcHVwV3JhcHBlciA9IHRoaXMucG9wdXBSZWYucG9wdXBFbGVtZW50O1xuICAgICAgICAgICAgY29uc3QgeyBtaW4sIG1heCB9ID0gdGhpcy5wb3B1cFdpZHRoO1xuICAgICAgICAgICAgcG9wdXBXcmFwcGVyLnN0eWxlLm1pbldpZHRoID0gbWluO1xuICAgICAgICAgICAgcG9wdXBXcmFwcGVyLnN0eWxlLndpZHRoID0gbWF4O1xuICAgICAgICB9XG4gICAgfVxuICAgIHZlcmlmeVNldHRpbmdzKCkge1xuICAgICAgICBpZiAoIWlzRGV2TW9kZSgpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMudmFsdWVQcmltaXRpdmUgPT09IHRydWUgJiYgaXNQcmVzZW50KHRoaXMudmFsdWUpICYmIHR5cGVvZiB0aGlzLnZhbHVlID09PSBcIm9iamVjdFwiKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoQ29tYm9Cb3hNZXNzYWdlcy5wcmltaXRpdmUpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnZhbHVlUHJpbWl0aXZlID09PSBmYWxzZSAmJiBpc1ByZXNlbnQodGhpcy52YWx1ZSkgJiYgdHlwZW9mIHRoaXMudmFsdWUgIT09IFwib2JqZWN0XCIpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihDb21ib0JveE1lc3NhZ2VzLm9iamVjdCk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgdmFsdWVPclRleHQgPSAhaXNQcmVzZW50KHRoaXMudmFsdWVGaWVsZCkgIT09ICFpc1ByZXNlbnQodGhpcy50ZXh0RmllbGQpO1xuICAgICAgICBpZiAodmFsdWVPclRleHQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihDb21ib0JveE1lc3NhZ2VzLnRleHRBbmRWYWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMudmlydHVhbCAmJiBpc05hTih0aGlzLnZpcnR1YWwuaXRlbUhlaWdodCkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihDb21ib0JveE1lc3NhZ2VzLm5vSXRlbUhlaWdodCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc2V0U3RhdGUoKSB7XG4gICAgICAgIC8vIEZpbHRlcmluZyBpbiBwcm9jZXNzLCBkbyBub3RoaW5nLlxuICAgICAgICBpZiAodGhpcy5fZmlsdGVyaW5nKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgdmFsdWUgPSB0aGlzLnZhbHVlO1xuICAgICAgICBjb25zdCB2YWx1ZUZpZWxkID0gdGhpcy52YWx1ZUZpZWxkO1xuICAgICAgICBjb25zdCByZXNvbHZlZCA9IHRoaXMuZmluZERhdGFJdGVtKHsgdmFsdWVGaWVsZCwgdmFsdWUgfSk7XG4gICAgICAgIGlmIChpc1ByZXNlbnQocmVzb2x2ZWQuaW5kZXgpICYmIHJlc29sdmVkLmluZGV4ICE9PSAtMSkge1xuICAgICAgICAgICAgdGhpcy51cGRhdGVTdGF0ZSh7IGRhdGFJdGVtOiByZXNvbHZlZC5kYXRhSXRlbSwgY29uZmlybTogdHJ1ZSB9KTtcbiAgICAgICAgICAgIHRoaXMucmVzZXRTZWxlY3Rpb24ocmVzb2x2ZWQuaW5kZXgpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGlzUHJlc2VudCh2YWx1ZSkgJiYgdGhpcy5hbGxvd0N1c3RvbSkge1xuICAgICAgICAgICAgdGhpcy51cGRhdGVTdGF0ZSh7IGRhdGFJdGVtOiB2YWx1ZSB9KTtcbiAgICAgICAgICAgIHRoaXMucmVzZXRTZWxlY3Rpb24oLTEpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHRoaXMuX3ByZXZpb3VzRGF0YUl0ZW0gJiYgdGhpcy52YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy51cGRhdGVTdGF0ZSh7IGRhdGFJdGVtOiB0aGlzLl9wcmV2aW91c0RhdGFJdGVtIH0pO1xuICAgICAgICAgICAgdGhpcy5yZXNldFNlbGVjdGlvbigpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5jbGVhclN0YXRlKCk7XG4gICAgICAgICAgICB0aGlzLnJlc2V0U2VsZWN0aW9uKC0xKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB1cGRhdGVTdGF0ZSh7IGRhdGFJdGVtLCBjb25maXJtID0gZmFsc2UgfSkge1xuICAgICAgICB0aGlzLmRhdGFJdGVtID0gZGF0YUl0ZW07XG4gICAgICAgIHRoaXMudGV4dCA9IGdldHRlciQxKGRhdGFJdGVtLCB0aGlzLnRleHRGaWVsZCk7XG4gICAgICAgIGlmIChjb25maXJtKSB7XG4gICAgICAgICAgICB0aGlzLl9wcmV2aW91c0RhdGFJdGVtID0gZGF0YUl0ZW07XG4gICAgICAgIH1cbiAgICB9XG4gICAgY2xlYXJTdGF0ZSgpIHtcbiAgICAgICAgdGhpcy50ZXh0ID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLmRhdGFJdGVtID0gdW5kZWZpbmVkO1xuICAgIH1cbiAgICByZXNldFNlbGVjdGlvbihpbmRleCkge1xuICAgICAgICBjb25zdCBjbGVhciA9ICFpc1ByZXNlbnQoaW5kZXgpIHx8IGluZGV4IDwgMDtcbiAgICAgICAgdGhpcy5zZWxlY3Rpb25TZXJ2aWNlLnJlc2V0U2VsZWN0aW9uKGNsZWFyID8gW10gOiBbaW5kZXhdKTtcbiAgICAgICAgdGhpcy5zZWxlY3Rpb25TZXJ2aWNlLmZvY3VzZWQgPSBpbmRleDtcbiAgICB9XG4gICAgZmlyc3RGb2N1c2FibGVJbmRleChpbmRleCkge1xuICAgICAgICBjb25zdCBtYXhJbmRleCA9IHRoaXMuZGF0YS5sZW5ndGggLSAxO1xuICAgICAgICBpZiAodGhpcy5kaXNhYmxlZEl0ZW1zU2VydmljZS5pc0luZGV4RGlzYWJsZWQoaW5kZXgpKSB7XG4gICAgICAgICAgICByZXR1cm4gKGluZGV4IDwgbWF4SW5kZXgpID8gdGhpcy5maXJzdEZvY3VzYWJsZUluZGV4KGluZGV4ICsgMSkgOiB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gaW5kZXg7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZmluZEluZGV4UHJlZGljYXRlKHRleHQpIHtcbiAgICAgICAgaWYgKHRoaXMuZGF0YVNlcnZpY2UuZ3JvdXBlZCkge1xuICAgICAgICAgICAgcmV0dXJuIChpdGVtKSA9PiB7XG4gICAgICAgICAgICAgICAgbGV0IGl0ZW1UZXh0ID0gZ2V0dGVyJDEoaXRlbS52YWx1ZSwgdGhpcy50ZXh0RmllbGQpO1xuICAgICAgICAgICAgICAgIGl0ZW1UZXh0ID0gIWlzUHJlc2VudChpdGVtVGV4dCkgPyBcIlwiIDogaXRlbVRleHQudG9TdHJpbmcoKS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgICAgIHJldHVybiBpdGVtVGV4dC5zdGFydHNXaXRoKHRleHQudG9Mb3dlckNhc2UoKSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIChpdGVtKSA9PiB7XG4gICAgICAgICAgICAgICAgbGV0IGl0ZW1UZXh0ID0gZ2V0dGVyJDEoaXRlbSwgdGhpcy50ZXh0RmllbGQpO1xuICAgICAgICAgICAgICAgIGl0ZW1UZXh0ID0gIWlzUHJlc2VudChpdGVtVGV4dCkgPyBcIlwiIDogaXRlbVRleHQudG9TdHJpbmcoKS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgICAgIHJldHVybiBpdGVtVGV4dC5zdGFydHNXaXRoKHRleHQudG9Mb3dlckNhc2UoKSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuICAgIGZpbmREYXRhSXRlbSh7IHZhbHVlRmllbGQsIHZhbHVlIH0pIHtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0ge1xuICAgICAgICAgICAgZGF0YUl0ZW06IG51bGwsXG4gICAgICAgICAgICBpbmRleDogLTFcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgY29tcGFyZXIgPSAoZWxlbWVudCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgZGF0YUl0ZW0gPSB0aGlzLmRhdGFTZXJ2aWNlLmdyb3VwZWQgPyBlbGVtZW50LnZhbHVlIDogZWxlbWVudDtcbiAgICAgICAgICAgIHJldHVybiBnZXR0ZXIkMShkYXRhSXRlbSwgdmFsdWVGaWVsZCkgPT09IGdldHRlciQxKHZhbHVlLCB2YWx1ZUZpZWxkKTtcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgaW5kZXggPSB0aGlzLmRhdGFTZXJ2aWNlLmZpbmRJbmRleChjb21wYXJlcik7XG4gICAgICAgIHJlc3VsdC5kYXRhSXRlbSA9IHRoaXMuZGF0YVNlcnZpY2UuaXRlbUF0KGluZGV4KTtcbiAgICAgICAgcmVzdWx0LmluZGV4ID0gaW5kZXg7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuICAgIHNlYXJjaCh0ZXh0LCBzdGFydEZyb20gPSAwKSB7XG4gICAgICAgIGxldCBpbmRleDtcbiAgICAgICAgaWYgKHRleHQubGVuZ3RoICYmIHRoaXMuZGF0YVNlcnZpY2UuaXRlbXNDb3VudCkge1xuICAgICAgICAgICAgaW5kZXggPSB0aGlzLmRhdGFTZXJ2aWNlLmZpbmRJbmRleCh0aGlzLmZpbmRJbmRleFByZWRpY2F0ZSh0ZXh0KSwgc3RhcnRGcm9tKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGluZGV4ID0gLTE7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuZGlzYWJsZWRJdGVtc1NlcnZpY2UuaXNJbmRleERpc2FibGVkKGluZGV4KSkge1xuICAgICAgICAgICAgaWYgKGluZGV4ICsgMSA8IHRoaXMuZGF0YVNlcnZpY2UuaXRlbXNDb3VudCkge1xuICAgICAgICAgICAgICAgIHRoaXMuc2VhcmNoKHRleHQsIGluZGV4ICsgMSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGlvblNlcnZpY2UuZm9jdXMoLTEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5zZWxlY3Rpb25TZXJ2aWNlLmZvY3VzKGluZGV4KTtcbiAgICAgICAgICAgIGlmICh0aGlzLnN1Z2dlc3QpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnN1Z2dlc3RlZFRleHQgPSBnZXR0ZXIkMSh0aGlzLmRhdGFTZXJ2aWNlLml0ZW1BdChpbmRleCksIHRoaXMudGV4dEZpZWxkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgZ2V0U3VnZ2VzdGlvbigpIHtcbiAgICAgICAgY29uc3QgaGFzU2VsZWN0ZWQgPSAhIXRoaXMuc2VsZWN0aW9uU2VydmljZS5zZWxlY3RlZC5sZW5ndGg7XG4gICAgICAgIGNvbnN0IHNob3VsZFN1Z2dlc3QgPSB0aGlzLnN1Z2dlc3QgJiYgIXRoaXMuYmFja3NwYWNlUHJlc3NlZCAmJiB0aGlzLnN1Z2dlc3RlZFRleHQgJiYgdGhpcy50ZXh0O1xuICAgICAgICBpZiAoIWhhc1NlbGVjdGVkICYmIHNob3VsZFN1Z2dlc3QgJiYgdGhpcy5zdWdnZXN0ZWRUZXh0LnRvTG93ZXJDYXNlKCkuc3RhcnRzV2l0aCh0aGlzLnRleHQudG9Mb3dlckNhc2UoKSkpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN1Z2dlc3RlZFRleHQ7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnN1Z2dlc3RlZFRleHQgPSB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICB9XG4gICAgbmF2aWdhdGUoaW5kZXgpIHtcbiAgICAgICAgaWYgKHRoaXMuZGF0YVNlcnZpY2UuaXRlbXNDb3VudCA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMudGV4dCA9IGdldHRlciQxKHRoaXMuZGF0YVNlcnZpY2UuaXRlbUF0KGluZGV4KSwgdGhpcy50ZXh0RmllbGQpO1xuICAgICAgICB0aGlzLnNlbGVjdGlvblNlcnZpY2Uuc2VsZWN0KGluZGV4KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIGhhbmRsZU5hdmlnYXRlKGV2ZW50KSB7XG4gICAgICAgIGNvbnN0IGhhc1NlbGVjdGVkID0gaXNQcmVzZW50KHRoaXMuc2VsZWN0aW9uU2VydmljZS5zZWxlY3RlZFswXSk7XG4gICAgICAgIGNvbnN0IGZvY3VzZWQgPSBpc05hTih0aGlzLnNlbGVjdGlvblNlcnZpY2UuZm9jdXNlZCkgPyB0aGlzLmZpcnN0Rm9jdXNhYmxlSW5kZXgoMCkgOiB0aGlzLnNlbGVjdGlvblNlcnZpY2UuZm9jdXNlZDtcbiAgICAgICAgbGV0IG9mZnNldCA9IDA7XG4gICAgICAgIGlmICh0aGlzLmRpc2FibGVkIHx8IHRoaXMucmVhZG9ubHkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZXZlbnQua2V5Q29kZSA9PT0gS2V5cy5Ib21lIHx8IGV2ZW50LmtleUNvZGUgPT09IEtleXMuRW5kKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFoYXNTZWxlY3RlZCkge1xuICAgICAgICAgICAgaWYgKGV2ZW50LmtleUNvZGUgPT09IEtleXMuQXJyb3dEb3duKSB7XG4gICAgICAgICAgICAgICAgb2Zmc2V0ID0gLTE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChldmVudC5rZXlDb2RlID09PSBLZXlzLkFycm93VXApIHtcbiAgICAgICAgICAgICAgICBvZmZzZXQgPSAxO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGFjdGlvbiA9IHRoaXMubmF2aWdhdGlvblNlcnZpY2UucHJvY2Vzcyh7XG4gICAgICAgICAgICBjdXJyZW50OiBvZmZzZXQgKyBmb2N1c2VkLFxuICAgICAgICAgICAgbWF4OiB0aGlzLmRhdGFTZXJ2aWNlLml0ZW1zQ291bnQgLSAxLFxuICAgICAgICAgICAgbWluOiAwLFxuICAgICAgICAgICAgb3JpZ2luYWxFdmVudDogZXZlbnRcbiAgICAgICAgfSk7XG4gICAgICAgIGlmIChhY3Rpb24gIT09IE5hdmlnYXRpb25BY3Rpb24uVW5kZWZpbmVkICYmXG4gICAgICAgICAgICBhY3Rpb24gIT09IE5hdmlnYXRpb25BY3Rpb24uTGVmdCAmJlxuICAgICAgICAgICAgYWN0aW9uICE9PSBOYXZpZ2F0aW9uQWN0aW9uLlJpZ2h0ICYmXG4gICAgICAgICAgICBhY3Rpb24gIT09IE5hdmlnYXRpb25BY3Rpb24uQmFja3NwYWNlICYmXG4gICAgICAgICAgICBhY3Rpb24gIT09IE5hdmlnYXRpb25BY3Rpb24uRGVsZXRlICYmXG4gICAgICAgICAgICAoKGFjdGlvbiA9PT0gTmF2aWdhdGlvbkFjdGlvbi5FbnRlciAmJiB0aGlzLmlzT3BlbikgfHwgYWN0aW9uICE9PSBOYXZpZ2F0aW9uQWN0aW9uLkVudGVyKSkge1xuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBoYW5kbGVFbnRlcigpIHtcbiAgICAgICAgY29uc3QgdGV4dCA9IHRoaXMudGV4dDtcbiAgICAgICAgY29uc3QgZm9jdXNlZCA9IHRoaXMuc2VsZWN0aW9uU2VydmljZS5mb2N1c2VkO1xuICAgICAgICBjb25zdCBoYXNGb2N1c2VkID0gaXNQcmVzZW50KGZvY3VzZWQpICYmIGZvY3VzZWQgIT09IC0xO1xuICAgICAgICBjb25zdCBwcmV2aW91c1RleHQgPSBnZXR0ZXIkMSh0aGlzLl9wcmV2aW91c0RhdGFJdGVtLCB0aGlzLnRleHRGaWVsZCkgfHwgXCJcIjtcbiAgICAgICAgY29uc3QgZm9jdXNlZEl0ZW1UZXh0ID0gZ2V0dGVyJDEodGhpcy5kYXRhU2VydmljZS5pdGVtQXQoZm9jdXNlZCksIHRoaXMudGV4dEZpZWxkKTtcbiAgICAgICAgY29uc3QgdGV4dEhhc0NoYW5nZWQgPSB0ZXh0ICE9PSBwcmV2aW91c1RleHQ7XG4gICAgICAgIHRoaXMudG9nZ2xlUG9wdXAoZmFsc2UpO1xuICAgICAgICB0aGlzLl9maWx0ZXJpbmcgPSBmYWxzZTtcbiAgICAgICAgaWYgKHRoaXMuYWxsb3dDdXN0b20gJiYgdGV4dEhhc0NoYW5nZWQpIHtcbiAgICAgICAgICAgIGlmICh0ZXh0ID09PSBmb2N1c2VkSXRlbVRleHQgfHwgdGhpcy51c2VTdWdnZXN0aW9uKCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGlvblNlcnZpY2UuY2hhbmdlKGZvY3VzZWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jaGFuZ2UodGV4dCwgdHJ1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF0aGlzLmFsbG93Q3VzdG9tKSB7XG4gICAgICAgICAgICBpZiAoaGFzRm9jdXNlZCkge1xuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0aW9uU2VydmljZS5jaGFuZ2UoZm9jdXNlZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICh0ZXh0SGFzQ2hhbmdlZCkge1xuICAgICAgICAgICAgICAgIHRoaXMuY2hhbmdlKHRleHQsIHRydWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBoYW5kbGVCbHVyKCkge1xuICAgICAgICB0aGlzLl9maWx0ZXJpbmcgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5zZWFyY2hiYXIuaW5wdXQubmF0aXZlRWxlbWVudC5zY3JvbGxMZWZ0ID0gMDsgLy8gRmlyZWZveCBkb2Vzbid0IGF1dG8tc2Nyb2xsIHRvIHRoZSBsZWZ0IG9uIGJsdXIgbGlrZSBvdGhlciBicm93c2Vyc1xuICAgICAgICB0aGlzLmlzRm9jdXNlZCA9IGZhbHNlO1xuICAgICAgICBjb25zdCB1bnJlc29sdmVkU2VsZWN0aW9uID0gZ2V0dGVyJDEodGhpcy5kYXRhSXRlbSwgdGhpcy52YWx1ZUZpZWxkKSAhPT0gZ2V0dGVyJDEodGhpcy52YWx1ZSwgdGhpcy52YWx1ZUZpZWxkKTtcbiAgICAgICAgY29uc3QgY3VycmVudFRleHQgPSB0aGlzLnNlYXJjaGJhci52YWx1ZTtcbiAgICAgICAgY29uc3QgdGV4dEhhc0NoYW5nZWQgPSBjdXJyZW50VGV4dCAhPT0gKGdldHRlciQxKHRoaXMuZGF0YUl0ZW0sIHRoaXMudGV4dEZpZWxkKSB8fCAnJyk7XG4gICAgICAgIGNvbnN0IHZhbHVlSGFzQ2hhbmdlZCA9IHVucmVzb2x2ZWRTZWxlY3Rpb24gfHwgdGV4dEhhc0NoYW5nZWQ7XG4gICAgICAgIGNvbnN0IHJ1bkluWm9uZSA9IHZhbHVlSGFzQ2hhbmdlZCB8fCBoYXNPYnNlcnZlcnModGhpcy5vbkJsdXIpIHx8IGhhc09ic2VydmVycyh0aGlzLmNsb3NlKSB8fCBpc1VudG91Y2hlZCh0aGlzLndyYXBwZXIubmF0aXZlRWxlbWVudCk7XG4gICAgICAgIGlmIChydW5JblpvbmUpIHtcbiAgICAgICAgICAgIHRoaXMuem9uZS5ydW4oKCkgPT4ge1xuICAgICAgICAgICAgICAgIGlmICh2YWx1ZUhhc0NoYW5nZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbG93ZXJDYXNlTWF0Y2ggPSBpc1ByZXNlbnQodGhpcy5mb2N1c2VkSXRlbVRleHQpICYmIHRoaXMuZm9jdXNlZEl0ZW1UZXh0LnRvTG93ZXJDYXNlKCkgPT09IGN1cnJlbnRUZXh0LnRvTG93ZXJDYXNlKCk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChsb3dlckNhc2VNYXRjaCB8fCB1bnJlc29sdmVkU2VsZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGlvblNlcnZpY2UuY2hhbmdlKHRoaXMuc2VsZWN0aW9uU2VydmljZS5mb2N1c2VkKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2hhbmdlKGN1cnJlbnRUZXh0LCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLm9uQmx1ci5lbWl0KCk7XG4gICAgICAgICAgICAgICAgdGhpcy5vblRvdWNoZWRDYWxsYmFjaygpO1xuICAgICAgICAgICAgICAgIHRoaXMudG9nZ2xlUG9wdXAoZmFsc2UpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnRvZ2dsZVBvcHVwKGZhbHNlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgaGFuZGxlRXNjYXBlKCkge1xuICAgICAgICB0aGlzLnRvZ2dsZVBvcHVwKGZhbHNlKTtcbiAgICAgICAgLy8gY2xlYXIgdGhlIGZvY3VzIG9ubHkgaWYgdGhlIGZvY3VzZWQgaXRlbSBpcyBub3Qgc2VsZWN0ZWRcbiAgICAgICAgY29uc3QgaGFzU2VsZWN0ZWQgPSB0aGlzLnNlbGVjdGlvblNlcnZpY2Uuc2VsZWN0ZWQubGVuZ3RoID4gMDtcbiAgICAgICAgaWYgKCFoYXNTZWxlY3RlZCkge1xuICAgICAgICAgICAgdGhpcy5zdWdnZXN0ZWRUZXh0ID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0aW9uU2VydmljZS5mb2N1c2VkID0gLTE7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIGhhbmRsZU5hdmlnYXRpb25PcGVuKCkge1xuICAgICAgICB0aGlzLnJlc3RvcmVJdGVtRm9jdXMoKTtcbiAgICAgICAgdGhpcy50b2dnbGVQb3B1cCh0cnVlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIHNlYXJjaEJhckNoYW5nZSh0ZXh0KSB7XG4gICAgICAgIGNvbnN0IGN1cnJlbnRUZXh0TGVuZ3RoID0gdGhpcy50ZXh0ID8gdGhpcy50ZXh0Lmxlbmd0aCA6IDA7XG4gICAgICAgIHRoaXMuYmFja3NwYWNlUHJlc3NlZCA9ICh0ZXh0Lmxlbmd0aCA8IGN1cnJlbnRUZXh0TGVuZ3RoKSA/IHRydWUgOiBmYWxzZTtcbiAgICAgICAgdGhpcy50ZXh0ID0gdGV4dDtcbiAgICAgICAgLy8gUmVzZXQgdGhlIHNlbGVjdGlvbiBwcmlvciB0byBmaWx0ZXIuIElmIGEgbWF0Y2ggaXMgcHJlc2VudCwgaXQgd2lsbCBiZSByZXNvbHZlZC4gSWYgYSBtYXRjaCBpcyBub3QgcHJlc2VudCwgaXQgaXMgbm90IG5lZWRlZC5cbiAgICAgICAgdGhpcy5zZWxlY3Rpb25TZXJ2aWNlLnJlc2V0U2VsZWN0aW9uKFtdKTtcbiAgICAgICAgdGhpcy50b2dnbGVQb3B1cCh0cnVlKTtcbiAgICAgICAgdGhpcy5fZmlsdGVyaW5nID0gdHJ1ZTtcbiAgICAgICAgaWYgKHRoaXMuZmlsdGVyYWJsZSAmJiB0aGlzLmZpbHRlclRleHQgIT09IHRleHQpIHtcbiAgICAgICAgICAgIHRoaXMuZmlsdGVyVGV4dCA9IHRleHQ7XG4gICAgICAgICAgICB0aGlzLmZpbHRlckNoYW5nZS5lbWl0KHRleHQpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5zZWFyY2godGV4dCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIGhhbmRsZUZvY3VzKCkge1xuICAgICAgICB0aGlzLmlzRm9jdXNlZCA9IHRydWU7XG4gICAgICAgIGlmIChoYXNPYnNlcnZlcnModGhpcy5vbkZvY3VzKSkge1xuICAgICAgICAgICAgdGhpcy56b25lLnJ1bigoKSA9PiB0aGlzLm9uRm9jdXMuZW1pdCgpKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgcGFnZUNoYW5nZShldmVudCkge1xuICAgICAgICBjb25zdCB2aXJ0dWFsID0gdGhpcy52aXJ0dWFsO1xuICAgICAgICB2aXJ0dWFsLnNraXAgPSBldmVudC5za2lwO1xuICAgIH1cbiAgICBjaGFuZ2UoY2FuZGlkYXRlLCBpc0N1c3RvbSA9IGZhbHNlKSB7XG4gICAgICAgIGlmIChpc0N1c3RvbSkge1xuICAgICAgICAgICAgdGhpcy5jdXN0b21WYWx1ZVN1YmplY3QubmV4dChjYW5kaWRhdGUpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy52YWx1ZVN1YmplY3QubmV4dChjYW5kaWRhdGUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVtaXRWYWx1ZUNoYW5nZSgpIHtcbiAgICAgICAgdGhpcy5vbkNoYW5nZUNhbGxiYWNrKHRoaXMudmFsdWUpO1xuICAgICAgICB0aGlzLnZhbHVlQ2hhbmdlLmVtaXQodGhpcy52YWx1ZSk7XG4gICAgICAgIHRoaXMuX3ByZXZpb3VzRGF0YUl0ZW0gPSB0aGlzLmRhdGFJdGVtO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgc2VsZWN0Q2xpY2soKSB7XG4gICAgICAgIGlmICghdGhpcy50b3VjaEVuYWJsZWQpIHtcbiAgICAgICAgICAgIHRoaXMuc2VhcmNoYmFyLmZvY3VzKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF0aGlzLmlzT3Blbikge1xuICAgICAgICAgICAgdGhpcy5yZXN0b3JlSXRlbUZvY3VzKCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy50b2dnbGVQb3B1cCghdGhpcy5pc09wZW4pO1xuICAgIH1cbiAgICBnZXQgbGlzdENvbnRhaW5lckNsYXNzZXMoKSB7XG4gICAgICAgIHJldHVybiBbJ2stbGlzdC1jb250YWluZXInLCAnay1yZXNldCddLmNvbmNhdCh0aGlzLnBvcHVwU2V0dGluZ3MucG9wdXBDbGFzcyB8fCBbXSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBwcmV2ZW50RXZlbnREZWZhdWx0KGV2ZW50KSB7XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgfVxuICAgIGdldCBmb2N1c2VkSXRlbVRleHQoKSB7XG4gICAgICAgIGNvbnN0IGZvY3VzZWQgPSB0aGlzLnNlbGVjdGlvblNlcnZpY2UuZm9jdXNlZDtcbiAgICAgICAgaWYgKCFpc1ByZXNlbnQoZm9jdXNlZCkgfHwgZm9jdXNlZCA9PT0gLTEpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGl0ZW1UZXh0ID0gZ2V0dGVyJDEodGhpcy5kYXRhU2VydmljZS5pdGVtQXQoZm9jdXNlZCksIHRoaXMudGV4dEZpZWxkKTtcbiAgICAgICAgcmV0dXJuICFpc1ByZXNlbnQoaXRlbVRleHQpID8gXCJcIiA6IGl0ZW1UZXh0LnRvU3RyaW5nKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEZvY3VzZXMgdGhlIGZpcnN0IG1hdGNoIHdoZW4gdGhlcmUncyB0ZXh0IGluIHRoZSBpbnB1dCBmaWVsZCwgYnV0IG5vIGZvY3VzZWQgaXRlbS5cbiAgICAgKi9cbiAgICByZXN0b3JlSXRlbUZvY3VzKCkge1xuICAgICAgICBjb25zdCBoYXNGb2N1cyA9IGlzUHJlc2VudCh0aGlzLnNlbGVjdGlvblNlcnZpY2UuZm9jdXNlZCkgJiYgdGhpcy5zZWxlY3Rpb25TZXJ2aWNlLmZvY3VzZWQgPiAtMTtcbiAgICAgICAgaWYgKCFoYXNGb2N1cyAmJiB0aGlzLnRleHQgJiYgdGhpcy5kYXRhU2VydmljZS5pdGVtc0NvdW50KSB7XG4gICAgICAgICAgICBpZiAodGhpcy5maWx0ZXJhYmxlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3Rpb25TZXJ2aWNlLmZvY3VzZWQgPSB0aGlzLmZpcnN0Rm9jdXNhYmxlSW5kZXgoMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNlYXJjaCh0aGlzLnRleHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHVzZVN1Z2dlc3Rpb24oKSB7XG4gICAgICAgIGlmICghKHRoaXMuc3VnZ2VzdCAmJiBpc1ByZXNlbnQodGhpcy5zZWFyY2hiYXIudmFsdWUpKSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGZvY3VzZWREYXRhSXRlbSA9IHRoaXMuZGF0YVNlcnZpY2UuaXRlbUF0KHRoaXMuc2VsZWN0aW9uU2VydmljZS5mb2N1c2VkKTtcbiAgICAgICAgY29uc3QgZm9jdXNlZEl0ZW1UZXh0ID0gZ2V0dGVyJDEoZm9jdXNlZERhdGFJdGVtLCB0aGlzLnRleHRGaWVsZCk7XG4gICAgICAgIGlmICghaXNQcmVzZW50KGZvY3VzZWRJdGVtVGV4dCkpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5zZWFyY2hiYXIudmFsdWUudG9Mb3dlckNhc2UoKSA9PT0gZm9jdXNlZEl0ZW1UZXh0LnRvTG93ZXJDYXNlKCk7XG4gICAgfVxuICAgIGRlc3Ryb3lQb3B1cCgpIHtcbiAgICAgICAgaWYgKHRoaXMucG9wdXBSZWYpIHtcbiAgICAgICAgICAgIHRoaXMucG9wdXBSZWYucG9wdXBFbGVtZW50XG4gICAgICAgICAgICAgICAgLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIHRoaXMucG9wdXBNb3VzZURvd25IYW5kbGVyKTtcbiAgICAgICAgICAgIHRoaXMucG9wdXBSZWYuY2xvc2UoKTtcbiAgICAgICAgICAgIHRoaXMucG9wdXBSZWYgPSBudWxsO1xuICAgICAgICB9XG4gICAgfVxuICAgIGNyZWF0ZVBvcHVwKCkge1xuICAgICAgICBpZiAodGhpcy52aXJ0dWFsKSB7XG4gICAgICAgICAgICB0aGlzLnZpcnR1YWwuc2tpcCA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgaG9yaXpvbnRhbEFsaWduID0gdGhpcy5kaXJlY3Rpb24gPT09IFwicnRsXCIgPyBcInJpZ2h0XCIgOiBcImxlZnRcIjtcbiAgICAgICAgY29uc3QgYW5jaG9yUG9zaXRpb24gPSB7IGhvcml6b250YWw6IGhvcml6b250YWxBbGlnbiwgdmVydGljYWw6IFwiYm90dG9tXCIgfTtcbiAgICAgICAgY29uc3QgcG9wdXBQb3NpdGlvbiA9IHsgaG9yaXpvbnRhbDogaG9yaXpvbnRhbEFsaWduLCB2ZXJ0aWNhbDogXCJ0b3BcIiB9O1xuICAgICAgICB0aGlzLnBvcHVwUmVmID0gdGhpcy5wb3B1cFNlcnZpY2Uub3Blbih7XG4gICAgICAgICAgICBhbmNob3I6IHRoaXMud3JhcHBlcixcbiAgICAgICAgICAgIGFuaW1hdGU6IHRoaXMucG9wdXBTZXR0aW5ncy5hbmltYXRlLFxuICAgICAgICAgICAgYXBwZW5kVG86IHRoaXMuYXBwZW5kVG8sXG4gICAgICAgICAgICBjb250ZW50OiB0aGlzLnBvcHVwVGVtcGxhdGUsXG4gICAgICAgICAgICBwb3B1cENsYXNzOiB0aGlzLmxpc3RDb250YWluZXJDbGFzc2VzLFxuICAgICAgICAgICAgcG9zaXRpb25Nb2RlOiAnYWJzb2x1dGUnLFxuICAgICAgICAgICAgYW5jaG9yQWxpZ246IGFuY2hvclBvc2l0aW9uLFxuICAgICAgICAgICAgcG9wdXBBbGlnbjogcG9wdXBQb3NpdGlvblxuICAgICAgICB9KTtcbiAgICAgICAgY29uc3QgcG9wdXBXcmFwcGVyID0gdGhpcy5wb3B1cFJlZi5wb3B1cEVsZW1lbnQ7XG4gICAgICAgIGNvbnN0IHsgbWluLCBtYXggfSA9IHRoaXMucG9wdXBXaWR0aDtcbiAgICAgICAgcG9wdXBXcmFwcGVyLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIHRoaXMucG9wdXBNb3VzZURvd25IYW5kbGVyKTtcbiAgICAgICAgcG9wdXBXcmFwcGVyLnN0eWxlLm1pbldpZHRoID0gbWluO1xuICAgICAgICBwb3B1cFdyYXBwZXIuc3R5bGUud2lkdGggPSBtYXg7XG4gICAgICAgIHBvcHVwV3JhcHBlci5zdHlsZS5oZWlnaHQgPSB0aGlzLnBvcHVwSGVpZ2h0O1xuICAgICAgICBwb3B1cFdyYXBwZXIuc2V0QXR0cmlidXRlKFwiZGlyXCIsIHRoaXMuZGlyZWN0aW9uKTtcbiAgICAgICAgdGhpcy5wb3B1cFJlZi5wb3B1cE9wZW4uc3Vic2NyaWJlKCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuY2RyLmRldGVjdENoYW5nZXMoKTtcbiAgICAgICAgICAgIHRoaXMub3B0aW9uc0xpc3Quc2Nyb2xsVG9JdGVtKHRoaXMuc2VsZWN0aW9uU2VydmljZS5mb2N1c2VkKTtcbiAgICAgICAgICAgIHRoaXMub3BlbmVkLmVtaXQoKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMucG9wdXBSZWYucG9wdXBDbG9zZS5zdWJzY3JpYmUoKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5jbG9zZWQuZW1pdCgpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5wb3B1cFJlZi5wb3B1cEFuY2hvclZpZXdwb3J0TGVhdmUuc3Vic2NyaWJlKCgpID0+IHRoaXMudG9nZ2xlUG9wdXAoZmFsc2UpKTtcbiAgICB9XG4gICAgX3RvZ2dsZShvcGVuKSB7XG4gICAgICAgIHRoaXMuX29wZW4gPSBvcGVuO1xuICAgICAgICB0aGlzLmRlc3Ryb3lQb3B1cCgpO1xuICAgICAgICBpZiAodGhpcy5fb3Blbikge1xuICAgICAgICAgICAgdGhpcy5jcmVhdGVQb3B1cCgpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHRyaWdnZXJQb3B1cEV2ZW50cyhvcGVuKSB7XG4gICAgICAgIGNvbnN0IGV2ZW50QXJncyA9IG5ldyBQcmV2ZW50YWJsZUV2ZW50KCk7XG4gICAgICAgIGlmIChvcGVuKSB7XG4gICAgICAgICAgICB0aGlzLm9wZW4uZW1pdChldmVudEFyZ3MpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5jbG9zZS5lbWl0KGV2ZW50QXJncyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGV2ZW50QXJncy5pc0RlZmF1bHRQcmV2ZW50ZWQoKTtcbiAgICB9XG4gICAgY2xlYXJGaWx0ZXIoKSB7XG4gICAgICAgIGlmICghKHRoaXMuZmlsdGVyYWJsZSAmJiB0aGlzLmZpbHRlclRleHQpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5maWx0ZXJUZXh0ID0gJyc7XG4gICAgICAgIHRoaXMuZmlsdGVyQ2hhbmdlLmVtaXQodGhpcy5maWx0ZXJUZXh0KTtcbiAgICB9XG4gICAgc3Vic2NyaWJlVG91Y2hFdmVudHMoKSB7XG4gICAgICAgIGlmICghaXNEb2N1bWVudEF2YWlsYWJsZSgpIHx8ICF0aGlzLnRvdWNoRW5hYmxlZCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuem9uZS5ydW5PdXRzaWRlQW5ndWxhcigoKSA9PiBcbiAgICAgICAgLy8gUm9sbCB1cCBDb21ib0JveCBvbiBpT1Mgd2hlbiB0YXBwZWQgb3V0c2lkZVxuICAgICAgICB0aGlzLnRvdWNoc3RhcnREaXNwb3NlSGFuZGxlciA9IHRoaXMucmVuZGVyZXIubGlzdGVuKGRvY3VtZW50LCAndG91Y2hzdGFydCcsIChlKSA9PiB7XG4gICAgICAgICAgICBjb25zdCB0YXJnZXQgPSBlLnRhcmdldDtcbiAgICAgICAgICAgIGNvbnN0IGlzSW5Ecm9wRG93biA9IGluRHJvcERvd24odGhpcy53cmFwcGVyLCB0YXJnZXQsIHRoaXMucG9wdXBSZWYpO1xuICAgICAgICAgICAgaWYgKHRoaXMuaXNGb2N1c2VkICYmICFpc0luRHJvcERvd24pIHtcbiAgICAgICAgICAgICAgICAvLyBDbG9zZSBwb3B1cCBhbmQgbW9iaWxlIGtleWJvYXJkIGlmIHNlYXJjaGJhciBpcyBmb2N1c2VkXG4gICAgICAgICAgICAgICAgdGhpcy56b25lLnJ1bigoKSA9PiB0aGlzLmJsdXIoKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICh0aGlzLmlzT3BlbiAmJiAhaXNJbkRyb3BEb3duKSB7XG4gICAgICAgICAgICAgICAgLy8gQ2xvc2UgcG9wdXAgaWYgdGhlIHBvcHVwIGlzIG9wZW5lZCB2aWEgdGhlIHNlbGVjdCBjbGlja1xuICAgICAgICAgICAgICAgIHRoaXMuem9uZS5ydW4oKCkgPT4gdGhpcy50b2dnbGVQb3B1cChmYWxzZSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGF0dGFjaFNlbGVjdENsaWNrSGFuZGxlcigpIHtcbiAgICAgICAgY29uc3Qgc2VsZWN0RWxlbWVudCA9IHRoaXMuc2VsZWN0Lm5hdGl2ZUVsZW1lbnQ7XG4gICAgICAgIGNvbnN0IGV2ZW50ID0gcG9pbnRlcnMgPyAncG9pbnRlcmRvd24nIDogJ2NsaWNrJztcbiAgICAgICAgdGhpcy5zZWxlY3RDbGlja0Rpc3Bvc2VIYW5kbGVyID0gdGhpcy5yZW5kZXJlci5saXN0ZW4oc2VsZWN0RWxlbWVudCwgZXZlbnQsIHRoaXMuc2VsZWN0Q2xpY2suYmluZCh0aGlzKSk7XG4gICAgfVxuICAgIHNldENvbXBvbmVudENsYXNzZXMoKSB7XG4gICAgICAgIGlmICh0aGlzLnNpemUpIHtcbiAgICAgICAgICAgIHRoaXMucmVuZGVyZXIuYWRkQ2xhc3ModGhpcy53cmFwcGVyLm5hdGl2ZUVsZW1lbnQsIGdldFNpemVDbGFzcygnaW5wdXQnLCB0aGlzLnNpemUpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5yb3VuZGVkKSB7XG4gICAgICAgICAgICB0aGlzLnJlbmRlcmVyLmFkZENsYXNzKHRoaXMud3JhcHBlci5uYXRpdmVFbGVtZW50LCBnZXRSb3VuZGVkQ2xhc3ModGhpcy5yb3VuZGVkKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuZmlsbE1vZGUpIHtcbiAgICAgICAgICAgIHRoaXMucmVuZGVyZXIuYWRkQ2xhc3ModGhpcy53cmFwcGVyLm5hdGl2ZUVsZW1lbnQsIGdldEZpbGxNb2RlQ2xhc3MoJ2lucHV0JywgdGhpcy5maWxsTW9kZSkpO1xuICAgICAgICB9XG4gICAgfVxufTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIFN0cmluZylcbl0sIENvbWJvQm94Q29tcG9uZW50LnByb3RvdHlwZSwgXCJmb2N1c2FibGVJZFwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgSW5wdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgQm9vbGVhbilcbl0sIENvbWJvQm94Q29tcG9uZW50LnByb3RvdHlwZSwgXCJhbGxvd0N1c3RvbVwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgSW5wdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgT2JqZWN0KSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnBhcmFtdHlwZXNcIiwgW09iamVjdF0pXG5dLCBDb21ib0JveENvbXBvbmVudC5wcm90b3R5cGUsIFwiZGF0YVwiLCBudWxsKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIE9iamVjdCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjpwYXJhbXR5cGVzXCIsIFtPYmplY3RdKVxuXSwgQ29tYm9Cb3hDb21wb25lbnQucHJvdG90eXBlLCBcInZhbHVlXCIsIG51bGwpO1xuX19kZWNvcmF0ZShbXG4gICAgSW5wdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgU3RyaW5nKVxuXSwgQ29tYm9Cb3hDb21wb25lbnQucHJvdG90eXBlLCBcInRleHRGaWVsZFwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgSW5wdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgU3RyaW5nKVxuXSwgQ29tYm9Cb3hDb21wb25lbnQucHJvdG90eXBlLCBcInZhbHVlRmllbGRcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEJvb2xlYW4pLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246cGFyYW10eXBlc1wiLCBbQm9vbGVhbl0pXG5dLCBDb21ib0JveENvbXBvbmVudC5wcm90b3R5cGUsIFwidmFsdWVQcmltaXRpdmVcIiwgbnVsbCk7XG5fX2RlY29yYXRlKFtcbiAgICBJbnB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBGdW5jdGlvbilcbl0sIENvbWJvQm94Q29tcG9uZW50LnByb3RvdHlwZSwgXCJ2YWx1ZU5vcm1hbGl6ZXJcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIFN0cmluZylcbl0sIENvbWJvQm94Q29tcG9uZW50LnByb3RvdHlwZSwgXCJwbGFjZWhvbGRlclwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgSW5wdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgT2JqZWN0KSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnBhcmFtdHlwZXNcIiwgW09iamVjdF0pXG5dLCBDb21ib0JveENvbXBvbmVudC5wcm90b3R5cGUsIFwicG9wdXBTZXR0aW5nc1wiLCBudWxsKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIE51bWJlcilcbl0sIENvbWJvQm94Q29tcG9uZW50LnByb3RvdHlwZSwgXCJsaXN0SGVpZ2h0XCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBJbnB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBTdHJpbmcpXG5dLCBDb21ib0JveENvbXBvbmVudC5wcm90b3R5cGUsIFwiaWNvbkNsYXNzXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBJbnB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBCb29sZWFuKVxuXSwgQ29tYm9Cb3hDb21wb25lbnQucHJvdG90eXBlLCBcImxvYWRpbmdcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEJvb2xlYW4pXG5dLCBDb21ib0JveENvbXBvbmVudC5wcm90b3R5cGUsIFwic3VnZ2VzdFwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgSW5wdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgQm9vbGVhbilcbl0sIENvbWJvQm94Q29tcG9uZW50LnByb3RvdHlwZSwgXCJjbGVhckJ1dHRvblwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgSW5wdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgQm9vbGVhbilcbl0sIENvbWJvQm94Q29tcG9uZW50LnByb3RvdHlwZSwgXCJkaXNhYmxlZFwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgSW5wdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgRnVuY3Rpb24pLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246cGFyYW10eXBlc1wiLCBbRnVuY3Rpb25dKVxuXSwgQ29tYm9Cb3hDb21wb25lbnQucHJvdG90eXBlLCBcIml0ZW1EaXNhYmxlZFwiLCBudWxsKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEJvb2xlYW4pXG5dLCBDb21ib0JveENvbXBvbmVudC5wcm90b3R5cGUsIFwicmVhZG9ubHlcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIE51bWJlcilcbl0sIENvbWJvQm94Q29tcG9uZW50LnByb3RvdHlwZSwgXCJ0YWJpbmRleFwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgSW5wdXQoXCJ0YWJJbmRleFwiKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgTnVtYmVyKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnBhcmFtdHlwZXNcIiwgW051bWJlcl0pXG5dLCBDb21ib0JveENvbXBvbmVudC5wcm90b3R5cGUsIFwidGFiSW5kZXhcIiwgbnVsbCk7XG5fX2RlY29yYXRlKFtcbiAgICBJbnB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBCb29sZWFuKVxuXSwgQ29tYm9Cb3hDb21wb25lbnQucHJvdG90eXBlLCBcImZpbHRlcmFibGVcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIE9iamVjdCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjpwYXJhbXR5cGVzXCIsIFtPYmplY3RdKVxuXSwgQ29tYm9Cb3hDb21wb25lbnQucHJvdG90eXBlLCBcInZpcnR1YWxcIiwgbnVsbCk7XG5fX2RlY29yYXRlKFtcbiAgICBJbnB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBTdHJpbmcpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246cGFyYW10eXBlc1wiLCBbU3RyaW5nXSlcbl0sIENvbWJvQm94Q29tcG9uZW50LnByb3RvdHlwZSwgXCJzaXplXCIsIG51bGwpO1xuX19kZWNvcmF0ZShbXG4gICAgSW5wdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgU3RyaW5nKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnBhcmFtdHlwZXNcIiwgW1N0cmluZ10pXG5dLCBDb21ib0JveENvbXBvbmVudC5wcm90b3R5cGUsIFwicm91bmRlZFwiLCBudWxsKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIFN0cmluZyksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjpwYXJhbXR5cGVzXCIsIFtTdHJpbmddKVxuXSwgQ29tYm9Cb3hDb21wb25lbnQucHJvdG90eXBlLCBcImZpbGxNb2RlXCIsIG51bGwpO1xuX19kZWNvcmF0ZShbXG4gICAgT3V0cHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEV2ZW50RW1pdHRlcilcbl0sIENvbWJvQm94Q29tcG9uZW50LnByb3RvdHlwZSwgXCJ2YWx1ZUNoYW5nZVwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgT3V0cHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEV2ZW50RW1pdHRlcilcbl0sIENvbWJvQm94Q29tcG9uZW50LnByb3RvdHlwZSwgXCJzZWxlY3Rpb25DaGFuZ2VcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIE91dHB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBFdmVudEVtaXR0ZXIpXG5dLCBDb21ib0JveENvbXBvbmVudC5wcm90b3R5cGUsIFwiZmlsdGVyQ2hhbmdlXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBPdXRwdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgRXZlbnRFbWl0dGVyKVxuXSwgQ29tYm9Cb3hDb21wb25lbnQucHJvdG90eXBlLCBcIm9wZW5cIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIE91dHB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBFdmVudEVtaXR0ZXIpXG5dLCBDb21ib0JveENvbXBvbmVudC5wcm90b3R5cGUsIFwib3BlbmVkXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBPdXRwdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgRXZlbnRFbWl0dGVyKVxuXSwgQ29tYm9Cb3hDb21wb25lbnQucHJvdG90eXBlLCBcImNsb3NlXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBPdXRwdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgRXZlbnRFbWl0dGVyKVxuXSwgQ29tYm9Cb3hDb21wb25lbnQucHJvdG90eXBlLCBcImNsb3NlZFwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgT3V0cHV0KCdmb2N1cycpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBFdmVudEVtaXR0ZXIpXG5dLCBDb21ib0JveENvbXBvbmVudC5wcm90b3R5cGUsIFwib25Gb2N1c1wiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgT3V0cHV0KCdibHVyJyksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEV2ZW50RW1pdHRlcilcbl0sIENvbWJvQm94Q29tcG9uZW50LnByb3RvdHlwZSwgXCJvbkJsdXJcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIENvbnRlbnRDaGlsZChJdGVtVGVtcGxhdGVEaXJlY3RpdmUsIHsgc3RhdGljOiBmYWxzZSB9KSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgSXRlbVRlbXBsYXRlRGlyZWN0aXZlKVxuXSwgQ29tYm9Cb3hDb21wb25lbnQucHJvdG90eXBlLCBcInRlbXBsYXRlXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBDb250ZW50Q2hpbGQoSGVhZGVyVGVtcGxhdGVEaXJlY3RpdmUsIHsgc3RhdGljOiBmYWxzZSB9KSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgSGVhZGVyVGVtcGxhdGVEaXJlY3RpdmUpXG5dLCBDb21ib0JveENvbXBvbmVudC5wcm90b3R5cGUsIFwiaGVhZGVyVGVtcGxhdGVcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIENvbnRlbnRDaGlsZChGb290ZXJUZW1wbGF0ZURpcmVjdGl2ZSwgeyBzdGF0aWM6IGZhbHNlIH0pLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBGb290ZXJUZW1wbGF0ZURpcmVjdGl2ZSlcbl0sIENvbWJvQm94Q29tcG9uZW50LnByb3RvdHlwZSwgXCJmb290ZXJUZW1wbGF0ZVwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgQ29udGVudENoaWxkKE5vRGF0YVRlbXBsYXRlRGlyZWN0aXZlLCB7IHN0YXRpYzogZmFsc2UgfSksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIE5vRGF0YVRlbXBsYXRlRGlyZWN0aXZlKVxuXSwgQ29tYm9Cb3hDb21wb25lbnQucHJvdG90eXBlLCBcIm5vRGF0YVRlbXBsYXRlXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBDb250ZW50Q2hpbGQoR3JvdXBUZW1wbGF0ZURpcmVjdGl2ZSwgeyBzdGF0aWM6IGZhbHNlIH0pLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBHcm91cFRlbXBsYXRlRGlyZWN0aXZlKVxuXSwgQ29tYm9Cb3hDb21wb25lbnQucHJvdG90eXBlLCBcImdyb3VwVGVtcGxhdGVcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIENvbnRlbnRDaGlsZChGaXhlZEdyb3VwVGVtcGxhdGVEaXJlY3RpdmUsIHsgc3RhdGljOiBmYWxzZSB9KSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgRml4ZWRHcm91cFRlbXBsYXRlRGlyZWN0aXZlKVxuXSwgQ29tYm9Cb3hDb21wb25lbnQucHJvdG90eXBlLCBcImZpeGVkR3JvdXBUZW1wbGF0ZVwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgVmlld0NoaWxkKCdjb250YWluZXInLCB7IHJlYWQ6IFZpZXdDb250YWluZXJSZWYsIHN0YXRpYzogdHJ1ZSB9KSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgVmlld0NvbnRhaW5lclJlZilcbl0sIENvbWJvQm94Q29tcG9uZW50LnByb3RvdHlwZSwgXCJjb250YWluZXJcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIFZpZXdDaGlsZCgncG9wdXBUZW1wbGF0ZScsIHsgc3RhdGljOiB0cnVlIH0pLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBUZW1wbGF0ZVJlZilcbl0sIENvbWJvQm94Q29tcG9uZW50LnByb3RvdHlwZSwgXCJwb3B1cFRlbXBsYXRlXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBWaWV3Q2hpbGQoU2VhcmNoQmFyQ29tcG9uZW50LCB7IHN0YXRpYzogdHJ1ZSB9KSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgU2VhcmNoQmFyQ29tcG9uZW50KVxuXSwgQ29tYm9Cb3hDb21wb25lbnQucHJvdG90eXBlLCBcInNlYXJjaGJhclwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgVmlld0NoaWxkKCdvcHRpb25zTGlzdCcsIHsgc3RhdGljOiBmYWxzZSB9KSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgTGlzdENvbXBvbmVudClcbl0sIENvbWJvQm94Q29tcG9uZW50LnByb3RvdHlwZSwgXCJvcHRpb25zTGlzdFwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgVmlld0NoaWxkKCdzZWxlY3QnLCB7IHN0YXRpYzogdHJ1ZSB9KSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgRWxlbWVudFJlZilcbl0sIENvbWJvQm94Q29tcG9uZW50LnByb3RvdHlwZSwgXCJzZWxlY3RcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIEhvc3RCaW5kaW5nKCdjbGFzcy5rLWNvbWJvYm94JyksXG4gICAgSG9zdEJpbmRpbmcoJ2NsYXNzLmstaW5wdXQnKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgQm9vbGVhbilcbl0sIENvbWJvQm94Q29tcG9uZW50LnByb3RvdHlwZSwgXCJ3aWRnZXRDbGFzc2VzXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBIb3N0QmluZGluZygnY2xhc3Muay1kaXNhYmxlZCcpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBCb29sZWFuKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnBhcmFtdHlwZXNcIiwgW10pXG5dLCBDb21ib0JveENvbXBvbmVudC5wcm90b3R5cGUsIFwiaXNEaXNhYmxlZFwiLCBudWxsKTtcbl9fZGVjb3JhdGUoW1xuICAgIEhvc3RCaW5kaW5nKCdjbGFzcy5rLWxvYWRpbmcnKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgQm9vbGVhbiksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjpwYXJhbXR5cGVzXCIsIFtdKVxuXSwgQ29tYm9Cb3hDb21wb25lbnQucHJvdG90eXBlLCBcImlzTG9hZGluZ1wiLCBudWxsKTtcbl9fZGVjb3JhdGUoW1xuICAgIEhvc3RCaW5kaW5nKCdhdHRyLmRpcicpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBPYmplY3QpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246cGFyYW10eXBlc1wiLCBbXSlcbl0sIENvbWJvQm94Q29tcG9uZW50LnByb3RvdHlwZSwgXCJkaXJcIiwgbnVsbCk7XG5Db21ib0JveENvbXBvbmVudCA9IENvbWJvQm94Q29tcG9uZW50XzEgPSBfX2RlY29yYXRlKFtcbiAgICBDb21wb25lbnQoe1xuICAgICAgICBleHBvcnRBczogJ2tlbmRvQ29tYm9Cb3gnLFxuICAgICAgICBwcm92aWRlcnM6IFtcbiAgICAgICAgICAgIENPTUJPQk9YX1ZBTFVFX0FDQ0VTU09SLFxuICAgICAgICAgICAgRGF0YVNlcnZpY2UsXG4gICAgICAgICAgICBTZWxlY3Rpb25TZXJ2aWNlLFxuICAgICAgICAgICAgTmF2aWdhdGlvblNlcnZpY2UsXG4gICAgICAgICAgICBEaXNhYmxlZEl0ZW1zU2VydmljZSxcbiAgICAgICAgICAgIExvY2FsaXphdGlvblNlcnZpY2UsXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcHJvdmlkZTogTDEwTl9QUkVGSVgsXG4gICAgICAgICAgICAgICAgdXNlVmFsdWU6ICdrZW5kby5jb21ib2JveCdcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcHJvdmlkZTogRmlsdGVyYWJsZUNvbXBvbmVudCwgdXNlRXhpc3Rpbmc6IGZvcndhcmRSZWYoKCkgPT4gQ29tYm9Cb3hDb21wb25lbnRfMSlcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcHJvdmlkZTogS2VuZG9JbnB1dCwgdXNlRXhpc3Rpbmc6IGZvcndhcmRSZWYoKCkgPT4gQ29tYm9Cb3hDb21wb25lbnRfMSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgXSxcbiAgICAgICAgc2VsZWN0b3I6ICdrZW5kby1jb21ib2JveCcsXG4gICAgICAgIHRlbXBsYXRlOiBgXG4gICAgICAgIDxuZy1jb250YWluZXIga2VuZG9Db21ib0JveExvY2FsaXplZE1lc3NhZ2VzXG4gICAgICAgICAgICBpMThuLW5vRGF0YVRleHQ9XCJrZW5kby5jb21ib2JveC5ub0RhdGFUZXh0fFRoZSB0ZXh0IGRpc3BsYXllZCBpbiB0aGUgcG9wdXAgd2hlbiB0aGVyZSBhcmUgbm8gaXRlbXNcIlxuICAgICAgICAgICAgbm9EYXRhVGV4dD1cIk5PIERBVEEgRk9VTkRcIlxuXG4gICAgICAgICAgICBpMThuLWNsZWFyVGl0bGU9XCJrZW5kby5jb21ib2JveC5jbGVhclRpdGxlfFRoZSB0aXRsZSBvZiB0aGUgY2xlYXIgYnV0dG9uXCJcbiAgICAgICAgICAgIGNsZWFyVGl0bGU9XCJjbGVhclwiXG5cbiAgICAgICAgICAgIGkxOG4tc2VsZWN0QnV0dG9uVGV4dD1cImtlbmRvLmNvbWJvYm94LnNlbGVjdEJ1dHRvblRleHR8VGhlIHRleHQgc2V0IGFzIGFyaWEtbGFiZWwgb24gdGhlIHNlbGVjdCBidXR0b25cIlxuICAgICAgICAgICAgc2VsZWN0QnV0dG9uVGV4dD1cIlNlbGVjdFwiXG4gICAgICAgID5cbiAgICAgICAgPC9uZy1jb250YWluZXI+XG4gICAgICAgIDxrZW5kby1zZWFyY2hiYXIgI3NlYXJjaGJhclxuICAgICAgICAgICAgW3JvbGVdPVwiJ2NvbWJvYm94J1wiXG4gICAgICAgICAgICBbaWRdPVwiZm9jdXNhYmxlSWRcIlxuICAgICAgICAgICAgW2xpc3RJZF09XCJsaXN0Qm94SWRcIlxuICAgICAgICAgICAgW2FjdGl2ZURlc2NlbmRhbnRdPVwiYWN0aXZlRGVzY2VuZGFudFwiXG4gICAgICAgICAgICBbbm9EYXRhTGFiZWxdPVwibm9EYXRhTGFiZWxcIlxuICAgICAgICAgICAgW3VzZXJJbnB1dF09XCJ0ZXh0XCJcbiAgICAgICAgICAgIFtzdWdnZXN0ZWRUZXh0XT1cImdldFN1Z2dlc3Rpb24oKVwiXG4gICAgICAgICAgICBbZGlzYWJsZWRdPVwiZGlzYWJsZWRcIlxuICAgICAgICAgICAgW3JlYWRvbmx5XT1cInJlYWRvbmx5XCJcbiAgICAgICAgICAgIFt0YWJJbmRleF09XCJ0YWJJbmRleFwiXG4gICAgICAgICAgICBbcG9wdXBPcGVuXT1cImlzT3BlblwiXG4gICAgICAgICAgICBbcGxhY2Vob2xkZXJdPVwicGxhY2Vob2xkZXJcIlxuICAgICAgICAgICAgKG9uTmF2aWdhdGUpPVwiaGFuZGxlTmF2aWdhdGUoJGV2ZW50KVwiXG4gICAgICAgICAgICAodmFsdWVDaGFuZ2UpPVwic2VhcmNoQmFyQ2hhbmdlKCRldmVudClcIlxuICAgICAgICAgICAgKG9uQmx1cik9XCJoYW5kbGVCbHVyKClcIlxuICAgICAgICAgICAgKG9uRm9jdXMpPVwiaGFuZGxlRm9jdXMoKVwiXG4gICAgICAgID48L2tlbmRvLXNlYXJjaGJhcj5cbiAgICAgICAgPHNwYW5cbiAgICAgICAgICAgICpuZ0lmPVwiY2xlYXJCdXR0b24gJiYgIWxvYWRpbmcgJiYgIWRpc2FibGVkICYmICFyZWFkb25seSAmJiB0ZXh0Py5sZW5ndGhcIlxuICAgICAgICAgICAgY2xhc3M9XCJrLWNsZWFyLXZhbHVlXCJcbiAgICAgICAgICAgIFtzdHlsZS52aXNpYmlsaXR5XT1cImNsZWFyQnV0dG9uVmlzaWJsaXR5XCJcbiAgICAgICAgICAgIGFyaWEtaGlkZGVuPVwidHJ1ZVwiXG4gICAgICAgICAgICBbYXR0ci50aXRsZV09XCJtZXNzYWdlRm9yKCdjbGVhclRpdGxlJylcIlxuICAgICAgICAgICAgKGNsaWNrKT1cImNsZWFyVmFsdWUoJGV2ZW50KVwiXG4gICAgICAgICAgICBba2VuZG9FdmVudHNPdXRzaWRlQW5ndWxhcl09XCJ7XG4gICAgICAgICAgICAgICAgbW91c2Vkb3duOiBwcmV2ZW50RXZlbnREZWZhdWx0XG4gICAgICAgICAgICB9XCJcbiAgICAgICAgPlxuICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJrLWljb24gay1pLXhcIj48L3NwYW4+XG4gICAgICAgIDwvc3Bhbj5cbiAgICAgICAgPGJ1dHRvblxuICAgICAgICAgICAgI3NlbGVjdFxuICAgICAgICAgICAgdW5zZWxlY3RhYmxlPVwib25cIlxuICAgICAgICAgICAgdHlwZT1cImJ1dHRvblwiXG4gICAgICAgICAgICBjbGFzcz1cImstaW5wdXQtYnV0dG9uIGstYnV0dG9uIGstaWNvbi1idXR0b25cIlxuICAgICAgICAgICAgW25nQ2xhc3NdPVwic2VsZWN0QnV0dG9uQ2xhc3Nlc1wiXG4gICAgICAgICAgICBbYXR0ci5hcmlhLWxhYmVsXT1cIm1lc3NhZ2VGb3IoJ3NlbGVjdEJ1dHRvblRleHQnKVwiXG4gICAgICAgICAgICBba2VuZG9FdmVudHNPdXRzaWRlQW5ndWxhcl09XCJ7XG4gICAgICAgICAgICAgICAgbW91c2Vkb3duOiBwcmV2ZW50RXZlbnREZWZhdWx0XG4gICAgICAgICAgICB9XCJcbiAgICAgICAgPlxuICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJrLWJ1dHRvbi1pY29uIGstaWNvblwiIFtuZ0NsYXNzXT1cImJ1dHRvbkNsYXNzZXNcIj48L3NwYW4+XG4gICAgICAgIDwvYnV0dG9uPlxuICAgICAgICA8bmctdGVtcGxhdGUgI3BvcHVwVGVtcGxhdGU+XG4gICAgICAgICAgICA8IS0taGVhZGVyIHRlbXBsYXRlLS0+XG4gICAgICAgICAgICA8bmctdGVtcGxhdGUgKm5nSWY9XCJoZWFkZXJUZW1wbGF0ZVwiXG4gICAgICAgICAgICAgICAgW3RlbXBsYXRlQ29udGV4dF09XCJ7XG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlUmVmOiBoZWFkZXJUZW1wbGF0ZS50ZW1wbGF0ZVJlZlxuICAgICAgICAgICAgICAgIH1cIj5cbiAgICAgICAgICAgIDwvbmctdGVtcGxhdGU+XG4gICAgICAgICAgICA8IS0tbGlzdC0tPlxuICAgICAgICAgICAgPGtlbmRvLWxpc3RcbiAgICAgICAgICAgICAgICAjb3B0aW9uc0xpc3RcbiAgICAgICAgICAgICAgICBbc2l6ZV09XCJzaXplXCJcbiAgICAgICAgICAgICAgICBbcm91bmRlZF09XCJyb3VuZGVkXCJcbiAgICAgICAgICAgICAgICBbaWRdPVwibGlzdEJveElkXCJcbiAgICAgICAgICAgICAgICBbb3B0aW9uUHJlZml4XT1cIm9wdGlvblByZWZpeFwiXG4gICAgICAgICAgICAgICAgW2RhdGFdPVwiZGF0YVwiXG4gICAgICAgICAgICAgICAgW3RleHRGaWVsZF09XCJ0ZXh0RmllbGRcIlxuICAgICAgICAgICAgICAgIFt2YWx1ZUZpZWxkXT1cInZhbHVlRmllbGRcIlxuICAgICAgICAgICAgICAgIFt0ZW1wbGF0ZV09XCJ0ZW1wbGF0ZVwiXG4gICAgICAgICAgICAgICAgW2dyb3VwVGVtcGxhdGVdPVwiZ3JvdXBUZW1wbGF0ZVwiXG4gICAgICAgICAgICAgICAgW2ZpeGVkR3JvdXBUZW1wbGF0ZV09XCJmaXhlZEdyb3VwVGVtcGxhdGVcIlxuICAgICAgICAgICAgICAgIFtoZWlnaHRdPVwibGlzdEhlaWdodFwiXG4gICAgICAgICAgICAgICAgW3Nob3ddPVwiaXNPcGVuXCJcbiAgICAgICAgICAgICAgICBbdmlydHVhbF09XCJ2aXJ0dWFsXCJcbiAgICAgICAgICAgICAgICAocGFnZUNoYW5nZSk9XCJwYWdlQ2hhbmdlKCRldmVudClcIlxuICAgICAgICAgICAgPlxuICAgICAgICAgICAgPC9rZW5kby1saXN0PlxuICAgICAgICAgICAgPCEtLW5vLWRhdGEgdGVtcGxhdGUtLT5cbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJrLW5vLWRhdGFcIiAqbmdJZj1cImRhdGEubGVuZ3RoID09PSAwXCI+XG4gICAgICAgICAgICAgICAgPG5nLXRlbXBsYXRlIFtuZ0lmXT1cIm5vRGF0YVRlbXBsYXRlXCJcbiAgICAgICAgICAgICAgICAgICAgW3RlbXBsYXRlQ29udGV4dF09XCJ7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVJlZjogbm9EYXRhVGVtcGxhdGUgPyBub0RhdGFUZW1wbGF0ZS50ZW1wbGF0ZVJlZiA6IHVuZGVmaW5lZFxuICAgICAgICAgICAgICAgICAgICB9XCI+XG4gICAgICAgICAgICAgICAgPC9uZy10ZW1wbGF0ZT5cbiAgICAgICAgICAgICAgICA8bmctdGVtcGxhdGUgW25nSWZdPVwiIW5vRGF0YVRlbXBsYXRlXCI+XG4gICAgICAgICAgICAgICAgICAgIDxkaXY+e3sgbWVzc2FnZUZvcignbm9EYXRhVGV4dCcpIH19PC9kaXY+XG4gICAgICAgICAgICAgICAgPC9uZy10ZW1wbGF0ZT5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPCEtLWZvb3RlciB0ZW1wbGF0ZS0tPlxuICAgICAgICAgICAgPG5nLXRlbXBsYXRlICpuZ0lmPVwiZm9vdGVyVGVtcGxhdGVcIlxuICAgICAgICAgICAgICAgIFt0ZW1wbGF0ZUNvbnRleHRdPVwie1xuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVJlZjogZm9vdGVyVGVtcGxhdGUudGVtcGxhdGVSZWZcbiAgICAgICAgICAgICAgICB9XCI+XG4gICAgICAgICAgICA8L25nLXRlbXBsYXRlPlxuICAgICAgICA8L25nLXRlbXBsYXRlPlxuICAgICAgICA8bmctdGVtcGxhdGUgW25nSWZdPVwiaXNPcGVuXCI+XG4gICAgICAgICAgICA8a2VuZG8tcmVzaXplLXNlbnNvciAocmVzaXplKT1cIm9uUmVzaXplKClcIj48L2tlbmRvLXJlc2l6ZS1zZW5zb3I+XG4gICAgICAgIDwvbmctdGVtcGxhdGU+XG4gICAgICAgIDxuZy1jb250YWluZXIgI2NvbnRhaW5lcj48L25nLWNvbnRhaW5lcj5cbiAgYFxuICAgIH0pLFxuICAgIF9fcGFyYW0oMTAsIE9wdGlvbmFsKCkpLCBfX3BhcmFtKDEwLCBJbmplY3QoVE9VQ0hfRU5BQkxFRCkpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246cGFyYW10eXBlc1wiLCBbRWxlbWVudFJlZixcbiAgICAgICAgTG9jYWxpemF0aW9uU2VydmljZSxcbiAgICAgICAgUG9wdXBTZXJ2aWNlLFxuICAgICAgICBTZWxlY3Rpb25TZXJ2aWNlLFxuICAgICAgICBOYXZpZ2F0aW9uU2VydmljZSxcbiAgICAgICAgRGlzYWJsZWRJdGVtc1NlcnZpY2UsXG4gICAgICAgIERhdGFTZXJ2aWNlLFxuICAgICAgICBOZ1pvbmUsXG4gICAgICAgIENoYW5nZURldGVjdG9yUmVmLFxuICAgICAgICBSZW5kZXJlcjIsIEJvb2xlYW5dKVxuXSwgQ29tYm9Cb3hDb21wb25lbnQpO1xuXG4vKipcbiAqIFJlbmRlcnMgdGhlIHNlbGVjdGVkIHZhbHVlIG9mIHRoZSBkcm9wZG93bi4gVG8gZGVmaW5lIHRoZSBoZWFkZXIgdGVtcGxhdGUsIG5lc3QgYW4gYDxuZy10ZW1wbGF0ZT5gIHRhZ1xuICogd2l0aCB0aGUgYGtlbmRvPENvbXBvbmVudE5hbWU+VmFsdWVUZW1wbGF0ZWAgZGlyZWN0aXZlIGluc2lkZSB0aGUgY29tcG9uZW50IHRhZy5cbiAqXG4gKiBUaGUgdGVtcGxhdGUgY29udGV4dCBpcyBzZXQgdG8gdGhlIGN1cnJlbnQgY29tcG9uZW50LlxuICogVG8gZ2V0IGEgcmVmZXJlbmNlIHRvIHRoZSBjdXJyZW50IGRhdGEgaXRlbSwgdXNlIHRoZSBgbGV0LWRhdGFJdGVtYCBkaXJlY3RpdmUuXG4gKlxuICogPiBUaGUgYFZhbHVlVGVtcGxhdGVgIGRpcmVjdGl2ZSBjYW4gb25seSBiZSB1c2VkIHdpdGggdGhlIERyb3BEb3duTGlzdCBhbmQgRHJvcERvd25UcmVlIGNvbXBvbmVudHMuXG4gKlxuICogLSBbVXNpbmcgYFZhbHVlVGVtcGxhdGVgIHdpdGggdGhlIERyb3BEb3duTGlzdF0oeyUgc2x1ZyB0ZW1wbGF0ZXNfZGRsICV9I3RvYy12YWx1ZS10ZW1wbGF0ZSlcbiAqIC0gW1VzaW5nIGBWYWx1ZVRlbXBsYXRlYCB3aXRoIHRoZSBEcm9wRG93blRyZWVdKHslIHNsdWcgdGVtcGxhdGVzX2RkdCAlfSN0b2MtdmFsdWUtdGVtcGxhdGUpXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYHRzXG4gKiBfQENvbXBvbmVudCh7XG4gKiBzZWxlY3RvcjogJ215LWFwcCcsXG4gKiB0ZW1wbGF0ZTogYFxuICogIDxrZW5kby1kcm9wZG93bmxpc3QgW2RhdGFdPVwibGlzdEl0ZW1zXCI+XG4gKiAgICA8bmctdGVtcGxhdGUga2VuZG9Ecm9wRG93bkxpc3RWYWx1ZVRlbXBsYXRlIGxldC1kYXRhSXRlbT5cbiAqICAgICAgPHNwYW4+e3tkYXRhSXRlbX19IG9wdGlvbjwvc3Bhbj5cbiAqICAgIDwvbmctdGVtcGxhdGU+XG4gKiAgPC9rZW5kby1kcm9wZG93bmxpc3Q+XG4gKiBgXG4gKiB9KVxuICogY2xhc3MgQXBwQ29tcG9uZW50IHtcbiAqICAgcHVibGljIGxpc3RJdGVtczogQXJyYXk8c3RyaW5nPiA9IFtcIkl0ZW0gMVwiLCBcIkl0ZW0gMlwiLCBcIkl0ZW0gM1wiLCBcIkl0ZW0gNFwiXTtcbiAqIH1cbiAqIGBgYFxuICovXG5sZXQgVmFsdWVUZW1wbGF0ZURpcmVjdGl2ZSA9IGNsYXNzIFZhbHVlVGVtcGxhdGVEaXJlY3RpdmUge1xuICAgIGNvbnN0cnVjdG9yKHRlbXBsYXRlUmVmKSB7XG4gICAgICAgIHRoaXMudGVtcGxhdGVSZWYgPSB0ZW1wbGF0ZVJlZjtcbiAgICB9XG59O1xuVmFsdWVUZW1wbGF0ZURpcmVjdGl2ZSA9IF9fZGVjb3JhdGUoW1xuICAgIERpcmVjdGl2ZSh7XG4gICAgICAgIHNlbGVjdG9yOiAnW2tlbmRvRHJvcERvd25MaXN0VmFsdWVUZW1wbGF0ZV0sW2tlbmRvRHJvcERvd25UcmVlVmFsdWVUZW1wbGF0ZV0nXG4gICAgfSksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjpwYXJhbXR5cGVzXCIsIFtUZW1wbGF0ZVJlZl0pXG5dLCBWYWx1ZVRlbXBsYXRlRGlyZWN0aXZlKTtcblxuLyogdHNsaW50OmRpc2FibGU6bWVtYmVyLW9yZGVyaW5nICovXG52YXIgRHJvcERvd25MaXN0Q29tcG9uZW50XzE7XG4vKipcbiAqIEBoaWRkZW5cbiAqL1xuY29uc3QgRFJPUERPV05MSVNUX1ZBTFVFX0FDQ0VTU09SID0ge1xuICAgIG11bHRpOiB0cnVlLFxuICAgIHByb3ZpZGU6IE5HX1ZBTFVFX0FDQ0VTU09SLFxuICAgIHVzZUV4aXN0aW5nOiBmb3J3YXJkUmVmKCgpID0+IERyb3BEb3duTGlzdENvbXBvbmVudClcbn07XG4vKipcbiAqIFJlcHJlc2VudHMgdGhlIFtLZW5kbyBVSSBEcm9wRG93bkxpc3QgY29tcG9uZW50IGZvciBBbmd1bGFyXSh7JSBzbHVnIG92ZXJ2aWV3X2RkbCAlfSkuXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYHRzXG4gKiBfQENvbXBvbmVudCh7XG4gKiBzZWxlY3RvcjogJ215LWFwcCcsXG4gKiB0ZW1wbGF0ZTogYFxuICogIDxrZW5kby1kcm9wZG93bmxpc3QgW2RhdGFdPVwibGlzdEl0ZW1zXCI+XG4gKiAgPC9rZW5kby1kcm9wZG93bmxpc3Q+XG4gKiBgXG4gKiB9KVxuICogY2xhc3MgQXBwQ29tcG9uZW50IHtcbiAqICAgcHVibGljIGxpc3RJdGVtczogQXJyYXk8c3RyaW5nPiA9IFtcIkl0ZW0gMVwiLCBcIkl0ZW0gMlwiLCBcIkl0ZW0gM1wiLCBcIkl0ZW0gNFwiXTtcbiAqIH1cbiAqIGBgYFxuICovXG5sZXQgRHJvcERvd25MaXN0Q29tcG9uZW50ID0gRHJvcERvd25MaXN0Q29tcG9uZW50XzEgPSBjbGFzcyBEcm9wRG93bkxpc3RDb21wb25lbnQge1xuICAgIGNvbnN0cnVjdG9yKHdyYXBwZXIsIGxvY2FsaXphdGlvbiwgcG9wdXBTZXJ2aWNlLCBzZWxlY3Rpb25TZXJ2aWNlLCBuYXZpZ2F0aW9uU2VydmljZSwgZGlzYWJsZWRJdGVtc1NlcnZpY2UsIGRhdGFTZXJ2aWNlLCBfem9uZSwgcmVuZGVyZXIsIGNkciwgdG91Y2hFbmFibGVkJCQxKSB7XG4gICAgICAgIHRoaXMud3JhcHBlciA9IHdyYXBwZXI7XG4gICAgICAgIHRoaXMubG9jYWxpemF0aW9uID0gbG9jYWxpemF0aW9uO1xuICAgICAgICB0aGlzLnBvcHVwU2VydmljZSA9IHBvcHVwU2VydmljZTtcbiAgICAgICAgdGhpcy5zZWxlY3Rpb25TZXJ2aWNlID0gc2VsZWN0aW9uU2VydmljZTtcbiAgICAgICAgdGhpcy5uYXZpZ2F0aW9uU2VydmljZSA9IG5hdmlnYXRpb25TZXJ2aWNlO1xuICAgICAgICB0aGlzLmRpc2FibGVkSXRlbXNTZXJ2aWNlID0gZGlzYWJsZWRJdGVtc1NlcnZpY2U7XG4gICAgICAgIHRoaXMuZGF0YVNlcnZpY2UgPSBkYXRhU2VydmljZTtcbiAgICAgICAgdGhpcy5fem9uZSA9IF96b25lO1xuICAgICAgICB0aGlzLnJlbmRlcmVyID0gcmVuZGVyZXI7XG4gICAgICAgIHRoaXMuY2RyID0gY2RyO1xuICAgICAgICB0aGlzLnRvdWNoRW5hYmxlZCA9IHRvdWNoRW5hYmxlZCQkMTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFNldHMgdGhlIGhlaWdodCBvZiB0aGUgb3B0aW9ucyBsaXN0LiBCeSBkZWZhdWx0LCBgbGlzdEhlaWdodGAgaXMgMjAwcHguXG4gICAgICAgICAqXG4gICAgICAgICAqID4gVGhlIGBsaXN0SGVpZ2h0YCBwcm9wZXJ0eSBhZmZlY3RzIG9ubHkgdGhlIGxpc3Qgb2Ygb3B0aW9ucyBhbmQgbm90IHRoZSB3aG9sZSBwb3B1cCBjb250YWluZXIuXG4gICAgICAgICAqID4gVG8gc2V0IHRoZSBoZWlnaHQgb2YgdGhlIHBvcHVwIGNvbnRhaW5lciwgdXNlIGBwb3B1cFNldHRpbmdzLmhlaWdodGAuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmxpc3RIZWlnaHQgPSAyMDA7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBTZXRzIHRoZSBkaXNhYmxlZCBzdGF0ZSBvZiB0aGUgY29tcG9uZW50LlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5kaXNhYmxlZCA9IGZhbHNlO1xuICAgICAgICAvKipcbiAgICAgICAgICogU2V0cyB0aGUgcmVhZC1vbmx5IHN0YXRlIG9mIHRoZSBjb21wb25lbnQuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnJlYWRvbmx5ID0gZmFsc2U7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBFbmFibGVzIHRoZSBbZmlsdGVyaW5nXSh7JSBzbHVnIGZpbHRlcmluZ19kZGwgJX0pIGZ1bmN0aW9uYWxpdHkgb2YgdGhlIERyb3BEb3duTGlzdC5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuZmlsdGVyYWJsZSA9IGZhbHNlO1xuICAgICAgICAvKipcbiAgICAgICAgICogRW5hYmxlcyBhIGNhc2UtaW5zZW5zaXRpdmUgc2VhcmNoLiBXaGVuIGZpbHRyYXRpb24gaXMgZGlzYWJsZWQsIHVzZSB0aGlzIG9wdGlvbi5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuaWdub3JlQ2FzZSA9IHRydWU7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBTZXRzIHRoZSBkZWxheSBiZWZvcmUgYW4gaXRlbSBzZWFyY2ggaXMgcGVyZm9ybWVkLiBXaGVuIGZpbHRyYXRpb24gaXMgZGlzYWJsZWQsIHVzZSB0aGlzIG9wdGlvbi5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuZGVsYXkgPSA1MDA7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBTcGVjaWZpZXMgdGhlIFtgdGFiaW5kZXhgXShodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9IVE1ML0dsb2JhbF9hdHRyaWJ1dGVzL3RhYmluZGV4KSBvZiB0aGUgY29tcG9uZW50LlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy50YWJpbmRleCA9IDA7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBGaXJlcyBlYWNoIHRpbWUgdGhlIHZhbHVlIGlzIGNoYW5nZWQgKFtzZWUgZXhhbXBsZV0oeyUgc2x1ZyBvdmVydmlld19kZGwgJX0jdG9jLWV2ZW50cykpLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy52YWx1ZUNoYW5nZSA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEZpcmVzIGVhY2ggdGltZSB0aGUgdXNlciB0eXBlcyBpbiB0aGUgaW5wdXQgZmllbGRcbiAgICAgICAgICogKFtzZWUgZXhhbXBsZV0oeyUgc2x1ZyBvdmVydmlld19kZGwgJX0jdG9jLWV2ZW50cykpLlxuICAgICAgICAgKiBZb3UgY2FuIGZpbHRlciB0aGUgc291cmNlIGJhc2VkIG9uIHRoZSBwYXNzZWQgZmlsdHJhdGlvbiB2YWx1ZS5cbiAgICAgICAgICogV2hlbiB0aGUgdmFsdWUgb2YgdGhlIGNvbXBvbmVudCBpcyBwcm9ncmFtbWF0aWNhbGx5IGNoYW5nZWQgdG8gYG5nTW9kZWxgIG9yIGBmb3JtQ29udHJvbGBcbiAgICAgICAgICogdGhyb3VnaCBpdHMgQVBJIG9yIGZvcm0gYmluZGluZywgdGhlIGB2YWx1ZUNoYW5nZWAgZXZlbnQgaXMgbm90IHRyaWdnZXJlZCBiZWNhdXNlIGl0XG4gICAgICAgICAqIG1pZ2h0IGNhdXNlIGEgbWl4LXVwIHdpdGggdGhlIGJ1aWx0LWluIGB2YWx1ZUNoYW5nZWAgbWVjaGFuaXNtcyBvZiB0aGUgYG5nTW9kZWxgIG9yIGBmb3JtQ29udHJvbGAgYmluZGluZ3MuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmZpbHRlckNoYW5nZSA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEZpcmVzIGVhY2ggdGltZSB0aGUgaXRlbSBzZWxlY3Rpb24gaXMgY2hhbmdlZFxuICAgICAgICAgKiAoW3NlZSBleGFtcGxlXSh7JSBzbHVnIG92ZXJ2aWV3X2RkbCAlfSN0b2MtZXZlbnRzKSkuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnNlbGVjdGlvbkNoYW5nZSA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEZpcmVzIGVhY2ggdGltZSB0aGUgcG9wdXAgaXMgYWJvdXQgdG8gb3BlblxuICAgICAgICAgKiAoW3NlZSBleGFtcGxlXSh7JSBzbHVnIG9wZW5zdGF0ZV9kZGwgJX0jdG9jLXByZXZlbnRpbmctb3BlbmluZy1hbmQtY2xvc2luZykpLlxuICAgICAgICAgKiBUaGlzIGV2ZW50IGlzIHByZXZlbnRhYmxlLiBJZiB5b3UgY2FuY2VsIGl0LCB0aGUgcG9wdXAgd2lsbCByZW1haW4gY2xvc2VkLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5vcGVuID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICAgICAgICAvKipcbiAgICAgICAgICogRmlyZXMgYWZ0ZXIgdGhlIHBvcHVwIGhhcyBiZWVuIG9wZW5lZC5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMub3BlbmVkID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICAgICAgICAvKipcbiAgICAgICAgICogRmlyZXMgZWFjaCB0aW1lIHRoZSBwb3B1cCBpcyBhYm91dCB0byBjbG9zZVxuICAgICAgICAgKiAoW3NlZSBleGFtcGxlXSh7JSBzbHVnIG9wZW5zdGF0ZV9kZGwgJX0jdG9jLXByZXZlbnRpbmctb3BlbmluZy1hbmQtY2xvc2luZykpLlxuICAgICAgICAgKiBUaGlzIGV2ZW50IGlzIHByZXZlbnRhYmxlLiBJZiB5b3UgY2FuY2VsIGl0LCB0aGUgcG9wdXAgd2lsbCByZW1haW4gb3Blbi5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuY2xvc2UgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBGaXJlcyBhZnRlciB0aGUgcG9wdXAgaGFzIGJlZW4gY2xvc2VkLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5jbG9zZWQgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBGaXJlcyBlYWNoIHRpbWUgdGhlIHVzZXIgZm9jdXNlcyB0aGUgRHJvcERvd25MaXN0LlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5vbkZvY3VzID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICAgICAgICAvKipcbiAgICAgICAgICogRmlyZXMgZWFjaCB0aW1lIHRoZSBEcm9wRG93bkxpc3QgZ2V0cyBibHVycmVkLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5vbkJsdXIgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gICAgICAgIHRoaXMuaG9zdENsYXNzZXMgPSB0cnVlO1xuICAgICAgICAvKipcbiAgICAgICAgICogQGhpZGRlblxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5mb2N1c2FibGVJZCA9IGBrLSR7Z3VpZCQxKCl9YDtcbiAgICAgICAgdGhpcy5yb2xlID0gJ2xpc3Rib3gnO1xuICAgICAgICB0aGlzLmdyb3VwSW5kaWNlcyA9IFtdO1xuICAgICAgICB0aGlzLmxpc3RCb3hJZCA9IGd1aWQkMSgpO1xuICAgICAgICB0aGlzLm9wdGlvblByZWZpeCA9IGd1aWQkMSgpO1xuICAgICAgICB0aGlzLmZpbHRlclRleHQgPSBcIlwiO1xuICAgICAgICB0aGlzLl9pc0ZvY3VzZWQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5vblRvdWNoZWRDYWxsYmFjayA9IChfKSA9PiB7IH07XG4gICAgICAgIHRoaXMub25DaGFuZ2VDYWxsYmFjayA9IChfKSA9PiB7IH07XG4gICAgICAgIHRoaXMud29yZCA9IFwiXCI7XG4gICAgICAgIHRoaXMubGFzdCA9IFwiXCI7XG4gICAgICAgIHRoaXMuZmlsdGVyRm9jdXNlZCA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcbiAgICAgICAgdGhpcy5maWx0ZXJCbHVycmVkID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICAgICAgICB0aGlzLmhvc3RFbGVtZW50Rm9jdXNlZCA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcbiAgICAgICAgdGhpcy5ob3N0RWxlbWVudEJsdXJyZWQgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gICAgICAgIHRoaXMuc2VsZWN0aW9uU3Vic2NyaXB0aW9uID0gbmV3IFN1YnNjcmlwdGlvbigpO1xuICAgICAgICB0aGlzLl9vcGVuID0gZmFsc2U7XG4gICAgICAgIHRoaXMuX3BvcHVwU2V0dGluZ3MgPSB7IGFuaW1hdGU6IHRydWUgfTtcbiAgICAgICAgdGhpcy5fc2l6ZSA9ICdtZWRpdW0nO1xuICAgICAgICB0aGlzLl9yb3VuZGVkID0gJ21lZGl1bSc7XG4gICAgICAgIHRoaXMuX2ZpbGxNb2RlID0gJ3NvbGlkJztcbiAgICAgICAgdmFsaWRhdGVQYWNrYWdlKHBhY2thZ2VNZXRhZGF0YSk7XG4gICAgICAgIHRoaXMuZGlyZWN0aW9uID0gbG9jYWxpemF0aW9uLnJ0bCA/ICdydGwnIDogJ2x0cic7XG4gICAgICAgIHRoaXMuZGF0YSA9IFtdO1xuICAgICAgICB0aGlzLnN1YnNjcmliZUV2ZW50cygpO1xuICAgICAgICB0aGlzLnN1YnNjcmliZVRvdWNoRXZlbnRzKCk7XG4gICAgICAgIHRoaXMuc3Vic2NyaWJlRm9jdXNFdmVudHMoKTtcbiAgICAgICAgdGhpcy5wb3B1cE1vdXNlRG93bkhhbmRsZXIgPSB0aGlzLm9uTW91c2VEb3duLmJpbmQodGhpcyk7XG4gICAgfVxuICAgIGdldCB3aWR0aCgpIHtcbiAgICAgICAgY29uc3Qgd3JhcHBlcldpZHRoID0gaXNEb2N1bWVudEF2YWlsYWJsZSgpID8gdGhpcy53cmFwcGVyLm5hdGl2ZUVsZW1lbnQub2Zmc2V0V2lkdGggOiAwO1xuICAgICAgICBjb25zdCB3aWR0aCA9IHRoaXMucG9wdXBTZXR0aW5ncy53aWR0aCB8fCB3cmFwcGVyV2lkdGg7XG4gICAgICAgIGNvbnN0IG1pbldpZHRoID0gaXNOYU4od3JhcHBlcldpZHRoKSA/IHdyYXBwZXJXaWR0aCA6IGAke3dyYXBwZXJXaWR0aH1weGA7XG4gICAgICAgIGNvbnN0IG1heFdpZHRoID0gaXNOYU4od2lkdGgpID8gd2lkdGggOiBgJHt3aWR0aH1weGA7XG4gICAgICAgIHJldHVybiB7IG1pbjogbWluV2lkdGgsIG1heDogbWF4V2lkdGggfTtcbiAgICB9XG4gICAgZ2V0IGhlaWdodCgpIHtcbiAgICAgICAgY29uc3QgcG9wdXBIZWlnaHQgPSB0aGlzLnBvcHVwU2V0dGluZ3MuaGVpZ2h0O1xuICAgICAgICByZXR1cm4gaXNQcmVzZW50KHBvcHVwSGVpZ2h0KSA/IGAke3BvcHVwSGVpZ2h0fXB4YCA6ICdhdXRvJztcbiAgICB9XG4gICAgZ2V0IHdpZGdldFRhYkluZGV4KCkge1xuICAgICAgICBpZiAodGhpcy5kaXNhYmxlZCkge1xuICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBwcm92aWRlZFRhYkluZGV4ID0gTnVtYmVyKHRoaXMudGFiSW5kZXgpO1xuICAgICAgICBjb25zdCBkZWZhdWx0VGFiSW5kZXggPSAwO1xuICAgICAgICByZXR1cm4gIWlzTmFOKHByb3ZpZGVkVGFiSW5kZXgpID8gcHJvdmlkZWRUYWJJbmRleCA6IGRlZmF1bHRUYWJJbmRleDtcbiAgICB9XG4gICAgZ2V0IGFyaWFFeHBhbmRlZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaXNPcGVuO1xuICAgIH1cbiAgICBnZXQgYXJpYU93bnMoKSB7XG4gICAgICAgIGlmICghdGhpcy5pc09wZW4pIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5saXN0Qm94SWQ7XG4gICAgfVxuICAgIGdldCBhcmlhQWN0aXZlZGVzY2VuZGFudCgpIHtcbiAgICAgICAgaWYgKCFpc1ByZXNlbnQodGhpcy5kYXRhSXRlbSkgfHwgIXRoaXMuaXNPcGVuKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMub3B0aW9uUHJlZml4ICsgXCItXCIgKyBnZXR0ZXIkMSh0aGlzLmRhdGFJdGVtLCB0aGlzLnZhbHVlRmllbGQpO1xuICAgIH1cbiAgICBnZXQgbm9EYXRhTGFiZWwoKSB7XG4gICAgICAgIGlmICh0aGlzLmRhdGFTZXJ2aWNlLml0ZW1zQ291bnQgPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm1lc3NhZ2VGb3IoJ25vRGF0YVRleHQnKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBnZXQgYXBwZW5kVG8oKSB7XG4gICAgICAgIGNvbnN0IHsgYXBwZW5kVG8gfSA9IHRoaXMucG9wdXBTZXR0aW5ncztcbiAgICAgICAgaWYgKCFhcHBlbmRUbyB8fCBhcHBlbmRUbyA9PT0gJ3Jvb3QnKSB7XG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhcHBlbmRUbyA9PT0gJ2NvbXBvbmVudCcgPyB0aGlzLmNvbnRhaW5lciA6IGFwcGVuZFRvO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZXRzIHRoZSBkYXRhIG9mIHRoZSBEcm9wRG93bkxpc3QuXG4gICAgICpcbiAgICAgKiA+IFRoZSBkYXRhIGhhcyB0byBiZSBwcm92aWRlZCBpbiBhbiBhcnJheS1saWtlIGxpc3QuXG4gICAgICovXG4gICAgc2V0IGRhdGEoZGF0YSkge1xuICAgICAgICB0aGlzLmRhdGFTZXJ2aWNlLmRhdGEgPSBkYXRhIHx8IFtdO1xuICAgICAgICBpZiAodGhpcy52aXJ0dWFsKSB7XG4gICAgICAgICAgICB0aGlzLnZpcnR1YWwuc2tpcCA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zZXRTdGF0ZSgpO1xuICAgIH1cbiAgICBnZXQgZGF0YSgpIHtcbiAgICAgICAgY29uc3QgdmlydHVhbCA9IHRoaXMudmlydHVhbDtcbiAgICAgICAgaWYgKHZpcnR1YWwpIHtcbiAgICAgICAgICAgIGNvbnN0IHN0YXJ0ID0gdmlydHVhbC5za2lwIHx8IDA7XG4gICAgICAgICAgICBjb25zdCBlbmQgPSBzdGFydCArIHZpcnR1YWwucGFnZVNpemU7XG4gICAgICAgICAgICAvLyBVc2UgbGVuZ3RoIGluc3RlYWQgb2YgaXRlbXNDb3VudCBiZWNhdXNlIG9mIHRoZSBncm91cGluZy5cbiAgICAgICAgICAgIHZpcnR1YWwudG90YWwgPSB0aGlzLmRhdGFTZXJ2aWNlLmRhdGEubGVuZ3RoO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZGF0YVNlcnZpY2UuZGF0YS5zbGljZShzdGFydCwgZW5kKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5kYXRhU2VydmljZS5kYXRhO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZXRzIHRoZSB2YWx1ZSBvZiB0aGUgRHJvcERvd25MaXN0LlxuICAgICAqIEl0IGNhbiBlaXRoZXIgYmUgb2YgdGhlIHByaW1pdGl2ZSAoc3RyaW5nLCBudW1iZXJzKSBvciBvZiB0aGUgY29tcGxleCAob2JqZWN0cykgdHlwZS5cbiAgICAgKiBUbyBkZWZpbmUgdGhlIHR5cGUsIHVzZSB0aGUgYHZhbHVlUHJpbWl0aXZlYCBvcHRpb24uXG4gICAgICpcbiAgICAgKiA+IEFsbCBzZWxlY3RlZCB2YWx1ZXMgd2hpY2ggYXJlIG5vdCBwcmVzZW50IGluIHRoZSBzb3VyY2UgYXJlIGlnbm9yZWQuXG4gICAgICovXG4gICAgc2V0IHZhbHVlKG5ld1ZhbHVlKSB7XG4gICAgICAgIGlmICghaXNQcmVzZW50KG5ld1ZhbHVlKSkge1xuICAgICAgICAgICAgdGhpcy5fcHJldmlvdXNEYXRhSXRlbSA9IHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl92YWx1ZSA9IG5ld1ZhbHVlO1xuICAgICAgICB0aGlzLnNldFN0YXRlKCk7XG4gICAgICAgIHRoaXMuY2RyLm1hcmtGb3JDaGVjaygpO1xuICAgIH1cbiAgICBnZXQgdmFsdWUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl92YWx1ZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ29uZmlndXJlcyB0aGUgcG9wdXAgb2YgdGhlIERyb3BEb3duTGlzdC5cbiAgICAgKlxuICAgICAqIFRoZSBhdmFpbGFibGUgb3B0aW9ucyBhcmU6XG4gICAgICogLSBgYW5pbWF0ZTogQm9vbGVhbmAmbWRhc2g7Q29udHJvbHMgdGhlIHBvcHVwIGFuaW1hdGlvbi4gQnkgZGVmYXVsdCwgdGhlIG9wZW4gYW5kIGNsb3NlIGFuaW1hdGlvbnMgYXJlIGVuYWJsZWQuXG4gICAgICogLSBgd2lkdGg6IE51bWJlciB8IFN0cmluZ2AmbWRhc2g7U2V0cyB0aGUgd2lkdGggb2YgdGhlIHBvcHVwIGNvbnRhaW5lci4gQnkgZGVmYXVsdCwgdGhlIHdpZHRoIG9mIHRoZSBob3N0IGVsZW1lbnQgaXMgdXNlZC4gSWYgc2V0IHRvIGBhdXRvYCwgdGhlIGNvbXBvbmVudCBhdXRvbWF0aWNhbGx5IGFkanVzdHMgdGhlIHdpZHRoIG9mIHRoZSBwb3B1cCBhbmQgbm8gaXRlbSBsYWJlbHMgYXJlIHdyYXBwZWQuIFRoZSBgYXV0b2AgbW9kZSBpcyBub3Qgc3VwcG9ydGVkIHdoZW4gdmlydHVhbCBzY3JvbGxpbmcgaXMgZW5hYmxlZC5cbiAgICAgKiAtIGBoZWlnaHQ6IE51bWJlcmAmbWRhc2g7U2V0cyB0aGUgaGVpZ2h0IG9mIHRoZSBwb3B1cCBjb250YWluZXIuXG4gICAgICogLSBgcG9wdXBDbGFzczogU3RyaW5nYCZtZGFzaDtTcGVjaWZpZXMgYSBsaXN0IG9mIENTUyBjbGFzc2VzIHRoYXQgYXJlIHVzZWQgdG8gc3R5bGUgdGhlIHBvcHVwLlxuICAgICAqIC0gYGFwcGVuZFRvOiBcInJvb3RcIiB8IFwiY29tcG9uZW50XCIgfCBWaWV3Q29udGFpbmVyUmVmYCZtZGFzaDtTcGVjaWZpZXMgdGhlIGNvbXBvbmVudCB0byB3aGljaCB0aGUgcG9wdXAgd2lsbCBiZSBhcHBlbmRlZC5cbiAgICAgKi9cbiAgICBzZXQgcG9wdXBTZXR0aW5ncyhzZXR0aW5ncykge1xuICAgICAgICB0aGlzLl9wb3B1cFNldHRpbmdzID0gT2JqZWN0LmFzc2lnbih7IGFuaW1hdGU6IHRydWUgfSwgc2V0dGluZ3MpO1xuICAgIH1cbiAgICBnZXQgcG9wdXBTZXR0aW5ncygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3BvcHVwU2V0dGluZ3M7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIERlZmluZXMgYSBCb29sZWFuIGZ1bmN0aW9uIHRoYXQgaXMgZXhlY3V0ZWQgZm9yIGVhY2ggZGF0YSBpdGVtIGluIHRoZSBjb21wb25lbnRcbiAgICAgKiAoW3NlZSBleGFtcGxlc10oeyUgc2x1ZyBkaXNhYmxlZGl0ZW1zX2RkbCAlfSkpLiBEZXRlcm1pbmVzIHdoZXRoZXIgdGhlIGl0ZW0gd2lsbCBiZSBkaXNhYmxlZC5cbiAgICAgKi9cbiAgICBzZXQgaXRlbURpc2FibGVkKGZuKSB7XG4gICAgICAgIGlmICh0eXBlb2YgZm4gIT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgaXRlbURpc2FibGVkIG11c3QgYmUgYSBmdW5jdGlvbiwgYnV0IHJlY2VpdmVkICR7SlNPTi5zdHJpbmdpZnkoZm4pfS5gKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmRpc2FibGVkSXRlbXNTZXJ2aWNlLml0ZW1EaXNhYmxlZCA9IGZuO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBFbmFibGVzIHRoZSBbdmlydHVhbGl6YXRpb25dKHslIHNsdWcgdmlydHVhbGl6YXRpb25fZGRsICV9KSBmdW5jdGlvbmFsaXR5LlxuICAgICAqL1xuICAgIHNldCB2aXJ0dWFsKHNldHRpbmdzKSB7XG4gICAgICAgIHRoaXMuX3ZpcnR1YWxTZXR0aW5ncyA9IG5vcm1hbGl6ZVZpcnR1YWxpemF0aW9uU2V0dGluZ3Moc2V0dGluZ3MpO1xuICAgIH1cbiAgICBnZXQgdmlydHVhbCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3ZpcnR1YWxTZXR0aW5ncztcbiAgICB9XG4gICAgLyoqXG4gICAgICogU3BlY2lmaWVzIHRoZSB0eXBlIG9mIHRoZSBzZWxlY3RlZCB2YWx1ZVxuICAgICAqIChbbW9yZSBpbmZvcm1hdGlvbiBhbmQgZXhhbXBsZV0oeyUgc2x1ZyB2YWx1ZWJpbmRpbmdfZGRsICV9I3RvYy1wcmltaXRpdmUtdmFsdWVzLWZyb20tb2JqZWN0LWZpZWxkcykpLlxuICAgICAqIElmIHNldCB0byBgdHJ1ZWAsIHRoZSBzZWxlY3RlZCB2YWx1ZSBoYXMgdG8gYmUgb2YgYSBwcmltaXRpdmUgdmFsdWUuXG4gICAgICovXG4gICAgc2V0IHZhbHVlUHJpbWl0aXZlKGlzUHJpbWl0aXZlKSB7XG4gICAgICAgIHRoaXMuX3ZhbHVlUHJpbWl0aXZlID0gaXNQcmltaXRpdmU7XG4gICAgfVxuICAgIGdldCB2YWx1ZVByaW1pdGl2ZSgpIHtcbiAgICAgICAgaWYgKCFpc1ByZXNlbnQodGhpcy5fdmFsdWVQcmltaXRpdmUpKSB7XG4gICAgICAgICAgICByZXR1cm4gIWlzUHJlc2VudCh0aGlzLnZhbHVlRmllbGQpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLl92YWx1ZVByaW1pdGl2ZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIHNldCB0YWJJbmRleCh0YWJJbmRleCkge1xuICAgICAgICB0aGlzLnRhYmluZGV4ID0gdGFiSW5kZXg7XG4gICAgfVxuICAgIGdldCB0YWJJbmRleCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudGFiaW5kZXg7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNldHMgdGhlIHNpemUgb2YgdGhlIGNvbXBvbmVudC5cbiAgICAgKlxuICAgICAqIFRoZSBwb3NzaWJsZSB2YWx1ZXMgYXJlOlxuICAgICAqICogYCdzbWFsbCdgXG4gICAgICogKiBgJ21lZGl1bSdgIChkZWZhdWx0KVxuICAgICAqICogYCdsYXJnZSdgXG4gICAgICogKiBgbnVsbGBcbiAgICAgKlxuICAgICAqL1xuICAgIHNldCBzaXplKHNpemUpIHtcbiAgICAgICAgdGhpcy5yZW5kZXJlci5yZW1vdmVDbGFzcyh0aGlzLndyYXBwZXIubmF0aXZlRWxlbWVudCwgZ2V0U2l6ZUNsYXNzKCdwaWNrZXInLCB0aGlzLnNpemUpKTtcbiAgICAgICAgaWYgKHNpemUpIHtcbiAgICAgICAgICAgIHRoaXMucmVuZGVyZXIuYWRkQ2xhc3ModGhpcy53cmFwcGVyLm5hdGl2ZUVsZW1lbnQsIGdldFNpemVDbGFzcygncGlja2VyJywgc2l6ZSkpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3NpemUgPSBzaXplO1xuICAgIH1cbiAgICBnZXQgc2l6ZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3NpemU7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNldHMgdGhlIGJvcmRlciByYWRpdXMgb2YgdGhlIGNvbXBvbmVudC5cbiAgICAgKlxuICAgICAqIFRoZSBwb3NzaWJsZSB2YWx1ZXMgYXJlOlxuICAgICAqICogYCdzbWFsbCdgXG4gICAgICogKiBgJ21lZGl1bSdgIChkZWZhdWx0KVxuICAgICAqICogYCdsYXJnZSdgXG4gICAgICogKiBgJ2Z1bGwnYFxuICAgICAqICogYG51bGxgXG4gICAgICpcbiAgICAgKi9cbiAgICBzZXQgcm91bmRlZChyb3VuZGVkKSB7XG4gICAgICAgIHRoaXMucmVuZGVyZXIucmVtb3ZlQ2xhc3ModGhpcy53cmFwcGVyLm5hdGl2ZUVsZW1lbnQsIGdldFJvdW5kZWRDbGFzcyh0aGlzLnJvdW5kZWQpKTtcbiAgICAgICAgaWYgKHJvdW5kZWQpIHtcbiAgICAgICAgICAgIHRoaXMucmVuZGVyZXIuYWRkQ2xhc3ModGhpcy53cmFwcGVyLm5hdGl2ZUVsZW1lbnQsIGdldFJvdW5kZWRDbGFzcyhyb3VuZGVkKSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fcm91bmRlZCA9IHJvdW5kZWQ7XG4gICAgfVxuICAgIGdldCByb3VuZGVkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fcm91bmRlZDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2V0cyB0aGUgZmlsbE1vZGUgb2YgdGhlIGNvbXBvbmVudC5cbiAgICAgKlxuICAgICAqIFRoZSBwb3NzaWJsZSB2YWx1ZXMgYXJlOlxuICAgICAqICogYCdmbGF0J2BcbiAgICAgKiAqIGAnc29saWQnYCAoZGVmYXVsdClcbiAgICAgKiAqIGAnb3V0bGluZSdgXG4gICAgICogKiBgbnVsbGBcbiAgICAgKlxuICAgICAqL1xuICAgIHNldCBmaWxsTW9kZShmaWxsTW9kZSkge1xuICAgICAgICB0aGlzLnJlbmRlcmVyLnJlbW92ZUNsYXNzKHRoaXMud3JhcHBlci5uYXRpdmVFbGVtZW50LCBnZXRGaWxsTW9kZUNsYXNzKCdwaWNrZXInLCB0aGlzLmZpbGxNb2RlKSk7XG4gICAgICAgIGlmIChmaWxsTW9kZSkge1xuICAgICAgICAgICAgdGhpcy5yZW5kZXJlci5hZGRDbGFzcyh0aGlzLndyYXBwZXIubmF0aXZlRWxlbWVudCwgZ2V0RmlsbE1vZGVDbGFzcygncGlja2VyJywgZmlsbE1vZGUpKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9maWxsTW9kZSA9IGZpbGxNb2RlO1xuICAgIH1cbiAgICBnZXQgZmlsbE1vZGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9maWxsTW9kZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIGJsdXJDb21wb25lbnQoZXZlbnQpIHtcbiAgICAgICAgaWYgKGV2ZW50LnRhcmdldCAhPT0gdGhpcy53cmFwcGVyLm5hdGl2ZUVsZW1lbnQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBldmVudC5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKTtcbiAgICAgICAgdGhpcy5ob3N0RWxlbWVudEJsdXJyZWQuZW1pdCgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgYmx1ckZpbHRlcklucHV0KCkge1xuICAgICAgICB0aGlzLmZpbHRlckJsdXJyZWQuZW1pdCgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgZm9jdXNDb21wb25lbnQoZXZlbnQpIHtcbiAgICAgICAgaWYgKGV2ZW50LnRhcmdldCAhPT0gdGhpcy53cmFwcGVyLm5hdGl2ZUVsZW1lbnQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBldmVudC5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKTtcbiAgICAgICAgdGhpcy5ob3N0RWxlbWVudEZvY3VzZWQuZW1pdCgpO1xuICAgICAgICBpZiAoIXRoaXMuaXNGb2N1c2VkKSB7XG4gICAgICAgICAgICB0aGlzLmlzRm9jdXNlZCA9IHRydWU7XG4gICAgICAgICAgICBpZiAoaGFzT2JzZXJ2ZXJzKHRoaXMub25Gb2N1cykpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl96b25lLnJ1bigoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMub25Gb2N1cy5lbWl0KCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIG9uUmVzaXplKCkge1xuICAgICAgICBpZiAodGhpcy5fb3Blbikge1xuICAgICAgICAgICAgY29uc3QgcG9wdXBXcmFwcGVyID0gdGhpcy5wb3B1cFJlZi5wb3B1cEVsZW1lbnQ7XG4gICAgICAgICAgICBjb25zdCB7IG1pbiwgbWF4IH0gPSB0aGlzLndpZHRoO1xuICAgICAgICAgICAgcG9wdXBXcmFwcGVyLnN0eWxlLm1pbldpZHRoID0gbWluO1xuICAgICAgICAgICAgcG9wdXBXcmFwcGVyLnN0eWxlLndpZHRoID0gbWF4O1xuICAgICAgICB9XG4gICAgfVxuICAgIGdldCBpc0Rpc2FibGVkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kaXNhYmxlZDtcbiAgICB9XG4gICAgZ2V0IGlzTG9hZGluZygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubG9hZGluZztcbiAgICB9XG4gICAgZ2V0IGRpcigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGlyZWN0aW9uO1xuICAgIH1cbiAgICBnZXQgaG9zdFRhYkluZGV4KCkge1xuICAgICAgICByZXR1cm4gdGhpcy53aWRnZXRUYWJJbmRleDtcbiAgICB9XG4gICAgZ2V0IGlzUmVhZG9ubHkoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnJlYWRvbmx5O1xuICAgIH1cbiAgICBnZXQgaXNBcmlhRXhwYW5kZWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmFyaWFFeHBhbmRlZDtcbiAgICB9XG4gICAgZ2V0IGhvc3RBcmlhT3ducygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYXJpYU93bnM7XG4gICAgfVxuICAgIGdldCBob3N0QXJpYUFjdGl2ZWRlc2NlbmRhbnQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmFyaWFBY3RpdmVkZXNjZW5kYW50O1xuICAgIH1cbiAgICBnZXQgaG9zdE5vRGF0YUxhYmVsKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5ub0RhdGFMYWJlbDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIGtleWRvd24oZXZlbnQpIHtcbiAgICAgICAgY29uc3QgZmlyc3RJbmRleCA9IGlzUHJlc2VudCh0aGlzLmRlZmF1bHRJdGVtKSA/IC0xIDogMDtcbiAgICAgICAgbGV0IGZvY3VzZWQgPSBpc05hTih0aGlzLnNlbGVjdGlvblNlcnZpY2UuZm9jdXNlZCkgPyB0aGlzLmZpcnN0Rm9jdXNhYmxlSW5kZXgoZmlyc3RJbmRleCkgOiB0aGlzLnNlbGVjdGlvblNlcnZpY2UuZm9jdXNlZDtcbiAgICAgICAgbGV0IG9mZnNldCA9IDA7XG4gICAgICAgIGlmICh0aGlzLmRpc2FibGVkIHx8IHRoaXMucmVhZG9ubHkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBpc0hvbWVFbmQgPSBldmVudC5rZXlDb2RlID09PSBLZXlzLkhvbWUgfHwgZXZlbnQua2V5Q29kZSA9PT0gS2V5cy5FbmQ7XG4gICAgICAgIGNvbnN0IGlzRmlsdGVyRm9jdXNlZCA9IHRoaXMuZmlsdGVyYWJsZSAmJiB0aGlzLmlzRm9jdXNlZCAmJiB0aGlzLmlzT3BlbjtcbiAgICAgICAgaWYgKGlzRmlsdGVyRm9jdXNlZCAmJiBpc0hvbWVFbmQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBoYXNTZWxlY3RlZCA9IGlzUHJlc2VudCh0aGlzLnNlbGVjdGlvblNlcnZpY2Uuc2VsZWN0ZWRbMF0pO1xuICAgICAgICBjb25zdCBmb2N1c2VkSXRlbU5vdFNlbGVjdGVkID0gaXNQcmVzZW50KHRoaXMuc2VsZWN0aW9uU2VydmljZS5mb2N1c2VkKSAmJiAhdGhpcy5zZWxlY3Rpb25TZXJ2aWNlLmlzU2VsZWN0ZWQodGhpcy5zZWxlY3Rpb25TZXJ2aWNlLmZvY3VzZWQpO1xuICAgICAgICBpZiAoIWhhc1NlbGVjdGVkIHx8IGZvY3VzZWRJdGVtTm90U2VsZWN0ZWQpIHtcbiAgICAgICAgICAgIGlmIChldmVudC5rZXlDb2RlID09PSBLZXlzLkFycm93RG93biB8fCBldmVudC5rZXlDb2RlID09PSBLZXlzLkFycm93UmlnaHQpIHtcbiAgICAgICAgICAgICAgICBvZmZzZXQgPSAtMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGV2ZW50LmtleUNvZGUgPT09IEtleXMuQXJyb3dVcCB8fCBldmVudC5rZXlDb2RlID09PSBLZXlzLkFycm93TGVmdCkge1xuICAgICAgICAgICAgICAgIG9mZnNldCA9IDE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgZXZlbnREYXRhID0gZXZlbnQ7XG4gICAgICAgIGNvbnN0IGFjdGlvbiA9IHRoaXMubmF2aWdhdGlvblNlcnZpY2UucHJvY2Vzcyh7XG4gICAgICAgICAgICBjdXJyZW50OiBmb2N1c2VkICsgb2Zmc2V0LFxuICAgICAgICAgICAgbWF4OiB0aGlzLmRhdGFTZXJ2aWNlLml0ZW1zQ291bnQgLSAxLFxuICAgICAgICAgICAgbWluOiB0aGlzLmRlZmF1bHRJdGVtID8gLTEgOiAwLFxuICAgICAgICAgICAgb3JpZ2luYWxFdmVudDogZXZlbnREYXRhXG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCBsZWZ0UmlnaHRLZXlzID0gKGFjdGlvbiA9PT0gTmF2aWdhdGlvbkFjdGlvbi5MZWZ0KSB8fCAoYWN0aW9uID09PSBOYXZpZ2F0aW9uQWN0aW9uLlJpZ2h0KTtcbiAgICAgICAgaWYgKGFjdGlvbiAhPT0gTmF2aWdhdGlvbkFjdGlvbi5VbmRlZmluZWQgJiZcbiAgICAgICAgICAgIGFjdGlvbiAhPT0gTmF2aWdhdGlvbkFjdGlvbi5UYWIgJiZcbiAgICAgICAgICAgIGFjdGlvbiAhPT0gTmF2aWdhdGlvbkFjdGlvbi5CYWNrc3BhY2UgJiZcbiAgICAgICAgICAgIGFjdGlvbiAhPT0gTmF2aWdhdGlvbkFjdGlvbi5EZWxldGUgJiZcbiAgICAgICAgICAgICEobGVmdFJpZ2h0S2V5cyAmJiB0aGlzLmZpbHRlcmFibGUpICYmXG4gICAgICAgICAgICBhY3Rpb24gIT09IE5hdmlnYXRpb25BY3Rpb24uRW50ZXIgLy9lbnRlciB3aGVuIHBvcHVwIGlzIG9wZW5lZCBpcyBoYW5kbGVkIGJlZm9yZSBgaGFuZGxlRW50ZXJgXG4gICAgICAgICkge1xuICAgICAgICAgICAgZXZlbnREYXRhLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIGtleXByZXNzKGV2ZW50KSB7XG4gICAgICAgIGlmICh0aGlzLmRpc2FibGVkIHx8IHRoaXMucmVhZG9ubHkgfHwgdGhpcy5maWx0ZXJhYmxlKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5vbktleVByZXNzKGV2ZW50KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIGNsaWNrKGV2ZW50KSB7XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIHRoaXMuZm9jdXMoKTtcbiAgICAgICAgdGhpcy50b2dnbGVQb3B1cCghdGhpcy5pc09wZW4pO1xuICAgIH1cbiAgICBzZXQgaXNGb2N1c2VkKGlzRm9jdXNlZCkge1xuICAgICAgICB0aGlzLnJlbmRlcmVyW2lzRm9jdXNlZCA/ICdhZGRDbGFzcycgOiAncmVtb3ZlQ2xhc3MnXSh0aGlzLndyYXBwZXIubmF0aXZlRWxlbWVudCwgJ2stZm9jdXMnKTtcbiAgICAgICAgdGhpcy5faXNGb2N1c2VkID0gaXNGb2N1c2VkO1xuICAgIH1cbiAgICBnZXQgaXNGb2N1c2VkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5faXNGb2N1c2VkO1xuICAgIH1cbiAgICBuZ09uSW5pdCgpIHtcbiAgICAgICAgdGhpcy5yZW5kZXJlci5yZW1vdmVBdHRyaWJ1dGUodGhpcy53cmFwcGVyLm5hdGl2ZUVsZW1lbnQsIFwidGFiaW5kZXhcIik7XG4gICAgICAgIHRoaXMubG9jYWxpemF0aW9uQ2hhbmdlc1N1YnNjcmlwdGlvbiA9IHRoaXMubG9jYWxpemF0aW9uXG4gICAgICAgICAgICAuY2hhbmdlcy5zdWJzY3JpYmUoKHsgcnRsIH0pID0+IHtcbiAgICAgICAgICAgIHRoaXMuZGlyZWN0aW9uID0gcnRsID8gJ3J0bCcgOiAnbHRyJztcbiAgICAgICAgICAgIHRoaXMuY2RyLmRldGVjdENoYW5nZXMoKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuYXNzaWduQXJpYURlc2NyaWJlZEJ5KCk7XG4gICAgICAgIHRoaXMuc2V0Q29tcG9uZW50Q2xhc3NlcygpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICogVXNlZCBieSB0aGUgVGV4dEJveENvbnRhaW5lciB0byBkZXRlcm1pbmUgaWYgdGhlIGNvbXBvbmVudCBpcyBlbXB0eS5cbiAgICAgKi9cbiAgICBpc0VtcHR5KCkge1xuICAgICAgICBjb25zdCB2YWx1ZSA9IHRoaXMudmFsdWU7XG4gICAgICAgIHJldHVybiAhKHZhbHVlID09PSAwIHx8IHZhbHVlID09PSBmYWxzZSB8fCB2YWx1ZSB8fCB0aGlzLmRlZmF1bHRJdGVtKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIG9uRmlsdGVyRm9jdXMoKSB7XG4gICAgICAgIHRoaXMuZmlsdGVyRm9jdXNlZC5lbWl0KCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBuZ09uRGVzdHJveSgpIHtcbiAgICAgICAgdGhpcy5kZXN0cm95UG9wdXAoKTtcbiAgICAgICAgdGhpcy51bnN1YnNjcmliZUV2ZW50cygpO1xuICAgICAgICBpZiAodGhpcy5sb2NhbGl6YXRpb25DaGFuZ2VzU3Vic2NyaXB0aW9uKSB7XG4gICAgICAgICAgICB0aGlzLmxvY2FsaXphdGlvbkNoYW5nZXNTdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgbmdPbkNoYW5nZXMoY2hhbmdlcykge1xuICAgICAgICBjb25zdCB2aXJ0dWFsID0gdGhpcy52aXJ0dWFsO1xuICAgICAgICBjb25zdCByZXF1ZXN0SW5pdGlhbERhdGEgPSB2aXJ0dWFsICYmIGNoYW5nZXMuZGF0YSAmJiBjaGFuZ2VzLmRhdGEuaXNGaXJzdENoYW5nZSgpO1xuICAgICAgICBpZiAocmVxdWVzdEluaXRpYWxEYXRhKSB7XG4gICAgICAgICAgICB0aGlzLnBhZ2VDaGFuZ2UoeyBza2lwOiAwLCB0YWtlOiB2aXJ0dWFsLnBhZ2VTaXplIH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpc0NoYW5nZWQoJ2RlZmF1bHRJdGVtJywgY2hhbmdlcywgZmFsc2UpKSB7XG4gICAgICAgICAgICB0aGlzLmRpc2FibGVkSXRlbXNTZXJ2aWNlLmRlZmF1bHRJdGVtID0gdGhpcy5kZWZhdWx0SXRlbTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoYW55Q2hhbmdlZChbJ3RleHRGaWVsZCcsICd2YWx1ZUZpZWxkJywgJ3ZhbHVlUHJpbWl0aXZlJywgJ2RlZmF1bHRJdGVtJywgJ2l0ZW1EaXNhYmxlZCddLCBjaGFuZ2VzLCBmYWxzZSkpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgbmdBZnRlckNvbnRlbnRDaGVja2VkKCkge1xuICAgICAgICB0aGlzLnZlcmlmeVNldHRpbmdzKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEZvY3VzZXMgYSBzcGVjaWZpYyBpdGVtIG9mIHRoZSBEcm9wRG93bkxpc3QgYmFzZWQgb24gYSBwcm92aWRlZCBpbmRleC5cbiAgICAgKiBJZiB0aGVyZSBpcyBhIGRlZmF1bHQgaXRlbSBpdCBpcyBwb3NpdGlvbmVkIGF0IGluZGV4IC0xLlxuICAgICAqIElmIG51bGwgb3IgaW52YWxpZCBpbmRleCBpcyBwcm92aWRlZCB0aGUgZm9jdXMgd2lsbCBiZSByZW1vdmVkLlxuICAgICAqL1xuICAgIGZvY3VzSXRlbUF0KGluZGV4KSB7XG4gICAgICAgIGNvbnN0IG1pbkluZGV4ID0gaXNQcmVzZW50KHRoaXMuZGVmYXVsdEl0ZW0pID8gLTEgOiAwO1xuICAgICAgICBjb25zdCBpc0luUmFuZ2UgPSBtaW5JbmRleCA8PSBpbmRleCAmJiBpbmRleCA8IHRoaXMuZGF0YS5sZW5ndGg7XG4gICAgICAgIGlmIChpc1ByZXNlbnQoaW5kZXgpICYmIGlzSW5SYW5nZSAmJiAhdGhpcy5kaXNhYmxlZEl0ZW1zU2VydmljZS5pc0luZGV4RGlzYWJsZWQoaW5kZXgpKSB7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdGlvblNlcnZpY2UuZm9jdXMoaW5kZXgpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5zZWxlY3Rpb25TZXJ2aWNlLmZvY3VzKG51bGwpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEZvY3VzZXMgdGhlIERyb3BEb3duTGlzdC5cbiAgICAgKi9cbiAgICBmb2N1cygpIHtcbiAgICAgICAgaWYgKCF0aGlzLmRpc2FibGVkKSB7XG4gICAgICAgICAgICB0aGlzLndyYXBwZXIubmF0aXZlRWxlbWVudC5mb2N1cygpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEJsdXJzIHRoZSBEcm9wRG93bkxpc3QuXG4gICAgICovXG4gICAgYmx1cigpIHtcbiAgICAgICAgaWYgKCF0aGlzLmRpc2FibGVkKSB7XG4gICAgICAgICAgICB0aGlzLndyYXBwZXIubmF0aXZlRWxlbWVudC5ibHVyKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogVG9nZ2xlcyB0aGUgdmlzaWJpbGl0eSBvZiB0aGUgcG9wdXBcbiAgICAgKiAoW3NlZSBleGFtcGxlXSh7JSBzbHVnIG9wZW5zdGF0ZV9kZGwgJX0jdG9jLXNldHRpbmctdGhlLWluaXRpYWxseS1vcGVuZWQtY29tcG9uZW50KSkuXG4gICAgICogSWYgeW91IHVzZSB0aGUgYHRvZ2dsZWAgbWV0aG9kIHRvIG9wZW4gb3IgY2xvc2UgdGhlIHBvcHVwLCB0aGUgYG9wZW5gIGFuZCBgY2xvc2VgIGV2ZW50cyB3aWxsIG5vdCBiZSBmaXJlZC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBvcGVuIC0gVGhlIHN0YXRlIG9mIHRoZSBwb3B1cC5cbiAgICAgKi9cbiAgICB0b2dnbGUob3Blbikge1xuICAgICAgICAvLyBUaGUgUHJvbWlzZSBpcyByZXF1aXJlZCB0byBvcGVuIHRoZSBwb3B1cCBvbiBsb2FkLlxuICAgICAgICAvLyBPdGhlcndpc2UsIHRoZSBcIkV4cHJlc3Npb24gaGFzIGNoYW5nZWQuLi5cIiB0eXBlIGVycm9yIHdpbGwgYmUgdGhyb3duLlxuICAgICAgICBQcm9taXNlLnJlc29sdmUobnVsbCkudGhlbigoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBzaG91bGRPcGVuID0gaXNQcmVzZW50KG9wZW4pID8gb3BlbiA6ICF0aGlzLl9vcGVuO1xuICAgICAgICAgICAgdGhpcy5fdG9nZ2xlKHNob3VsZE9wZW4pO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgX3RvZ2dsZShvcGVuKSB7XG4gICAgICAgIHRoaXMuX29wZW4gPSBvcGVuO1xuICAgICAgICB0aGlzLmRlc3Ryb3lQb3B1cCgpO1xuICAgICAgICBpZiAodGhpcy5fb3Blbikge1xuICAgICAgICAgICAgdGhpcy5jcmVhdGVQb3B1cCgpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHRyaWdnZXJQb3B1cEV2ZW50cyhvcGVuKSB7XG4gICAgICAgIGNvbnN0IGV2ZW50QXJncyA9IG5ldyBQcmV2ZW50YWJsZUV2ZW50KCk7XG4gICAgICAgIGlmIChvcGVuKSB7XG4gICAgICAgICAgICB0aGlzLm9wZW4uZW1pdChldmVudEFyZ3MpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5jbG9zZS5lbWl0KGV2ZW50QXJncyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGV2ZW50QXJncy5pc0RlZmF1bHRQcmV2ZW50ZWQoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIHRvZ2dsZVBvcHVwKG9wZW4pIHtcbiAgICAgICAgY29uc3QgaXNEaXNhYmxlZCA9IHRoaXMuZGlzYWJsZWQgfHwgdGhpcy5yZWFkb25seTtcbiAgICAgICAgY29uc3Qgc2FtZVN0YXRlID0gdGhpcy5pc09wZW4gPT09IG9wZW47XG4gICAgICAgIGlmIChpc0Rpc2FibGVkIHx8IHNhbWVTdGF0ZSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGlzRGVmYXVsdFByZXZlbnRlZCA9IHRoaXMudHJpZ2dlclBvcHVwRXZlbnRzKG9wZW4pO1xuICAgICAgICBpZiAoIWlzRGVmYXVsdFByZXZlbnRlZCkge1xuICAgICAgICAgICAgaWYgKCFvcGVuICYmIHRoaXMuZmlsdGVyYWJsZSAmJiB0aGlzLmlzRm9jdXNlZCkge1xuICAgICAgICAgICAgICAgIHRoaXMuZm9jdXMoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuX3RvZ2dsZShvcGVuKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRoZSBjdXJyZW50IG9wZW4gc3RhdGUgb2YgdGhlIHBvcHVwLlxuICAgICAqL1xuICAgIGdldCBpc09wZW4oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9vcGVuO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXNldHMgdGhlIHZhbHVlIG9mIHRoZSBEcm9wRG93bkxpc3QuXG4gICAgICogSWYgeW91IHVzZSB0aGUgYHJlc2V0YCBtZXRob2QgdG8gY2xlYXIgdGhlIHZhbHVlIG9mIHRoZSBjb21wb25lbnQsXG4gICAgICogdGhlIG1vZGVsIHdpbGwgbm90IHVwZGF0ZSBhdXRvbWF0aWNhbGx5IGFuZCB0aGUgYHNlbGVjdGlvbkNoYW5nZWAgYW5kIGB2YWx1ZUNoYW5nZWAgZXZlbnRzIHdpbGwgbm90IGJlIGZpcmVkLlxuICAgICAqL1xuICAgIHJlc2V0KCkge1xuICAgICAgICB0aGlzLnZhbHVlID0gdW5kZWZpbmVkO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgbWVzc2FnZUZvcihrZXkpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubG9jYWxpemF0aW9uLmdldChrZXkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgd3JpdGVWYWx1ZSh2YWx1ZSkge1xuICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWUgPT09IG51bGwgPyB1bmRlZmluZWQgOiB2YWx1ZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIHJlZ2lzdGVyT25DaGFuZ2UoZm4pIHtcbiAgICAgICAgdGhpcy5vbkNoYW5nZUNhbGxiYWNrID0gZm47XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICByZWdpc3Rlck9uVG91Y2hlZChmbikge1xuICAgICAgICB0aGlzLm9uVG91Y2hlZENhbGxiYWNrID0gZm47XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBzZXREaXNhYmxlZFN0YXRlKGlzRGlzYWJsZWQpIHtcbiAgICAgICAgdGhpcy5kaXNhYmxlZCA9IGlzRGlzYWJsZWQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBnZXQgYnV0dG9uQ2xhc3NlcygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubG9hZGluZyA/ICdrLWktbG9hZGluZycgOiB0aGlzLmljb25DbGFzcyB8fCAnay1pLWFycm93LXMnO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgZ2V0IHNlbGVjdEJ1dHRvbkNsYXNzZXMoKSB7XG4gICAgICAgIHJldHVybiBgJHt0aGlzLnNpemUgPyBnZXRTaXplQ2xhc3MoJ2J1dHRvbicsIHRoaXMuc2l6ZSkgOiAnJ30gJHt0aGlzLmZpbGxNb2RlID8gJ2stYnV0dG9uLScgKyB0aGlzLmZpbGxNb2RlIDogJyd9ICR7dGhpcy5maWxsTW9kZSA/ICdrLWJ1dHRvbi0nICsgdGhpcy5maWxsTW9kZSArICctYmFzZScgOiAnJ31gO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgZ2V0IGZpbHRlcklucHV0Q2xhc3NlcygpIHtcbiAgICAgICAgcmV0dXJuIGAke3RoaXMuc2l6ZSA/IGdldFNpemVDbGFzcygnaW5wdXQnLCB0aGlzLnNpemUpIDogJyd9ICR7dGhpcy5maWxsTW9kZSA/ICdrLWlucHV0LScgKyB0aGlzLmZpbGxNb2RlIDogJyd9ICR7dGhpcy5yb3VuZGVkID8gZ2V0Um91bmRlZENsYXNzKHRoaXMucm91bmRlZCkgOiAnJ31gO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgZ2V0IG9wdGlvbkxhYmVsU2l6ZUNsYXNzKCkge1xuICAgICAgICByZXR1cm4gYCR7dGhpcy5zaXplID8gZ2V0U2l6ZUNsYXNzKCdsaXN0JywgdGhpcy5zaXplKSA6ICcnfWA7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBnZXQgbGlzdENvbnRhaW5lckNsYXNzZXMoKSB7XG4gICAgICAgIGNvbnN0IGNvbnRhaW5lckNsYXNzZXMgPSBbJ2stbGlzdC1jb250YWluZXInLCAnay1yZXNldCddO1xuICAgICAgICBpZiAodGhpcy5wb3B1cFNldHRpbmdzLnBvcHVwQ2xhc3MpIHtcbiAgICAgICAgICAgIGNvbnRhaW5lckNsYXNzZXMucHVzaCh0aGlzLnBvcHVwU2V0dGluZ3MucG9wdXBDbGFzcyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNvbnRhaW5lckNsYXNzZXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBnZXQgaXNEaXNhYmxlZERlZmF1bHRJdGVtKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kaXNhYmxlZEl0ZW1zU2VydmljZS5pc0l0ZW1EaXNhYmxlZCh0aGlzLmRlZmF1bHRJdGVtKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIGdldFRleHQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnRleHQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBnZXREZWZhdWx0SXRlbVRleHQoKSB7XG4gICAgICAgIHJldHVybiBnZXR0ZXIkMSh0aGlzLmRlZmF1bHRJdGVtLCB0aGlzLnRleHRGaWVsZCk7XG4gICAgfVxuICAgIGNyZWF0ZVBvcHVwKCkge1xuICAgICAgICBpZiAodGhpcy52aXJ0dWFsKSB7XG4gICAgICAgICAgICB0aGlzLnZpcnR1YWwuc2tpcCA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgaG9yaXpvbnRhbEFsaWduID0gdGhpcy5kaXJlY3Rpb24gPT09IFwicnRsXCIgPyBcInJpZ2h0XCIgOiBcImxlZnRcIjtcbiAgICAgICAgY29uc3QgYW5jaG9yUG9zaXRpb24gPSB7IGhvcml6b250YWw6IGhvcml6b250YWxBbGlnbiwgdmVydGljYWw6IFwiYm90dG9tXCIgfTtcbiAgICAgICAgY29uc3QgcG9wdXBQb3NpdGlvbiA9IHsgaG9yaXpvbnRhbDogaG9yaXpvbnRhbEFsaWduLCB2ZXJ0aWNhbDogXCJ0b3BcIiB9O1xuICAgICAgICB0aGlzLnBvcHVwUmVmID0gdGhpcy5wb3B1cFNlcnZpY2Uub3Blbih7XG4gICAgICAgICAgICBhbmNob3I6IHRoaXMud3JhcHBlcixcbiAgICAgICAgICAgIGFuY2hvckFsaWduOiBhbmNob3JQb3NpdGlvbixcbiAgICAgICAgICAgIGFuaW1hdGU6IHRoaXMucG9wdXBTZXR0aW5ncy5hbmltYXRlLFxuICAgICAgICAgICAgYXBwZW5kVG86IHRoaXMuYXBwZW5kVG8sXG4gICAgICAgICAgICBjb250ZW50OiB0aGlzLnBvcHVwVGVtcGxhdGUsXG4gICAgICAgICAgICBwb3B1cEFsaWduOiBwb3B1cFBvc2l0aW9uLFxuICAgICAgICAgICAgcG9wdXBDbGFzczogdGhpcy5saXN0Q29udGFpbmVyQ2xhc3NlcyxcbiAgICAgICAgICAgIHBvc2l0aW9uTW9kZTogJ2Fic29sdXRlJ1xuICAgICAgICB9KTtcbiAgICAgICAgY29uc3QgcG9wdXBXcmFwcGVyID0gdGhpcy5wb3B1cFJlZi5wb3B1cEVsZW1lbnQ7XG4gICAgICAgIGNvbnN0IHsgbWluLCBtYXggfSA9IHRoaXMud2lkdGg7XG4gICAgICAgIHBvcHVwV3JhcHBlci5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCB0aGlzLnBvcHVwTW91c2VEb3duSGFuZGxlcik7XG4gICAgICAgIHBvcHVwV3JhcHBlci5zdHlsZS5taW5XaWR0aCA9IG1pbjtcbiAgICAgICAgcG9wdXBXcmFwcGVyLnN0eWxlLndpZHRoID0gbWF4O1xuICAgICAgICBwb3B1cFdyYXBwZXIuc3R5bGUuaGVpZ2h0ID0gdGhpcy5oZWlnaHQ7XG4gICAgICAgIHBvcHVwV3JhcHBlci5zZXRBdHRyaWJ1dGUoXCJkaXJcIiwgdGhpcy5kaXJlY3Rpb24pO1xuICAgICAgICB0aGlzLnBvcHVwUmVmLnBvcHVwT3Blbi5zdWJzY3JpYmUoKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5jZHIuZGV0ZWN0Q2hhbmdlcygpO1xuICAgICAgICAgICAgdGhpcy5vcHRpb25zTGlzdC5zY3JvbGxUb0l0ZW0odGhpcy5zZWxlY3Rpb25TZXJ2aWNlLmZvY3VzZWQpO1xuICAgICAgICAgICAgdGhpcy5vcGVuZWQuZW1pdCgpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5wb3B1cFJlZi5wb3B1cENsb3NlLnN1YnNjcmliZSgoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmNsb3NlZC5lbWl0KCk7XG4gICAgICAgIH0pO1xuICAgICAgICBpZiAoIXRoaXMuZmlsdGVyYWJsZSkge1xuICAgICAgICAgICAgdGhpcy5wb3B1cFJlZi5wb3B1cEFuY2hvclZpZXdwb3J0TGVhdmUuc3Vic2NyaWJlKCgpID0+IHRoaXMudG9nZ2xlUG9wdXAoZmFsc2UpKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBkZXN0cm95UG9wdXAoKSB7XG4gICAgICAgIGlmICh0aGlzLnBvcHVwUmVmKSB7XG4gICAgICAgICAgICB0aGlzLnBvcHVwUmVmLnBvcHVwRWxlbWVudFxuICAgICAgICAgICAgICAgIC5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCB0aGlzLnBvcHVwTW91c2VEb3duSGFuZGxlcik7XG4gICAgICAgICAgICB0aGlzLnBvcHVwUmVmLmNsb3NlKCk7XG4gICAgICAgICAgICB0aGlzLnBvcHVwUmVmID0gbnVsbDtcbiAgICAgICAgfVxuICAgIH1cbiAgICB1cGRhdGVTdGF0ZSh7IGRhdGFJdGVtLCBjb25maXJtID0gZmFsc2UgfSkge1xuICAgICAgICB0aGlzLmRhdGFJdGVtID0gZGF0YUl0ZW07XG4gICAgICAgIHRoaXMudGV4dCA9IGdldHRlciQxKGRhdGFJdGVtLCB0aGlzLnRleHRGaWVsZCk7XG4gICAgICAgIGlmIChjb25maXJtKSB7XG4gICAgICAgICAgICB0aGlzLl9wcmV2aW91c0RhdGFJdGVtID0gZGF0YUl0ZW07XG4gICAgICAgIH1cbiAgICB9XG4gICAgY2xlYXJTdGF0ZSgpIHtcbiAgICAgICAgdGhpcy50ZXh0ID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLmRhdGFJdGVtID0gdW5kZWZpbmVkO1xuICAgIH1cbiAgICByZXNldFNlbGVjdGlvbihpbmRleCkge1xuICAgICAgICBjb25zdCBjbGVhciA9ICFpc1ByZXNlbnQoaW5kZXgpO1xuICAgICAgICB0aGlzLnNlbGVjdGlvblNlcnZpY2UucmVzZXRTZWxlY3Rpb24oY2xlYXIgPyBbXSA6IFtpbmRleF0pO1xuICAgICAgICB0aGlzLnNlbGVjdGlvblNlcnZpY2UuZm9jdXNlZCA9IGNsZWFyID8gdGhpcy5maXJzdEZvY3VzYWJsZUluZGV4KDApIDogaW5kZXg7XG4gICAgfVxuICAgIG9uU2VsZWN0aW9uQ2hhbmdlKHsgZGF0YUl0ZW0gfSkge1xuICAgICAgICB0aGlzLnVwZGF0ZVN0YXRlKHsgZGF0YUl0ZW0gfSk7XG4gICAgICAgIHRoaXMuc2VsZWN0aW9uQ2hhbmdlLmVtaXQoZGF0YUl0ZW0pO1xuICAgICAgICAvLyByZWFzc2lnbmluZyB0aGUgdmFsdWUgbGFiZWwgSUQgYXMgYXJpYS1kZWFzY2liZWRieSBmb3JjZXMgZmlyZWZveC9udmRhLCBmb3JlZm94L2phd3MgdG8gcmVhZFxuICAgICAgICAvLyB0aGUgbmV3IHZhbHVlIHdoZW4gdGhlIHBvcHVwIGlzIGNsb3NlZCBhbmQgdGhlIHZhbHVlIGlzIGNoYW5nZWQgd2l0aCB0aGUgYXJyb3cga2V5cyAodXAvZG93bilcbiAgICAgICAgdGhpcy5hc3NpZ25BcmlhRGVzY3JpYmVkQnkoKTtcbiAgICB9XG4gICAgc3Vic2NyaWJlRXZlbnRzKCkge1xuICAgICAgICBpZiAoIWlzRG9jdW1lbnRBdmFpbGFibGUoKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIC8vIEl0ZW0gc2VsZWN0aW9uIHdoZW4gdGhlIHBvcHVwIGlzIG9wZW4uXG4gICAgICAgIHRoaXMuc2VsZWN0aW9uU3Vic2NyaXB0aW9uLmFkZCh0aGlzLnNlbGVjdGlvblNlcnZpY2Uub25TZWxlY3QucGlwZShmaWx0ZXIoXyA9PiB0aGlzLmlzT3BlbiksIG1hcCh0aGlzLml0ZW1Gcm9tRXZlbnQuYmluZCh0aGlzKSkpXG4gICAgICAgICAgICAuc3Vic2NyaWJlKHRoaXMub25TZWxlY3Rpb25DaGFuZ2UuYmluZCh0aGlzKSkpO1xuICAgICAgICAvLyBJdGVtIHNlbGVjdGlvbiB3aGVuIHRoZSBwb3B1cCBpcyBjbG9zZWQgfCBjbGlja2VkIHwgZW50ZXIsIGFuZCBzbyBvbi5cbiAgICAgICAgdGhpcy5zZWxlY3Rpb25TdWJzY3JpcHRpb24uYWRkKG1lcmdlKHRoaXMuc2VsZWN0aW9uU2VydmljZS5vblNlbGVjdC5waXBlKGZpbHRlcihfID0+ICF0aGlzLmlzT3BlbikpLCB0aGlzLnNlbGVjdGlvblNlcnZpY2Uub25DaGFuZ2UpLnBpcGUobWFwKHRoaXMuaXRlbUZyb21FdmVudC5iaW5kKHRoaXMpKSwgdGFwKF8gPT4gdGhpcy50b2dnbGVQb3B1cChmYWxzZSkpKVxuICAgICAgICAgICAgLnN1YnNjcmliZSgoeyBkYXRhSXRlbSwgdmFsdWU6IG5ld1ZhbHVlLCBuZXdTZWxlY3Rpb24gfSkgPT4ge1xuICAgICAgICAgICAgaWYgKG5ld1NlbGVjdGlvbikge1xuICAgICAgICAgICAgICAgIHRoaXMub25TZWxlY3Rpb25DaGFuZ2UoeyBkYXRhSXRlbSB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IHNob3VsZFVzZVByZXZpb3VzID0gIWlzUHJlc2VudChkYXRhSXRlbSkgJiYgdGhpcy5fcHJldmlvdXNEYXRhSXRlbTtcbiAgICAgICAgICAgIGNvbnN0IHNob3VsZFVzZU5ld1ZhbHVlID0gbmV3VmFsdWUgIT09IGdldHRlciQxKHRoaXMudmFsdWUsIHRoaXMudmFsdWVGaWVsZCk7XG4gICAgICAgICAgICBpZiAoc2hvdWxkVXNlUHJldmlvdXMpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVN0YXRlKHsgZGF0YUl0ZW06IHRoaXMuX3ByZXZpb3VzRGF0YUl0ZW0gfSk7XG4gICAgICAgICAgICAgICAgdGhpcy5yZXNldFNlbGVjdGlvbigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoc2hvdWxkVXNlTmV3VmFsdWUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnZhbHVlID0gdGhpcy52YWx1ZVByaW1pdGl2ZSA/IG5ld1ZhbHVlIDogZGF0YUl0ZW07XG4gICAgICAgICAgICAgICAgdGhpcy5fcHJldmlvdXNEYXRhSXRlbSA9IGRhdGFJdGVtO1xuICAgICAgICAgICAgICAgIHRoaXMuZW1pdENoYW5nZSh0aGlzLnZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuY2xlYXJGaWx0ZXIoKTtcbiAgICAgICAgfSkpO1xuICAgICAgICB0aGlzLm5hdmlnYXRpb25TdWJzY3JpcHRpb24gPSBtZXJnZSh0aGlzLm5hdmlnYXRpb25TZXJ2aWNlLnVwLCB0aGlzLm5hdmlnYXRpb25TZXJ2aWNlLmRvd24sIHRoaXMubmF2aWdhdGlvblNlcnZpY2UubGVmdC5waXBlKHNraXBXaGlsZSgoKSA9PiB0aGlzLmZpbHRlcmFibGUpKSwgdGhpcy5uYXZpZ2F0aW9uU2VydmljZS5yaWdodC5waXBlKHNraXBXaGlsZSgoKSA9PiB0aGlzLmZpbHRlcmFibGUpKSwgdGhpcy5uYXZpZ2F0aW9uU2VydmljZS5ob21lLCB0aGlzLm5hdmlnYXRpb25TZXJ2aWNlLmVuZClcbiAgICAgICAgICAgIC5waXBlKGZpbHRlcigoZXZlbnQpID0+ICFpc05hTihldmVudC5pbmRleCkpKVxuICAgICAgICAgICAgLnN1YnNjcmliZSgoZXZlbnQpID0+IHRoaXMuc2VsZWN0aW9uU2VydmljZS5zZWxlY3QoZXZlbnQuaW5kZXgpKTtcbiAgICAgICAgdGhpcy5vcGVuU3Vic2NyaXB0aW9uID0gdGhpcy5uYXZpZ2F0aW9uU2VydmljZS5vcGVuLnN1YnNjcmliZSgoKSA9PiB0aGlzLnRvZ2dsZVBvcHVwKHRydWUpKTtcbiAgICAgICAgdGhpcy5jbG9zZVN1YnNjcmlwdGlvbiA9IHRoaXMubmF2aWdhdGlvblNlcnZpY2UuY2xvc2Uuc3Vic2NyaWJlKCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMudG9nZ2xlUG9wdXAoZmFsc2UpO1xuICAgICAgICAgICAgdGhpcy5mb2N1cygpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5lbnRlclN1YnNjcmlwdGlvbiA9IHRoaXMubmF2aWdhdGlvblNlcnZpY2UuZW50ZXJcbiAgICAgICAgICAgIC5waXBlKHRhcCgoZXZlbnQpID0+IGV2ZW50Lm9yaWdpbmFsRXZlbnQucHJldmVudERlZmF1bHQoKSkpXG4gICAgICAgICAgICAuc3Vic2NyaWJlKHRoaXMuaGFuZGxlRW50ZXIuYmluZCh0aGlzKSk7XG4gICAgICAgIHRoaXMuZXNjU3Vic2NyaXB0aW9uID0gdGhpcy5uYXZpZ2F0aW9uU2VydmljZS5lc2NcbiAgICAgICAgICAgIC5zdWJzY3JpYmUodGhpcy5oYW5kbGVFc2NhcGUuYmluZCh0aGlzKSk7XG4gICAgICAgIHRoaXMuZmlsdGVyQmx1cnJlZFN1YnNjcmlwdGlvbiA9IHRoaXMuZmlsdGVyQmx1cnJlZC5waXBlKGNvbmNhdE1hcCgoKSA9PiBpbnRlcnZhbCgxMCkucGlwZSh0YWtlKDEpLCB0YWtlVW50aWwodGhpcy5ob3N0RWxlbWVudEZvY3VzZWQpKSkpXG4gICAgICAgICAgICAuc3Vic2NyaWJlKCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuaG9zdEVsZW1lbnRCbHVycmVkLmVtaXQoKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuX3pvbmUucnVuT3V0c2lkZUFuZ3VsYXIoKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5jb21wb25lbnRCbHVycmVkU3Vic2NyaXB0aW9uID1cbiAgICAgICAgICAgICAgICBtZXJnZSh0aGlzLmhvc3RFbGVtZW50Qmx1cnJlZC5waXBlKGNvbmNhdE1hcCgoKSA9PiBpbnRlcnZhbCgxMCkucGlwZSh0YWtlKDEpLCB0YWtlVW50aWwodGhpcy5maWx0ZXJGb2N1c2VkKSkpKSwgdGhpcy5uYXZpZ2F0aW9uU2VydmljZS50YWIpLnBpcGUodGFwKGV2ZW50ID0+IGV2ZW50IGluc3RhbmNlb2YgTmF2aWdhdGlvbkV2ZW50ICYmIHRoaXMuZm9jdXMoKSksIGZpbHRlcigoKSA9PiB0aGlzLmlzRm9jdXNlZCkpXG4gICAgICAgICAgICAgICAgICAgIC5zdWJzY3JpYmUoKCkgPT4gdGhpcy5jb21wb25lbnRCbHVyKCkpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgc3Vic2NyaWJlVG91Y2hFdmVudHMoKSB7XG4gICAgICAgIGlmICghaXNEb2N1bWVudEF2YWlsYWJsZSgpIHx8ICF0aGlzLnRvdWNoRW5hYmxlZCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3pvbmUucnVuT3V0c2lkZUFuZ3VsYXIoKCkgPT4gXG4gICAgICAgIC8vIFJvbGwgdXAgRHJvcERvd25MaXN0IG9uIGlPUyB3aGVuIHRhcHBlZCBvdXRzaWRlXG4gICAgICAgIHRoaXMudG91Y2hzdGFydERpc3Bvc2VIYW5kbGVyID0gdGhpcy5yZW5kZXJlci5saXN0ZW4oZG9jdW1lbnQsICd0b3VjaHN0YXJ0JywgKGUpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHRhcmdldCA9IGUudGFyZ2V0O1xuICAgICAgICAgICAgaWYgKHRoaXMuaXNGb2N1c2VkICYmICFpbkRyb3BEb3duKHRoaXMud3JhcHBlciwgdGFyZ2V0LCB0aGlzLnBvcHVwUmVmKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX3pvbmUucnVuKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuZmlsdGVyRm9jdXNlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ2xvc2UgcG9wdXAgaWYgZmlsdGVyIGlzIGZvY3VzZWRcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudG9nZ2xlUG9wdXAoZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYmx1cigpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHN1YnNjcmliZUZvY3VzRXZlbnRzKCkge1xuICAgICAgICBpZiAoaXNEb2N1bWVudEF2YWlsYWJsZSgpKSB7XG4gICAgICAgICAgICB0aGlzLmZvY3VzQ29tcG9uZW50ID0gdGhpcy5mb2N1c0NvbXBvbmVudC5iaW5kKHRoaXMpO1xuICAgICAgICAgICAgdGhpcy5ibHVyQ29tcG9uZW50ID0gdGhpcy5ibHVyQ29tcG9uZW50LmJpbmQodGhpcyk7XG4gICAgICAgICAgICB0aGlzLl96b25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCB1c2VDYXB0dXJlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdmb2N1cycsIHRoaXMuZm9jdXNDb21wb25lbnQsIHVzZUNhcHR1cmUpO1xuICAgICAgICAgICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2JsdXInLCB0aGlzLmJsdXJDb21wb25lbnQsIHVzZUNhcHR1cmUpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdW5TdWJzY3JpYmVGb2N1c0V2ZW50cygpIHtcbiAgICAgICAgaWYgKGlzRG9jdW1lbnRBdmFpbGFibGUoKSkge1xuICAgICAgICAgICAgY29uc3QgdXNlQ2FwdHVyZSA9IHRydWU7XG4gICAgICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdmb2N1cycsIHRoaXMuZm9jdXNDb21wb25lbnQsIHVzZUNhcHR1cmUpO1xuICAgICAgICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignYmx1cicsIHRoaXMuYmx1ckNvbXBvbmVudCwgdXNlQ2FwdHVyZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdW5zdWJzY3JpYmVFdmVudHMoKSB7XG4gICAgICAgIGlmICghaXNEb2N1bWVudEF2YWlsYWJsZSgpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5uYXZpZ2F0aW9uU3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7XG4gICAgICAgIHRoaXMub3BlblN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpO1xuICAgICAgICB0aGlzLmNsb3NlU3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7XG4gICAgICAgIHRoaXMuZW50ZXJTdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcbiAgICAgICAgdGhpcy5lc2NTdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcbiAgICAgICAgdGhpcy5jb21wb25lbnRCbHVycmVkU3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7XG4gICAgICAgIHRoaXMuZmlsdGVyQmx1cnJlZFN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpO1xuICAgICAgICB0aGlzLnVuU3Vic2NyaWJlRm9jdXNFdmVudHMoKTtcbiAgICAgICAgaWYgKHRoaXMudG91Y2hzdGFydERpc3Bvc2VIYW5kbGVyKSB7XG4gICAgICAgICAgICB0aGlzLnRvdWNoc3RhcnREaXNwb3NlSGFuZGxlcigpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnNlbGVjdGlvblN1YnNjcmlwdGlvbikge1xuICAgICAgICAgICAgdGhpcy5zZWxlY3Rpb25TdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpdGVtRnJvbUV2ZW50KGV2ZW50KSB7XG4gICAgICAgIGNvbnN0IGluZGV4ID0gZXZlbnQuaW5kaWNlc1swXTtcbiAgICAgICAgbGV0IGRhdGFJdGVtID0gdGhpcy5kYXRhU2VydmljZS5pdGVtQXQoaW5kZXgpO1xuICAgICAgICBkYXRhSXRlbSA9IGlzUHJlc2VudChkYXRhSXRlbSkgPyBkYXRhSXRlbSA6IHRoaXMuY3VycmVudE9yRGVmYXVsdChpbmRleCk7XG4gICAgICAgIGNvbnN0IHZhbHVlID0gZ2V0dGVyJDEoZGF0YUl0ZW0sIHRoaXMudmFsdWVGaWVsZCk7XG4gICAgICAgIGNvbnN0IG5ld1NlbGVjdGlvbiA9IGV2ZW50Lm5ld1NlbGVjdGlvbjtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGRhdGFJdGVtLFxuICAgICAgICAgICAgaW5kZXgsXG4gICAgICAgICAgICBuZXdTZWxlY3Rpb24sXG4gICAgICAgICAgICB2YWx1ZVxuICAgICAgICB9O1xuICAgIH1cbiAgICBjdXJyZW50T3JEZWZhdWx0KHNlbGVjdGVkSW5kZXgpIHtcbiAgICAgICAgY29uc3QgZGVmYXVsdEl0ZW1JbmRleCA9IC0xO1xuICAgICAgICBpZiAoaXNQcmVzZW50KHRoaXMuZGF0YUl0ZW0pICYmIHNlbGVjdGVkSW5kZXggIT09IGRlZmF1bHRJdGVtSW5kZXgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmRhdGFJdGVtO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZGVmYXVsdEl0ZW07XG4gICAgICAgIH1cbiAgICB9XG4gICAgZmlyc3RGb2N1c2FibGVJbmRleChpbmRleCkge1xuICAgICAgICBjb25zdCBtYXhJbmRleCA9IHRoaXMuZGF0YVNlcnZpY2UuaXRlbXNDb3VudCAtIDE7XG4gICAgICAgIGlmICh0aGlzLmRpc2FibGVkSXRlbXNTZXJ2aWNlLmlzSW5kZXhEaXNhYmxlZChpbmRleCkpIHtcbiAgICAgICAgICAgIHJldHVybiAoaW5kZXggPCBtYXhJbmRleCkgPyB0aGlzLmZpcnN0Rm9jdXNhYmxlSW5kZXgoaW5kZXggKyAxKSA6IHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBpbmRleDtcbiAgICAgICAgfVxuICAgIH1cbiAgICBoYW5kbGVFbnRlcigpIHtcbiAgICAgICAgaWYgKHRoaXMuaXNPcGVuKSB7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdGlvblNlcnZpY2UuY2hhbmdlKHRoaXMuc2VsZWN0aW9uU2VydmljZS5mb2N1c2VkKTtcbiAgICAgICAgICAgIHRoaXMuZm9jdXMoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMudG9nZ2xlUG9wdXAodHJ1ZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaGFuZGxlRXNjYXBlKCkge1xuICAgICAgICBpZiAoaXNQcmVzZW50KHRoaXMuc2VsZWN0aW9uU2VydmljZS5zZWxlY3RlZFswXSkpIHtcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0aW9uU2VydmljZS5jaGFuZ2UodGhpcy5zZWxlY3Rpb25TZXJ2aWNlLnNlbGVjdGVkWzBdKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMudG9nZ2xlUG9wdXAoZmFsc2UpO1xuICAgICAgICAgICAgdGhpcy5jbGVhckZpbHRlcigpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZm9jdXMoKTtcbiAgICB9XG4gICAgY2xlYXJGaWx0ZXIoKSB7XG4gICAgICAgIGlmICghKHRoaXMuZmlsdGVyYWJsZSAmJiB0aGlzLmZpbHRlclRleHQpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5maWx0ZXJUZXh0ID0gXCJcIjtcbiAgICAgICAgdGhpcy5jZHIubWFya0ZvckNoZWNrKCk7XG4gICAgICAgIHRoaXMuZmlsdGVyQ2hhbmdlLmVtaXQodGhpcy5maWx0ZXJUZXh0KTtcbiAgICB9XG4gICAgdmVyaWZ5U2V0dGluZ3MoKSB7XG4gICAgICAgIGlmICghaXNEZXZNb2RlKCkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5kZWZhdWx0SXRlbSAmJiB0aGlzLnZhbHVlRmllbGQgJiYgdHlwZW9mIHRoaXMuZGVmYXVsdEl0ZW0gIT09IFwib2JqZWN0XCIpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihEcm9wRG93bkxpc3RNZXNzYWdlcy5kZWZhdWx0SXRlbSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMudmFsdWVQcmltaXRpdmUgPT09IHRydWUgJiYgaXNQcmVzZW50KHRoaXMudmFsdWUpICYmIHR5cGVvZiB0aGlzLnZhbHVlID09PSBcIm9iamVjdFwiKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoRHJvcERvd25MaXN0TWVzc2FnZXMucHJpbWl0aXZlKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy52YWx1ZVByaW1pdGl2ZSA9PT0gZmFsc2UgJiYgaXNQcmVzZW50KHRoaXMudmFsdWUpICYmIHR5cGVvZiB0aGlzLnZhbHVlICE9PSBcIm9iamVjdFwiKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoRHJvcERvd25MaXN0TWVzc2FnZXMub2JqZWN0KTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCB2YWx1ZU9yVGV4dCA9ICFpc1ByZXNlbnQodGhpcy52YWx1ZUZpZWxkKSAhPT0gIWlzUHJlc2VudCh0aGlzLnRleHRGaWVsZCk7XG4gICAgICAgIGlmICh2YWx1ZU9yVGV4dCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKERyb3BEb3duTGlzdE1lc3NhZ2VzLnRleHRBbmRWYWx1ZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgY29tcG9uZW50Qmx1cigpIHtcbiAgICAgICAgdGhpcy5pc0ZvY3VzZWQgPSBmYWxzZTtcbiAgICAgICAgY29uc3Qgc2VsZWN0aW9uUHJlc2VudCA9IGlzUHJlc2VudCh0aGlzLnNlbGVjdGlvblNlcnZpY2Uuc2VsZWN0ZWRbMF0pO1xuICAgICAgICBjb25zdCB2YWx1ZUhhc0NoYW5nZWQgPSBzZWxlY3Rpb25QcmVzZW50ICYmIGdldHRlciQxKHRoaXMudmFsdWUsIHRoaXMudmFsdWVGaWVsZCkgIT09IGdldHRlciQxKHRoaXMuZGF0YVNlcnZpY2UuaXRlbUF0KHRoaXMuc2VsZWN0aW9uU2VydmljZS5zZWxlY3RlZFswXSksIHRoaXMudmFsdWVGaWVsZCk7XG4gICAgICAgIGlmICh2YWx1ZUhhc0NoYW5nZWQgfHxcbiAgICAgICAgICAgIGhhc09ic2VydmVycyh0aGlzLmNsb3NlKSB8fFxuICAgICAgICAgICAgaGFzT2JzZXJ2ZXJzKHRoaXMub25CbHVyKSB8fFxuICAgICAgICAgICAgaGFzT2JzZXJ2ZXJzKHRoaXMuZmlsdGVyQ2hhbmdlKSB8fFxuICAgICAgICAgICAgaXNVbnRvdWNoZWQodGhpcy53cmFwcGVyLm5hdGl2ZUVsZW1lbnQpKSB7XG4gICAgICAgICAgICB0aGlzLl96b25lLnJ1bigoKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlSGFzQ2hhbmdlZCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGlvblNlcnZpY2UuY2hhbmdlKHRoaXMuc2VsZWN0aW9uU2VydmljZS5zZWxlY3RlZFswXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMudG9nZ2xlUG9wdXAoZmFsc2UpO1xuICAgICAgICAgICAgICAgIHRoaXMuY2xlYXJGaWx0ZXIoKTtcbiAgICAgICAgICAgICAgICB0aGlzLm9uQmx1ci5lbWl0KCk7XG4gICAgICAgICAgICAgICAgdGhpcy5vblRvdWNoZWRDYWxsYmFjaygpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnRvZ2dsZVBvcHVwKGZhbHNlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgb25Nb3VzZURvd24oZXZlbnQpIHtcbiAgICAgICAgY29uc3QgdGFnTmFtZSA9IGV2ZW50LnRhcmdldC50YWdOYW1lLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIGlmICh0YWdOYW1lICE9PSBcImlucHV0XCIpIHtcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgb25LZXlQcmVzcyhldmVudCkge1xuICAgICAgICBpZiAoZXZlbnQud2hpY2ggPT09IDAgfHwgZXZlbnQua2V5Q29kZSA9PT0gS2V5cy5FbnRlcikge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGxldCBjaGFyYWN0ZXIgPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGV2ZW50LmNoYXJDb2RlIHx8IGV2ZW50LmtleUNvZGUpO1xuICAgICAgICBpZiAodGhpcy5pZ25vcmVDYXNlKSB7XG4gICAgICAgICAgICBjaGFyYWN0ZXIgPSBjaGFyYWN0ZXIudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY2hhcmFjdGVyID09PSBcIiBcIikge1xuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLndvcmQgKz0gY2hhcmFjdGVyO1xuICAgICAgICB0aGlzLmxhc3QgPSBjaGFyYWN0ZXI7XG4gICAgICAgIHRoaXMuc2VhcmNoKCk7XG4gICAgfVxuICAgIHNlYXJjaCgpIHtcbiAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMudHlwaW5nVGltZW91dCk7XG4gICAgICAgIGlmICghdGhpcy5maWx0ZXJhYmxlKSB7XG4gICAgICAgICAgICB0aGlzLnR5cGluZ1RpbWVvdXQgPSBzZXRUaW1lb3V0KCgpID0+IHsgdGhpcy53b3JkID0gXCJcIjsgfSwgdGhpcy5kZWxheSk7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdE5leHQoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzZWxlY3ROZXh0KCkge1xuICAgICAgICBsZXQgZGF0YSA9IHRoaXMuZGF0YVNlcnZpY2VcbiAgICAgICAgICAgIC5maWx0ZXIoKGl0ZW0pID0+IGlzUHJlc2VudChpdGVtKSAmJiAhaXRlbS5oZWFkZXIgJiYgIXRoaXMuZGlzYWJsZWRJdGVtc1NlcnZpY2UuaXNJdGVtRGlzYWJsZWQoaXRlbSkpXG4gICAgICAgICAgICAubWFwKChpdGVtKSA9PiB7XG4gICAgICAgICAgICBpZiAodGhpcy5kYXRhU2VydmljZS5ncm91cGVkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHsgaXRlbTogaXRlbS52YWx1ZSwgaXRlbUluZGV4OiBpdGVtLm9mZnNldEluZGV4IH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4geyBpdGVtOiBpdGVtLCBpdGVtSW5kZXg6IHRoaXMuZGF0YVNlcnZpY2UuaW5kZXhPZihpdGVtKSB9O1xuICAgICAgICB9KTtcbiAgICAgICAgY29uc3QgaXNJbkxvb3AgPSBzYW1lQ2hhcnNPbmx5KHRoaXMud29yZCwgdGhpcy5sYXN0KTtcbiAgICAgICAgbGV0IGRhdGFMZW5ndGggPSBkYXRhLmxlbmd0aDtcbiAgICAgICAgbGV0IGhhc1NlbGVjdGVkID0gIWlzTmFOKHRoaXMuc2VsZWN0aW9uU2VydmljZS5zZWxlY3RlZFswXSk7XG4gICAgICAgIGxldCBzdGFydEluZGV4ID0gIWhhc1NlbGVjdGVkID8gMCA6IHRoaXMuc2VsZWN0aW9uU2VydmljZS5zZWxlY3RlZFswXTtcbiAgICAgICAgbGV0IHRleHQsIGluZGV4LCBkZWZhdWx0SXRlbTtcbiAgICAgICAgaWYgKHRoaXMuZGVmYXVsdEl0ZW0gJiYgIXRoaXMuZGlzYWJsZWRJdGVtc1NlcnZpY2UuaXNJdGVtRGlzYWJsZWQodGhpcy5kZWZhdWx0SXRlbSkpIHtcbiAgICAgICAgICAgIGRlZmF1bHRJdGVtID0geyBpdGVtOiB0aGlzLmRlZmF1bHRJdGVtLCBpdGVtSW5kZXg6IC0xIH07XG4gICAgICAgICAgICBkYXRhTGVuZ3RoICs9IDE7XG4gICAgICAgICAgICBzdGFydEluZGV4ICs9IDE7XG4gICAgICAgIH1cbiAgICAgICAgc3RhcnRJbmRleCArPSBpc0luTG9vcCAmJiBoYXNTZWxlY3RlZCA/IDEgOiAwO1xuICAgICAgICBkYXRhID0gc2h1ZmZsZURhdGEoZGF0YSwgc3RhcnRJbmRleCwgZGVmYXVsdEl0ZW0pO1xuICAgICAgICBpbmRleCA9IDA7XG4gICAgICAgIGZvciAoOyBpbmRleCA8IGRhdGFMZW5ndGg7IGluZGV4KyspIHtcbiAgICAgICAgICAgIHRleHQgPSBnZXR0ZXIkMShkYXRhW2luZGV4XS5pdGVtLCB0aGlzLnRleHRGaWVsZCk7XG4gICAgICAgICAgICBjb25zdCBsb29wTWF0Y2ggPSBCb29sZWFuKGlzSW5Mb29wICYmIG1hdGNoVGV4dCh0ZXh0LCB0aGlzLmxhc3QsIHRoaXMuaWdub3JlQ2FzZSkpO1xuICAgICAgICAgICAgY29uc3QgbmV4dE1hdGNoID0gQm9vbGVhbihtYXRjaFRleHQodGV4dCwgdGhpcy53b3JkLCB0aGlzLmlnbm9yZUNhc2UpKTtcbiAgICAgICAgICAgIGlmIChsb29wTWF0Y2ggfHwgbmV4dE1hdGNoKSB7XG4gICAgICAgICAgICAgICAgaW5kZXggPSBkYXRhW2luZGV4XS5pdGVtSW5kZXg7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGluZGV4ICE9PSBkYXRhTGVuZ3RoKSB7XG4gICAgICAgICAgICB0aGlzLm5hdmlnYXRlKGluZGV4KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbWl0Q2hhbmdlKHZhbHVlKSB7XG4gICAgICAgIHRoaXMub25DaGFuZ2VDYWxsYmFjayh2YWx1ZSk7XG4gICAgICAgIHRoaXMudmFsdWVDaGFuZ2UuZW1pdCh2YWx1ZSk7XG4gICAgfVxuICAgIG5hdmlnYXRlKGluZGV4KSB7XG4gICAgICAgIHRoaXMuc2VsZWN0aW9uU2VydmljZS5zZWxlY3QoaW5kZXgpO1xuICAgIH1cbiAgICBmaW5kRGF0YUl0ZW0oeyB2YWx1ZUZpZWxkLCB2YWx1ZSB9KSB7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IHtcbiAgICAgICAgICAgIGRhdGFJdGVtOiBudWxsLFxuICAgICAgICAgICAgaW5kZXg6IC0xXG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IHByb3AgPSBkYXRhSXRlbSA9PiBnZXR0ZXIkMShkYXRhSXRlbSwgdmFsdWVGaWVsZCk7XG4gICAgICAgIGxldCBjb21wYXJlcjtcbiAgICAgICAgaWYgKHRoaXMuZGF0YVNlcnZpY2UuZ3JvdXBlZCkge1xuICAgICAgICAgICAgY29tcGFyZXIgPSAoZWxlbWVudCkgPT4ge1xuICAgICAgICAgICAgICAgIHJldHVybiBwcm9wKGVsZW1lbnQudmFsdWUpID09PSBwcm9wKHZhbHVlKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjb21wYXJlciA9IChlbGVtZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHByb3AoZWxlbWVudCkgPT09IHByb3AodmFsdWUpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBpbmRleCA9IHRoaXMuZGF0YVNlcnZpY2UuZmluZEluZGV4KGNvbXBhcmVyKTtcbiAgICAgICAgcmVzdWx0LmRhdGFJdGVtID0gdGhpcy5kYXRhU2VydmljZS5pdGVtQXQoaW5kZXgpO1xuICAgICAgICByZXN1bHQuaW5kZXggPSBpbmRleDtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG4gICAgc2V0U3RhdGUoKSB7XG4gICAgICAgIGNvbnN0IHZhbHVlID0gdGhpcy52YWx1ZTtcbiAgICAgICAgY29uc3QgdmFsdWVGaWVsZCA9IHRoaXMudmFsdWVGaWVsZDtcbiAgICAgICAgY29uc3QgdGV4dEZpZWxkID0gdGhpcy50ZXh0RmllbGQ7XG4gICAgICAgIGNvbnN0IHByaW1pdGl2ZSA9IHRoaXMudmFsdWVQcmltaXRpdmU7XG4gICAgICAgIGlmICh0aGlzLmRlZmF1bHRJdGVtKSB7XG4gICAgICAgICAgICBjb25zdCBkZWZhdWx0VmFsdWUgPSBnZXR0ZXIkMSh0aGlzLmRlZmF1bHRJdGVtLCB2YWx1ZUZpZWxkKTtcbiAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRWYWx1ZSA9IGdldHRlciQxKHZhbHVlLCB2YWx1ZUZpZWxkKTtcbiAgICAgICAgICAgIGlmICghaXNQcmVzZW50KHZhbHVlKSB8fCAoY3VycmVudFZhbHVlID09PSBkZWZhdWx0VmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVTdGF0ZSh7IGRhdGFJdGVtOiB0aGlzLmRlZmF1bHRJdGVtLCBjb25maXJtOiB0cnVlIH0pO1xuICAgICAgICAgICAgICAgIHRoaXMucmVzZXRTZWxlY3Rpb24oLTEpO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmZpbHRlcmFibGUgJiYgdGhpcy5maWx0ZXJUZXh0ICYmIHRoaXMuZGF0YVNlcnZpY2UuaXRlbXNDb3VudCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGlvblNlcnZpY2UuZm9jdXNlZCA9IHRoaXMuZmlyc3RGb2N1c2FibGVJbmRleCgwKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHJlc29sdmVkID0gdGhpcy5maW5kRGF0YUl0ZW0oeyB2YWx1ZUZpZWxkLCB2YWx1ZSB9KTtcbiAgICAgICAgLy8gVGhlIGRhdGEgYW5kIHZhbHVlIGFyZSBvZiBzYW1lIHNoYXBlLFxuICAgICAgICAvLyBmb3IgZXhhbXBsZSwgdmFsdWU6ICdmb28nLCBkYXRhOiBbJ2ZvbycsICdiYXInXVxuICAgICAgICAvLyBvciB2YWx1ZTogeyB2YWx1ZTogMSwgdGV4dDogJ2ZvbycgfSwgZGF0YTogW3sgdmFsdWU6IDEsIHRleHQ6ICdmb28nIH1dLlxuICAgICAgICBjb25zdCBvZlNhbWVUeXBlID0gIShwcmltaXRpdmUgJiYgdGV4dEZpZWxkKTtcbiAgICAgICAgaWYgKHJlc29sdmVkLmRhdGFJdGVtKSB7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVN0YXRlKHsgZGF0YUl0ZW06IHJlc29sdmVkLmRhdGFJdGVtLCBjb25maXJtOiB0cnVlIH0pO1xuICAgICAgICAgICAgdGhpcy5yZXNldFNlbGVjdGlvbihyZXNvbHZlZC5pbmRleCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoaXNQcmVzZW50KHZhbHVlKSAmJiBvZlNhbWVUeXBlKSB7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVN0YXRlKHsgZGF0YUl0ZW06IHZhbHVlIH0pO1xuICAgICAgICAgICAgdGhpcy5yZXNldFNlbGVjdGlvbigpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHRoaXMuX3ByZXZpb3VzRGF0YUl0ZW0pIHtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlU3RhdGUoeyBkYXRhSXRlbTogdGhpcy5fcHJldmlvdXNEYXRhSXRlbSB9KTtcbiAgICAgICAgICAgIHRoaXMucmVzZXRTZWxlY3Rpb24oKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuY2xlYXJTdGF0ZSgpO1xuICAgICAgICAgICAgdGhpcy5yZXNldFNlbGVjdGlvbigpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBoYW5kbGVGaWx0ZXIoZXZlbnQpIHtcbiAgICAgICAgdGhpcy5maWx0ZXJDaGFuZ2UuZW1pdChldmVudC50YXJnZXQudmFsdWUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgcGFnZUNoYW5nZShldmVudCkge1xuICAgICAgICBjb25zdCB2aXJ0dWFsID0gdGhpcy52aXJ0dWFsO1xuICAgICAgICB2aXJ0dWFsLnNraXAgPSBldmVudC5za2lwO1xuICAgIH1cbiAgICBhc3NpZ25BcmlhRGVzY3JpYmVkQnkoKSB7XG4gICAgICAgIGNvbnN0IGN1cnJlbnRWYWx1ZSA9IHRoaXMud3JhcHBlci5uYXRpdmVFbGVtZW50LmdldEF0dHJpYnV0ZSgnYXJpYS1kZXNjcmliZWRieScpIHx8ICcnO1xuICAgICAgICBjb25zdCB0cmltbWVkID0gY3VycmVudFZhbHVlLnJlcGxhY2UodGhpcy52YWx1ZUxhYmVsSWQsICcnKS50cmltKCk7XG4gICAgICAgIC8vIHJlc2V0IHRoZSB2YWx1ZSBsYWJlbCBJRCB0byBmb3JjZSByZWFkZXJzIHRvIHJlYWQgdGhlIG5ldyB2YWx1ZVxuICAgICAgICB0aGlzLnZhbHVlTGFiZWxJZCA9IGd1aWQkMSgpO1xuICAgICAgICAvLyBhZGQgdG8gdGhlIGN1cnJlbnQgdmFsdWUgLSBkb24ndCByZXBsYWNlIGl0XG4gICAgICAgIGNvbnN0IG5ld1ZhbHVlID0gYCR7dGhpcy52YWx1ZUxhYmVsSWR9ICR7dHJpbW1lZH1gLnRyaW0oKTtcbiAgICAgICAgdGhpcy5yZW5kZXJlci5zZXRBdHRyaWJ1dGUodGhpcy53cmFwcGVyLm5hdGl2ZUVsZW1lbnQsICdhcmlhLWRlc2NyaWJlZGJ5JywgbmV3VmFsdWUpO1xuICAgIH1cbiAgICBzZXRDb21wb25lbnRDbGFzc2VzKCkge1xuICAgICAgICBpZiAodGhpcy5zaXplKSB7XG4gICAgICAgICAgICB0aGlzLnJlbmRlcmVyLmFkZENsYXNzKHRoaXMud3JhcHBlci5uYXRpdmVFbGVtZW50LCBnZXRTaXplQ2xhc3MoJ3BpY2tlcicsIHRoaXMuc2l6ZSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnJvdW5kZWQpIHtcbiAgICAgICAgICAgIHRoaXMucmVuZGVyZXIuYWRkQ2xhc3ModGhpcy53cmFwcGVyLm5hdGl2ZUVsZW1lbnQsIGdldFJvdW5kZWRDbGFzcyh0aGlzLnJvdW5kZWQpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5maWxsTW9kZSkge1xuICAgICAgICAgICAgdGhpcy5yZW5kZXJlci5hZGRDbGFzcyh0aGlzLndyYXBwZXIubmF0aXZlRWxlbWVudCwgZ2V0RmlsbE1vZGVDbGFzcygncGlja2VyJywgdGhpcy5maWxsTW9kZSkpO1xuICAgICAgICB9XG4gICAgfVxufTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIFN0cmluZylcbl0sIERyb3BEb3duTGlzdENvbXBvbmVudC5wcm90b3R5cGUsIFwiaWNvbkNsYXNzXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBJbnB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBCb29sZWFuKVxuXSwgRHJvcERvd25MaXN0Q29tcG9uZW50LnByb3RvdHlwZSwgXCJsb2FkaW5nXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBJbnB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBPYmplY3QpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246cGFyYW10eXBlc1wiLCBbT2JqZWN0XSlcbl0sIERyb3BEb3duTGlzdENvbXBvbmVudC5wcm90b3R5cGUsIFwiZGF0YVwiLCBudWxsKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIE9iamVjdCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjpwYXJhbXR5cGVzXCIsIFtPYmplY3RdKVxuXSwgRHJvcERvd25MaXN0Q29tcG9uZW50LnByb3RvdHlwZSwgXCJ2YWx1ZVwiLCBudWxsKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIFN0cmluZylcbl0sIERyb3BEb3duTGlzdENvbXBvbmVudC5wcm90b3R5cGUsIFwidGV4dEZpZWxkXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBJbnB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBTdHJpbmcpXG5dLCBEcm9wRG93bkxpc3RDb21wb25lbnQucHJvdG90eXBlLCBcInZhbHVlRmllbGRcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIE9iamVjdCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjpwYXJhbXR5cGVzXCIsIFtPYmplY3RdKVxuXSwgRHJvcERvd25MaXN0Q29tcG9uZW50LnByb3RvdHlwZSwgXCJwb3B1cFNldHRpbmdzXCIsIG51bGwpO1xuX19kZWNvcmF0ZShbXG4gICAgSW5wdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgTnVtYmVyKVxuXSwgRHJvcERvd25MaXN0Q29tcG9uZW50LnByb3RvdHlwZSwgXCJsaXN0SGVpZ2h0XCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBJbnB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBPYmplY3QpXG5dLCBEcm9wRG93bkxpc3RDb21wb25lbnQucHJvdG90eXBlLCBcImRlZmF1bHRJdGVtXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBJbnB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBCb29sZWFuKVxuXSwgRHJvcERvd25MaXN0Q29tcG9uZW50LnByb3RvdHlwZSwgXCJkaXNhYmxlZFwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgSW5wdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgRnVuY3Rpb24pLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246cGFyYW10eXBlc1wiLCBbRnVuY3Rpb25dKVxuXSwgRHJvcERvd25MaXN0Q29tcG9uZW50LnByb3RvdHlwZSwgXCJpdGVtRGlzYWJsZWRcIiwgbnVsbCk7XG5fX2RlY29yYXRlKFtcbiAgICBJbnB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBCb29sZWFuKVxuXSwgRHJvcERvd25MaXN0Q29tcG9uZW50LnByb3RvdHlwZSwgXCJyZWFkb25seVwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgSW5wdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgQm9vbGVhbilcbl0sIERyb3BEb3duTGlzdENvbXBvbmVudC5wcm90b3R5cGUsIFwiZmlsdGVyYWJsZVwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgSW5wdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgT2JqZWN0KSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnBhcmFtdHlwZXNcIiwgW09iamVjdF0pXG5dLCBEcm9wRG93bkxpc3RDb21wb25lbnQucHJvdG90eXBlLCBcInZpcnR1YWxcIiwgbnVsbCk7XG5fX2RlY29yYXRlKFtcbiAgICBJbnB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBCb29sZWFuKVxuXSwgRHJvcERvd25MaXN0Q29tcG9uZW50LnByb3RvdHlwZSwgXCJpZ25vcmVDYXNlXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBJbnB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBOdW1iZXIpXG5dLCBEcm9wRG93bkxpc3RDb21wb25lbnQucHJvdG90eXBlLCBcImRlbGF5XCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBJbnB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBCb29sZWFuKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnBhcmFtdHlwZXNcIiwgW0Jvb2xlYW5dKVxuXSwgRHJvcERvd25MaXN0Q29tcG9uZW50LnByb3RvdHlwZSwgXCJ2YWx1ZVByaW1pdGl2ZVwiLCBudWxsKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIE51bWJlcilcbl0sIERyb3BEb3duTGlzdENvbXBvbmVudC5wcm90b3R5cGUsIFwidGFiaW5kZXhcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KFwidGFiSW5kZXhcIiksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIE51bWJlciksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjpwYXJhbXR5cGVzXCIsIFtOdW1iZXJdKVxuXSwgRHJvcERvd25MaXN0Q29tcG9uZW50LnByb3RvdHlwZSwgXCJ0YWJJbmRleFwiLCBudWxsKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIFN0cmluZyksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjpwYXJhbXR5cGVzXCIsIFtTdHJpbmddKVxuXSwgRHJvcERvd25MaXN0Q29tcG9uZW50LnByb3RvdHlwZSwgXCJzaXplXCIsIG51bGwpO1xuX19kZWNvcmF0ZShbXG4gICAgSW5wdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgU3RyaW5nKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnBhcmFtdHlwZXNcIiwgW1N0cmluZ10pXG5dLCBEcm9wRG93bkxpc3RDb21wb25lbnQucHJvdG90eXBlLCBcInJvdW5kZWRcIiwgbnVsbCk7XG5fX2RlY29yYXRlKFtcbiAgICBJbnB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBTdHJpbmcpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246cGFyYW10eXBlc1wiLCBbU3RyaW5nXSlcbl0sIERyb3BEb3duTGlzdENvbXBvbmVudC5wcm90b3R5cGUsIFwiZmlsbE1vZGVcIiwgbnVsbCk7XG5fX2RlY29yYXRlKFtcbiAgICBPdXRwdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgRXZlbnRFbWl0dGVyKVxuXSwgRHJvcERvd25MaXN0Q29tcG9uZW50LnByb3RvdHlwZSwgXCJ2YWx1ZUNoYW5nZVwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgT3V0cHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEV2ZW50RW1pdHRlcilcbl0sIERyb3BEb3duTGlzdENvbXBvbmVudC5wcm90b3R5cGUsIFwiZmlsdGVyQ2hhbmdlXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBPdXRwdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgRXZlbnRFbWl0dGVyKVxuXSwgRHJvcERvd25MaXN0Q29tcG9uZW50LnByb3RvdHlwZSwgXCJzZWxlY3Rpb25DaGFuZ2VcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIE91dHB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBFdmVudEVtaXR0ZXIpXG5dLCBEcm9wRG93bkxpc3RDb21wb25lbnQucHJvdG90eXBlLCBcIm9wZW5cIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIE91dHB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBFdmVudEVtaXR0ZXIpXG5dLCBEcm9wRG93bkxpc3RDb21wb25lbnQucHJvdG90eXBlLCBcIm9wZW5lZFwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgT3V0cHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEV2ZW50RW1pdHRlcilcbl0sIERyb3BEb3duTGlzdENvbXBvbmVudC5wcm90b3R5cGUsIFwiY2xvc2VcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIE91dHB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBFdmVudEVtaXR0ZXIpXG5dLCBEcm9wRG93bkxpc3RDb21wb25lbnQucHJvdG90eXBlLCBcImNsb3NlZFwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgT3V0cHV0KCdmb2N1cycpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBFdmVudEVtaXR0ZXIpXG5dLCBEcm9wRG93bkxpc3RDb21wb25lbnQucHJvdG90eXBlLCBcIm9uRm9jdXNcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIE91dHB1dCgnYmx1cicpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBFdmVudEVtaXR0ZXIpXG5dLCBEcm9wRG93bkxpc3RDb21wb25lbnQucHJvdG90eXBlLCBcIm9uQmx1clwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgQ29udGVudENoaWxkKEl0ZW1UZW1wbGF0ZURpcmVjdGl2ZSwgeyBzdGF0aWM6IGZhbHNlIH0pLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBJdGVtVGVtcGxhdGVEaXJlY3RpdmUpXG5dLCBEcm9wRG93bkxpc3RDb21wb25lbnQucHJvdG90eXBlLCBcIml0ZW1UZW1wbGF0ZVwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgQ29udGVudENoaWxkKEdyb3VwVGVtcGxhdGVEaXJlY3RpdmUsIHsgc3RhdGljOiBmYWxzZSB9KSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgR3JvdXBUZW1wbGF0ZURpcmVjdGl2ZSlcbl0sIERyb3BEb3duTGlzdENvbXBvbmVudC5wcm90b3R5cGUsIFwiZ3JvdXBUZW1wbGF0ZVwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgQ29udGVudENoaWxkKEZpeGVkR3JvdXBUZW1wbGF0ZURpcmVjdGl2ZSwgeyBzdGF0aWM6IGZhbHNlIH0pLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBGaXhlZEdyb3VwVGVtcGxhdGVEaXJlY3RpdmUpXG5dLCBEcm9wRG93bkxpc3RDb21wb25lbnQucHJvdG90eXBlLCBcImZpeGVkR3JvdXBUZW1wbGF0ZVwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgQ29udGVudENoaWxkKFZhbHVlVGVtcGxhdGVEaXJlY3RpdmUsIHsgc3RhdGljOiBmYWxzZSB9KSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgVmFsdWVUZW1wbGF0ZURpcmVjdGl2ZSlcbl0sIERyb3BEb3duTGlzdENvbXBvbmVudC5wcm90b3R5cGUsIFwidmFsdWVUZW1wbGF0ZVwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgQ29udGVudENoaWxkKEhlYWRlclRlbXBsYXRlRGlyZWN0aXZlLCB7IHN0YXRpYzogZmFsc2UgfSksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEhlYWRlclRlbXBsYXRlRGlyZWN0aXZlKVxuXSwgRHJvcERvd25MaXN0Q29tcG9uZW50LnByb3RvdHlwZSwgXCJoZWFkZXJUZW1wbGF0ZVwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgQ29udGVudENoaWxkKEZvb3RlclRlbXBsYXRlRGlyZWN0aXZlLCB7IHN0YXRpYzogZmFsc2UgfSksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEZvb3RlclRlbXBsYXRlRGlyZWN0aXZlKVxuXSwgRHJvcERvd25MaXN0Q29tcG9uZW50LnByb3RvdHlwZSwgXCJmb290ZXJUZW1wbGF0ZVwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgQ29udGVudENoaWxkKE5vRGF0YVRlbXBsYXRlRGlyZWN0aXZlLCB7IHN0YXRpYzogZmFsc2UgfSksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIE5vRGF0YVRlbXBsYXRlRGlyZWN0aXZlKVxuXSwgRHJvcERvd25MaXN0Q29tcG9uZW50LnByb3RvdHlwZSwgXCJub0RhdGFUZW1wbGF0ZVwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgVmlld0NoaWxkKCdjb250YWluZXInLCB7IHJlYWQ6IFZpZXdDb250YWluZXJSZWYsIHN0YXRpYzogdHJ1ZSB9KSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgVmlld0NvbnRhaW5lclJlZilcbl0sIERyb3BEb3duTGlzdENvbXBvbmVudC5wcm90b3R5cGUsIFwiY29udGFpbmVyXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBWaWV3Q2hpbGQoJ3BvcHVwVGVtcGxhdGUnLCB7IHN0YXRpYzogdHJ1ZSB9KSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgVGVtcGxhdGVSZWYpXG5dLCBEcm9wRG93bkxpc3RDb21wb25lbnQucHJvdG90eXBlLCBcInBvcHVwVGVtcGxhdGVcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIFZpZXdDaGlsZCgnb3B0aW9uc0xpc3QnLCB7IHN0YXRpYzogZmFsc2UgfSksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIExpc3RDb21wb25lbnQpXG5dLCBEcm9wRG93bkxpc3RDb21wb25lbnQucHJvdG90eXBlLCBcIm9wdGlvbnNMaXN0XCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBIb3N0QmluZGluZygnY2xhc3Muay1kcm9wZG93bmxpc3QnKSxcbiAgICBIb3N0QmluZGluZygnY2xhc3Muay1waWNrZXInKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgQm9vbGVhbilcbl0sIERyb3BEb3duTGlzdENvbXBvbmVudC5wcm90b3R5cGUsIFwiaG9zdENsYXNzZXNcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIEhvc3RCaW5kaW5nKCdjbGFzcy5rLWRpc2FibGVkJyksXG4gICAgSG9zdEJpbmRpbmcoJ2F0dHIuYXJpYS1kaXNhYmxlZCcpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBCb29sZWFuKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnBhcmFtdHlwZXNcIiwgW10pXG5dLCBEcm9wRG93bkxpc3RDb21wb25lbnQucHJvdG90eXBlLCBcImlzRGlzYWJsZWRcIiwgbnVsbCk7XG5fX2RlY29yYXRlKFtcbiAgICBIb3N0QmluZGluZygnY2xhc3Muay1sb2FkaW5nJyksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEJvb2xlYW4pLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246cGFyYW10eXBlc1wiLCBbXSlcbl0sIERyb3BEb3duTGlzdENvbXBvbmVudC5wcm90b3R5cGUsIFwiaXNMb2FkaW5nXCIsIG51bGwpO1xuX19kZWNvcmF0ZShbXG4gICAgSW5wdXQoJ2lkJyksXG4gICAgSG9zdEJpbmRpbmcoJ2F0dHIuaWQnKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgU3RyaW5nKVxuXSwgRHJvcERvd25MaXN0Q29tcG9uZW50LnByb3RvdHlwZSwgXCJmb2N1c2FibGVJZFwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgSG9zdEJpbmRpbmcoJ2F0dHIuZGlyJyksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIFN0cmluZyksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjpwYXJhbXR5cGVzXCIsIFtdKVxuXSwgRHJvcERvd25MaXN0Q29tcG9uZW50LnByb3RvdHlwZSwgXCJkaXJcIiwgbnVsbCk7XG5fX2RlY29yYXRlKFtcbiAgICBIb3N0QmluZGluZygnYXR0ci50YWJpbmRleCcpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBOdW1iZXIpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246cGFyYW10eXBlc1wiLCBbXSlcbl0sIERyb3BEb3duTGlzdENvbXBvbmVudC5wcm90b3R5cGUsIFwiaG9zdFRhYkluZGV4XCIsIG51bGwpO1xuX19kZWNvcmF0ZShbXG4gICAgSG9zdEJpbmRpbmcoJ2F0dHIucmVhZG9ubHknKSxcbiAgICBIb3N0QmluZGluZygnYXR0ci5hcmlhLXJlYWRvbmx5JyksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEJvb2xlYW4pLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246cGFyYW10eXBlc1wiLCBbXSlcbl0sIERyb3BEb3duTGlzdENvbXBvbmVudC5wcm90b3R5cGUsIFwiaXNSZWFkb25seVwiLCBudWxsKTtcbl9fZGVjb3JhdGUoW1xuICAgIEhvc3RCaW5kaW5nKCdhdHRyLnJvbGUnKSxcbiAgICBIb3N0QmluZGluZygnYXR0ci5hcmlhLWhhc3BvcHVwJyksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIFN0cmluZylcbl0sIERyb3BEb3duTGlzdENvbXBvbmVudC5wcm90b3R5cGUsIFwicm9sZVwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgSG9zdEJpbmRpbmcoJ2F0dHIuYXJpYS1leHBhbmRlZCcpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBCb29sZWFuKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnBhcmFtdHlwZXNcIiwgW10pXG5dLCBEcm9wRG93bkxpc3RDb21wb25lbnQucHJvdG90eXBlLCBcImlzQXJpYUV4cGFuZGVkXCIsIG51bGwpO1xuX19kZWNvcmF0ZShbXG4gICAgSG9zdEJpbmRpbmcoJ2F0dHIuYXJpYS1vd25zJyksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIFN0cmluZyksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjpwYXJhbXR5cGVzXCIsIFtdKVxuXSwgRHJvcERvd25MaXN0Q29tcG9uZW50LnByb3RvdHlwZSwgXCJob3N0QXJpYU93bnNcIiwgbnVsbCk7XG5fX2RlY29yYXRlKFtcbiAgICBIb3N0QmluZGluZygnYXR0ci5hcmlhLWFjdGl2ZWRlc2NlbmRhbnQnKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgU3RyaW5nKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnBhcmFtdHlwZXNcIiwgW10pXG5dLCBEcm9wRG93bkxpc3RDb21wb25lbnQucHJvdG90eXBlLCBcImhvc3RBcmlhQWN0aXZlZGVzY2VuZGFudFwiLCBudWxsKTtcbl9fZGVjb3JhdGUoW1xuICAgIEhvc3RCaW5kaW5nKCdhdHRyLmFyaWEtbGFiZWwnKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgU3RyaW5nKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnBhcmFtdHlwZXNcIiwgW10pXG5dLCBEcm9wRG93bkxpc3RDb21wb25lbnQucHJvdG90eXBlLCBcImhvc3ROb0RhdGFMYWJlbFwiLCBudWxsKTtcbl9fZGVjb3JhdGUoW1xuICAgIEhvc3RMaXN0ZW5lcigna2V5ZG93bicsIFsnJGV2ZW50J10pLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBGdW5jdGlvbiksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjpwYXJhbXR5cGVzXCIsIFtPYmplY3RdKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnJldHVybnR5cGVcIiwgdm9pZCAwKVxuXSwgRHJvcERvd25MaXN0Q29tcG9uZW50LnByb3RvdHlwZSwgXCJrZXlkb3duXCIsIG51bGwpO1xuX19kZWNvcmF0ZShbXG4gICAgSG9zdExpc3RlbmVyKCdrZXlwcmVzcycsIFsnJGV2ZW50J10pLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBGdW5jdGlvbiksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjpwYXJhbXR5cGVzXCIsIFtPYmplY3RdKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnJldHVybnR5cGVcIiwgdm9pZCAwKVxuXSwgRHJvcERvd25MaXN0Q29tcG9uZW50LnByb3RvdHlwZSwgXCJrZXlwcmVzc1wiLCBudWxsKTtcbl9fZGVjb3JhdGUoW1xuICAgIEhvc3RMaXN0ZW5lcignY2xpY2snLCBbJyRldmVudCddKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgRnVuY3Rpb24pLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246cGFyYW10eXBlc1wiLCBbT2JqZWN0XSksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjpyZXR1cm50eXBlXCIsIHZvaWQgMClcbl0sIERyb3BEb3duTGlzdENvbXBvbmVudC5wcm90b3R5cGUsIFwiY2xpY2tcIiwgbnVsbCk7XG5Ecm9wRG93bkxpc3RDb21wb25lbnQgPSBEcm9wRG93bkxpc3RDb21wb25lbnRfMSA9IF9fZGVjb3JhdGUoW1xuICAgIENvbXBvbmVudCh7XG4gICAgICAgIGV4cG9ydEFzOiAna2VuZG9Ecm9wRG93bkxpc3QnLFxuICAgICAgICBwcm92aWRlcnM6IFtcbiAgICAgICAgICAgIERST1BET1dOTElTVF9WQUxVRV9BQ0NFU1NPUixcbiAgICAgICAgICAgIERhdGFTZXJ2aWNlLFxuICAgICAgICAgICAgU2VsZWN0aW9uU2VydmljZSxcbiAgICAgICAgICAgIE5hdmlnYXRpb25TZXJ2aWNlLFxuICAgICAgICAgICAgRGlzYWJsZWRJdGVtc1NlcnZpY2UsXG4gICAgICAgICAgICBMb2NhbGl6YXRpb25TZXJ2aWNlLFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHByb3ZpZGU6IEwxME5fUFJFRklYLFxuICAgICAgICAgICAgICAgIHVzZVZhbHVlOiAna2VuZG8uZHJvcGRvd25saXN0J1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBwcm92aWRlOiBGaWx0ZXJhYmxlQ29tcG9uZW50LCB1c2VFeGlzdGluZzogZm9yd2FyZFJlZigoKSA9PiBEcm9wRG93bkxpc3RDb21wb25lbnRfMSlcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcHJvdmlkZTogS2VuZG9JbnB1dCwgdXNlRXhpc3Rpbmc6IGZvcndhcmRSZWYoKCkgPT4gRHJvcERvd25MaXN0Q29tcG9uZW50XzEpXG4gICAgICAgICAgICB9XG4gICAgICAgIF0sXG4gICAgICAgIHNlbGVjdG9yOiAna2VuZG8tZHJvcGRvd25saXN0JyxcbiAgICAgICAgdGVtcGxhdGU6IGBcbiAgICAgICAgPG5nLWNvbnRhaW5lciBrZW5kb0Ryb3BEb3duTGlzdExvY2FsaXplZE1lc3NhZ2VzXG4gICAgICAgICAgICBpMThuLW5vRGF0YVRleHQ9XCJrZW5kby5kcm9wZG93bmxpc3Qubm9EYXRhVGV4dHxUaGUgdGV4dCBkaXNwbGF5ZWQgaW4gdGhlIHBvcHVwIHdoZW4gdGhlcmUgYXJlIG5vIGl0ZW1zXCJcbiAgICAgICAgICAgIG5vRGF0YVRleHQ9XCJOTyBEQVRBIEZPVU5EXCJcblxuICAgICAgICAgICAgaTE4bi1zZWxlY3RCdXR0b25UZXh0PVwia2VuZG8uZHJvcGRvd25saXN0LnNlbGVjdEJ1dHRvblRleHR8VGhlIHRleHQgc2V0IGFzIGFyaWEtbGFiZWwgb24gdGhlIHNlbGVjdCBidXR0b25cIlxuICAgICAgICAgICAgc2VsZWN0QnV0dG9uVGV4dD1cIlNlbGVjdFwiXG4gICAgICAgID5cbiAgICAgICAgPC9uZy1jb250YWluZXI+XG4gICAgICAgIDxzcGFuIGNsYXNzPVwiay1pbnB1dC1pbm5lclwiIHVuc2VsZWN0YWJsZT1cIm9uXCIgcm9sZT1cIm9wdGlvblwiIFtpZF09XCJ2YWx1ZUxhYmVsSWRcIj5cbiAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwiay1pbnB1dC12YWx1ZS10ZXh0XCI+XG4gICAgICAgICAgICAgICAgPG5nLXRlbXBsYXRlICpuZ0lmPVwidmFsdWVUZW1wbGF0ZVwiXG4gICAgICAgICAgICAgICAgICAgIFt0ZW1wbGF0ZUNvbnRleHRdPVwie1xuICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVSZWY6IHZhbHVlVGVtcGxhdGUudGVtcGxhdGVSZWYsXG4gICAgICAgICAgICAgICAgICAgICAgICAkaW1wbGljaXQ6IGRhdGFJdGVtXG4gICAgICAgICAgICAgICAgICAgIH1cIj5cbiAgICAgICAgICAgICAgICA8L25nLXRlbXBsYXRlPlxuICAgICAgICAgICAgICAgIDxuZy10ZW1wbGF0ZSBbbmdJZl09XCIhdmFsdWVUZW1wbGF0ZVwiPnt7IGdldFRleHQoKSB9fTwvbmctdGVtcGxhdGU+XG4gICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgIDwvc3Bhbj5cbiAgICAgICAgPGJ1dHRvblxuICAgICAgICAgICAgdGFiaW5kZXg9XCItMVwiXG4gICAgICAgICAgICB1bnNlbGVjdGFibGU9XCJvblwiXG4gICAgICAgICAgICB0eXBlPVwiYnV0dG9uXCJcbiAgICAgICAgICAgIGNsYXNzPVwiay1pbnB1dC1idXR0b24gay1idXR0b24gay1pY29uLWJ1dHRvblwiXG4gICAgICAgICAgICBbbmdDbGFzc109XCJzZWxlY3RCdXR0b25DbGFzc2VzXCJcbiAgICAgICAgICAgIFthdHRyLmFyaWEtbGFiZWxdPVwibWVzc2FnZUZvcignc2VsZWN0QnV0dG9uVGV4dCcpXCJcbiAgICAgICAgICAgIFtrZW5kb0V2ZW50c091dHNpZGVBbmd1bGFyXT1cIntcbiAgICAgICAgICAgICAgICBtb3VzZWRvd246IG9uTW91c2VEb3duXG4gICAgICAgICAgICB9XCJcbiAgICAgICAgPlxuICAgICAgICAgICAgPHNwYW5cbiAgICAgICAgICAgICAgICBjbGFzcz1cImstYnV0dG9uLWljb24gay1pY29uXCJcbiAgICAgICAgICAgICAgICB1bnNlbGVjdGFibGU9XCJvblwiXG4gICAgICAgICAgICAgICAgW25nQ2xhc3NdPVwiYnV0dG9uQ2xhc3Nlc1wiXG4gICAgICAgICAgICA+PC9zcGFuPlxuICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgPG5nLXRlbXBsYXRlICNwb3B1cFRlbXBsYXRlPlxuICAgICAgICAgICAgPCEtLWZpbHRlcmFibGUtLT5cblxuICAgICAgICAgICAgPG5nLXRlbXBsYXRlIFtuZ0lmXT1cImZpbHRlcmFibGVcIj5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiay1saXN0LWZpbHRlclwiIChjbGljayk9XCIkZXZlbnQuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKClcIj5cbiAgICAgICAgICAgICAgICAgICAgPHNwYW5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzPVwiay1zZWFyY2hib3ggay1pbnB1dFwiXG4gICAgICAgICAgICAgICAgICAgICAgICBbbmdDbGFzc109XCJmaWx0ZXJJbnB1dENsYXNzZXNcIlxuICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cImstaW5wdXQtaWNvbiBrLWljb24gay1pLXNlYXJjaFwiIHVuc2VsZWN0YWJsZT1cIm9uXCI+PC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgW2F0dHIuYXJpYS1vd25zXT1cImFyaWFPd25zXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbYXR0ci5hcmlhLWFjdGl2ZWRlc2NlbmRhbnRdPVwiYXJpYUFjdGl2ZWRlc2NlbmRhbnRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFthdHRyLmFyaWEtbGFiZWxdPVwibm9EYXRhTGFiZWxcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhYmluZGV4PVwiLTFcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtmaWx0ZXJJbnB1dF09XCJpc0ZvY3VzZWQgJiYgIXRvdWNoRW5hYmxlZFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgW2Rpcl09XCJkaXJlY3Rpb25cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsobmdNb2RlbCldPVwiZmlsdGVyVGV4dFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3M9XCJrLWlucHV0LWlubmVyXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoa2V5ZG93bik9XCJrZXlkb3duKCRldmVudClcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIChpbnB1dCk9XCJoYW5kbGVGaWx0ZXIoJGV2ZW50KVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKGZvY3VzKT1cIm9uRmlsdGVyRm9jdXMoKVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKGJsdXIpPVwiYmx1ckZpbHRlcklucHV0KClcIiAvPlxuICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8L25nLXRlbXBsYXRlPlxuICAgICAgICAgICAgPCEtLWRlZmF1bHQgaXRlbS0tPlxuICAgICAgICAgICAgPG5nLXRlbXBsYXRlIFtuZ0lmXT1cImRlZmF1bHRJdGVtICYmICFpdGVtVGVtcGxhdGVcIj5cbiAgICAgICAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICAgICAgICAgIGNsYXNzPVwiay1saXN0XCJcbiAgICAgICAgICAgICAgICAgICAgW25nQ2xhc3NdPVwib3B0aW9uTGFiZWxTaXplQ2xhc3NcIlxuICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImstbGlzdC1vcHRpb25sYWJlbFwiIFtuZ0NsYXNzXT1cInsgJ2stZGlzYWJsZWQnOiBpc0Rpc2FibGVkRGVmYXVsdEl0ZW0gfVwiIGtlbmRvRHJvcERvd25zU2VsZWN0YWJsZSBbaW5kZXhdPVwiLTFcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIHt7IGdldERlZmF1bHRJdGVtVGV4dCgpIH19XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPC9uZy10ZW1wbGF0ZT5cbiAgICAgICAgICAgIDxuZy10ZW1wbGF0ZSBbbmdJZl09XCJkZWZhdWx0SXRlbSAmJiBpdGVtVGVtcGxhdGVcIj5cbiAgICAgICAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICAgICAgICAgIGNsYXNzPVwiay1saXN0XCJcbiAgICAgICAgICAgICAgICAgICAgW25nQ2xhc3NdPVwib3B0aW9uTGFiZWxTaXplQ2xhc3NcIlxuICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImstbGlzdC1vcHRpb25sYWJlbFwiIFtuZ0NsYXNzXT1cInsgJ2stZGlzYWJsZWQnOiBpc0Rpc2FibGVkRGVmYXVsdEl0ZW0gfVwiIGtlbmRvRHJvcERvd25zU2VsZWN0YWJsZSBbaW5kZXhdPVwiLTFcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxuZy10ZW1wbGF0ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFt0ZW1wbGF0ZUNvbnRleHRdPVwie1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVJlZjogaXRlbVRlbXBsYXRlLnRlbXBsYXRlUmVmLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkaW1wbGljaXQ6IGRlZmF1bHRJdGVtXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9uZy10ZW1wbGF0ZT5cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8L25nLXRlbXBsYXRlPlxuICAgICAgICAgICAgPCEtLWhlYWRlciB0ZW1wbGF0ZS0tPlxuICAgICAgICAgICAgPG5nLXRlbXBsYXRlICpuZ0lmPVwiaGVhZGVyVGVtcGxhdGVcIlxuICAgICAgICAgICAgICAgIFt0ZW1wbGF0ZUNvbnRleHRdPVwie1xuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVJlZjogaGVhZGVyVGVtcGxhdGUudGVtcGxhdGVSZWZcbiAgICAgICAgICAgICAgICB9XCI+XG4gICAgICAgICAgICA8L25nLXRlbXBsYXRlPlxuICAgICAgICAgICAgPCEtLWxpc3QtLT5cbiAgICAgICAgICAgIDxrZW5kby1saXN0XG4gICAgICAgICAgICAgICAgI29wdGlvbnNMaXN0XG4gICAgICAgICAgICAgICAgW3NpemVdPVwic2l6ZVwiXG4gICAgICAgICAgICAgICAgW3JvdW5kZWRdPVwicm91bmRlZFwiXG4gICAgICAgICAgICAgICAgW2lkXT1cImxpc3RCb3hJZFwiXG4gICAgICAgICAgICAgICAgW29wdGlvblByZWZpeF09XCJvcHRpb25QcmVmaXhcIlxuICAgICAgICAgICAgICAgIFtkYXRhXT1cImRhdGFcIlxuICAgICAgICAgICAgICAgIFt0ZXh0RmllbGRdPVwidGV4dEZpZWxkXCJcbiAgICAgICAgICAgICAgICBbdmFsdWVGaWVsZF09XCJ2YWx1ZUZpZWxkXCJcbiAgICAgICAgICAgICAgICBbdGVtcGxhdGVdPVwiaXRlbVRlbXBsYXRlXCJcbiAgICAgICAgICAgICAgICBbZ3JvdXBUZW1wbGF0ZV09XCJncm91cFRlbXBsYXRlXCJcbiAgICAgICAgICAgICAgICBbZml4ZWRHcm91cFRlbXBsYXRlXT1cImZpeGVkR3JvdXBUZW1wbGF0ZVwiXG4gICAgICAgICAgICAgICAgW2hlaWdodF09XCJsaXN0SGVpZ2h0XCJcbiAgICAgICAgICAgICAgICBbc2hvd109XCJpc09wZW5cIlxuICAgICAgICAgICAgICAgIFt2aXJ0dWFsXT1cInZpcnR1YWxcIlxuICAgICAgICAgICAgICAgIChwYWdlQ2hhbmdlKT1cInBhZ2VDaGFuZ2UoJGV2ZW50KVwiXG4gICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgPC9rZW5kby1saXN0PlxuICAgICAgICAgICAgPCEtLW5vLWRhdGEgdGVtcGxhdGUtLT5cbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJrLW5vLWRhdGFcIiAqbmdJZj1cImRhdGEubGVuZ3RoID09PSAwXCI+XG4gICAgICAgICAgICAgICAgPG5nLXRlbXBsYXRlIFtuZ0lmXT1cIm5vRGF0YVRlbXBsYXRlXCJcbiAgICAgICAgICAgICAgICAgICAgW3RlbXBsYXRlQ29udGV4dF09XCJ7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVJlZjogbm9EYXRhVGVtcGxhdGUgPyBub0RhdGFUZW1wbGF0ZS50ZW1wbGF0ZVJlZiA6IHVuZGVmaW5lZFxuICAgICAgICAgICAgICAgICAgICB9XCI+XG4gICAgICAgICAgICAgICAgPC9uZy10ZW1wbGF0ZT5cbiAgICAgICAgICAgICAgICA8bmctdGVtcGxhdGUgW25nSWZdPVwiIW5vRGF0YVRlbXBsYXRlXCI+XG4gICAgICAgICAgICAgICAgICAgIDxkaXY+e3sgbWVzc2FnZUZvcignbm9EYXRhVGV4dCcpIH19PC9kaXY+XG4gICAgICAgICAgICAgICAgPC9uZy10ZW1wbGF0ZT5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPCEtLWZvb3RlciB0ZW1wbGF0ZS0tPlxuICAgICAgICAgICAgPG5nLXRlbXBsYXRlICpuZ0lmPVwiZm9vdGVyVGVtcGxhdGVcIlxuICAgICAgICAgICAgICAgIFt0ZW1wbGF0ZUNvbnRleHRdPVwie1xuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVJlZjogZm9vdGVyVGVtcGxhdGUudGVtcGxhdGVSZWZcbiAgICAgICAgICAgICAgICB9XCI+XG4gICAgICAgICAgICA8L25nLXRlbXBsYXRlPlxuICAgICAgICA8L25nLXRlbXBsYXRlPlxuICAgICAgICA8bmctdGVtcGxhdGUgW25nSWZdPVwiaXNPcGVuXCI+XG4gICAgICAgICAgICA8a2VuZG8tcmVzaXplLXNlbnNvciAocmVzaXplKT1cIm9uUmVzaXplKClcIj48L2tlbmRvLXJlc2l6ZS1zZW5zb3I+XG4gICAgICAgIDwvbmctdGVtcGxhdGU+XG4gICAgICAgIDxuZy1jb250YWluZXIgI2NvbnRhaW5lcj48L25nLWNvbnRhaW5lcj5cbiAgYFxuICAgIH0pLFxuICAgIF9fcGFyYW0oMTAsIE9wdGlvbmFsKCkpLCBfX3BhcmFtKDEwLCBJbmplY3QoVE9VQ0hfRU5BQkxFRCkpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246cGFyYW10eXBlc1wiLCBbRWxlbWVudFJlZixcbiAgICAgICAgTG9jYWxpemF0aW9uU2VydmljZSxcbiAgICAgICAgUG9wdXBTZXJ2aWNlLFxuICAgICAgICBTZWxlY3Rpb25TZXJ2aWNlLFxuICAgICAgICBOYXZpZ2F0aW9uU2VydmljZSxcbiAgICAgICAgRGlzYWJsZWRJdGVtc1NlcnZpY2UsXG4gICAgICAgIERhdGFTZXJ2aWNlLFxuICAgICAgICBOZ1pvbmUsXG4gICAgICAgIFJlbmRlcmVyMixcbiAgICAgICAgQ2hhbmdlRGV0ZWN0b3JSZWYsIEJvb2xlYW5dKVxuXSwgRHJvcERvd25MaXN0Q29tcG9uZW50KTtcblxuLyoqXG4gKiBSZW5kZXJzIHRoZSBjb250ZW50IG9mIHRoZSBjdXN0b20gbGlzdCBpdGVtIGluIHRoZSBNdWx0aVNlbGVjdFxuICogKFtzZWUgZXhhbXBsZV0oeyUgc2x1ZyB0ZW1wbGF0ZXNfbXVsdGlzZWxlY3QgJX0jdG9jLWN1c3RvbWl6aW5nLXRoZS1pdGVtLWNvbnRlbnQpKS5cbiAqIFRoZSB0ZW1wbGF0ZSBjb250ZXh0IGlzIHNldCB0byB0aGUgY3VycmVudCBjb21wb25lbnQuXG4gKiBUbyBnZXQgYSByZWZlcmVuY2UgdG8gdGhlIGN1cnJlbnQgdGV4dCB0aGF0IGlzIHR5cGVkIGJ5IHRoZVxuICogdXNlciwgdXNlIHRoZSBgbGV0LWN1c3RvbUl0ZW1gIGRpcmVjdGl2ZS5cbiAqXG4gKiA+IFRoZSBgQ3VzdG9tSXRlbVRlbXBsYXRlYCBkaXJlY3RpdmUgY2FuIG9ubHkgYmUgdXNlZCB3aXRoIHRoZSBNdWx0aVNlbGVjdCBjb21wb25lbnQuXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYHRzXG4gKiBfQENvbXBvbmVudCh7XG4gKiBzZWxlY3RvcjogJ215LWFwcCcsXG4gKiB0ZW1wbGF0ZTogYFxuICogIDxrZW5kby1tdWx0aXNlbGVjdCBbZGF0YV09XCJsaXN0SXRlbXNcIiBbYWxsb3dDdXN0b21dPVwidHJ1ZVwiPlxuICogICAgPG5nLXRlbXBsYXRlIGtlbmRvTXVsdGlTZWxlY3RDdXN0b21JdGVtVGVtcGxhdGUgbGV0LWN1c3RvbUl0ZW0+XG4gKiAgICAgIDxzcGFuPk5ldyBJdGVtOiB7e2N1c3RvbUl0ZW19fTwvc3Bhbj5cbiAqICAgIDwvbmctdGVtcGxhdGU+XG4gKiAgPC9rZW5kby1tdWx0aXNlbGVjdD5cbiAqIGBcbiAqIH0pXG4gKiBjbGFzcyBBcHBDb21wb25lbnQge1xuICogICBwdWJsaWMgbGlzdEl0ZW1zOiBBcnJheTxzdHJpbmc+ID0gW1wiSXRlbSAxXCIsIFwiSXRlbSAyXCIsIFwiSXRlbSAzXCIsIFwiSXRlbSA0XCJdO1xuICogfVxuICogYGBgXG4gKlxuICovXG5sZXQgQ3VzdG9tSXRlbVRlbXBsYXRlRGlyZWN0aXZlID0gY2xhc3MgQ3VzdG9tSXRlbVRlbXBsYXRlRGlyZWN0aXZlIHtcbiAgICBjb25zdHJ1Y3Rvcih0ZW1wbGF0ZVJlZikge1xuICAgICAgICB0aGlzLnRlbXBsYXRlUmVmID0gdGVtcGxhdGVSZWY7XG4gICAgfVxufTtcbkN1c3RvbUl0ZW1UZW1wbGF0ZURpcmVjdGl2ZSA9IF9fZGVjb3JhdGUoW1xuICAgIERpcmVjdGl2ZSh7XG4gICAgICAgIHNlbGVjdG9yOiAnW2tlbmRvTXVsdGlTZWxlY3RDdXN0b21JdGVtVGVtcGxhdGVdJ1xuICAgIH0pLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246cGFyYW10eXBlc1wiLCBbVGVtcGxhdGVSZWZdKVxuXSwgQ3VzdG9tSXRlbVRlbXBsYXRlRGlyZWN0aXZlKTtcblxuLyoqXG4gKiBSZW5kZXJzIHRoZSBzZWxlY3RlZCB0YWcgdmFsdWUgb2YgdGhlIE11bHRpU2VsZWN0XG4gKiAoW3NlZSBleGFtcGxlXSh7JSBzbHVnIHRlbXBsYXRlc19tdWx0aXNlbGVjdCAlfSN0b2MtdGFnLXRlbXBsYXRlKSkuXG4gKiBUaGUgdGVtcGxhdGUgY29udGV4dCBpcyBzZXQgdG8gdGhlIGN1cnJlbnQgY29tcG9uZW50LlxuICogVG8gZ2V0IGEgcmVmZXJlbmNlIHRvIHRoZSBjdXJyZW50IGRhdGEgaXRlbSwgdXNlIHRoZSBgbGV0LWRhdGFJdGVtYCBkaXJlY3RpdmUuXG4gKlxuICogPiBUaGUgYFRhZ1RlbXBsYXRlYCBkaXJlY3RpdmUgY2FuIG9ubHkgYmUgdXNlZCB3aXRoIHRoZSBNdWx0aVNlbGVjdCBhbmQgTXVsdGlTZWxlY3RUcmVlIGNvbXBvbmVudHMuXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYHRzXG4gKiBfQENvbXBvbmVudCh7XG4gKiBzZWxlY3RvcjogJ215LWFwcCcsXG4gKiB0ZW1wbGF0ZTogYFxuICogIDxrZW5kby1tdWx0aXNlbGVjdCBbZGF0YV09XCJpdGVtc1wiPlxuICogICAgPG5nLXRlbXBsYXRlIGtlbmRvTXVsdGlTZWxlY3RUYWdUZW1wbGF0ZSBsZXQtZGF0YUl0ZW0+XG4gKiAgICAgIDxzcGFuPnt7ZGF0YUl0ZW19fSBvcHRpb248L3NwYW4+XG4gKiAgICA8L25nLXRlbXBsYXRlPlxuICogIDwva2VuZG8tbXVsdGlzZWxlY3Q+XG4gKiBgXG4gKiB9KVxuICogY2xhc3MgQXBwQ29tcG9uZW50IHtcbiAqICAgcHVibGljIGl0ZW1zOiBBcnJheTxzdHJpbmc+ID0gW1wiSXRlbSAxXCIsIFwiSXRlbSAyXCIsIFwiSXRlbSAzXCIsIFwiSXRlbSA0XCJdO1xuICogfVxuICogYGBgXG4gKi9cbmxldCBUYWdUZW1wbGF0ZURpcmVjdGl2ZSA9IGNsYXNzIFRhZ1RlbXBsYXRlRGlyZWN0aXZlIHtcbiAgICBjb25zdHJ1Y3Rvcih0ZW1wbGF0ZVJlZikge1xuICAgICAgICB0aGlzLnRlbXBsYXRlUmVmID0gdGVtcGxhdGVSZWY7XG4gICAgfVxufTtcblRhZ1RlbXBsYXRlRGlyZWN0aXZlID0gX19kZWNvcmF0ZShbXG4gICAgRGlyZWN0aXZlKHtcbiAgICAgICAgc2VsZWN0b3I6ICdba2VuZG9NdWx0aVNlbGVjdFRhZ1RlbXBsYXRlXSxba2VuZG9NdWx0aVNlbGVjdFRyZWVUYWdUZW1wbGF0ZV0nXG4gICAgfSksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjpwYXJhbXR5cGVzXCIsIFtUZW1wbGF0ZVJlZl0pXG5dLCBUYWdUZW1wbGF0ZURpcmVjdGl2ZSk7XG5cbi8qKlxuICogUmVuZGVycyB0aGUgZ3JvdXBlZCB0YWcgdmFsdWVzIGluIHRoZSBNdWx0aVNlbGVjdFxuICogKFtzZWUgZXhhbXBsZV0oeyUgc2x1ZyBzdW1tYXJ5dGFnbW9kZV9tdWx0aXNlbGVjdCAlfSkpLlxuICogVGhlIHRlbXBsYXRlIGNvbnRleHQgaXMgc2V0IHRvIHRoZSBjdXJyZW50IGNvbXBvbmVudC5cbiAqIFRvIGdldCBhIHJlZmVyZW5jZSB0byB0aGUgY3VycmVudCBncm91cGVkXG4gKiBkYXRhIGl0ZW1zIGNvbGxlY3Rpb24sIHVzZSB0aGUgYGxldC1kYXRhSXRlbXNgIGRpcmVjdGl2ZS5cbiAqXG4gKiA+IFRoZSBgR3JvdXBUYWdUZW1wbGF0ZWAgZGlyZWN0aXZlIGNhbiBvbmx5IGJlIHVzZWQgd2l0aCB0aGUgTXVsdGlTZWxlY3QgYW5kIE11bHRpU2VsZWN0VHJlZSBjb21wb25lbnRzLlxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGB0c1xuICogX0BDb21wb25lbnQoe1xuICogc2VsZWN0b3I6ICdteS1hcHAnLFxuICogdGVtcGxhdGU6IGBcbiAqICA8a2VuZG8tbXVsdGlzZWxlY3Qga2VuZG9NdWx0aVNlbGVjdFN1bW1hcnlUYWcgW2RhdGFdPVwiaXRlbXNcIj5cbiAqICAgIDxuZy10ZW1wbGF0ZSBrZW5kb011bHRpU2VsZWN0R3JvdXBUYWdUZW1wbGF0ZSBsZXQtZGF0YUl0ZW1zPlxuICogICAgICA8c3Bhbj57e2RhdGFJdGVtcy5sZW5ndGh9fSBpdGVtKHMpIHNlbGVjdGVkPC9zcGFuPlxuICogICAgPC9uZy10ZW1wbGF0ZT5cbiAqICA8L2tlbmRvLW11bHRpc2VsZWN0PlxuICogYFxuICogfSlcbiAqIGNsYXNzIEFwcENvbXBvbmVudCB7XG4gKiAgIHB1YmxpYyBpdGVtczogQXJyYXk8c3RyaW5nPiA9IFtcIkl0ZW0gMVwiLCBcIkl0ZW0gMlwiLCBcIkl0ZW0gM1wiLCBcIkl0ZW0gNFwiXTtcbiAqIH1cbiAqIGBgYFxuICovXG5sZXQgR3JvdXBUYWdUZW1wbGF0ZURpcmVjdGl2ZSA9IGNsYXNzIEdyb3VwVGFnVGVtcGxhdGVEaXJlY3RpdmUge1xuICAgIGNvbnN0cnVjdG9yKHRlbXBsYXRlUmVmKSB7XG4gICAgICAgIHRoaXMudGVtcGxhdGVSZWYgPSB0ZW1wbGF0ZVJlZjtcbiAgICB9XG59O1xuR3JvdXBUYWdUZW1wbGF0ZURpcmVjdGl2ZSA9IF9fZGVjb3JhdGUoW1xuICAgIERpcmVjdGl2ZSh7XG4gICAgICAgIHNlbGVjdG9yOiAnW2tlbmRvTXVsdGlTZWxlY3RHcm91cFRhZ1RlbXBsYXRlXSxba2VuZG9NdWx0aVNlbGVjdFRyZWVHcm91cFRhZ1RlbXBsYXRlXSdcbiAgICB9KSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnBhcmFtdHlwZXNcIiwgW1RlbXBsYXRlUmVmXSlcbl0sIEdyb3VwVGFnVGVtcGxhdGVEaXJlY3RpdmUpO1xuXG4vKipcbiAqIEFyZ3VtZW50cyBmb3IgdGhlIGByZW1vdmVUYWdgIGV2ZW50LiBUaGUgYHJlbW92ZVRhZ2AgZXZlbnQgZmlyZXMgd2hlbiBhIHRhZyBpcyBhYm91dFxuICogdG8gdGhlIHJlbW92ZWQuIElmIHlvdSBjYW5jZWwgdGhlIGV2ZW50LCB0aGUgcmVtb3ZhbCBpcyBwcmV2ZW50ZWQuXG4gKi9cbmNsYXNzIFJlbW92ZVRhZ0V2ZW50IGV4dGVuZHMgUHJldmVudGFibGVFdmVudCB7XG4gICAgLyoqXG4gICAgICogQ29uc3RydWN0cyB0aGUgZXZlbnQgYXJndW1lbnRzIGZvciB0aGUgYHJlbW92ZWAgZXZlbnQuXG4gICAgICogQHBhcmFtIGRhdGFJdGVtIC0gVGhlIGRhdGEgaXRlbSBvciBhbiBhcnJheSBvZiBkYXRhIGl0ZW1zIHRoYXQgd2lsbCBiZSByZW1vdmVkLlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKGRhdGFJdGVtKSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMuZGF0YUl0ZW0gPSBkYXRhSXRlbTtcbiAgICB9XG59XG5cbi8qKlxuICogQGhpZGRlblxuICovXG5jb25zdCBub3JtYWxpemVDaGVja2JveGVzU2V0dGluZ3MgPSAoc2V0dGluZ3MpID0+IHtcbiAgICBpZiAoaXNPYmplY3Qoc2V0dGluZ3MpKSB7XG4gICAgICAgIGNvbnN0IGRlZmF1bHRTZXR0aW5ncyA9IHsgZW5hYmxlZDogdHJ1ZSwgY2hlY2tPbkNsaWNrOiB0cnVlIH07XG4gICAgICAgIHJldHVybiBPYmplY3QuYXNzaWduKHt9LCBkZWZhdWx0U2V0dGluZ3MsIHNldHRpbmdzKTtcbiAgICB9XG4gICAgcmV0dXJuIHsgZW5hYmxlZDogQm9vbGVhbihzZXR0aW5ncyksIGNoZWNrT25DbGljazogdHJ1ZSB9O1xufTtcblxuLyogdHNsaW50OmRpc2FibGU6bWVtYmVyLW9yZGVyaW5nICovXG52YXIgTXVsdGlTZWxlY3RDb21wb25lbnRfMTtcbmNvbnN0IE1VTFRJU0VMRUNUX1ZBTFVFX0FDQ0VTU09SID0ge1xuICAgIG11bHRpOiB0cnVlLFxuICAgIHByb3ZpZGU6IE5HX1ZBTFVFX0FDQ0VTU09SLFxuICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpuby11c2UtYmVmb3JlLWRlY2xhcmVcbiAgICB1c2VFeGlzdGluZzogZm9yd2FyZFJlZigoKSA9PiBNdWx0aVNlbGVjdENvbXBvbmVudClcbn07XG4vKipcbiAqIFJlcHJlc2VudHMgdGhlIFtLZW5kbyBVSSBNdWx0aVNlbGVjdCBjb21wb25lbnQgZm9yIEFuZ3VsYXJdKHslIHNsdWcgb3ZlcnZpZXdfbXVsdGlzZWxlY3QgJX0pLlxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGB0c1xuICogX0BDb21wb25lbnQoe1xuICogc2VsZWN0b3I6ICdteS1hcHAnLFxuICogdGVtcGxhdGU6IGBcbiAqICA8a2VuZG8tbXVsdGlzZWxlY3QgW2RhdGFdPVwibGlzdEl0ZW1zXCI+XG4gKiAgPC9rZW5kby1tdWx0aXNlbGVjdD5cbiAqIGBcbiAqIH0pXG4gKiBjbGFzcyBBcHBDb21wb25lbnQge1xuICogICBwdWJsaWMgbGlzdEl0ZW1zOiBBcnJheTxzdHJpbmc+ID0gW1wiSXRlbSAxXCIsIFwiSXRlbSAyXCIsIFwiSXRlbSAzXCIsIFwiSXRlbSA0XCJdO1xuICogfVxuICogYGBgXG4gKi9cbmxldCBNdWx0aVNlbGVjdENvbXBvbmVudCA9IE11bHRpU2VsZWN0Q29tcG9uZW50XzEgPSBjbGFzcyBNdWx0aVNlbGVjdENvbXBvbmVudCB7XG4gICAgY29uc3RydWN0b3Iod3JhcHBlciwgbG9jYWxpemF0aW9uLCBwb3B1cFNlcnZpY2UsIGRhdGFTZXJ2aWNlLCBzZWxlY3Rpb25TZXJ2aWNlLCBuYXZpZ2F0aW9uU2VydmljZSwgZGlzYWJsZWRJdGVtc1NlcnZpY2UsIGNkciwgZGlmZmVycywgcmVuZGVyZXIsIF96b25lLCB0b3VjaEVuYWJsZWQkJDEpIHtcbiAgICAgICAgdGhpcy53cmFwcGVyID0gd3JhcHBlcjtcbiAgICAgICAgdGhpcy5sb2NhbGl6YXRpb24gPSBsb2NhbGl6YXRpb247XG4gICAgICAgIHRoaXMucG9wdXBTZXJ2aWNlID0gcG9wdXBTZXJ2aWNlO1xuICAgICAgICB0aGlzLmRhdGFTZXJ2aWNlID0gZGF0YVNlcnZpY2U7XG4gICAgICAgIHRoaXMuc2VsZWN0aW9uU2VydmljZSA9IHNlbGVjdGlvblNlcnZpY2U7XG4gICAgICAgIHRoaXMubmF2aWdhdGlvblNlcnZpY2UgPSBuYXZpZ2F0aW9uU2VydmljZTtcbiAgICAgICAgdGhpcy5kaXNhYmxlZEl0ZW1zU2VydmljZSA9IGRpc2FibGVkSXRlbXNTZXJ2aWNlO1xuICAgICAgICB0aGlzLmNkciA9IGNkcjtcbiAgICAgICAgdGhpcy5kaWZmZXJzID0gZGlmZmVycztcbiAgICAgICAgdGhpcy5yZW5kZXJlciA9IHJlbmRlcmVyO1xuICAgICAgICB0aGlzLl96b25lID0gX3pvbmU7XG4gICAgICAgIHRoaXMudG91Y2hFbmFibGVkID0gdG91Y2hFbmFibGVkJCQxO1xuICAgICAgICB0aGlzLmxpc3RCb3hJZCA9IGd1aWQkMSgpO1xuICAgICAgICB0aGlzLnRhZ0xpc3RJZCA9IGd1aWQkMSgpO1xuICAgICAgICB0aGlzLnRhZ1ByZWZpeCA9IFwidGFnLVwiICsgZ3VpZCQxKCk7XG4gICAgICAgIHRoaXMub3B0aW9uUHJlZml4ID0gXCJvcHRpb24tXCIgKyBndWlkJDEoKTtcbiAgICAgICAgdGhpcy5mb2N1c2VkVGFnSW5kZXggPSB1bmRlZmluZWQ7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAaGlkZGVuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmZvY3VzYWJsZUlkID0gYGstJHtndWlkJDEoKX1gO1xuICAgICAgICAvKipcbiAgICAgICAgICogRGV0ZXJtaW5lcyB3aGV0aGVyIHRvIGNsb3NlIHRoZSBvcHRpb25zIGxpc3Qgb2YgdGhlIE11bHRpU2VsZWN0IGFmdGVyIHRoZSBpdGVtIHNlbGVjdGlvbiBpcyBmaW5pc2hlZFxuICAgICAgICAgKiAoW3NlZSBleGFtcGxlXSh7JSBzbHVnIG9wZW5zdGF0ZV9tdWx0aXNlbGVjdCAlfSN0b2Mta2VlcGluZy10aGUtb3B0aW9ucy1saXN0LW9wZW4td2hpbGUtb24tZm9jdXMpKS5cbiAgICAgICAgICogQGRlZmF1bHQgdHJ1ZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5hdXRvQ2xvc2UgPSB0cnVlO1xuICAgICAgICAvKipcbiAgICAgICAgICogU3BlY2lmaWVzIHRoZSBbYHRhYmluZGV4YF0oaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvSFRNTC9HbG9iYWxfYXR0cmlidXRlcy90YWJpbmRleCkgb2YgdGhlIGNvbXBvbmVudC5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMudGFiaW5kZXggPSAwO1xuICAgICAgICAvKipcbiAgICAgICAgICogU2V0cyB0aGUgZGlzYWJsZWQgc3RhdGUgb2YgdGhlIGNvbXBvbmVudC5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuZGlzYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFNldHMgdGhlIHJlYWQtb25seSBzdGF0ZSBvZiB0aGUgY29tcG9uZW50LlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5yZWFkb25seSA9IGZhbHNlO1xuICAgICAgICAvKipcbiAgICAgICAgICogRW5hYmxlcyB0aGUgW2ZpbHRlcmluZ10oeyUgc2x1ZyBmaWx0ZXJpbmdfbXVsdGlzZWxlY3QgJX0pIGZ1bmN0aW9uYWxpdHkgb2YgdGhlIE11bHRpU2VsZWN0LlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5maWx0ZXJhYmxlID0gZmFsc2U7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBTZXRzIHRoZSBoZWlnaHQgb2YgdGhlIHN1Z2dlc3Rpb25zIGxpc3QuIEJ5IGRlZmF1bHQsIGBsaXN0SGVpZ2h0YCBpcyAyMDBweC5cbiAgICAgICAgICpcbiAgICAgICAgICogPiBUaGUgYGxpc3RIZWlnaHRgIHByb3BlcnR5IGFmZmVjdHMgb25seSB0aGUgbGlzdCBvZiBzdWdnZXN0aW9ucyBhbmQgbm90IHRoZSB3aG9sZSBwb3B1cCBjb250YWluZXIuXG4gICAgICAgICAqID4gVG8gc2V0IHRoZSBoZWlnaHQgb2YgdGhlIHBvcHVwIGNvbnRhaW5lciwgdXNlIGBwb3B1cFNldHRpbmdzLmhlaWdodGAuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmxpc3RIZWlnaHQgPSAyMDA7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBJZiBzZXQgdG8gYHRydWVgLCByZW5kZXJzIGEgYnV0dG9uIG9uIGhvdmVyaW5nIG92ZXIgdGhlIGNvbXBvbmVudC5cbiAgICAgICAgICogQ2xpY2tpbmcgdGhpcyBidXR0b24gcmVzZXRzIHRoZSB2YWx1ZSBvZiB0aGUgY29tcG9uZW50IHRvIGFuIGVtcHR5IGFycmF5IGFuZCB0cmlnZ2VycyB0aGUgYGNoYW5nZWAgZXZlbnQuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmNsZWFyQnV0dG9uID0gdHJ1ZTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEEgdXNlci1kZWZpbmVkIGNhbGxiYWNrIGZ1bmN0aW9uIHdoaWNoIHJlY2VpdmVzIGFuIGFycmF5IG9mIHNlbGVjdGVkIGRhdGEgaXRlbXMgYW5kIG1hcHMgdGhlbSB0byBhbiBhcnJheSBvZiB0YWdzXG4gICAgICAgICAqIChbc2VlIGV4YW1wbGVzXSh7JSBzbHVnIHN1bW1hcnl0YWdtb2RlX211bHRpc2VsZWN0ICV9I3RvYy1yZW5kZXJpbmctb2YtdGFncykpLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAcGFyYW0geyBBbnlbXSB9IGRhdGFJdGVtcyAtIFRoZSBzZWxlY3RlZCBkYXRhIGl0ZW1zIGZyb20gdGhlIGxpc3QuXG4gICAgICAgICAqIEByZXR1cm5zIHsgQW55W10gfSAtIFRoZSB0YWdzIHRoYXQgd2lsbCBiZSByZW5kZXJlZCBieSB0aGUgY29tcG9uZW50LlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy50YWdNYXBwZXIgPSAodGFncykgPT4gdGFncyB8fCBbXTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFNwZWNpZmllcyB3aGV0aGVyIHRoZSBNdWx0aVNlbGVjdCBhbGxvd3MgdXNlci1kZWZpbmVkIHZhbHVlcyB0aGF0IGFyZSBub3QgcHJlc2VudCBpbiB0aGUgZGF0YXNldFxuICAgICAgICAgKiAoW21vcmUgaW5mb3JtYXRpb24gYW5kIGV4YW1wbGVzXSh7JSBzbHVnIGN1c3RvbV92YWx1ZXNfbXVsdGlzZWxlY3QgJX0pKS5cbiAgICAgICAgICogRGVmYXVsdHMgdG8gYGZhbHNlYC5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuYWxsb3dDdXN0b20gPSBmYWxzZTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEEgdXNlci1kZWZpbmVkIGNhbGxiYWNrIGZ1bmN0aW9uIHdoaWNoIHJldHVybnMgbm9ybWFsaXplZCBjdXN0b20gdmFsdWVzLlxuICAgICAgICAgKiBUeXBpY2FsbHkgdXNlZCB3aGVuIHRoZSBkYXRhIGl0ZW1zIGFyZSBkaWZmZXJlbnQgZnJvbSB0eXBlIGBzdHJpbmdgLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAcGFyYW0geyBBbnkgfSB2YWx1ZSAtIFRoZSBjdXN0b20gdmFsdWUgdGhhdCBpcyBkZWZpbmVkIGJ5IHRoZSB1c2VyLlxuICAgICAgICAgKiBAcmV0dXJucyB7IEFueSB9XG4gICAgICAgICAqXG4gICAgICAgICAqIEBleGFtcGxlXG4gICAgICAgICAqIGBgYHRzXG4gICAgICAgICAqIGltcG9ydCB7IG1hcCB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcbiAgICAgICAgICpcbiAgICAgICAgICogX0BDb21wb25lbnQoe1xuICAgICAgICAgKiBzZWxlY3RvcjogJ215LWFwcCcsXG4gICAgICAgICAqIHRlbXBsYXRlOiBgXG4gICAgICAgICAqICAgPGtlbmRvLW11bHRpc2VsZWN0XG4gICAgICAgICAqICAgICAgIFthbGxvd0N1c3RvbV09XCJ0cnVlXCJcbiAgICAgICAgICogICAgICAgW2RhdGFdPVwibGlzdEl0ZW1zXCJcbiAgICAgICAgICogICAgICAgdGV4dEZpZWxkPVwidGV4dFwiXG4gICAgICAgICAqICAgICAgIHZhbHVlRmllbGQ9XCJ2YWx1ZVwiXG4gICAgICAgICAqICAgICAgIFt2YWx1ZU5vcm1hbGl6ZXJdPVwidmFsdWVOb3JtYWxpemVyXCJcbiAgICAgICAgICogICAgICAgKHZhbHVlQ2hhbmdlKT1cIm9uVmFsdWVDaGFuZ2UoJGV2ZW50KVwiXG4gICAgICAgICAqICAgPlxuICAgICAgICAgKiAgIDwva2VuZG8tbXVsdGlzZWxlY3Q+XG4gICAgICAgICAqIGBcbiAgICAgICAgICogfSlcbiAgICAgICAgICpcbiAgICAgICAgICogY2xhc3MgQXBwQ29tcG9uZW50IHtcbiAgICAgICAgICogICBwdWJsaWMgbGlzdEl0ZW1zOiBBcnJheTx7IHRleHQ6IHN0cmluZywgdmFsdWU6IG51bWJlciB9PiA9IFtcbiAgICAgICAgICogICAgICAgeyB0ZXh0OiBcIlNtYWxsXCIsIHZhbHVlOiAxIH0sXG4gICAgICAgICAqICAgICAgIHsgdGV4dDogXCJNZWRpdW1cIiwgdmFsdWU6IDIgfSxcbiAgICAgICAgICogICAgICAgeyB0ZXh0OiBcIkxhcmdlXCIsIHZhbHVlOiAzIH1cbiAgICAgICAgICogICBdO1xuICAgICAgICAgKlxuICAgICAgICAgKiAgIHB1YmxpYyBvblZhbHVlQ2hhbmdlKHZhbHVlKSB7XG4gICAgICAgICAqICAgICAgIGNvbnNvbGUubG9nKFwidmFsdWVDaGFuZ2UgOiBcIiwgdmFsdWUpO1xuICAgICAgICAgKiAgIH1cbiAgICAgICAgICpcbiAgICAgICAgICogICBwdWJsaWMgdmFsdWVOb3JtYWxpemVyID0gKHRleHQkOiBPYnNlcnZhYmxlPHN0cmluZz4pID0+IHRleHQkLnBpcGUobWFwKCh0ZXh0OiBzdHJpbmcpID0+IHtcbiAgICAgICAgICogICAgICByZXR1cm4ge1xuICAgICAgICAgKiAgICAgICAgIHZhbHVlOiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAoMTAwMCAtIDEwMCkgKyAxMDAwKSwgLy9nZW5lcmF0ZSB1bmlxdWUgdmFsdWVGaWVsZFxuICAgICAgICAgKiAgICAgICAgIHRleHQ6IHRleHQgfTtcbiAgICAgICAgICogICB9KSk7XG4gICAgICAgICAqXG4gICAgICAgICAqIH1cbiAgICAgICAgICogYGBgXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnZhbHVlTm9ybWFsaXplciA9ICh0ZXh0KSA9PiB0ZXh0LnBpcGUobWFwKCh1c2VySW5wdXQpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGNvbXBhcmVyID0gKGl0ZW0pID0+IHR5cGVvZiBpdGVtID09PSAnc3RyaW5nJyAmJiB1c2VySW5wdXQudG9Mb3dlckNhc2UoKSA9PT0gaXRlbS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgY29uc3QgbWF0Y2hpbmdWYWx1ZSA9IHRoaXMudmFsdWUuZmluZChjb21wYXJlcik7XG4gICAgICAgICAgICBpZiAobWF0Y2hpbmdWYWx1ZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBtYXRjaGluZ1ZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgbWF0Y2hpbmdJdGVtID0gdGhpcy5kYXRhU2VydmljZS5maW5kKGNvbXBhcmVyKTtcbiAgICAgICAgICAgIHJldHVybiBtYXRjaGluZ0l0ZW0gPyBtYXRjaGluZ0l0ZW0gOiB1c2VySW5wdXQ7XG4gICAgICAgIH0pKTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEZpcmVzIGVhY2ggdGltZSB0aGUgdXNlciB0eXBlcyBpbiB0aGUgaW5wdXQgZmllbGQuXG4gICAgICAgICAqIFlvdSBjYW4gZmlsdGVyIHRoZSBzb3VyY2UgYmFzZWQgb24gdGhlIHBhc3NlZCBmaWx0cmF0aW9uIHZhbHVlLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5maWx0ZXJDaGFuZ2UgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBGaXJlcyBlYWNoIHRpbWUgdGhlIHZhbHVlIGlzIGNoYW5nZWQmbWRhc2g7XG4gICAgICAgICAqIHdoZW4gdGhlIGNvbXBvbmVudCBpcyBibHVycmVkIG9yIHRoZSB2YWx1ZSBpcyBjbGVhcmVkIHRocm91Z2ggdGhlICoqQ2xlYXIqKiBidXR0b25cbiAgICAgICAgICogKFtzZWUgZXhhbXBsZV0oeyUgc2x1ZyBvdmVydmlld19tdWx0aXNlbGVjdCAlfSN0b2MtZXZlbnRzKSkuXG4gICAgICAgICAqIFdoZW4gdGhlIHZhbHVlIG9mIHRoZSBjb21wb25lbnQgaXMgcHJvZ3JhbW1hdGljYWxseSBjaGFuZ2VkIHRvIGBuZ01vZGVsYCBvciBgZm9ybUNvbnRyb2xgXG4gICAgICAgICAqIHRocm91Z2ggaXRzIEFQSSBvciBmb3JtIGJpbmRpbmcsIHRoZSBgdmFsdWVDaGFuZ2VgIGV2ZW50IGlzIG5vdCB0cmlnZ2VyZWQgYmVjYXVzZSBpdFxuICAgICAgICAgKiBtaWdodCBjYXVzZSBhIG1peC11cCB3aXRoIHRoZSBidWlsdC1pbiBgdmFsdWVDaGFuZ2VgIG1lY2hhbmlzbXMgb2YgdGhlIGBuZ01vZGVsYCBvciBgZm9ybUNvbnRyb2xgIGJpbmRpbmdzLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy52YWx1ZUNoYW5nZSA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEZpcmVzIGVhY2ggdGltZSB0aGUgcG9wdXAgaXMgYWJvdXQgdG8gb3BlblxuICAgICAgICAgKiAoW3NlZSBleGFtcGxlXSh7JSBzbHVnIG9wZW5zdGF0ZV9tdWx0aXNlbGVjdCAlfSN0b2MtcHJldmVudGluZy1vcGVuaW5nLWFuZC1jbG9zaW5nKSkuXG4gICAgICAgICAqIFRoaXMgZXZlbnQgaXMgcHJldmVudGFibGUuIElmIHlvdSBjYW5jZWwgaXQsIHRoZSBwb3B1cCB3aWxsIHJlbWFpbiBjbG9zZWQuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLm9wZW4gPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBGaXJlcyBhZnRlciB0aGUgcG9wdXAgaGFzIGJlZW4gb3BlbmVkLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5vcGVuZWQgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBGaXJlcyBlYWNoIHRpbWUgdGhlIHBvcHVwIGlzIGFib3V0IHRvIGNsb3NlXG4gICAgICAgICAqIChbc2VlIGV4YW1wbGVdKHslIHNsdWcgb3BlbnN0YXRlX211bHRpc2VsZWN0ICV9I3RvYy1wcmV2ZW50aW5nLW9wZW5pbmctYW5kLWNsb3NpbmcpKS5cbiAgICAgICAgICogVGhpcyBldmVudCBpcyBwcmV2ZW50YWJsZS4gSWYgeW91IGNhbmNlbCBpdCwgdGhlIHBvcHVwIHdpbGwgcmVtYWluIG9wZW4uXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmNsb3NlID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICAgICAgICAvKipcbiAgICAgICAgICogRmlyZXMgYWZ0ZXIgdGhlIHBvcHVwIGhhcyBiZWVuIGNsb3NlZC5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuY2xvc2VkID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICAgICAgICAvKipcbiAgICAgICAgICogRmlyZXMgZWFjaCB0aW1lIHRoZSB1c2VyIGZvY3VzZXMgdGhlIE11bHRpU2VsZWN0LlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5vbkZvY3VzID0gbmV3IEV2ZW50RW1pdHRlcigpOyAvL3RzbGludDpkaXNhYmxlLWxpbmU6bm8tb3V0cHV0LXJlbmFtZVxuICAgICAgICAvKipcbiAgICAgICAgICogRmlyZXMgZWFjaCB0aW1lIHRoZSBNdWx0aVNlbGVjdCBnZXRzIGJsdXJyZWQuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLm9uQmx1ciA9IG5ldyBFdmVudEVtaXR0ZXIoKTsgLy90c2xpbnQ6ZGlzYWJsZS1saW5lOm5vLW91dHB1dC1yZW5hbWVcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEZpcmVzIGVhY2ggdGltZSBhIHRhZyBpcyBhYm91dCB0byBiZSByZW1vdmVkLlxuICAgICAgICAgKiBUaGlzIGV2ZW50IGlzIHByZXZlbnRhYmxlLiBJZiB5b3UgY2FuY2VsIGl0LCB0aGUgdGFnIHdpbGwgbm90IGJlIHJlbW92ZWQuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnJlbW92ZVRhZyA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcbiAgICAgICAgdGhpcy5ob3N0Q2xhc3NlcyA9IHRydWU7XG4gICAgICAgIHRoaXMucm9sZSA9ICdjb21ib2JveCc7XG4gICAgICAgIHRoaXMuaW5pdGlhbGl6ZWQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5fc2l6ZSA9ICdtZWRpdW0nO1xuICAgICAgICB0aGlzLl9yb3VuZGVkID0gJ21lZGl1bSc7XG4gICAgICAgIHRoaXMuX2ZpbGxNb2RlID0gJ3NvbGlkJztcbiAgICAgICAgdGhpcy5vbkNoYW5nZUNhbGxiYWNrID0gKF8pID0+IHsgfTtcbiAgICAgICAgdGhpcy5vblRvdWNoZWRDYWxsYmFjayA9IChfKSA9PiB7IH07XG4gICAgICAgIHRoaXMuX3BsYWNlaG9sZGVyID0gJyc7XG4gICAgICAgIHRoaXMuX29wZW4gPSBmYWxzZTtcbiAgICAgICAgdGhpcy5fdmFsdWUgPSBbXTtcbiAgICAgICAgdGhpcy5fcG9wdXBTZXR0aW5ncyA9IHsgYW5pbWF0ZTogdHJ1ZSB9O1xuICAgICAgICB0aGlzLl9jaGVja2JveGVzID0geyBlbmFibGVkOiBmYWxzZSB9O1xuICAgICAgICB0aGlzLl9pc0ZvY3VzZWQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5zZWxlY3RlZERhdGFJdGVtcyA9IFtdO1xuICAgICAgICB0aGlzLmN1c3RvbVZhbHVlU3ViamVjdCA9IG5ldyBTdWJqZWN0KCk7XG4gICAgICAgIHRoaXMub2JzZXJ2YWJsZVN1YnNjcmlwdGlvbnMgPSBuZXcgU3Vic2NyaXB0aW9uKCk7XG4gICAgICAgIHZhbGlkYXRlUGFja2FnZShwYWNrYWdlTWV0YWRhdGEpO1xuICAgICAgICB0aGlzLnBvcHVwTW91c2VEb3duSGFuZGxlciA9IHRoaXMub25Nb3VzZURvd24uYmluZCh0aGlzKTtcbiAgICAgICAgdGhpcy5kYXRhID0gW107XG4gICAgICAgIHRoaXMuZGlyZWN0aW9uID0gdGhpcy5sb2NhbGl6YXRpb24ucnRsID8gJ3J0bCcgOiAnbHRyJztcbiAgICAgICAgdGhpcy5zdWJzY3JpYmVFdmVudHMoKTtcbiAgICAgICAgdGhpcy5zdWJzY3JpYmVUb3VjaEV2ZW50cygpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBGb2N1c2VzIGEgc3BlY2lmaWMgaXRlbSBvZiB0aGUgTXVsdGlTZWxlY3QgYmFzZWQgb24gYSBwcm92aWRlZCBpbmRleC5cbiAgICAgKiBJZiB0aGVyZSBpcyBhIGN1c3RvbSBpdGVtIGl0IGlzIHBvc2l0aW9uZWQgYXQgaW5kZXggLTEuXG4gICAgICogSWYgbnVsbCBvciBpbnZhbGlkIGluZGV4IGlzIHByb3ZpZGVkIHRoZSBmb2N1cyB3aWxsIGJlIHJlbW92ZWQuXG4gICAgICovXG4gICAgZm9jdXNJdGVtQXQoaW5kZXgpIHtcbiAgICAgICAgY29uc3QgbWluSW5kZXggPSB0aGlzLmFsbG93Q3VzdG9tID8gLTEgOiAwO1xuICAgICAgICBjb25zdCBpc0luUmFuZ2UgPSBtaW5JbmRleCA8PSAwICYmIGluZGV4IDwgdGhpcy5kYXRhLmxlbmd0aDtcbiAgICAgICAgaWYgKGlzUHJlc2VudChpbmRleCkgJiYgaXNJblJhbmdlICYmICF0aGlzLmRpc2FibGVkSXRlbXNTZXJ2aWNlLmlzSW5kZXhEaXNhYmxlZChpbmRleCkpIHtcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0aW9uU2VydmljZS5mb2N1cyhpbmRleCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdGlvblNlcnZpY2UuZm9jdXMobnVsbCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogRm9jdXNlcyB0aGUgTXVsdGlTZWxlY3QuXG4gICAgICovXG4gICAgZm9jdXMoKSB7XG4gICAgICAgIGlmICghdGhpcy5kaXNhYmxlZCkge1xuICAgICAgICAgICAgdGhpcy5zZWFyY2hiYXIuZm9jdXMoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgb25TZWFyY2hCYXJGb2N1cygpIHtcbiAgICAgICAgaWYgKCF0aGlzLmlzRm9jdXNlZCkge1xuICAgICAgICAgICAgdGhpcy5pc0ZvY3VzZWQgPSB0cnVlO1xuICAgICAgICAgICAgaWYgKGhhc09ic2VydmVycyh0aGlzLm9uRm9jdXMpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fem9uZS5ydW4oKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm9uRm9jdXMuZW1pdCgpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEJsdXJzIHRoZSBNdWx0aVNlbGVjdC5cbiAgICAgKi9cbiAgICBibHVyKCkge1xuICAgICAgICBpZiAoIXRoaXMuZGlzYWJsZWQpIHtcbiAgICAgICAgICAgIHRoaXMuc2VhcmNoYmFyLmJsdXIoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgb25TZWFyY2hCYXJCbHVyKCkge1xuICAgICAgICBpZiAoIXRoaXMuaXNGb2N1c2VkKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5pc0ZvY3VzZWQgPSBmYWxzZTtcbiAgICAgICAgaWYgKGhhc09ic2VydmVycyh0aGlzLm9uQmx1cikgfHxcbiAgICAgICAgICAgIGhhc09ic2VydmVycyh0aGlzLmZpbHRlckNoYW5nZSkgfHxcbiAgICAgICAgICAgIGhhc09ic2VydmVycyh0aGlzLmNsb3NlKSB8fFxuICAgICAgICAgICAgaXNVbnRvdWNoZWQodGhpcy53cmFwcGVyLm5hdGl2ZUVsZW1lbnQpKSB7XG4gICAgICAgICAgICB0aGlzLl96b25lLnJ1bigoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5jbG9zZVBvcHVwKCk7XG4gICAgICAgICAgICAgICAgaWYgKCEodGhpcy5pc09wZW4gJiYgdGhpcy5hbGxvd0N1c3RvbSkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jbGVhckZpbHRlcigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLm9uQmx1ci5lbWl0KCk7XG4gICAgICAgICAgICAgICAgdGhpcy5vblRvdWNoZWRDYWxsYmFjaygpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuYWxsb3dDdXN0b20pIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNsZWFyRmlsdGVyKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmNsb3NlUG9wdXAoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgb25Nb3VzZURvd24oZXZlbnQpIHtcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIG9uUmVzaXplKCkge1xuICAgICAgICBpZiAodGhpcy5fb3Blbikge1xuICAgICAgICAgICAgY29uc3QgcG9wdXBXcmFwcGVyID0gdGhpcy5wb3B1cFJlZi5wb3B1cEVsZW1lbnQ7XG4gICAgICAgICAgICBjb25zdCB7IG1pbiwgbWF4IH0gPSB0aGlzLndpZHRoO1xuICAgICAgICAgICAgcG9wdXBXcmFwcGVyLnN0eWxlLm1pbldpZHRoID0gbWluO1xuICAgICAgICAgICAgcG9wdXBXcmFwcGVyLnN0eWxlLndpZHRoID0gbWF4O1xuICAgICAgICB9XG4gICAgfVxuICAgIGdldCBhcHBlbmRUbygpIHtcbiAgICAgICAgY29uc3QgeyBhcHBlbmRUbyB9ID0gdGhpcy5wb3B1cFNldHRpbmdzO1xuICAgICAgICBpZiAoIWFwcGVuZFRvIHx8IGFwcGVuZFRvID09PSAncm9vdCcpIHtcbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGFwcGVuZFRvID09PSAnY29tcG9uZW50JyA/IHRoaXMuY29udGFpbmVyIDogYXBwZW5kVG87XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNldHMgdGhlIGRhdGEgb2YgdGhlIE11bHRpU2VsZWN0LlxuICAgICAqXG4gICAgICogPiBUaGUgZGF0YSBoYXMgdG8gYmUgcHJvdmlkZWQgaW4gYW4gYXJyYXktbGlrZSBsaXN0IG9mIGl0ZW1zLlxuICAgICAqL1xuICAgIHNldCBkYXRhKGRhdGEpIHtcbiAgICAgICAgdGhpcy5kYXRhU2VydmljZS5kYXRhID0gZGF0YSB8fCBbXTtcbiAgICAgICAgaWYgKHRoaXMudmlydHVhbCkge1xuICAgICAgICAgICAgdGhpcy52aXJ0dWFsLnNraXAgPSAwO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmluaXRpYWxpemVkKSB7XG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKHRoaXMudmFsdWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGdldCBkYXRhKCkge1xuICAgICAgICBjb25zdCB2aXJ0dWFsID0gdGhpcy52aXJ0dWFsO1xuICAgICAgICBpZiAodmlydHVhbCkge1xuICAgICAgICAgICAgY29uc3Qgc3RhcnQgPSB2aXJ0dWFsLnNraXAgfHwgMDtcbiAgICAgICAgICAgIGNvbnN0IGVuZCA9IHN0YXJ0ICsgdmlydHVhbC5wYWdlU2l6ZTtcbiAgICAgICAgICAgIC8vVXNlIGxlbmd0aCBpbnN0ZWFkIG9mIGl0ZW1zQ291bnQgYmVjYXVzZSBvZiBncm91cGluZ1xuICAgICAgICAgICAgdmlydHVhbC50b3RhbCA9IHRoaXMuZGF0YVNlcnZpY2UuZGF0YS5sZW5ndGg7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5kYXRhU2VydmljZS5kYXRhLnNsaWNlKHN0YXJ0LCBlbmQpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLmRhdGFTZXJ2aWNlLmRhdGE7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNldHMgdGhlIHZhbHVlIG9mIHRoZSBNdWx0aVNlbGVjdC4gSXQgY2FuIGJlIGVpdGhlciBvZiB0aGUgcHJpbWl0aXZlIChzdHJpbmcsIG51bWJlcnMpIG9yIG9mIHRoZSBjb21wbGV4IChvYmplY3RzKSB0eXBlLlxuICAgICAqIFRvIGRlZmluZSB0aGUgdHlwZSwgdXNlIHRoZSBgdmFsdWVQcmltaXRpdmVgIG9wdGlvbi5cbiAgICAgKlxuICAgICAqID4gQWxsIHNlbGVjdGVkIHZhbHVlcyB3aGljaCBhcmUgbm90IHByZXNlbnQgaW4gdGhlIHNvdXJjZSBhcmUgaWdub3JlZC5cbiAgICAgKi9cbiAgICBzZXQgdmFsdWUodmFsdWVzKSB7XG4gICAgICAgIHRoaXMuX3ZhbHVlID0gdmFsdWVzID8gdmFsdWVzIDogW107XG4gICAgICAgIGlmICghdGhpcy5kaWZmZXIgJiYgdGhpcy52YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5kaWZmZXIgPSB0aGlzLmRpZmZlcnMuZmluZCh0aGlzLnZhbHVlKS5jcmVhdGUoKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnZhbHVlQ2hhbmdlRGV0ZWN0ZWQgPSB0cnVlO1xuICAgICAgICBpZiAodGhpcy5pbml0aWFsaXplZCkge1xuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh0aGlzLnZhbHVlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBnZXQgdmFsdWUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl92YWx1ZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIHNldCB0YWJJbmRleCh0YWJJbmRleCkge1xuICAgICAgICB0aGlzLnRhYmluZGV4ID0gdGFiSW5kZXg7XG4gICAgfVxuICAgIGdldCB0YWJJbmRleCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudGFiaW5kZXg7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNldHMgdGhlIHNpemUgb2YgdGhlIGNvbXBvbmVudC5cbiAgICAgKlxuICAgICAqIFRoZSBwb3NzaWJsZSB2YWx1ZXMgYXJlOlxuICAgICAqICogYCdzbWFsbCdgXG4gICAgICogKiBgJ21lZGl1bSdgIChkZWZhdWx0KVxuICAgICAqICogYCdsYXJnZSdgXG4gICAgICogKiBgbnVsbGBcbiAgICAgKlxuICAgICAqL1xuICAgIHNldCBzaXplKHNpemUpIHtcbiAgICAgICAgdGhpcy5yZW5kZXJlci5yZW1vdmVDbGFzcyh0aGlzLndyYXBwZXIubmF0aXZlRWxlbWVudCwgZ2V0U2l6ZUNsYXNzKCdpbnB1dCcsIHRoaXMuc2l6ZSkpO1xuICAgICAgICBpZiAoc2l6ZSkge1xuICAgICAgICAgICAgdGhpcy5yZW5kZXJlci5hZGRDbGFzcyh0aGlzLndyYXBwZXIubmF0aXZlRWxlbWVudCwgZ2V0U2l6ZUNsYXNzKCdpbnB1dCcsIHNpemUpKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9zaXplID0gc2l6ZTtcbiAgICB9XG4gICAgZ2V0IHNpemUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9zaXplO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZXRzIHRoZSBib3JkZXIgcmFkaXVzIG9mIHRoZSBjb21wb25lbnQuXG4gICAgICpcbiAgICAgKiBUaGUgcG9zc2libGUgdmFsdWVzIGFyZTpcbiAgICAgKiAqIGAnc21hbGwnYFxuICAgICAqICogYCdtZWRpdW0nYCAoZGVmYXVsdClcbiAgICAgKiAqIGAnbGFyZ2UnYFxuICAgICAqICogYCdmdWxsJ2BcbiAgICAgKiAqIGBudWxsYFxuICAgICAqXG4gICAgICovXG4gICAgc2V0IHJvdW5kZWQocm91bmRlZCkge1xuICAgICAgICB0aGlzLnJlbmRlcmVyLnJlbW92ZUNsYXNzKHRoaXMud3JhcHBlci5uYXRpdmVFbGVtZW50LCBnZXRSb3VuZGVkQ2xhc3ModGhpcy5yb3VuZGVkKSk7XG4gICAgICAgIGlmIChyb3VuZGVkKSB7XG4gICAgICAgICAgICB0aGlzLnJlbmRlcmVyLmFkZENsYXNzKHRoaXMud3JhcHBlci5uYXRpdmVFbGVtZW50LCBnZXRSb3VuZGVkQ2xhc3Mocm91bmRlZCkpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3JvdW5kZWQgPSByb3VuZGVkO1xuICAgIH1cbiAgICBnZXQgcm91bmRlZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3JvdW5kZWQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNldHMgdGhlIGZpbGxNb2RlIG9mIHRoZSBjb21wb25lbnQuXG4gICAgICpcbiAgICAgKiBUaGUgcG9zc2libGUgdmFsdWVzIGFyZTpcbiAgICAgKiAqIGAnZmxhdCdgXG4gICAgICogKiBgJ3NvbGlkJ2AgKGRlZmF1bHQpXG4gICAgICogKiBgJ291dGxpbmUnYFxuICAgICAqICogYG51bGxgXG4gICAgICpcbiAgICAgKi9cbiAgICBzZXQgZmlsbE1vZGUoZmlsbE1vZGUpIHtcbiAgICAgICAgdGhpcy5yZW5kZXJlci5yZW1vdmVDbGFzcyh0aGlzLndyYXBwZXIubmF0aXZlRWxlbWVudCwgZ2V0RmlsbE1vZGVDbGFzcygnaW5wdXQnLCB0aGlzLmZpbGxNb2RlKSk7XG4gICAgICAgIGlmIChmaWxsTW9kZSkge1xuICAgICAgICAgICAgdGhpcy5yZW5kZXJlci5hZGRDbGFzcyh0aGlzLndyYXBwZXIubmF0aXZlRWxlbWVudCwgZ2V0RmlsbE1vZGVDbGFzcygnaW5wdXQnLCBmaWxsTW9kZSkpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2ZpbGxNb2RlID0gZmlsbE1vZGU7XG4gICAgfVxuICAgIGdldCBmaWxsTW9kZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2ZpbGxNb2RlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBUaGUgaGludCB3aGljaCBpcyBkaXNwbGF5ZWQgd2hlbiB0aGUgY29tcG9uZW50IGlzIGVtcHR5LlxuICAgICAqIFdoZW4gdGhlIHZhbHVlcyBhcmUgc2VsZWN0ZWQsIGl0IGRpc2FwcGVhcnMuXG4gICAgICovXG4gICAgc2V0IHBsYWNlaG9sZGVyKHRleHQpIHtcbiAgICAgICAgdGhpcy5fcGxhY2Vob2xkZXIgPSB0ZXh0IHx8ICcnO1xuICAgIH1cbiAgICBnZXQgcGxhY2Vob2xkZXIoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNlbGVjdGVkRGF0YUl0ZW1zLmxlbmd0aCA/ICcnIDogdGhpcy5fcGxhY2Vob2xkZXI7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIERlZmluZXMgYSBCb29sZWFuIGZ1bmN0aW9uIHRoYXQgaXMgZXhlY3V0ZWQgZm9yIGVhY2ggZGF0YSBpdGVtIGluIHRoZSBjb21wb25lbnRcbiAgICAgKiAoW3NlZSBleGFtcGxlc10oeyUgc2x1ZyBkaXNhYmxlZGl0ZW1zX211bHRpc2VsZWN0ICV9KSkuIERldGVybWluZXMgd2hldGhlciB0aGUgaXRlbSB3aWxsIGJlIGRpc2FibGVkLlxuICAgICAqL1xuICAgIHNldCBpdGVtRGlzYWJsZWQoZm4pIHtcbiAgICAgICAgaWYgKHR5cGVvZiBmbiAhPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBpdGVtRGlzYWJsZWQgbXVzdCBiZSBhIGZ1bmN0aW9uLCBidXQgcmVjZWl2ZWQgJHtKU09OLnN0cmluZ2lmeShmbil9LmApO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZGlzYWJsZWRJdGVtc1NlcnZpY2UuaXRlbURpc2FibGVkID0gZm47XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNwZWNpZmllcyB3aGV0aGVyIGNoZWNrYm94ZXMgd2lsbCBiZSByZW5kZXJlZCBiZWZvcmUgZWFjaCBpdGVtIGluIHRoZSBwb3B1cCBsaXN0LlxuICAgICAqL1xuICAgIHNldCBjaGVja2JveGVzKHNldHRpbmdzKSB7XG4gICAgICAgIHRoaXMuX2NoZWNrYm94ZXMgPSBub3JtYWxpemVDaGVja2JveGVzU2V0dGluZ3Moc2V0dGluZ3MpO1xuICAgIH1cbiAgICBnZXQgY2hlY2tib3hlcygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2NoZWNrYm94ZXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEVuYWJsZXMgdGhlIFt2aXJ0dWFsaXphdGlvbl0oeyUgc2x1ZyB2aXJ0dWFsaXphdGlvbl9tdWx0aXNlbGVjdCAlfSkgZnVuY3Rpb25hbGl0eS5cbiAgICAgKi9cbiAgICBzZXQgdmlydHVhbChzZXR0aW5ncykge1xuICAgICAgICB0aGlzLl92aXJ0dWFsU2V0dGluZ3MgPSBub3JtYWxpemVWaXJ0dWFsaXphdGlvblNldHRpbmdzKHNldHRpbmdzKTtcbiAgICB9XG4gICAgZ2V0IHZpcnR1YWwoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl92aXJ0dWFsU2V0dGluZ3M7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENvbmZpZ3VyZXMgdGhlIHBvcHVwIG9mIHRoZSBNdWx0aVNlbGVjdC5cbiAgICAgKlxuICAgICAqIFRoZSBhdmFpbGFibGUgb3B0aW9ucyBhcmU6XG4gICAgICogLSBgYW5pbWF0ZTogQm9vbGVhbmAmbWRhc2g7Q29udHJvbHMgdGhlIHBvcHVwIGFuaW1hdGlvbi4gQnkgZGVmYXVsdCwgdGhlIG9wZW4gYW5kIGNsb3NlIGFuaW1hdGlvbnMgYXJlIGVuYWJsZWQuXG4gICAgICogLSBgd2lkdGg6IE51bWJlciB8IFN0cmluZ2AmbWRhc2g7U2V0cyB0aGUgd2lkdGggb2YgdGhlIHBvcHVwIGNvbnRhaW5lci4gQnkgZGVmYXVsdCwgdGhlIHdpZHRoIG9mIHRoZSBob3N0IGVsZW1lbnQgaXMgdXNlZC4gSWYgc2V0IHRvIGBhdXRvYCwgdGhlIGNvbXBvbmVudCBhdXRvbWF0aWNhbGx5IGFkanVzdHMgdGhlIHdpZHRoIG9mIHRoZSBwb3B1cCBhbmQgbm8gaXRlbSBsYWJlbHMgYXJlIHdyYXBwZWQuIFRoZSBgYXV0b2AgbW9kZSBpcyBub3Qgc3VwcG9ydGVkIHdoZW4gdmlydHVhbCBzY3JvbGxpbmcgaXMgZW5hYmxlZC5cbiAgICAgKiAtIGBoZWlnaHQ6IE51bWJlcmAmbWRhc2g7U2V0cyB0aGUgaGVpZ2h0IG9mIHRoZSBwb3B1cCBjb250YWluZXIuXG4gICAgICogLSBgcG9wdXBDbGFzczogU3RyaW5nYCZtZGFzaDtTcGVjaWZpZXMgYSBsaXN0IG9mIENTUyBjbGFzc2VzIHRoYXQgYXJlIHVzZWQgdG8gc3R5bGUgdGhlIHBvcHVwLlxuICAgICAqIC0gYGFwcGVuZFRvOiBcInJvb3RcIiB8IFwiY29tcG9uZW50XCIgfCBWaWV3Q29udGFpbmVyUmVmYCZtZGFzaDtTcGVjaWZpZXMgdGhlIGNvbXBvbmVudCB0byB3aGljaCB0aGUgcG9wdXAgd2lsbCBiZSBhcHBlbmRlZC5cbiAgICAgKi9cbiAgICBzZXQgcG9wdXBTZXR0aW5ncyhzZXR0aW5ncykge1xuICAgICAgICB0aGlzLl9wb3B1cFNldHRpbmdzID0gT2JqZWN0LmFzc2lnbih7IGFuaW1hdGU6IHRydWUgfSwgc2V0dGluZ3MpO1xuICAgIH1cbiAgICBnZXQgcG9wdXBTZXR0aW5ncygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3BvcHVwU2V0dGluZ3M7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNwZWNpZmllcyB0aGUgdHlwZSBvZiB0aGUgc2VsZWN0ZWQgdmFsdWUuXG4gICAgICogSWYgc2V0IHRvIGB0cnVlYCwgdGhlIHNlbGVjdGVkIHZhbHVlIGhhcyB0byBiZSBvZiB0aGUgcHJpbWl0aXZlIHR5cGVcbiAgICAgKiAoW21vcmUgaW5mb3JtYXRpb24gYW5kIGV4YW1wbGVdKHslIHNsdWcgdmFsdWViaW5kaW5nX211bHRpc2VsZWN0ICV9I3RvYy1wcmltaXRpdmUtdmFsdWVzLWZyb20tb2JqZWN0LWZpZWxkcykpLlxuICAgICAqL1xuICAgIHNldCB2YWx1ZVByaW1pdGl2ZShpc1ByaW1pdGl2ZSkge1xuICAgICAgICB0aGlzLl92YWx1ZVByaW1pdGl2ZSA9IGlzUHJpbWl0aXZlO1xuICAgIH1cbiAgICBnZXQgdmFsdWVQcmltaXRpdmUoKSB7XG4gICAgICAgIGlmICghaXNQcmVzZW50KHRoaXMuX3ZhbHVlUHJpbWl0aXZlKSkge1xuICAgICAgICAgICAgcmV0dXJuICFpc1ByZXNlbnQodGhpcy52YWx1ZUZpZWxkKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5fdmFsdWVQcmltaXRpdmU7XG4gICAgfVxuICAgIGdldCBkaXIoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRpcmVjdGlvbjtcbiAgICB9XG4gICAgZ2V0IGRpc2FibGVkQ2xhc3MoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRpc2FibGVkO1xuICAgIH1cbiAgICBnZXQgaXNMb2FkaW5nKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5sb2FkaW5nO1xuICAgIH1cbiAgICBnZXQgaXNBcmlhRXhwYW5kZWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmlzT3BlbjtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIGhvc3RNb3VzZWRvd24oZXZlbnQpIHtcbiAgICAgICAgY29uc3QgaW5wdXRFbGVtZW50ID0gdGhpcy5zZWFyY2hiYXIuaW5wdXQubmF0aXZlRWxlbWVudDtcbiAgICAgICAgaWYgKGV2ZW50LmJ1dHRvbiA9PT0gMCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuaXNGb2N1c2VkICYmIHRoaXMuaXNPcGVuICYmIGV2ZW50LnRhcmdldCA9PT0gaW5wdXRFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCF0aGlzLnRvdWNoRW5hYmxlZCB8fCAodGhpcy50b3VjaEVuYWJsZWQgJiYgZXZlbnQudGFyZ2V0LnRhZ05hbWUgIT09ICdTUEFOJykpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNlYXJjaGJhci5mb2N1cygpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy50b2dnbGVQb3B1cCghdGhpcy5pc09wZW4pO1xuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBnZXQgbGlzdENvbnRhaW5lckNsYXNzZXMoKSB7XG4gICAgICAgIGNvbnN0IGNvbnRhaW5lckNsYXNzZXMgPSBbJ2stbGlzdC1jb250YWluZXInLCAnay1yZXNldCddO1xuICAgICAgICBpZiAodGhpcy5wb3B1cFNldHRpbmdzLnBvcHVwQ2xhc3MpIHtcbiAgICAgICAgICAgIGNvbnRhaW5lckNsYXNzZXMucHVzaCh0aGlzLnBvcHVwU2V0dGluZ3MucG9wdXBDbGFzcyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNvbnRhaW5lckNsYXNzZXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBnZXQgY3VzdG9tSXRlbVNpemVDbGFzcygpIHtcbiAgICAgICAgcmV0dXJuIGAke3RoaXMuc2l6ZSA/IGdldFNpemVDbGFzcygnbGlzdCcsIHRoaXMuc2l6ZSkgOiAnJ31gO1xuICAgIH1cbiAgICBnZXQgd2lkdGgoKSB7XG4gICAgICAgIGxldCB3cmFwcGVyT2Zmc2V0V2lkdGggPSAwO1xuICAgICAgICBpZiAoaXNEb2N1bWVudEF2YWlsYWJsZSgpKSB7XG4gICAgICAgICAgICB3cmFwcGVyT2Zmc2V0V2lkdGggPSB0aGlzLndyYXBwZXIubmF0aXZlRWxlbWVudC5vZmZzZXRXaWR0aDtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCB3aWR0aCA9IHRoaXMucG9wdXBTZXR0aW5ncy53aWR0aCB8fCB3cmFwcGVyT2Zmc2V0V2lkdGg7XG4gICAgICAgIGNvbnN0IG1pbldpZHRoID0gaXNOYU4od3JhcHBlck9mZnNldFdpZHRoKSA/IHdyYXBwZXJPZmZzZXRXaWR0aCA6IGAke3dyYXBwZXJPZmZzZXRXaWR0aH1weGA7XG4gICAgICAgIGNvbnN0IG1heFdpZHRoID0gaXNOYU4od2lkdGgpID8gd2lkdGggOiBgJHt3aWR0aH1weGA7XG4gICAgICAgIHJldHVybiB7IG1pbjogbWluV2lkdGgsIG1heDogbWF4V2lkdGggfTtcbiAgICB9XG4gICAgZ2V0IGhlaWdodCgpIHtcbiAgICAgICAgY29uc3QgcG9wdXBIZWlnaHQgPSB0aGlzLnBvcHVwU2V0dGluZ3MuaGVpZ2h0O1xuICAgICAgICByZXR1cm4gaXNQcmVzZW50KHBvcHVwSGVpZ2h0KSA/IGAke3BvcHVwSGVpZ2h0fXB4YCA6ICdhdXRvJztcbiAgICB9XG4gICAgZ2V0IGFjdGl2ZURlc2NlbmRhbnQoKSB7XG4gICAgICAgIGNvbnN0IGZvY3VzZWRUYWdJbmRleCA9IHRoaXMuZm9jdXNlZFRhZ0luZGV4O1xuICAgICAgICBjb25zdCBmb2N1c2VkTGlzdEluZGV4ID0gdGhpcy5zZWxlY3Rpb25TZXJ2aWNlLmZvY3VzZWQ7XG4gICAgICAgIGxldCBwcmVmaXg7XG4gICAgICAgIGxldCBpdGVtO1xuICAgICAgICBpZiAoaXNQcmVzZW50KGZvY3VzZWRUYWdJbmRleCkgJiYgIXRoaXMuaXNPcGVuKSB7XG4gICAgICAgICAgICBpdGVtID0gdGhpcy50YWdzW2ZvY3VzZWRUYWdJbmRleF07XG4gICAgICAgICAgICBwcmVmaXggPSB0aGlzLnRhZ1ByZWZpeDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChpc1ByZXNlbnQoZm9jdXNlZExpc3RJbmRleCkgJiYgZm9jdXNlZExpc3RJbmRleCAhPT0gLTEgJiYgdGhpcy5pc09wZW4pIHtcbiAgICAgICAgICAgIGl0ZW0gPSB0aGlzLmRhdGFTZXJ2aWNlLml0ZW1BdChmb2N1c2VkTGlzdEluZGV4KTtcbiAgICAgICAgICAgIHByZWZpeCA9IHRoaXMub3B0aW9uUHJlZml4O1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHByZWZpeCArIFwiLVwiICsgZ2V0dGVyJDEoaXRlbSwgdGhpcy52YWx1ZUZpZWxkKTtcbiAgICB9XG4gICAgZ2V0IG5vRGF0YUxhYmVsKCkge1xuICAgICAgICBpZiAodGhpcy5kYXRhU2VydmljZS5pdGVtc0NvdW50ID09PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5tZXNzYWdlRm9yKCdub0RhdGFUZXh0Jyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZ2V0IGNsZWFyQnV0dG9uVmlzaWJsaXR5KCkge1xuICAgICAgICBpZiAodGhpcy50b3VjaEVuYWJsZWQpIHtcbiAgICAgICAgICAgIHJldHVybiAndmlzaWJsZSc7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIHZlcmlmeVNldHRpbmdzKCkge1xuICAgICAgICBpZiAoIWlzRGV2TW9kZSgpIHx8IHRoaXMudmFsdWUubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFpc0FycmF5KHRoaXMudmFsdWUpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoTXVsdGlzZWxlY3RNZXNzYWdlcy5hcnJheSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMudmFsdWVQcmltaXRpdmUgPT09IHRydWUgJiYgaXNPYmplY3RBcnJheSh0aGlzLnZhbHVlKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKE11bHRpc2VsZWN0TWVzc2FnZXMucHJpbWl0aXZlKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy52YWx1ZVByaW1pdGl2ZSA9PT0gZmFsc2UgJiYgIWlzT2JqZWN0QXJyYXkodGhpcy52YWx1ZSkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihNdWx0aXNlbGVjdE1lc3NhZ2VzLm9iamVjdCk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgdmFsdWVPclRleHQgPSAhaXNQcmVzZW50KHRoaXMudmFsdWVGaWVsZCkgIT09ICFpc1ByZXNlbnQodGhpcy50ZXh0RmllbGQpO1xuICAgICAgICBpZiAodmFsdWVPclRleHQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihNdWx0aXNlbGVjdE1lc3NhZ2VzLnRleHRBbmRWYWx1ZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIGNoYW5nZShldmVudCkge1xuICAgICAgICBjb25zdCBpc0N1c3RvbUl0ZW0gPSAoaXNQcmVzZW50KGV2ZW50LmFkZGVkKSB8fCBpc1ByZXNlbnQoZXZlbnQucmVtb3ZlZCkpICYmIChldmVudC5hZGRlZCA9PT0gLTEgfHwgZXZlbnQucmVtb3ZlZCA9PT0gLTEpO1xuICAgICAgICBpZiAoaXNDdXN0b21JdGVtKSB7XG4gICAgICAgICAgICB0aGlzLmFkZEN1c3RvbVZhbHVlKHRoaXMudGV4dCk7XG4gICAgICAgICAgICByZXR1cm47IC8vIFRoZSBjaGFuZ2UgaXMgZW1pdGVkIGFzeW5jaHJvbm9zbHkuXG4gICAgICAgIH1cbiAgICAgICAgLy8gRXhpc3RpbmcgaXRlbXMuXG4gICAgICAgIGlmIChpc1ByZXNlbnQoZXZlbnQuYWRkZWQpKSB7XG4gICAgICAgICAgICBjb25zdCBkYXRhSXRlbSA9IHRoaXMuZGF0YVNlcnZpY2UuaXRlbUF0KGV2ZW50LmFkZGVkKTtcbiAgICAgICAgICAgIGNvbnN0IG5ld0l0ZW0gPSAodGhpcy52YWx1ZVByaW1pdGl2ZSAmJiBpc1ByZXNlbnQoZGF0YUl0ZW0pICYmIGlzUHJlc2VudChkYXRhSXRlbVt0aGlzLnZhbHVlRmllbGRdKSkgPyBkYXRhSXRlbVt0aGlzLnZhbHVlRmllbGRdIDogZGF0YUl0ZW07XG4gICAgICAgICAgICB0aGlzLnZhbHVlID0gWy4uLnRoaXMudmFsdWUsIG5ld0l0ZW1dO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpc1ByZXNlbnQoZXZlbnQucmVtb3ZlZCkpIHtcbiAgICAgICAgICAgIGNvbnN0IGRhdGFJdGVtID0gdGhpcy5kYXRhU2VydmljZS5pdGVtQXQoZXZlbnQucmVtb3ZlZCk7XG4gICAgICAgICAgICBjb25zdCBmaWx0ZXIkJDEgPSAoaXRlbSkgPT4gZ2V0dGVyJDEoaXRlbSwgdGhpcy52YWx1ZUZpZWxkKSAhPT0gZ2V0dGVyJDEoZGF0YUl0ZW0sIHRoaXMudmFsdWVGaWVsZCk7XG4gICAgICAgICAgICB0aGlzLnZhbHVlID0gdGhpcy52YWx1ZS5maWx0ZXIoZmlsdGVyJCQxKTtcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0aW9uU2VydmljZS5mb2N1c2VkID0gZXZlbnQucmVtb3ZlZDtcbiAgICAgICAgICAgIHRoaXMuY2RyLmRldGVjdENoYW5nZXMoKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmVtaXRWYWx1ZUNoYW5nZSgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgc2V0U3RhdGUodmFsdWUpIHtcbiAgICAgICAgbGV0IGRhdGEgPSB0aGlzLmRhdGFTZXJ2aWNlLmRhdGE7XG4gICAgICAgIGlmICh0aGlzLmRhdGFTZXJ2aWNlLmdyb3VwZWQpIHtcbiAgICAgICAgICAgIGRhdGEgPSBkYXRhLmZpbHRlcihpdGVtID0+ICFpdGVtLmhlYWRlcikubWFwKGl0ZW0gPT4gaXRlbS52YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qgc2VsZWN0aW9uID0gc2VsZWN0ZWRJbmRpY2VzKHRoaXMudmFsdWUsIGRhdGEsIHRoaXMudmFsdWVGaWVsZCk7XG4gICAgICAgIHRoaXMuc2VsZWN0aW9uU2VydmljZS5yZXNldFNlbGVjdGlvbihzZWxlY3Rpb24pO1xuICAgICAgICBpZiAodGhpcy5kaXNhYmxlZEl0ZW1zU2VydmljZS5pc0luZGV4RGlzYWJsZWQodGhpcy5zZWxlY3Rpb25TZXJ2aWNlLmZvY3VzZWQpKSB7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdGlvblNlcnZpY2UuZm9jdXNlZCA9IHRoaXMuZmlyc3RGb2N1c2FibGVJbmRleCgwKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5pc09wZW4gJiYgdGhpcy5zZWxlY3Rpb25TZXJ2aWNlLmZvY3VzZWQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuZGF0YVNlcnZpY2UuaXRlbXNDb3VudCA+IDApIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGlvblNlcnZpY2UuZm9jdXNlZCA9IHRoaXMuZmlyc3RGb2N1c2FibGVJbmRleCgwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMuYWxsb3dDdXN0b20pIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGlvblNlcnZpY2UuZm9jdXNlZCA9IC0xO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnZhbHVlUHJpbWl0aXZlICYmICF0aGlzLnZhbHVlRmllbGQpIHtcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWREYXRhSXRlbXMgPSB2YWx1ZS5zbGljZSgpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpc09iamVjdEFycmF5KHZhbHVlKSB8fCB0aGlzLnZhbHVlUHJpbWl0aXZlICYmIHRoaXMudmFsdWVGaWVsZCkge1xuICAgICAgICAgICAgdGhpcy5zZWxlY3RlZERhdGFJdGVtcyA9IHJlc29sdmVBbGxWYWx1ZXModmFsdWUsIGRhdGEsIHRoaXMudmFsdWVGaWVsZCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuc2VsZWN0ZWREYXRhSXRlbXMubGVuZ3RoIDwgdmFsdWUubGVuZ3RoKSB7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdGVkRGF0YUl0ZW1zID0gdmFsdWVcbiAgICAgICAgICAgICAgICAubWFwKGN1cnJlbnQgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGRhdGFJdGVtID0gdGhpcy5zZWxlY3RlZERhdGFJdGVtcy5maW5kKGl0ZW0gPT4gZ2V0dGVyJDEoaXRlbSwgdGhpcy52YWx1ZUZpZWxkKSA9PT0gZ2V0dGVyJDEoY3VycmVudCwgdGhpcy52YWx1ZUZpZWxkKSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGlzUHJlc2VudChkYXRhSXRlbSkgPyBkYXRhSXRlbSA6IHRoaXMucmVzb2x2ZURhdGFJdGVtRnJvbVRhZ3MoY3VycmVudCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5maWx0ZXIoZGF0YUl0ZW0gPT4gaXNQcmVzZW50KGRhdGFJdGVtKSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy50YWdzID0gdGhpcy50YWdNYXBwZXIodGhpcy5zZWxlY3RlZERhdGFJdGVtcy5zbGljZSgwKSk7XG4gICAgICAgIHRoaXMuZGlzYWJsZWRJbmRpY2VzID0gdGhpcy5kaXNhYmxlZEl0ZW1zTWFwcGVyKCk7XG4gICAgICAgIHRoaXMuY2RyLm1hcmtGb3JDaGVjaygpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgaGFuZGxlRmlsdGVyKHRleHQpIHtcbiAgICAgICAgdGhpcy50ZXh0ID0gdGV4dDtcbiAgICAgICAgaWYgKHRleHQgJiYgIXRoaXMuaXNPcGVuKSB7XG4gICAgICAgICAgICB0aGlzLm9wZW5Qb3B1cCgpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmZpbHRlcmFibGUpIHtcbiAgICAgICAgICAgIHRoaXMuZmlsdGVyQ2hhbmdlLmVtaXQodGV4dCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnNlYXJjaFRleHRBbmRGb2N1cyh0ZXh0KTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnNlYXJjaGJhci5zZXRJbnB1dFNpemUoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIHBhZ2VDaGFuZ2UoZXZlbnQpIHtcbiAgICAgICAgY29uc3QgdmlydHVhbCA9IHRoaXMudmlydHVhbDtcbiAgICAgICAgdmlydHVhbC5za2lwID0gZXZlbnQuc2tpcDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIGNsZWFyRmlsdGVyKCkge1xuICAgICAgICBpZiAodGhpcy5maWx0ZXJhYmxlICYmIHRoaXMudGV4dCkge1xuICAgICAgICAgICAgdGhpcy5maWx0ZXJDaGFuZ2UuZW1pdChcIlwiKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnRleHQgPSBcIlwiO1xuICAgICAgICAvKiBDbGVhcmluZyB0aGUgdmFsdWUgZnJvbSB0aGUgaW5wdXQgYXMgdGhlIHNldElucHV0U2l6ZSBjYWxjdWxhdGlvbiB3aWxsIGJlIGluY29ycmVjdCBvdGhlcndpc2UuXG4gICAgICAgICBDYWxsaW5nIGNkci5kZXRlY3RDaGFuZ2VzIHRvIGNsZWFyIHRoZSBpbnB1dCB2YWx1ZSBhcyBhIHJlc3VsdCBvZiBwcm9wZXJ0eSBiaW5kaW5nXG4gICAgICAgICBjYXVzZXMgSkFXUyB0byByZWFkIG91dGRhdGVkIHRhZyB2YWx1ZXMgaW4gSUUgdXBvbiB0YWcgc2VsZWN0aW9uIGZvciBzb21lIHJlYXNvbi4gKi9cbiAgICAgICAgdGhpcy5zZWFyY2hiYXIuaW5wdXQubmF0aXZlRWxlbWVudC52YWx1ZSA9IFwiXCI7XG4gICAgICAgIHRoaXMuc2VhcmNoYmFyLnNldElucHV0U2l6ZSgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgaGFuZGxlTmF2aWdhdGUoZXZlbnQpIHtcbiAgICAgICAgY29uc3QgbmF2aWdhdGVJbnB1dCA9IHRoaXMudGV4dCAmJiBldmVudC5rZXlDb2RlICE9PSBLZXlzLkFycm93RG93biAmJiBldmVudC5rZXlDb2RlICE9PSBLZXlzLkFycm93VXA7XG4gICAgICAgIGNvbnN0IHNlbGVjdFZhbHVlID0gdGhpcy50ZXh0ICYmIGV2ZW50LmtleUNvZGUgPT09IEtleXMuRW50ZXIgfHwgZXZlbnQua2V5Q29kZSA9PT0gS2V5cy5Fc2NhcGU7XG4gICAgICAgIGNvbnN0IGRlbGV0ZVRhZyA9ICF0aGlzLnRleHQgJiYgZXZlbnQua2V5Q29kZSA9PT0gS2V5cy5CYWNrc3BhY2UgJiYgdGhpcy50YWdzLmxlbmd0aCA+IDA7XG4gICAgICAgIGlmIChkZWxldGVUYWcpIHtcbiAgICAgICAgICAgIHRoaXMuaGFuZGxlQmFja3NwYWNlKCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuZGlzYWJsZWQgfHwgbmF2aWdhdGVJbnB1dCAmJiAhc2VsZWN0VmFsdWUpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBldmVudERhdGEgPSBldmVudDtcbiAgICAgICAgY29uc3QgZm9jdXNlZCA9IGlzTmFOKHRoaXMuc2VsZWN0aW9uU2VydmljZS5mb2N1c2VkKSA/IC0xIDogdGhpcy5zZWxlY3Rpb25TZXJ2aWNlLmZvY3VzZWQ7XG4gICAgICAgIGNvbnN0IGFjdGlvbiA9IHRoaXMubmF2aWdhdGlvblNlcnZpY2UucHJvY2Vzcyh7XG4gICAgICAgICAgICBjdXJyZW50OiBmb2N1c2VkLFxuICAgICAgICAgICAgbWF4OiB0aGlzLmRhdGFTZXJ2aWNlLml0ZW1zQ291bnQgLSAxLFxuICAgICAgICAgICAgbWluOiB0aGlzLmFsbG93Q3VzdG9tICYmIHRoaXMudGV4dCA/IC0xIDogMCxcbiAgICAgICAgICAgIG9wZW46IHRoaXMuaXNPcGVuLFxuICAgICAgICAgICAgb3JpZ2luYWxFdmVudDogZXZlbnREYXRhXG4gICAgICAgIH0pO1xuICAgICAgICBpZiAoYWN0aW9uICE9PSBOYXZpZ2F0aW9uQWN0aW9uLlVuZGVmaW5lZCAmJlxuICAgICAgICAgICAgKChhY3Rpb24gPT09IE5hdmlnYXRpb25BY3Rpb24uRW50ZXIgJiYgdGhpcy5pc09wZW4pIHx8IGFjdGlvbiAhPT0gTmF2aWdhdGlvbkFjdGlvbi5FbnRlcikpIHtcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIGhhbmRsZVJlbW92ZVRhZyh7IHRhZyB9KSB7XG4gICAgICAgIGNvbnN0IGV2ZW50QXJncyA9IG5ldyBSZW1vdmVUYWdFdmVudCh0YWcpO1xuICAgICAgICBpZiAodGhpcy5kaXNhYmxlZCB8fCB0aGlzLnJlYWRvbmx5KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5mb2N1cygpO1xuICAgICAgICB0aGlzLnJlbW92ZVRhZy5lbWl0KGV2ZW50QXJncyk7XG4gICAgICAgIGlmIChldmVudEFyZ3MuaXNEZWZhdWx0UHJldmVudGVkKCkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGFnIGluc3RhbmNlb2YgQXJyYXkpIHtcbiAgICAgICAgICAgIHRoaXMucmVtb3ZlR3JvdXBUYWcodGFnKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMucmVtb3ZlU2luZ2xlVGFnKHRhZyk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5jZHIuZGV0ZWN0Q2hhbmdlcygpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgY2xlYXJBbGwoZXZlbnQpIHtcbiAgICAgICAgZXZlbnQuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIHRoaXMuZm9jdXMoKTtcbiAgICAgICAgdGhpcy5jbGVhckZpbHRlcigpO1xuICAgICAgICBjb25zdCBzZWxlY3RlZCA9IHRoaXMuc2VsZWN0aW9uU2VydmljZS5zZWxlY3RlZDtcbiAgICAgICAgdGhpcy52YWx1ZSA9IHRoaXMudmFsdWUuZmlsdGVyKChfaXRlbSwgaW5kZXgpID0+IHRoaXMuZGlzYWJsZWRJdGVtc1NlcnZpY2UuaXNJbmRleERpc2FibGVkKHNlbGVjdGVkW2luZGV4XSkpO1xuICAgICAgICB0aGlzLmVtaXRWYWx1ZUNoYW5nZSgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgYWRkQ3VzdG9tVmFsdWUodGV4dCkge1xuICAgICAgICB0aGlzLmN1c3RvbVZhbHVlU3ViamVjdC5uZXh0KHRleHQpO1xuICAgIH1cbiAgICBuZ0FmdGVyQ29udGVudENoZWNrZWQoKSB7XG4gICAgICAgIHRoaXMudmVyaWZ5U2V0dGluZ3MoKTtcbiAgICB9XG4gICAgbmdEb0NoZWNrKCkge1xuICAgICAgICBjb25zdCB2YWx1ZUNoYW5nZXMgPSB0aGlzLmRpZmZlciAmJiB0aGlzLmRpZmZlci5kaWZmKHRoaXMudmFsdWUpO1xuICAgICAgICBpZiAodmFsdWVDaGFuZ2VzICYmICF0aGlzLnZhbHVlQ2hhbmdlRGV0ZWN0ZWQpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUodGhpcy52YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy52YWx1ZUNoYW5nZURldGVjdGVkID0gZmFsc2U7XG4gICAgfVxuICAgIG5nT25Jbml0KCkge1xuICAgICAgICB0aGlzLnJlbmRlcmVyLnJlbW92ZUF0dHJpYnV0ZSh0aGlzLndyYXBwZXIubmF0aXZlRWxlbWVudCwgXCJ0YWJpbmRleFwiKTtcbiAgICAgICAgdGhpcy5jcmVhdGVDdXN0b21WYWx1ZVN0cmVhbSgpO1xuICAgICAgICB0aGlzLmxvY2FsaXphdGlvbkNoYW5nZVN1YnNjcmlwdGlvbiA9IHRoaXMubG9jYWxpemF0aW9uXG4gICAgICAgICAgICAuY2hhbmdlcy5zdWJzY3JpYmUoKHsgcnRsIH0pID0+IHtcbiAgICAgICAgICAgIHRoaXMuZGlyZWN0aW9uID0gcnRsID8gJ3J0bCcgOiAnbHRyJztcbiAgICAgICAgICAgIHRoaXMuY2RyLm1hcmtGb3JDaGVjaygpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh0aGlzLnZhbHVlKTtcbiAgICAgICAgdGhpcy5zZXRDb21wb25lbnRDbGFzc2VzKCk7XG4gICAgICAgIHRoaXMuaW5pdGlhbGl6ZWQgPSB0cnVlO1xuICAgIH1cbiAgICBuZ09uQ2hhbmdlcyhjaGFuZ2VzKSB7XG4gICAgICAgIGNvbnN0IHZpcnR1YWwgPSB0aGlzLnZpcnR1YWw7XG4gICAgICAgIGNvbnN0IHJlcXVlc3RJbml0aWFsRGF0YSA9IHZpcnR1YWwgJiYgY2hhbmdlcy5kYXRhICYmIGNoYW5nZXMuZGF0YS5pc0ZpcnN0Q2hhbmdlKCk7XG4gICAgICAgIGlmIChyZXF1ZXN0SW5pdGlhbERhdGEpIHtcbiAgICAgICAgICAgIHRoaXMucGFnZUNoYW5nZSh7IHNraXA6IDAsIHRha2U6IHZpcnR1YWwucGFnZVNpemUgfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlzQ2hhbmdlZCgndmFsdWVOb3JtYWxpemVyJywgY2hhbmdlcykpIHtcbiAgICAgICAgICAgIHRoaXMuY3JlYXRlQ3VzdG9tVmFsdWVTdHJlYW0oKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoYW55Q2hhbmdlZChbJ3RleHRGaWVsZCcsICd2YWx1ZUZpZWxkJywgJ3ZhbHVlUHJpbWl0aXZlJ10sIGNoYW5nZXMpKSB7XG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKHRoaXMudmFsdWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIG5nQWZ0ZXJWaWV3SW5pdCgpIHtcbiAgICAgICAgdGhpcy5zZWFyY2hiYXIuc2V0SW5wdXRTaXplKCk7XG4gICAgfVxuICAgIG5nT25EZXN0cm95KCkge1xuICAgICAgICB0aGlzLl90b2dnbGUoZmFsc2UpO1xuICAgICAgICB0aGlzLnVuc3Vic2NyaWJlRXZlbnRzKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRvZ2dsZXMgdGhlIHZpc2liaWxpdHkgb2YgdGhlIHBvcHVwXG4gICAgICogKFtzZWUgZXhhbXBsZV0oeyUgc2x1ZyBvcGVuc3RhdGVfbXVsdGlzZWxlY3QgJX0jdG9jLXNldHRpbmctdGhlLWluaXRpYWxseS1vcGVuZWQtY29tcG9uZW50KSkuXG4gICAgICogSWYgeW91IHVzZSB0aGUgYHRvZ2dsZWAgbWV0aG9kIHRvIG9wZW4gb3IgY2xvc2UgdGhlIHBvcHVwLCB0aGUgcmVzcGVjdGl2ZSBgb3BlbmAgYW5kIGBjbG9zZWAgZXZlbnRzIHdpbGwgbm90IGJlIGZpcmVkLlxuICAgICAqXG4gICAgICogQHBhcmFtIG9wZW4gLSBUaGUgc3RhdGUgb2YgdGhlIHBvcHVwLlxuICAgICAqL1xuICAgIHRvZ2dsZShvcGVuKSB7XG4gICAgICAgIC8vIFRoZSBQcm9taXNlIGlzIHJlcXVpcmVkIGZvciBvcGVuaW5nIHRoZSBwb3B1cCBvbiBsb2FkLlxuICAgICAgICAvLyBPdGhlcndpc2UsIHRoZSBcIkV4cHJlc3Npb24gaGFzIGNoYW5nZWQuLi5cIiB0eXBlIGVycm9yIHdpbGwgYmUgdGhyb3duLlxuICAgICAgICBQcm9taXNlLnJlc29sdmUobnVsbCkudGhlbigoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBzaG91bGRPcGVuID0gaXNQcmVzZW50KG9wZW4pID8gb3BlbiA6ICF0aGlzLl9vcGVuO1xuICAgICAgICAgICAgdGhpcy5fdG9nZ2xlKHNob3VsZE9wZW4pO1xuICAgICAgICAgICAgdGhpcy5jZHIubWFya0ZvckNoZWNrKCk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRoZSBjdXJyZW50IG9wZW4gc3RhdGUgb2YgdGhlIHBvcHVwLlxuICAgICAqL1xuICAgIGdldCBpc09wZW4oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9vcGVuO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXNldHMgdGhlIHZhbHVlIG9mIHRoZSBNdWx0aVNlbGVjdC5cbiAgICAgKiBJZiB5b3UgdXNlIHRoZSBgcmVzZXRgIG1ldGhvZCB0byBjbGVhciB0aGUgdmFsdWUgb2YgdGhlIGNvbXBvbmVudCxcbiAgICAgKiB0aGUgbW9kZWwgd2lsbCBub3QgdXBkYXRlIGF1dG9tYXRpY2FsbHkgYW5kIHRoZSBgc2VsZWN0aW9uQ2hhbmdlYCBhbmQgYHZhbHVlQ2hhbmdlYCBldmVudHMgd2lsbCBub3QgYmUgZmlyZWQuXG4gICAgICovXG4gICAgcmVzZXQoKSB7XG4gICAgICAgIHRoaXMudGV4dCA9IFwiXCI7XG4gICAgICAgIHRoaXMudmFsdWUgPSBbXTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIG1lc3NhZ2VGb3Ioa2V5KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmxvY2FsaXphdGlvbi5nZXQoa2V5KTtcbiAgICB9XG4gICAgLy8gTkcgTU9ERUwgQklORElOR1NcbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgd3JpdGVWYWx1ZSh2YWx1ZSkge1xuICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWUgfHwgW107XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICByZWdpc3Rlck9uQ2hhbmdlKGZuKSB7XG4gICAgICAgIHRoaXMub25DaGFuZ2VDYWxsYmFjayA9IGZuO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgcmVnaXN0ZXJPblRvdWNoZWQoZm4pIHtcbiAgICAgICAgdGhpcy5vblRvdWNoZWRDYWxsYmFjayA9IGZuO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgc2V0RGlzYWJsZWRTdGF0ZShpc0Rpc2FibGVkKSB7XG4gICAgICAgIHRoaXMuZGlzYWJsZWQgPSBpc0Rpc2FibGVkO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgb25UYWdNYXBwZXJDaGFuZ2UoKSB7XG4gICAgICAgIHRoaXMudGFncyA9IHRoaXMudGFnTWFwcGVyKHRoaXMuc2VsZWN0ZWREYXRhSXRlbXMuc2xpY2UoMCkpO1xuICAgICAgICB0aGlzLmNkci5tYXJrRm9yQ2hlY2soKTtcbiAgICB9XG4gICAgc2V0IGlzRm9jdXNlZChpc0ZvY3VzZWQpIHtcbiAgICAgICAgdGhpcy5yZW5kZXJlcltpc0ZvY3VzZWQgPyAnYWRkQ2xhc3MnIDogJ3JlbW92ZUNsYXNzJ10odGhpcy53cmFwcGVyLm5hdGl2ZUVsZW1lbnQsICdrLWZvY3VzJyk7XG4gICAgICAgIHRoaXMuX2lzRm9jdXNlZCA9IGlzRm9jdXNlZDtcbiAgICB9XG4gICAgZ2V0IGlzRm9jdXNlZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2lzRm9jdXNlZDtcbiAgICB9XG4gICAgc3Vic2NyaWJlRXZlbnRzKCkge1xuICAgICAgICBpZiAoIWlzRG9jdW1lbnRBdmFpbGFibGUoKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGlzT3BlbiA9ICgpID0+IHRoaXMuaXNPcGVuO1xuICAgICAgICBjb25zdCBpc0Nsb3NlZCA9ICgpID0+ICF0aGlzLmlzT3BlbjtcbiAgICAgICAgY29uc3QgaXNUYWdGb2N1c2VkID0gKCkgPT4gIXRoaXMuaXNPcGVuICYmIHRoaXMuZm9jdXNlZFRhZ0luZGV4ICE9PSB1bmRlZmluZWQ7XG4gICAgICAgIFtcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0aW9uU2VydmljZS5vbkNoYW5nZS5zdWJzY3JpYmUodGhpcy5oYW5kbGVJdGVtQ2hhbmdlLmJpbmQodGhpcykpLFxuICAgICAgICAgICAgdGhpcy5uYXZpZ2F0aW9uU2VydmljZS5lc2Muc3Vic2NyaWJlKHRoaXMuY2xvc2VQb3B1cC5iaW5kKHRoaXMpKSxcbiAgICAgICAgICAgIHRoaXMubmF2aWdhdGlvblNlcnZpY2UuZW50ZXIucGlwZShmaWx0ZXIoaXNPcGVuKSkuc3Vic2NyaWJlKHRoaXMuaGFuZGxlRW50ZXIuYmluZCh0aGlzKSksXG4gICAgICAgICAgICB0aGlzLm5hdmlnYXRpb25TZXJ2aWNlLm9wZW4uc3Vic2NyaWJlKHRoaXMub3BlblBvcHVwLmJpbmQodGhpcykpLFxuICAgICAgICAgICAgdGhpcy5uYXZpZ2F0aW9uU2VydmljZS5jbG9zZS5zdWJzY3JpYmUodGhpcy5oYW5kbGVDbG9zZS5iaW5kKHRoaXMpKSxcbiAgICAgICAgICAgIHRoaXMubmF2aWdhdGlvblNlcnZpY2UudXAucGlwZShmaWx0ZXIoaXNPcGVuKSkuc3Vic2NyaWJlKChldmVudCkgPT4gdGhpcy5oYW5kbGVVcChldmVudC5pbmRleCkpLFxuICAgICAgICAgICAgdGhpcy5uYXZpZ2F0aW9uU2VydmljZS5ob21lLnBpcGUoZmlsdGVyKCgpID0+IGlzQ2xvc2VkKSkuc3Vic2NyaWJlKHRoaXMuaGFuZGxlSG9tZS5iaW5kKHRoaXMpKSxcbiAgICAgICAgICAgIHRoaXMubmF2aWdhdGlvblNlcnZpY2UuZW5kLnBpcGUoZmlsdGVyKCgpID0+IGlzQ2xvc2VkKSkuc3Vic2NyaWJlKHRoaXMuaGFuZGxlRW5kLmJpbmQodGhpcykpLFxuICAgICAgICAgICAgdGhpcy5uYXZpZ2F0aW9uU2VydmljZS5iYWNrc3BhY2UucGlwZShmaWx0ZXIoaXNUYWdGb2N1c2VkKSkuc3Vic2NyaWJlKHRoaXMuaGFuZGxlQmFja3NwYWNlLmJpbmQodGhpcykpLFxuICAgICAgICAgICAgdGhpcy5uYXZpZ2F0aW9uU2VydmljZS5kZWxldGUucGlwZShmaWx0ZXIoaXNUYWdGb2N1c2VkKSkuc3Vic2NyaWJlKHRoaXMuaGFuZGxlRGVsZXRlLmJpbmQodGhpcykpLFxuICAgICAgICAgICAgdGhpcy5uYXZpZ2F0aW9uU2VydmljZS5sZWZ0LnN1YnNjcmliZSh0aGlzLmRpcmVjdGlvbiA9PT0gJ3J0bCcgPyB0aGlzLmhhbmRsZVJpZ2h0S2V5LmJpbmQodGhpcykgOiB0aGlzLmhhbmRsZUxlZnRLZXkuYmluZCh0aGlzKSksXG4gICAgICAgICAgICB0aGlzLm5hdmlnYXRpb25TZXJ2aWNlLnJpZ2h0LnN1YnNjcmliZSh0aGlzLmRpcmVjdGlvbiA9PT0gJ3J0bCcgPyB0aGlzLmhhbmRsZUxlZnRLZXkuYmluZCh0aGlzKSA6IHRoaXMuaGFuZGxlUmlnaHRLZXkuYmluZCh0aGlzKSksXG4gICAgICAgICAgICB0aGlzLm5hdmlnYXRpb25TZXJ2aWNlLmRvd24uc3Vic2NyaWJlKChldmVudCkgPT4gdGhpcy5oYW5kbGVEb3duS2V5KGV2ZW50LmluZGV4KSlcbiAgICAgICAgXS5mb3JFYWNoKHMgPT4gdGhpcy5vYnNlcnZhYmxlU3Vic2NyaXB0aW9ucy5hZGQocykpO1xuICAgIH1cbiAgICBzdWJzY3JpYmVUb3VjaEV2ZW50cygpIHtcbiAgICAgICAgaWYgKCFpc0RvY3VtZW50QXZhaWxhYmxlKCkgfHwgIXRoaXMudG91Y2hFbmFibGVkKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fem9uZS5ydW5PdXRzaWRlQW5ndWxhcigoKSA9PiBcbiAgICAgICAgLy8gUm9sbCB1cCBNdWx0aVNlbGVjdCBvbiBpT1Mgd2hlbiB0YXBwZWQgb3V0c2lkZVxuICAgICAgICB0aGlzLnRvdWNoc3RhcnREaXNwb3NlSGFuZGxlciA9IHRoaXMucmVuZGVyZXIubGlzdGVuKGRvY3VtZW50LCAndG91Y2hzdGFydCcsIChlKSA9PiB7XG4gICAgICAgICAgICBjb25zdCB0YXJnZXQgPSBlLnRhcmdldDtcbiAgICAgICAgICAgIGlmICgodGhpcy5pc0ZvY3VzZWQgfHwgdGhpcy5pc09wZW4pICYmICFpbkRyb3BEb3duKHRoaXMud3JhcHBlciwgdGFyZ2V0LCB0aGlzLnBvcHVwUmVmKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX3pvbmUucnVuKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5ibHVyKCk7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmlzT3Blbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50b2dnbGVQb3B1cChmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICB1bnN1YnNjcmliZUV2ZW50cygpIHtcbiAgICAgICAgaWYgKCFpc0RvY3VtZW50QXZhaWxhYmxlKCkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm9ic2VydmFibGVTdWJzY3JpcHRpb25zLnVuc3Vic2NyaWJlKCk7XG4gICAgICAgIGlmICh0aGlzLmN1c3RvbVZhbHVlU3Vic2NyaXB0aW9uKSB7XG4gICAgICAgICAgICB0aGlzLmN1c3RvbVZhbHVlU3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMubG9jYWxpemF0aW9uQ2hhbmdlU3Vic2NyaXB0aW9uKSB7XG4gICAgICAgICAgICB0aGlzLmxvY2FsaXphdGlvbkNoYW5nZVN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnRvdWNoc3RhcnREaXNwb3NlSGFuZGxlcikge1xuICAgICAgICAgICAgdGhpcy50b3VjaHN0YXJ0RGlzcG9zZUhhbmRsZXIoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZW1vdmVHcm91cFRhZyhkYXRhSXRlbXMpIHtcbiAgICAgICAgbGV0IGRhdGEgPSB0aGlzLmRhdGFTZXJ2aWNlLmRhdGE7XG4gICAgICAgIGlmICh0aGlzLmRhdGFTZXJ2aWNlLmdyb3VwZWQpIHtcbiAgICAgICAgICAgIGRhdGEgPSBkYXRhLmZpbHRlcihpdGVtID0+ICFpdGVtLmhlYWRlcikubWFwKGl0ZW0gPT4gaXRlbS52YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgZGF0YUl0ZW1WYWx1ZXMgPSBuZXcgU2V0KGRhdGFJdGVtcy5tYXAoaXRlbSA9PiBnZXR0ZXIkMShpdGVtLCB0aGlzLnZhbHVlRmllbGQpKSk7XG4gICAgICAgIHRoaXMudmFsdWUgPSB0aGlzLnZhbHVlLmZpbHRlcih2YWx1ZSA9PiB7XG4gICAgICAgICAgICBjb25zdCBpbmRleCA9IHNlbGVjdGVkSW5kaWNlcyhbdmFsdWVdLCBkYXRhLCB0aGlzLnZhbHVlRmllbGQpWzBdO1xuICAgICAgICAgICAgY29uc3QgaXNEYXRhSXRlbURpc2FibGVkID0gdGhpcy5kaXNhYmxlZEl0ZW1zU2VydmljZS5pc0luZGV4RGlzYWJsZWQoaW5kZXgpO1xuICAgICAgICAgICAgcmV0dXJuICFkYXRhSXRlbVZhbHVlcy5oYXMoZ2V0dGVyJDEodmFsdWUsIHRoaXMudmFsdWVGaWVsZCkpIHx8IGlzRGF0YUl0ZW1EaXNhYmxlZDtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuZW1pdFZhbHVlQ2hhbmdlKCk7XG4gICAgfVxuICAgIHJlbW92ZVNpbmdsZVRhZyhkYXRhSXRlbSkge1xuICAgICAgICBsZXQgZGF0YSA9IHRoaXMuZGF0YVNlcnZpY2UuZGF0YTtcbiAgICAgICAgaWYgKHRoaXMuZGF0YVNlcnZpY2UuZ3JvdXBlZCkge1xuICAgICAgICAgICAgZGF0YSA9IGRhdGEuZmlsdGVyKGl0ZW0gPT4gIWl0ZW0uaGVhZGVyKS5tYXAoaXRlbSA9PiBpdGVtLnZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBpbmRleCA9IHNlbGVjdGVkSW5kaWNlcyhbZGF0YUl0ZW1dLCBkYXRhLCB0aGlzLnZhbHVlRmllbGQpWzBdO1xuICAgICAgICBpZiAodGhpcy5kaXNhYmxlZEl0ZW1zU2VydmljZS5pc0luZGV4RGlzYWJsZWQoaW5kZXgpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlzTnVtYmVyKGluZGV4KSkge1xuICAgICAgICAgICAgdGhpcy5zZWxlY3Rpb25TZXJ2aWNlLnVuc2VsZWN0KGluZGV4KTtcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0aW9uU2VydmljZS5mb2N1c2VkID0gaW5kZXg7XG4gICAgICAgICAgICB0aGlzLnRvZ2dsZVBvcHVwKGZhbHNlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHsgLy8gdGhlIGRlbGV0ZWQgaXRlbSBpcyBub3QgcHJlc2VudCBpbiB0aGUgc291cmNlXG4gICAgICAgICAgICBjb25zdCBmaWx0ZXIkJDEgPSBpdGVtID0+IGdldHRlciQxKGl0ZW0sIHRoaXMudmFsdWVGaWVsZCkgIT09IGdldHRlciQxKGRhdGFJdGVtLCB0aGlzLnZhbHVlRmllbGQpO1xuICAgICAgICAgICAgdGhpcy52YWx1ZSA9IHRoaXMudmFsdWUuZmlsdGVyKGZpbHRlciQkMSk7XG4gICAgICAgICAgICB0aGlzLmVtaXRWYWx1ZUNoYW5nZSgpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKlxuICAgICAqIERldGVybWluZXMgd2hpY2ggb2YgdGhlIHByb3ZpZGVkIHRhZ3Mgc2hvdWxkIGJlIGRpc2FibGVkIGFuZCBzdG9yZXMgdGhlaXIgcG9zaXRpb24gaW5kaWNlc1xuICAgICAqL1xuICAgIGRpc2FibGVkSXRlbXNNYXBwZXIoKSB7XG4gICAgICAgIGNvbnN0IHsgc2VsZWN0ZWQgfSA9IHRoaXMuc2VsZWN0aW9uU2VydmljZTtcbiAgICAgICAgcmV0dXJuIG5ldyBTZXQodGhpcy5zZWxlY3RlZERhdGFJdGVtcy5yZWR1Y2UoKGluZGljZXMsIF9pdGVtLCBpbmRleCkgPT4ge1xuICAgICAgICAgICAgaWYgKHRoaXMuZGlzYWJsZWRJdGVtc1NlcnZpY2UuaXNJbmRleERpc2FibGVkKHNlbGVjdGVkW2luZGV4XSkpIHtcbiAgICAgICAgICAgICAgICBpbmRpY2VzLnB1c2goaW5kZXgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGluZGljZXM7XG4gICAgICAgIH0sIFtdKSk7XG4gICAgfVxuICAgIGNyZWF0ZUN1c3RvbVZhbHVlU3RyZWFtKCkge1xuICAgICAgICBpZiAodGhpcy5jdXN0b21WYWx1ZVN1YnNjcmlwdGlvbikge1xuICAgICAgICAgICAgdGhpcy5jdXN0b21WYWx1ZVN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuY3VzdG9tVmFsdWVTdWJzY3JpcHRpb24gPSB0aGlzLmN1c3RvbVZhbHVlU3ViamVjdC5waXBlKHRhcCgoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmxvYWRpbmcgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5kaXNhYmxlZCA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLmNkci5kZXRlY3RDaGFuZ2VzKCk7XG4gICAgICAgIH0pLCB0aGlzLnZhbHVlTm9ybWFsaXplciwgY2F0Y2hFcnJvcigoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMuZGlzYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIGlmICh0aGlzLmF1dG9DbG9zZSkge1xuICAgICAgICAgICAgICAgIHRoaXMudG9nZ2xlUG9wdXAoZmFsc2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuYXV0b0Nsb3NlIHx8ICF0aGlzLmZpbHRlcmFibGUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNsZWFyRmlsdGVyKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLm5leHRUaWNrKCgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnNlYXJjaGJhci5mb2N1cygpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLmNyZWF0ZUN1c3RvbVZhbHVlU3RyZWFtKCk7XG4gICAgICAgICAgICByZXR1cm4gb2YobnVsbCk7XG4gICAgICAgIH0pKVxuICAgICAgICAgICAgLnN1YnNjcmliZSgobm9ybWFsaXplZFZhbHVlKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMuZGlzYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIGlmIChpc1ByZXNlbnQobm9ybWFsaXplZFZhbHVlKSkgeyAvLyBpZiB2YWx1ZU5vcm1hbGl6ZXIgcmV0dXJucyBgbnVsbGAgb3IgYHVuZGVmaW5lZGAgY3VzdG9tIHZhbHVlIGlzIGRpc2NhcmRlZFxuICAgICAgICAgICAgICAgIGNvbnN0IG5ld1ZhbHVlID0gdGhpcy52YWx1ZVByaW1pdGl2ZSA/IGdldHRlciQxKG5vcm1hbGl6ZWRWYWx1ZSwgdGhpcy52YWx1ZUZpZWxkKSA6IG5vcm1hbGl6ZWRWYWx1ZTtcbiAgICAgICAgICAgICAgICBjb25zdCBpdGVtSW5kZXggPSB0aGlzLmRhdGFTZXJ2aWNlLmluZGV4T2YobmV3VmFsdWUpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGN1c3RvbUl0ZW0gPSBpdGVtSW5kZXggPT09IC0xO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnZhbHVlLmluZGV4T2YobmV3VmFsdWUpID09PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnRhZ3MgPSB0aGlzLnRhZ01hcHBlcihbLi4udGhpcy5zZWxlY3RlZERhdGFJdGVtcywgbm9ybWFsaXplZFZhbHVlXSk7XG4gICAgICAgICAgICAgICAgICAgIGlmICghY3VzdG9tSXRlbSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3Rpb25TZXJ2aWNlLmFkZChpdGVtSW5kZXgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy52YWx1ZSA9IFsuLi50aGlzLnZhbHVlLCBuZXdWYWx1ZV07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghY3VzdG9tSXRlbSAmJiB0aGlzLnNlbGVjdGlvblNlcnZpY2UuaXNTZWxlY3RlZChpdGVtSW5kZXgpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGlvblNlcnZpY2UudW5zZWxlY3QoaXRlbUluZGV4KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0aW9uU2VydmljZS5mb2N1c2VkID0gaXRlbUluZGV4O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy52YWx1ZSA9IHRoaXMudmFsdWUuZmlsdGVyKGl0ZW0gPT4gZ2V0dGVyJDEoaXRlbSwgdGhpcy52YWx1ZUZpZWxkKSAhPT0gbmV3VmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuZW1pdFZhbHVlQ2hhbmdlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5hdXRvQ2xvc2UpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnRvZ2dsZVBvcHVwKGZhbHNlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLmF1dG9DbG9zZSB8fCAhdGhpcy5maWx0ZXJhYmxlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jbGVhckZpbHRlcigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5uZXh0VGljaygoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZWFyY2hiYXIuZm9jdXMoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgaGFuZGxlSXRlbUNoYW5nZShldmVudCkge1xuICAgICAgICB0aGlzLmNoYW5nZShldmVudCk7XG4gICAgICAgIGlmICh0aGlzLmF1dG9DbG9zZSkge1xuICAgICAgICAgICAgdGhpcy50b2dnbGVQb3B1cChmYWxzZSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuYXV0b0Nsb3NlIHx8ICF0aGlzLmZpbHRlcmFibGUpIHtcbiAgICAgICAgICAgIHRoaXMuY2xlYXJGaWx0ZXIoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBoYW5kbGVFbnRlcihldmVudCkge1xuICAgICAgICBjb25zdCBzZXJ2aWNlID0gdGhpcy5zZWxlY3Rpb25TZXJ2aWNlO1xuICAgICAgICBjb25zdCBmb2N1c2VkSW5kZXggPSB0aGlzLnNlbGVjdGlvblNlcnZpY2UuZm9jdXNlZDtcbiAgICAgICAgaWYgKHRoaXMuaXNPcGVuKSB7XG4gICAgICAgICAgICBldmVudC5vcmlnaW5hbEV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGZvY3VzZWRJbmRleCA9PT0gLTEpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmFsbG93Q3VzdG9tICYmIHRoaXMudGV4dCkge1xuICAgICAgICAgICAgICAgIHRoaXMuYWRkQ3VzdG9tVmFsdWUodGhpcy50ZXh0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybjsgLy8gQ2xlYXIgZmlsdGVyICYgY2xvc2UgYXJlIGRvbmUgYXQgY3VzdG9tVmFsdWVTdWJzY3JpcHRpb24gZHVlIHRvIHJhY2UgY29uZGl0aW9ucy5cbiAgICAgICAgfVxuICAgICAgICBpZiAoc2VydmljZS5pc1NlbGVjdGVkKGZvY3VzZWRJbmRleCkpIHtcbiAgICAgICAgICAgIHNlcnZpY2UudW5zZWxlY3QoZm9jdXNlZEluZGV4KTtcbiAgICAgICAgICAgIHNlcnZpY2UuZm9jdXNlZCA9IGZvY3VzZWRJbmRleDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHNlcnZpY2UuYWRkKGZvY3VzZWRJbmRleCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuYXV0b0Nsb3NlKSB7XG4gICAgICAgICAgICB0aGlzLnRvZ2dsZVBvcHVwKGZhbHNlKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5hdXRvQ2xvc2UgfHwgIXRoaXMuZmlsdGVyYWJsZSkge1xuICAgICAgICAgICAgdGhpcy5jbGVhckZpbHRlcigpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGhhbmRsZUNsb3NlKCkge1xuICAgICAgICB0aGlzLmNsb3NlUG9wdXAoKTtcbiAgICAgICAgdGhpcy5zZWFyY2hiYXIuZm9jdXMoKTtcbiAgICB9XG4gICAgaGFuZGxlRW5kKCkge1xuICAgICAgICB0aGlzLmZvY3VzZWRUYWdJbmRleCA9IHRoaXMudGFncy5sZW5ndGggLSAxO1xuICAgIH1cbiAgICBoYW5kbGVIb21lKCkge1xuICAgICAgICB0aGlzLmZvY3VzZWRUYWdJbmRleCA9IDA7XG4gICAgfVxuICAgIGhhbmRsZVVwKGluZGV4KSB7XG4gICAgICAgIHRoaXMuc2VsZWN0aW9uU2VydmljZS5mb2N1c2VkID0gaW5kZXg7XG4gICAgfVxuICAgIGhhbmRsZUJhY2tzcGFjZSgpIHtcbiAgICAgICAgaWYgKHRoaXMuZm9jdXNlZFRhZ0luZGV4ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRoaXMuaGFuZGxlRGVsZXRlKCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmhhbmRsZVJlbW92ZVRhZyh7IHRhZzogdGhpcy50YWdzW3RoaXMudGFncy5sZW5ndGggLSAxXSB9KTtcbiAgICAgICAgICAgIHRoaXMuc2VhcmNoYmFyLmZvY3VzKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaGFuZGxlRGVsZXRlKCkge1xuICAgICAgICB0aGlzLmhhbmRsZVJlbW92ZVRhZyh7IHRhZzogdGhpcy50YWdzW3RoaXMuZm9jdXNlZFRhZ0luZGV4XSB9KTtcbiAgICAgICAgaWYgKHRoaXMuZm9jdXNlZFRhZ0luZGV4ID09PSB0aGlzLnRhZ3MubGVuZ3RoKSB7XG4gICAgICAgICAgICB0aGlzLmZvY3VzZWRUYWdJbmRleCA9IHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgIH1cbiAgICBoYW5kbGVMZWZ0S2V5KCkge1xuICAgICAgICBpZiAodGhpcy5mb2N1c2VkVGFnSW5kZXggPT09IHVuZGVmaW5lZCB8fCB0aGlzLmZvY3VzZWRUYWdJbmRleCA8IDApIHtcbiAgICAgICAgICAgIHRoaXMuZm9jdXNlZFRhZ0luZGV4ID0gdGhpcy50YWdzLmxlbmd0aCAtIDE7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodGhpcy5mb2N1c2VkVGFnSW5kZXggIT09IDApIHtcbiAgICAgICAgICAgIHRoaXMuZm9jdXNlZFRhZ0luZGV4LS07XG4gICAgICAgIH1cbiAgICB9XG4gICAgaGFuZGxlRG93bktleShpbmRleCkge1xuICAgICAgICBpZiAodGhpcy5pc09wZW4pIHtcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0aW9uU2VydmljZS5mb2N1c2VkID0gaW5kZXggfHwgdGhpcy5maXJzdEZvY3VzYWJsZUluZGV4KDApO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5vcGVuUG9wdXAoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBoYW5kbGVSaWdodEtleSgpIHtcbiAgICAgICAgY29uc3QgbGFzdCA9IHRoaXMudGFncy5sZW5ndGggLSAxO1xuICAgICAgICBpZiAodGhpcy5mb2N1c2VkVGFnSW5kZXggPT09IGxhc3QpIHtcbiAgICAgICAgICAgIHRoaXMuZm9jdXNlZFRhZ0luZGV4ID0gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHRoaXMuZm9jdXNlZFRhZ0luZGV4IDwgbGFzdCkge1xuICAgICAgICAgICAgdGhpcy5mb2N1c2VkVGFnSW5kZXgrKztcbiAgICAgICAgfVxuICAgIH1cbiAgICBmaW5kSW5kZXgodGV4dCwgc3RhcnRzRnJvbSA9IDApIHtcbiAgICAgICAgbGV0IGl0ZW1UZXh0O1xuICAgICAgICB0ZXh0ID0gdGV4dC50b0xvd2VyQ2FzZSgpO1xuICAgICAgICBsZXQgaW5kZXggPSB0aGlzLmRhdGFTZXJ2aWNlLmZpbmRJbmRleChpdGVtID0+IHtcbiAgICAgICAgICAgIGlmICh0aGlzLmRhdGFTZXJ2aWNlLmdyb3VwZWQpIHtcbiAgICAgICAgICAgICAgICBpdGVtVGV4dCA9IGdldHRlciQxKGl0ZW0udmFsdWUsIHRoaXMudGV4dEZpZWxkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGl0ZW1UZXh0ID0gZ2V0dGVyJDEoaXRlbSwgdGhpcy50ZXh0RmllbGQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaXRlbVRleHQgPSAhaXNQcmVzZW50KGl0ZW1UZXh0KSA/IFwiXCIgOiBpdGVtVGV4dC50b1N0cmluZygpLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgICAgICByZXR1cm4gdGV4dCAmJiBpdGVtVGV4dC5zdGFydHNXaXRoKHRleHQpO1xuICAgICAgICB9LCBzdGFydHNGcm9tKTtcbiAgICAgICAgaWYgKHRoaXMuZGlzYWJsZWRJdGVtc1NlcnZpY2UuaXNJbmRleERpc2FibGVkKGluZGV4KSkge1xuICAgICAgICAgICAgcmV0dXJuIChpbmRleCArIDEgPiB0aGlzLmRhdGFTZXJ2aWNlLml0ZW1zQ291bnQpID8gLTEgOiB0aGlzLmZpbmRJbmRleCh0ZXh0LCBpbmRleCArIDEpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIGluZGV4O1xuICAgICAgICB9XG4gICAgfVxuICAgIHNlYXJjaFRleHRBbmRGb2N1cyh0ZXh0KSB7XG4gICAgICAgIGNvbnN0IGluZGV4ID0gdGhpcy5maW5kSW5kZXgodGV4dCk7XG4gICAgICAgIHRoaXMuc2VsZWN0aW9uU2VydmljZS5mb2N1c2VkID0gaW5kZXg7XG4gICAgfVxuICAgIGNsb3NlUG9wdXAoKSB7XG4gICAgICAgIHRoaXMudG9nZ2xlUG9wdXAoZmFsc2UpO1xuICAgICAgICB0aGlzLmZvY3VzZWRUYWdJbmRleCA9IHVuZGVmaW5lZDtcbiAgICB9XG4gICAgb3BlblBvcHVwKCkge1xuICAgICAgICB0aGlzLnRvZ2dsZVBvcHVwKHRydWUpO1xuICAgICAgICB0aGlzLmZvY3VzZWRUYWdJbmRleCA9IHVuZGVmaW5lZDtcbiAgICB9XG4gICAgdG9nZ2xlUG9wdXAob3Blbikge1xuICAgICAgICBjb25zdCBpc0Rpc2FibGVkID0gdGhpcy5kaXNhYmxlZCB8fCB0aGlzLnJlYWRvbmx5O1xuICAgICAgICBjb25zdCBzYW1lU3RhdGUgPSB0aGlzLmlzT3BlbiA9PT0gb3BlbjtcbiAgICAgICAgaWYgKGlzRGlzYWJsZWQgfHwgc2FtZVN0YXRlKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgaXNEZWZhdWx0UHJldmVudGVkID0gdGhpcy50cmlnZ2VyUG9wdXBFdmVudHMob3Blbik7XG4gICAgICAgIGlmICghaXNEZWZhdWx0UHJldmVudGVkKSB7XG4gICAgICAgICAgICB0aGlzLl90b2dnbGUob3Blbik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdHJpZ2dlclBvcHVwRXZlbnRzKG9wZW4pIHtcbiAgICAgICAgY29uc3QgZXZlbnRBcmdzID0gbmV3IFByZXZlbnRhYmxlRXZlbnQoKTtcbiAgICAgICAgaWYgKG9wZW4pIHtcbiAgICAgICAgICAgIHRoaXMub3Blbi5lbWl0KGV2ZW50QXJncyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmNsb3NlLmVtaXQoZXZlbnRBcmdzKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZXZlbnRBcmdzLmlzRGVmYXVsdFByZXZlbnRlZCgpO1xuICAgIH1cbiAgICBfdG9nZ2xlKG9wZW4pIHtcbiAgICAgICAgdGhpcy5fb3BlbiA9IG9wZW47XG4gICAgICAgIHRoaXMuZGVzdHJveVBvcHVwKCk7XG4gICAgICAgIGlmICh0aGlzLl9vcGVuKSB7XG4gICAgICAgICAgICB0aGlzLmNyZWF0ZVBvcHVwKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZGVzdHJveVBvcHVwKCkge1xuICAgICAgICBpZiAodGhpcy5wb3B1cFJlZikge1xuICAgICAgICAgICAgdGhpcy5wb3B1cFJlZi5wb3B1cEVsZW1lbnRcbiAgICAgICAgICAgICAgICAucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgdGhpcy5wb3B1cE1vdXNlRG93bkhhbmRsZXIpO1xuICAgICAgICAgICAgdGhpcy5wb3B1cFJlZi5jbG9zZSgpO1xuICAgICAgICAgICAgdGhpcy5wb3B1cFJlZiA9IG51bGw7XG4gICAgICAgIH1cbiAgICB9XG4gICAgY3JlYXRlUG9wdXAoKSB7XG4gICAgICAgIGlmICh0aGlzLnZpcnR1YWwpIHtcbiAgICAgICAgICAgIHRoaXMudmlydHVhbC5za2lwID0gMDtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBob3Jpem9udGFsQWxpZ24gPSB0aGlzLmRpcmVjdGlvbiA9PT0gXCJydGxcIiA/IFwicmlnaHRcIiA6IFwibGVmdFwiO1xuICAgICAgICBjb25zdCBhbmNob3JQb3NpdGlvbiA9IHsgaG9yaXpvbnRhbDogaG9yaXpvbnRhbEFsaWduLCB2ZXJ0aWNhbDogXCJib3R0b21cIiB9O1xuICAgICAgICBjb25zdCBwb3B1cFBvc2l0aW9uID0geyBob3Jpem9udGFsOiBob3Jpem9udGFsQWxpZ24sIHZlcnRpY2FsOiBcInRvcFwiIH07XG4gICAgICAgIHRoaXMucG9wdXBSZWYgPSB0aGlzLnBvcHVwU2VydmljZS5vcGVuKHtcbiAgICAgICAgICAgIGFuY2hvcjogdGhpcy53cmFwcGVyLFxuICAgICAgICAgICAgYW5jaG9yQWxpZ246IGFuY2hvclBvc2l0aW9uLFxuICAgICAgICAgICAgYW5pbWF0ZTogdGhpcy5wb3B1cFNldHRpbmdzLmFuaW1hdGUsXG4gICAgICAgICAgICBhcHBlbmRUbzogdGhpcy5hcHBlbmRUbyxcbiAgICAgICAgICAgIGNvbnRlbnQ6IHRoaXMucG9wdXBUZW1wbGF0ZSxcbiAgICAgICAgICAgIHBvcHVwQWxpZ246IHBvcHVwUG9zaXRpb24sXG4gICAgICAgICAgICBwb3B1cENsYXNzOiB0aGlzLmxpc3RDb250YWluZXJDbGFzc2VzLFxuICAgICAgICAgICAgcG9zaXRpb25Nb2RlOiAnYWJzb2x1dGUnXG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCBwb3B1cFdyYXBwZXIgPSB0aGlzLnBvcHVwUmVmLnBvcHVwRWxlbWVudDtcbiAgICAgICAgY29uc3QgeyBtaW4sIG1heCB9ID0gdGhpcy53aWR0aDtcbiAgICAgICAgcG9wdXBXcmFwcGVyLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIHRoaXMucG9wdXBNb3VzZURvd25IYW5kbGVyKTtcbiAgICAgICAgcG9wdXBXcmFwcGVyLnN0eWxlLm1pbldpZHRoID0gbWluO1xuICAgICAgICBwb3B1cFdyYXBwZXIuc3R5bGUud2lkdGggPSBtYXg7XG4gICAgICAgIHBvcHVwV3JhcHBlci5zdHlsZS5oZWlnaHQgPSB0aGlzLmhlaWdodDtcbiAgICAgICAgcG9wdXBXcmFwcGVyLnNldEF0dHJpYnV0ZShcImRpclwiLCB0aGlzLmRpcmVjdGlvbik7XG4gICAgICAgIHRoaXMucG9wdXBSZWYucG9wdXBPcGVuLnN1YnNjcmliZSgoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmNkci5kZXRlY3RDaGFuZ2VzKCk7XG4gICAgICAgICAgICB0aGlzLm9wdGlvbnNMaXN0LnNjcm9sbFRvSXRlbSh0aGlzLnNlbGVjdGlvblNlcnZpY2UuZm9jdXNlZCk7XG4gICAgICAgICAgICB0aGlzLm9wZW5lZC5lbWl0KCk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnBvcHVwUmVmLnBvcHVwQ2xvc2Uuc3Vic2NyaWJlKCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuY2xvc2VkLmVtaXQoKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMucG9wdXBSZWYucG9wdXBBbmNob3JWaWV3cG9ydExlYXZlLnN1YnNjcmliZSgoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnRvZ2dsZVBvcHVwKGZhbHNlKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGVtaXRWYWx1ZUNoYW5nZSgpIHtcbiAgICAgICAgdGhpcy5vbkNoYW5nZUNhbGxiYWNrKHRoaXMudmFsdWUpO1xuICAgICAgICB0aGlzLnZhbHVlQ2hhbmdlLmVtaXQodGhpcy52YWx1ZSk7XG4gICAgfVxuICAgIHJlc29sdmVEYXRhSXRlbUZyb21UYWdzKHZhbHVlKSB7XG4gICAgICAgIGlmICghKHRoaXMudGFncyAmJiB0aGlzLnRhZ3MubGVuZ3RoICYmIGlzUHJlc2VudCh2YWx1ZSkpKSB7XG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICAgIC8vIEZsYXR0ZW5pbmcgdGhlIHRhZ3MgYXJyYXkgaW4gY2FzZSBvZiBhIHN1bW1hcnkgdGFnIG9jY3VycmVuY2UuXG4gICAgICAgIGNvbnN0IHRhZ3MgPSB0aGlzLnRhZ3MucmVkdWNlKChhY2MsIHRhZykgPT4ge1xuICAgICAgICAgICAgY29uc3QgaXRlbXMgPSBpc0FycmF5KHRhZykgPyB0YWcgOiBbdGFnXTtcbiAgICAgICAgICAgIGFjYy5wdXNoKC4uLml0ZW1zKTtcbiAgICAgICAgICAgIHJldHVybiBhY2M7XG4gICAgICAgIH0sIFtdKTtcbiAgICAgICAgcmV0dXJuIHRhZ3MuZmluZCh0YWcgPT4gZ2V0dGVyJDEodGFnLCB0aGlzLnZhbHVlRmllbGQpID09PSBnZXR0ZXIkMSh2YWx1ZSwgdGhpcy52YWx1ZUZpZWxkKSk7XG4gICAgfVxuICAgIGZpcnN0Rm9jdXNhYmxlSW5kZXgoaW5kZXgpIHtcbiAgICAgICAgY29uc3QgbWF4SW5kZXggPSB0aGlzLmRhdGFTZXJ2aWNlLml0ZW1zQ291bnQ7XG4gICAgICAgIGlmICh0aGlzLmRpc2FibGVkSXRlbXNTZXJ2aWNlLmlzSW5kZXhEaXNhYmxlZChpbmRleCkpIHtcbiAgICAgICAgICAgIGNvbnN0IG5leHRJbmRleCA9IGluZGV4ICsgMTtcbiAgICAgICAgICAgIHJldHVybiAobmV4dEluZGV4IDwgbWF4SW5kZXgpID8gdGhpcy5maXJzdEZvY3VzYWJsZUluZGV4KG5leHRJbmRleCkgOiB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gaW5kZXg7XG4gICAgICAgIH1cbiAgICB9XG4gICAgbmV4dFRpY2soZikge1xuICAgICAgICB0aGlzLl96b25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+IHtcbiAgICAgICAgICAgIC8vIFVzZSBgc2V0VGltZW91dGAgaW5zdGVhZCBvZiBhIHJlc29sdmVkIHByb21pc2VcbiAgICAgICAgICAgIC8vIGJlY2F1c2UgdGhlIGxhdHRlciBkb2VzIG5vdCB3YWl0IGxvbmcgZW5vdWdoLlxuICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB0aGlzLl96b25lLnJ1bihmKSk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBzZXRDb21wb25lbnRDbGFzc2VzKCkge1xuICAgICAgICBpZiAodGhpcy5zaXplKSB7XG4gICAgICAgICAgICB0aGlzLnJlbmRlcmVyLmFkZENsYXNzKHRoaXMud3JhcHBlci5uYXRpdmVFbGVtZW50LCBnZXRTaXplQ2xhc3MoJ2lucHV0JywgdGhpcy5zaXplKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMucm91bmRlZCkge1xuICAgICAgICAgICAgdGhpcy5yZW5kZXJlci5hZGRDbGFzcyh0aGlzLndyYXBwZXIubmF0aXZlRWxlbWVudCwgZ2V0Um91bmRlZENsYXNzKHRoaXMucm91bmRlZCkpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmZpbGxNb2RlKSB7XG4gICAgICAgICAgICB0aGlzLnJlbmRlcmVyLmFkZENsYXNzKHRoaXMud3JhcHBlci5uYXRpdmVFbGVtZW50LCBnZXRGaWxsTW9kZUNsYXNzKCdpbnB1dCcsIHRoaXMuZmlsbE1vZGUpKTtcbiAgICAgICAgfVxuICAgIH1cbn07XG5fX2RlY29yYXRlKFtcbiAgICBJbnB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBTdHJpbmcpXG5dLCBNdWx0aVNlbGVjdENvbXBvbmVudC5wcm90b3R5cGUsIFwiZm9jdXNhYmxlSWRcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEJvb2xlYW4pXG5dLCBNdWx0aVNlbGVjdENvbXBvbmVudC5wcm90b3R5cGUsIFwiYXV0b0Nsb3NlXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBJbnB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBCb29sZWFuKVxuXSwgTXVsdGlTZWxlY3RDb21wb25lbnQucHJvdG90eXBlLCBcImxvYWRpbmdcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEFycmF5KSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnBhcmFtdHlwZXNcIiwgW0FycmF5XSlcbl0sIE11bHRpU2VsZWN0Q29tcG9uZW50LnByb3RvdHlwZSwgXCJkYXRhXCIsIG51bGwpO1xuX19kZWNvcmF0ZShbXG4gICAgSW5wdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgQXJyYXkpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246cGFyYW10eXBlc1wiLCBbQXJyYXldKVxuXSwgTXVsdGlTZWxlY3RDb21wb25lbnQucHJvdG90eXBlLCBcInZhbHVlXCIsIG51bGwpO1xuX19kZWNvcmF0ZShbXG4gICAgSW5wdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgU3RyaW5nKVxuXSwgTXVsdGlTZWxlY3RDb21wb25lbnQucHJvdG90eXBlLCBcInZhbHVlRmllbGRcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIFN0cmluZylcbl0sIE11bHRpU2VsZWN0Q29tcG9uZW50LnByb3RvdHlwZSwgXCJ0ZXh0RmllbGRcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIE51bWJlcilcbl0sIE11bHRpU2VsZWN0Q29tcG9uZW50LnByb3RvdHlwZSwgXCJ0YWJpbmRleFwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgSW5wdXQoXCJ0YWJJbmRleFwiKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgTnVtYmVyKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnBhcmFtdHlwZXNcIiwgW051bWJlcl0pXG5dLCBNdWx0aVNlbGVjdENvbXBvbmVudC5wcm90b3R5cGUsIFwidGFiSW5kZXhcIiwgbnVsbCk7XG5fX2RlY29yYXRlKFtcbiAgICBJbnB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBTdHJpbmcpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246cGFyYW10eXBlc1wiLCBbU3RyaW5nXSlcbl0sIE11bHRpU2VsZWN0Q29tcG9uZW50LnByb3RvdHlwZSwgXCJzaXplXCIsIG51bGwpO1xuX19kZWNvcmF0ZShbXG4gICAgSW5wdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgU3RyaW5nKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnBhcmFtdHlwZXNcIiwgW1N0cmluZ10pXG5dLCBNdWx0aVNlbGVjdENvbXBvbmVudC5wcm90b3R5cGUsIFwicm91bmRlZFwiLCBudWxsKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIFN0cmluZyksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjpwYXJhbXR5cGVzXCIsIFtTdHJpbmddKVxuXSwgTXVsdGlTZWxlY3RDb21wb25lbnQucHJvdG90eXBlLCBcImZpbGxNb2RlXCIsIG51bGwpO1xuX19kZWNvcmF0ZShbXG4gICAgSW5wdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgU3RyaW5nKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnBhcmFtdHlwZXNcIiwgW1N0cmluZ10pXG5dLCBNdWx0aVNlbGVjdENvbXBvbmVudC5wcm90b3R5cGUsIFwicGxhY2Vob2xkZXJcIiwgbnVsbCk7XG5fX2RlY29yYXRlKFtcbiAgICBJbnB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBCb29sZWFuKVxuXSwgTXVsdGlTZWxlY3RDb21wb25lbnQucHJvdG90eXBlLCBcImRpc2FibGVkXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBJbnB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBGdW5jdGlvbiksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjpwYXJhbXR5cGVzXCIsIFtGdW5jdGlvbl0pXG5dLCBNdWx0aVNlbGVjdENvbXBvbmVudC5wcm90b3R5cGUsIFwiaXRlbURpc2FibGVkXCIsIG51bGwpO1xuX19kZWNvcmF0ZShbXG4gICAgSW5wdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgT2JqZWN0KSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnBhcmFtdHlwZXNcIiwgW09iamVjdF0pXG5dLCBNdWx0aVNlbGVjdENvbXBvbmVudC5wcm90b3R5cGUsIFwiY2hlY2tib3hlc1wiLCBudWxsKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEJvb2xlYW4pXG5dLCBNdWx0aVNlbGVjdENvbXBvbmVudC5wcm90b3R5cGUsIFwicmVhZG9ubHlcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEJvb2xlYW4pXG5dLCBNdWx0aVNlbGVjdENvbXBvbmVudC5wcm90b3R5cGUsIFwiZmlsdGVyYWJsZVwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgSW5wdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgT2JqZWN0KSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnBhcmFtdHlwZXNcIiwgW09iamVjdF0pXG5dLCBNdWx0aVNlbGVjdENvbXBvbmVudC5wcm90b3R5cGUsIFwidmlydHVhbFwiLCBudWxsKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIE9iamVjdCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjpwYXJhbXR5cGVzXCIsIFtPYmplY3RdKVxuXSwgTXVsdGlTZWxlY3RDb21wb25lbnQucHJvdG90eXBlLCBcInBvcHVwU2V0dGluZ3NcIiwgbnVsbCk7XG5fX2RlY29yYXRlKFtcbiAgICBJbnB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBOdW1iZXIpXG5dLCBNdWx0aVNlbGVjdENvbXBvbmVudC5wcm90b3R5cGUsIFwibGlzdEhlaWdodFwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgSW5wdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgQm9vbGVhbiksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjpwYXJhbXR5cGVzXCIsIFtCb29sZWFuXSlcbl0sIE11bHRpU2VsZWN0Q29tcG9uZW50LnByb3RvdHlwZSwgXCJ2YWx1ZVByaW1pdGl2ZVwiLCBudWxsKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEJvb2xlYW4pXG5dLCBNdWx0aVNlbGVjdENvbXBvbmVudC5wcm90b3R5cGUsIFwiY2xlYXJCdXR0b25cIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIE9iamVjdClcbl0sIE11bHRpU2VsZWN0Q29tcG9uZW50LnByb3RvdHlwZSwgXCJ0YWdNYXBwZXJcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEJvb2xlYW4pXG5dLCBNdWx0aVNlbGVjdENvbXBvbmVudC5wcm90b3R5cGUsIFwiYWxsb3dDdXN0b21cIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEZ1bmN0aW9uKVxuXSwgTXVsdGlTZWxlY3RDb21wb25lbnQucHJvdG90eXBlLCBcInZhbHVlTm9ybWFsaXplclwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgT3V0cHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEV2ZW50RW1pdHRlcilcbl0sIE11bHRpU2VsZWN0Q29tcG9uZW50LnByb3RvdHlwZSwgXCJmaWx0ZXJDaGFuZ2VcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIE91dHB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBFdmVudEVtaXR0ZXIpXG5dLCBNdWx0aVNlbGVjdENvbXBvbmVudC5wcm90b3R5cGUsIFwidmFsdWVDaGFuZ2VcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIE91dHB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBFdmVudEVtaXR0ZXIpXG5dLCBNdWx0aVNlbGVjdENvbXBvbmVudC5wcm90b3R5cGUsIFwib3BlblwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgT3V0cHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEV2ZW50RW1pdHRlcilcbl0sIE11bHRpU2VsZWN0Q29tcG9uZW50LnByb3RvdHlwZSwgXCJvcGVuZWRcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIE91dHB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBFdmVudEVtaXR0ZXIpXG5dLCBNdWx0aVNlbGVjdENvbXBvbmVudC5wcm90b3R5cGUsIFwiY2xvc2VcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIE91dHB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBFdmVudEVtaXR0ZXIpXG5dLCBNdWx0aVNlbGVjdENvbXBvbmVudC5wcm90b3R5cGUsIFwiY2xvc2VkXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBPdXRwdXQoJ2ZvY3VzJyksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEV2ZW50RW1pdHRlcilcbl0sIE11bHRpU2VsZWN0Q29tcG9uZW50LnByb3RvdHlwZSwgXCJvbkZvY3VzXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBPdXRwdXQoJ2JsdXInKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgRXZlbnRFbWl0dGVyKVxuXSwgTXVsdGlTZWxlY3RDb21wb25lbnQucHJvdG90eXBlLCBcIm9uQmx1clwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgT3V0cHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEV2ZW50RW1pdHRlcilcbl0sIE11bHRpU2VsZWN0Q29tcG9uZW50LnByb3RvdHlwZSwgXCJyZW1vdmVUYWdcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIFZpZXdDaGlsZCgnY29udGFpbmVyJywgeyByZWFkOiBWaWV3Q29udGFpbmVyUmVmLCBzdGF0aWM6IHRydWUgfSksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIFZpZXdDb250YWluZXJSZWYpXG5dLCBNdWx0aVNlbGVjdENvbXBvbmVudC5wcm90b3R5cGUsIFwiY29udGFpbmVyXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBWaWV3Q2hpbGQoU2VhcmNoQmFyQ29tcG9uZW50LCB7IHN0YXRpYzogdHJ1ZSB9KSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgU2VhcmNoQmFyQ29tcG9uZW50KVxuXSwgTXVsdGlTZWxlY3RDb21wb25lbnQucHJvdG90eXBlLCBcInNlYXJjaGJhclwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgVmlld0NoaWxkKCdwb3B1cFRlbXBsYXRlJywgeyBzdGF0aWM6IHRydWUgfSksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIFRlbXBsYXRlUmVmKVxuXSwgTXVsdGlTZWxlY3RDb21wb25lbnQucHJvdG90eXBlLCBcInBvcHVwVGVtcGxhdGVcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIFZpZXdDaGlsZCgnb3B0aW9uc0xpc3QnLCB7IHN0YXRpYzogZmFsc2UgfSksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIExpc3RDb21wb25lbnQpXG5dLCBNdWx0aVNlbGVjdENvbXBvbmVudC5wcm90b3R5cGUsIFwib3B0aW9uc0xpc3RcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIENvbnRlbnRDaGlsZChJdGVtVGVtcGxhdGVEaXJlY3RpdmUsIHsgc3RhdGljOiBmYWxzZSB9KSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgSXRlbVRlbXBsYXRlRGlyZWN0aXZlKVxuXSwgTXVsdGlTZWxlY3RDb21wb25lbnQucHJvdG90eXBlLCBcInRlbXBsYXRlXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBDb250ZW50Q2hpbGQoQ3VzdG9tSXRlbVRlbXBsYXRlRGlyZWN0aXZlLCB7IHN0YXRpYzogZmFsc2UgfSksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEN1c3RvbUl0ZW1UZW1wbGF0ZURpcmVjdGl2ZSlcbl0sIE11bHRpU2VsZWN0Q29tcG9uZW50LnByb3RvdHlwZSwgXCJjdXN0b21JdGVtVGVtcGxhdGVcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIENvbnRlbnRDaGlsZChHcm91cFRlbXBsYXRlRGlyZWN0aXZlLCB7IHN0YXRpYzogZmFsc2UgfSksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEdyb3VwVGVtcGxhdGVEaXJlY3RpdmUpXG5dLCBNdWx0aVNlbGVjdENvbXBvbmVudC5wcm90b3R5cGUsIFwiZ3JvdXBUZW1wbGF0ZVwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgQ29udGVudENoaWxkKEZpeGVkR3JvdXBUZW1wbGF0ZURpcmVjdGl2ZSwgeyBzdGF0aWM6IGZhbHNlIH0pLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBGaXhlZEdyb3VwVGVtcGxhdGVEaXJlY3RpdmUpXG5dLCBNdWx0aVNlbGVjdENvbXBvbmVudC5wcm90b3R5cGUsIFwiZml4ZWRHcm91cFRlbXBsYXRlXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBDb250ZW50Q2hpbGQoSGVhZGVyVGVtcGxhdGVEaXJlY3RpdmUsIHsgc3RhdGljOiBmYWxzZSB9KSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgSGVhZGVyVGVtcGxhdGVEaXJlY3RpdmUpXG5dLCBNdWx0aVNlbGVjdENvbXBvbmVudC5wcm90b3R5cGUsIFwiaGVhZGVyVGVtcGxhdGVcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIENvbnRlbnRDaGlsZChGb290ZXJUZW1wbGF0ZURpcmVjdGl2ZSwgeyBzdGF0aWM6IGZhbHNlIH0pLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBGb290ZXJUZW1wbGF0ZURpcmVjdGl2ZSlcbl0sIE11bHRpU2VsZWN0Q29tcG9uZW50LnByb3RvdHlwZSwgXCJmb290ZXJUZW1wbGF0ZVwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgQ29udGVudENoaWxkKFRhZ1RlbXBsYXRlRGlyZWN0aXZlLCB7IHN0YXRpYzogZmFsc2UgfSksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIFRhZ1RlbXBsYXRlRGlyZWN0aXZlKVxuXSwgTXVsdGlTZWxlY3RDb21wb25lbnQucHJvdG90eXBlLCBcInRhZ1RlbXBsYXRlXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBDb250ZW50Q2hpbGQoR3JvdXBUYWdUZW1wbGF0ZURpcmVjdGl2ZSwgeyBzdGF0aWM6IGZhbHNlIH0pLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBHcm91cFRhZ1RlbXBsYXRlRGlyZWN0aXZlKVxuXSwgTXVsdGlTZWxlY3RDb21wb25lbnQucHJvdG90eXBlLCBcImdyb3VwVGFnVGVtcGxhdGVcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIENvbnRlbnRDaGlsZChOb0RhdGFUZW1wbGF0ZURpcmVjdGl2ZSwgeyBzdGF0aWM6IGZhbHNlIH0pLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBOb0RhdGFUZW1wbGF0ZURpcmVjdGl2ZSlcbl0sIE11bHRpU2VsZWN0Q29tcG9uZW50LnByb3RvdHlwZSwgXCJub0RhdGFUZW1wbGF0ZVwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgSG9zdEJpbmRpbmcoJ2NsYXNzLmstbXVsdGlzZWxlY3QnKSxcbiAgICBIb3N0QmluZGluZygnY2xhc3Muay1pbnB1dCcpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBCb29sZWFuKVxuXSwgTXVsdGlTZWxlY3RDb21wb25lbnQucHJvdG90eXBlLCBcImhvc3RDbGFzc2VzXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBIb3N0QmluZGluZygnYXR0ci5kaXInKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgU3RyaW5nKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnBhcmFtdHlwZXNcIiwgW10pXG5dLCBNdWx0aVNlbGVjdENvbXBvbmVudC5wcm90b3R5cGUsIFwiZGlyXCIsIG51bGwpO1xuX19kZWNvcmF0ZShbXG4gICAgSG9zdEJpbmRpbmcoJ2NsYXNzLmstZGlzYWJsZWQnKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgQm9vbGVhbiksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjpwYXJhbXR5cGVzXCIsIFtdKVxuXSwgTXVsdGlTZWxlY3RDb21wb25lbnQucHJvdG90eXBlLCBcImRpc2FibGVkQ2xhc3NcIiwgbnVsbCk7XG5fX2RlY29yYXRlKFtcbiAgICBIb3N0QmluZGluZygnY2xhc3Muay1sb2FkaW5nJyksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEJvb2xlYW4pLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246cGFyYW10eXBlc1wiLCBbXSlcbl0sIE11bHRpU2VsZWN0Q29tcG9uZW50LnByb3RvdHlwZSwgXCJpc0xvYWRpbmdcIiwgbnVsbCk7XG5fX2RlY29yYXRlKFtcbiAgICBIb3N0QmluZGluZygnYXR0ci5yb2xlJyksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIFN0cmluZylcbl0sIE11bHRpU2VsZWN0Q29tcG9uZW50LnByb3RvdHlwZSwgXCJyb2xlXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBIb3N0QmluZGluZygnYXR0ci5hcmlhLWV4cGFuZGVkJyksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEJvb2xlYW4pLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246cGFyYW10eXBlc1wiLCBbXSlcbl0sIE11bHRpU2VsZWN0Q29tcG9uZW50LnByb3RvdHlwZSwgXCJpc0FyaWFFeHBhbmRlZFwiLCBudWxsKTtcbl9fZGVjb3JhdGUoW1xuICAgIEhvc3RMaXN0ZW5lcignbW91c2Vkb3duJywgWyckZXZlbnQnXSksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEZ1bmN0aW9uKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnBhcmFtdHlwZXNcIiwgW09iamVjdF0pLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246cmV0dXJudHlwZVwiLCB2b2lkIDApXG5dLCBNdWx0aVNlbGVjdENvbXBvbmVudC5wcm90b3R5cGUsIFwiaG9zdE1vdXNlZG93blwiLCBudWxsKTtcbk11bHRpU2VsZWN0Q29tcG9uZW50ID0gTXVsdGlTZWxlY3RDb21wb25lbnRfMSA9IF9fZGVjb3JhdGUoW1xuICAgIENvbXBvbmVudCh7XG4gICAgICAgIGV4cG9ydEFzOiAna2VuZG9NdWx0aVNlbGVjdCcsXG4gICAgICAgIHByb3ZpZGVyczogW1xuICAgICAgICAgICAgTVVMVElTRUxFQ1RfVkFMVUVfQUNDRVNTT1IsXG4gICAgICAgICAgICBEYXRhU2VydmljZSxcbiAgICAgICAgICAgIFNlbGVjdGlvblNlcnZpY2UsXG4gICAgICAgICAgICBOYXZpZ2F0aW9uU2VydmljZSxcbiAgICAgICAgICAgIERpc2FibGVkSXRlbXNTZXJ2aWNlLFxuICAgICAgICAgICAgTG9jYWxpemF0aW9uU2VydmljZSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBwcm92aWRlOiBMMTBOX1BSRUZJWCxcbiAgICAgICAgICAgICAgICB1c2VWYWx1ZTogJ2tlbmRvLm11bHRpc2VsZWN0J1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBwcm92aWRlOiBGaWx0ZXJhYmxlQ29tcG9uZW50LCB1c2VFeGlzdGluZzogZm9yd2FyZFJlZigoKSA9PiBNdWx0aVNlbGVjdENvbXBvbmVudF8xKVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBwcm92aWRlOiBLZW5kb0lucHV0LCB1c2VFeGlzdGluZzogZm9yd2FyZFJlZigoKSA9PiBNdWx0aVNlbGVjdENvbXBvbmVudF8xKVxuICAgICAgICAgICAgfVxuICAgICAgICBdLFxuICAgICAgICBzZWxlY3RvcjogJ2tlbmRvLW11bHRpc2VsZWN0JyxcbiAgICAgICAgdGVtcGxhdGU6IGBcbiAgICAgICAgPG5nLWNvbnRhaW5lciBrZW5kb011bHRpU2VsZWN0TG9jYWxpemVkTWVzc2FnZXNcbiAgICAgICAgICAgIGkxOG4tbm9EYXRhVGV4dD1cImtlbmRvLm11bHRpc2VsZWN0Lm5vRGF0YVRleHR8VGhlIHRleHQgZGlzcGxheWVkIGluIHRoZSBwb3B1cCB3aGVuIHRoZXJlIGFyZSBubyBpdGVtc1wiXG4gICAgICAgICAgICBub0RhdGFUZXh0PVwiTk8gREFUQSBGT1VORFwiXG5cbiAgICAgICAgICAgIGkxOG4tY2xlYXJUaXRsZT1cImtlbmRvLm11bHRpc2VsZWN0LmNsZWFyVGl0bGV8VGhlIHRpdGxlIG9mIHRoZSBjbGVhciBidXR0b25cIlxuICAgICAgICAgICAgY2xlYXJUaXRsZT1cImNsZWFyXCJcbiAgICAgICAgPlxuICAgICAgICA8L25nLWNvbnRhaW5lcj5cbiAgICAgICAgPGtlbmRvLXRhZ2xpc3RcbiAgICAgICAgICAgIFtzaXplXT1cInNpemVcIlxuICAgICAgICAgICAgW3JvdW5kZWRdPVwicm91bmRlZFwiXG4gICAgICAgICAgICBbZmlsbE1vZGVdPVwiZmlsbE1vZGVcIlxuICAgICAgICAgICAgW2lkXT1cInRhZ0xpc3RJZFwiXG4gICAgICAgICAgICBbdGFnc109XCJ0YWdzXCJcbiAgICAgICAgICAgIFt0ZXh0RmllbGRdPVwidGV4dEZpZWxkXCJcbiAgICAgICAgICAgIFt2YWx1ZUZpZWxkXT1cInZhbHVlRmllbGRcIlxuICAgICAgICAgICAgW2ZvY3VzZWRdPVwiZm9jdXNlZFRhZ0luZGV4XCJcbiAgICAgICAgICAgIFtkaXNhYmxlZF09XCJkaXNhYmxlZFwiXG4gICAgICAgICAgICBbdGVtcGxhdGVdPVwidGFnVGVtcGxhdGVcIlxuICAgICAgICAgICAgW2dyb3VwVGVtcGxhdGVdPVwiZ3JvdXBUYWdUZW1wbGF0ZVwiXG4gICAgICAgICAgICBbdGFnUHJlZml4XT1cInRhZ1ByZWZpeFwiXG4gICAgICAgICAgICBbZGlzYWJsZWRJbmRpY2VzXT1cImRpc2FibGVkSW5kaWNlc1wiXG4gICAgICAgICAgICAocmVtb3ZlVGFnKT1cImhhbmRsZVJlbW92ZVRhZygkZXZlbnQpXCJcbiAgICAgICAgPlxuICAgICAgICAgICAgPGtlbmRvLXNlYXJjaGJhclxuICAgICAgICAgICAgICAgICNzZWFyY2hiYXJcbiAgICAgICAgICAgICAgICBbaWRdPVwiZm9jdXNhYmxlSWRcIlxuICAgICAgICAgICAgICAgIFtyb2xlXT1cIid0ZXh0Ym94J1wiXG4gICAgICAgICAgICAgICAgW3RhZ0xpc3RJZF09XCJ0YWdMaXN0SWRcIlxuICAgICAgICAgICAgICAgIFthY3RpdmVEZXNjZW5kYW50XT1cImFjdGl2ZURlc2NlbmRhbnRcIlxuICAgICAgICAgICAgICAgIFtub0RhdGFMYWJlbF09XCJub0RhdGFMYWJlbFwiXG4gICAgICAgICAgICAgICAgW3VzZXJJbnB1dF09XCJ0ZXh0XCJcbiAgICAgICAgICAgICAgICBbZGlzYWJsZWRdPVwiZGlzYWJsZWRcIlxuICAgICAgICAgICAgICAgIFtyZWFkb25seV09XCJyZWFkb25seVwiXG4gICAgICAgICAgICAgICAgW3RhYkluZGV4XT1cInRhYkluZGV4XCJcbiAgICAgICAgICAgICAgICBbcG9wdXBPcGVuXT1cImlzT3BlblwiXG4gICAgICAgICAgICAgICAgW3BsYWNlaG9sZGVyXT1cInBsYWNlaG9sZGVyXCJcbiAgICAgICAgICAgICAgICAob25OYXZpZ2F0ZSk9XCJoYW5kbGVOYXZpZ2F0ZSgkZXZlbnQpXCJcbiAgICAgICAgICAgICAgICAodmFsdWVDaGFuZ2UpPVwiaGFuZGxlRmlsdGVyKCRldmVudClcIlxuICAgICAgICAgICAgICAgIChvbkJsdXIpPVwib25TZWFyY2hCYXJCbHVyKClcIlxuICAgICAgICAgICAgICAgIChvbkZvY3VzKT1cIm9uU2VhcmNoQmFyRm9jdXMoKVwiXG4gICAgICAgICAgICA+XG4gICAgICAgICAgICA8L2tlbmRvLXNlYXJjaGJhcj5cbiAgICAgICAgPC9rZW5kby10YWdsaXN0PlxuXG4gICAgICAgIDxzcGFuXG4gICAgICAgICAgICAqbmdJZj1cIiFsb2FkaW5nICYmICFyZWFkb25seSAmJiBjbGVhckJ1dHRvbiAmJiAodGFncz8ubGVuZ3RoIHx8IHRleHQ/Lmxlbmd0aClcIlxuICAgICAgICAgICAgY2xhc3M9XCJrLWNsZWFyLXZhbHVlXCJcbiAgICAgICAgICAgIFtzdHlsZS52aXNpYmlsaXR5XT1cImNsZWFyQnV0dG9uVmlzaWJsaXR5XCJcbiAgICAgICAgICAgIFthdHRyLnRpdGxlXT1cIm1lc3NhZ2VGb3IoJ2NsZWFyVGl0bGUnKVwiXG4gICAgICAgICAgICByb2xlPVwiYnV0dG9uXCJcbiAgICAgICAgICAgIHRhYmluZGV4PVwiLTFcIlxuICAgICAgICAgICAgKG1vdXNlZG93bik9XCJjbGVhckFsbCgkZXZlbnQpXCJcbiAgICAgICAgPlxuICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJrLWljb24gay1pLXhcIj48L3NwYW4+XG4gICAgICAgIDwvc3Bhbj5cbiAgICAgICAgPHNwYW5cbiAgICAgICAgICAgICpuZ0lmPVwibG9hZGluZ1wiXG4gICAgICAgICAgICBjbGFzcz1cImstaWNvbiBrLWktbG9hZGluZ1wiXG4gICAgICAgID5cbiAgICAgICAgPC9zcGFuPlxuICAgICAgICA8bmctdGVtcGxhdGUgI3BvcHVwVGVtcGxhdGU+XG4gICAgICAgICAgICA8IS0taGVhZGVyIHRlbXBsYXRlLS0+XG4gICAgICAgICAgICA8bmctdGVtcGxhdGUgKm5nSWY9XCJoZWFkZXJUZW1wbGF0ZVwiXG4gICAgICAgICAgICAgICAgW3RlbXBsYXRlQ29udGV4dF09XCJ7XG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlUmVmOiBoZWFkZXJUZW1wbGF0ZS50ZW1wbGF0ZVJlZlxuICAgICAgICAgICAgICAgIH1cIj5cbiAgICAgICAgICAgIDwvbmctdGVtcGxhdGU+XG4gICAgICAgICAgICA8IS0tY3VzdG9tIGl0ZW0gdGVtcGxhdGUtLT5cbiAgICAgICAgICAgIDxkaXZcbiAgICAgICAgICAgICAgICAqbmdJZj1cImFsbG93Q3VzdG9tICYmIHRleHRcIlxuICAgICAgICAgICAgICAgIGNsYXNzPVwiay1saXN0XCJcbiAgICAgICAgICAgICAgICBbbmdDbGFzc109XCJjdXN0b21JdGVtU2l6ZUNsYXNzXCJcbiAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiay1saXN0LWl0ZW0gay1jdXN0b20taXRlbVwiIGtlbmRvRHJvcERvd25zU2VsZWN0YWJsZSBbbXVsdGlwbGVTZWxlY3Rpb25dPVwidHJ1ZVwiIFtpbmRleF09XCItMVwiPlxuICAgICAgICAgICAgICAgICAgICA8bmctdGVtcGxhdGUgKm5nSWY9XCJjdXN0b21JdGVtVGVtcGxhdGU7ZWxzZSBkZWZhdWx0X2N1c3RvbV9pdGVtX3RlbXBsYXRlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIFt0ZW1wbGF0ZUNvbnRleHRdPVwie1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlUmVmOiBjdXN0b21JdGVtVGVtcGxhdGUudGVtcGxhdGVSZWYsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJGltcGxpY2l0OiB0ZXh0XG4gICAgICAgICAgICAgICAgICAgICAgICB9XCI+XG4gICAgICAgICAgICAgICAgICAgIDwvbmctdGVtcGxhdGU+XG4gICAgICAgICAgICAgICAgICAgIDxuZy10ZW1wbGF0ZSAjZGVmYXVsdF9jdXN0b21faXRlbV90ZW1wbGF0ZT57eyB0ZXh0IH19PC9uZy10ZW1wbGF0ZT5cbiAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJrLWljb24gay1pLXBsdXNcIiBzdHlsZT1cImZsb2F0OiByaWdodFwiPjwvc3Bhbj5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPCEtLWxpc3QtLT5cbiAgICAgICAgICAgIDxrZW5kby1saXN0XG4gICAgICAgICAgICAgICAgI29wdGlvbnNMaXN0XG4gICAgICAgICAgICAgICAgW3NpemVdPVwic2l6ZVwiXG4gICAgICAgICAgICAgICAgW3JvdW5kZWRdPVwicm91bmRlZFwiXG4gICAgICAgICAgICAgICAgW2lkXT1cImxpc3RCb3hJZFwiXG4gICAgICAgICAgICAgICAgW29wdGlvblByZWZpeF09XCJvcHRpb25QcmVmaXhcIlxuICAgICAgICAgICAgICAgIFtkYXRhXT1cImRhdGFcIlxuICAgICAgICAgICAgICAgIFt0ZXh0RmllbGRdPVwidGV4dEZpZWxkXCJcbiAgICAgICAgICAgICAgICBbdmFsdWVGaWVsZF09XCJ2YWx1ZUZpZWxkXCJcbiAgICAgICAgICAgICAgICBbaGVpZ2h0XT1cImxpc3RIZWlnaHRcIlxuICAgICAgICAgICAgICAgIFt0ZW1wbGF0ZV09XCJ0ZW1wbGF0ZVwiXG4gICAgICAgICAgICAgICAgW2dyb3VwVGVtcGxhdGVdPVwiZ3JvdXBUZW1wbGF0ZVwiXG4gICAgICAgICAgICAgICAgW2ZpeGVkR3JvdXBUZW1wbGF0ZV09XCJmaXhlZEdyb3VwVGVtcGxhdGVcIlxuICAgICAgICAgICAgICAgIFtzaG93XT1cImlzT3BlblwiXG4gICAgICAgICAgICAgICAgW211bHRpcGxlU2VsZWN0aW9uXT1cInRydWVcIlxuICAgICAgICAgICAgICAgIFt2aXJ0dWFsXT1cInZpcnR1YWxcIlxuICAgICAgICAgICAgICAgIChwYWdlQ2hhbmdlKT1cInBhZ2VDaGFuZ2UoJGV2ZW50KVwiXG4gICAgICAgICAgICAgICAgW2NoZWNrYm94ZXNdPVwiY2hlY2tib3hlc1wiXG4gICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgPC9rZW5kby1saXN0PlxuICAgICAgICAgICAgPCEtLW5vIGRhdGEgdGVtcGxhdGUtLT5cbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJrLW5vLWRhdGFcIiAqbmdJZj1cImRhdGEubGVuZ3RoID09PSAwXCI+XG4gICAgICAgICAgICAgICAgPG5nLXRlbXBsYXRlIFtuZ0lmXT1cIm5vRGF0YVRlbXBsYXRlXCJcbiAgICAgICAgICAgICAgICAgICAgW3RlbXBsYXRlQ29udGV4dF09XCJ7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVJlZjogbm9EYXRhVGVtcGxhdGUgPyBub0RhdGFUZW1wbGF0ZS50ZW1wbGF0ZVJlZiA6IHVuZGVmaW5lZFxuICAgICAgICAgICAgICAgICAgICB9XCI+XG4gICAgICAgICAgICAgICAgPC9uZy10ZW1wbGF0ZT5cbiAgICAgICAgICAgICAgICA8bmctdGVtcGxhdGUgW25nSWZdPVwiIW5vRGF0YVRlbXBsYXRlXCI+XG4gICAgICAgICAgICAgICAgICAgIDxkaXY+e3sgbWVzc2FnZUZvcignbm9EYXRhVGV4dCcpIH19PC9kaXY+XG4gICAgICAgICAgICAgICAgPC9uZy10ZW1wbGF0ZT5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPCEtLWZvb3RlciB0ZW1wbGF0ZS0tPlxuICAgICAgICAgICAgPG5nLXRlbXBsYXRlICpuZ0lmPVwiZm9vdGVyVGVtcGxhdGVcIlxuICAgICAgICAgICAgICAgIFt0ZW1wbGF0ZUNvbnRleHRdPVwie1xuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVJlZjogZm9vdGVyVGVtcGxhdGUudGVtcGxhdGVSZWZcbiAgICAgICAgICAgICAgICB9XCI+XG4gICAgICAgICAgICA8L25nLXRlbXBsYXRlPlxuICAgICAgICA8L25nLXRlbXBsYXRlPlxuICAgICAgICA8bmctdGVtcGxhdGUgW25nSWZdPVwiaXNPcGVuXCI+XG4gICAgICAgICAgICA8a2VuZG8tcmVzaXplLXNlbnNvciAocmVzaXplKT1cIm9uUmVzaXplKClcIj48L2tlbmRvLXJlc2l6ZS1zZW5zb3I+XG4gICAgICAgIDwvbmctdGVtcGxhdGU+XG4gICAgICAgIDxuZy1jb250YWluZXIgI2NvbnRhaW5lcj48L25nLWNvbnRhaW5lcj5cbiAgYFxuICAgIH0pLFxuICAgIF9fcGFyYW0oMTEsIE9wdGlvbmFsKCkpLCBfX3BhcmFtKDExLCBJbmplY3QoVE9VQ0hfRU5BQkxFRCkpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246cGFyYW10eXBlc1wiLCBbRWxlbWVudFJlZixcbiAgICAgICAgTG9jYWxpemF0aW9uU2VydmljZSxcbiAgICAgICAgUG9wdXBTZXJ2aWNlLFxuICAgICAgICBEYXRhU2VydmljZSxcbiAgICAgICAgU2VsZWN0aW9uU2VydmljZSxcbiAgICAgICAgTmF2aWdhdGlvblNlcnZpY2UsXG4gICAgICAgIERpc2FibGVkSXRlbXNTZXJ2aWNlLFxuICAgICAgICBDaGFuZ2VEZXRlY3RvclJlZixcbiAgICAgICAgS2V5VmFsdWVEaWZmZXJzLFxuICAgICAgICBSZW5kZXJlcjIsXG4gICAgICAgIE5nWm9uZSwgQm9vbGVhbl0pXG5dLCBNdWx0aVNlbGVjdENvbXBvbmVudCk7XG5cbi8qKlxuICogUmVuZGVycyB0aGUgY29sdW1uIGNlbGwgY29udGVudCBvZiB0aGUgTXVsdGlDb2x1bW5Db21ib0JveC4gVG8gZGVmaW5lIGEgY29sdW1uIGNlbGwgdGVtcGxhdGUsIG5lc3QgYW4gYDxuZy10ZW1wbGF0ZT5gIHRhZ1xuICogd2l0aCB0aGUgYGtlbmRvTXVsdGlDb2x1bW5Db21ib0JveENvbHVtbkNlbGxUZW1wbGF0ZWAgZGlyZWN0aXZlIGluc2lkZSB0aGUgW2A8a2VuZG8tY29tYm9ib3gtY29sdW1uPmBdKHslIHNsdWcgYXBpX2Ryb3Bkb3duc19jb21ib2JveGNvbHVtbmNvbXBvbmVudCAlfSkgdGFnXG4gKiAoW3NlZSBleGFtcGxlXSh7JSBzbHVnIHRlbXBsYXRlc19tdWx0aWNvbHVtbmNvbWJvYm94ICV9KSkuXG4gKlxuICogVGhlIGN1cnJlbnQgW2Bjb2x1bW5gXSh7JSBzbHVnIGFwaV9kcm9wZG93bnNfY29tYm9ib3hjb2x1bW5jb21wb25lbnQgJX0pIGFuZCBkYXRhIGl0ZW0gYXJlIGF2YWlsYWJsZSBhcyBjb250ZXh0IHZhcmlhYmxlczpcbiAqXG4gKiAtIGBsZXQtZGF0YUl0ZW09XCJkYXRhSXRlbVwiYCAoYGFueWApIC0gVGhlIGN1cnJlbnQgZGF0YSBpdGVtLiBBbHNvIGF2YWlsYWJsZSBhcyBpbXBsaWNpdCBjb250ZXh0IHZhcmlhYmxlLlxuICogLSBgbGV0LWNvbHVtbj1cImNvbHVtblwiYCAoW2BDb2x1bW5Db21wb25lbnRgXSh7JSBzbHVnIGFwaV9kcm9wZG93bnNfY29tYm9ib3hjb2x1bW5jb21wb25lbnQgJX0pKSAtIFRoZSBjdXJyZW50IGNvbHVtbiBjb25maWd1cmF0aW9uIG9iZWpjdC5cbiAqL1xubGV0IENvbHVtbkNlbGxUZW1wbGF0ZURpcmVjdGl2ZSA9IGNsYXNzIENvbHVtbkNlbGxUZW1wbGF0ZURpcmVjdGl2ZSB7XG4gICAgY29uc3RydWN0b3IodGVtcGxhdGVSZWYpIHtcbiAgICAgICAgdGhpcy50ZW1wbGF0ZVJlZiA9IHRlbXBsYXRlUmVmO1xuICAgIH1cbn07XG5Db2x1bW5DZWxsVGVtcGxhdGVEaXJlY3RpdmUgPSBfX2RlY29yYXRlKFtcbiAgICBEaXJlY3RpdmUoe1xuICAgICAgICBzZWxlY3RvcjogJ1trZW5kb011bHRpQ29sdW1uQ29tYm9Cb3hDb2x1bW5DZWxsVGVtcGxhdGVdJ1xuICAgIH0pLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246cGFyYW10eXBlc1wiLCBbVGVtcGxhdGVSZWZdKVxuXSwgQ29sdW1uQ2VsbFRlbXBsYXRlRGlyZWN0aXZlKTtcblxuLyoqXG4gKiBSZW5kZXJzIHRoZSBjb2x1bW4gaGVhZGVyIGNvbnRlbnQgb2YgdGhlIE11bHRpQ29sdW1uQ29tYm9Cb3guIFRvIGRlZmluZSBhIGNvbHVtbiBoZWFkZXIgdGVtcGxhdGUsIG5lc3QgYW4gYDxuZy10ZW1wbGF0ZT5gIHRhZ1xuICogd2l0aCB0aGUgYGtlbmRvTXVsdGlDb2x1bW5Db21ib0JveENvbHVtbkhlYWRlclRlbXBsYXRlYCBkaXJlY3RpdmUgaW5zaWRlIHRoZSBbYDxrZW5kby1jb21ib2JveC1jb2x1bW4+YF0oeyUgc2x1ZyBhcGlfZHJvcGRvd25zX2NvbWJvYm94Y29sdW1uY29tcG9uZW50ICV9KSB0YWdcbiAqIChbc2VlIGV4YW1wbGVdKHslIHNsdWcgdGVtcGxhdGVzX211bHRpY29sdW1uY29tYm9ib3ggJX0pKS5cbiAqXG4gKiBUaGUgY3VycmVudCBbYGNvbHVtbmBdKHslIHNsdWcgYXBpX2Ryb3Bkb3duc19jb21ib2JveGNvbHVtbmNvbXBvbmVudCAlfSkgaXMgYXZhaWxhYmxlIGFzIGltcGxpY2l0IGNvbnRleHQgdmFyaWFibGUuXG4gKi9cbmxldCBDb2x1bW5IZWFkZXJUZW1wbGF0ZURpcmVjdGl2ZSA9IGNsYXNzIENvbHVtbkhlYWRlclRlbXBsYXRlRGlyZWN0aXZlIHtcbiAgICBjb25zdHJ1Y3Rvcih0ZW1wbGF0ZVJlZikge1xuICAgICAgICB0aGlzLnRlbXBsYXRlUmVmID0gdGVtcGxhdGVSZWY7XG4gICAgfVxufTtcbkNvbHVtbkhlYWRlclRlbXBsYXRlRGlyZWN0aXZlID0gX19kZWNvcmF0ZShbXG4gICAgRGlyZWN0aXZlKHtcbiAgICAgICAgc2VsZWN0b3I6ICdba2VuZG9NdWx0aUNvbHVtbkNvbWJvQm94Q29sdW1uSGVhZGVyVGVtcGxhdGVdJ1xuICAgIH0pLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246cGFyYW10eXBlc1wiLCBbVGVtcGxhdGVSZWZdKVxuXSwgQ29sdW1uSGVhZGVyVGVtcGxhdGVEaXJlY3RpdmUpO1xuXG4vKipcbiAqIFJlcHJlc2VudHMgdGhlIGNvbHVtbiBkZWZpbml0aW9uIG9mIHRoZSBbTXVsdGlDb2x1bW5Db21ib0JveF0oeyUgc2x1ZyBvdmVydmlld19tdWx0aWNvbHVtbmNvbWJvYm94ICV9KVxuICogKFtzZWUgZXhhbXBsZV0oeyUgc2x1ZyBjb2x1bW5zX211bHRpY29sdW1uY29tYm9ib3ggJX0pKS5cbiAqL1xubGV0IENvbWJvQm94Q29sdW1uQ29tcG9uZW50ID0gY2xhc3MgQ29tYm9Cb3hDb2x1bW5Db21wb25lbnQge1xuICAgIC8qKlxuICAgICAqIFJlcHJlc2VudHMgdGhlIGNvbHVtbiBkZWZpbml0aW9uIG9mIHRoZSBbTXVsdGlDb2x1bW5Db21ib0JveF0oeyUgc2x1ZyBvdmVydmlld19tdWx0aWNvbHVtbmNvbWJvYm94ICV9KVxuICAgICAqIChbc2VlIGV4YW1wbGVdKHslIHNsdWcgY29sdW1uc19tdWx0aWNvbHVtbmNvbWJvYm94ICV9KSkuXG4gICAgICovXG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBTZXRzIHRoZSB2aXNpYmlsaXR5IG9mIHRoZSBjb2x1bW4uXG4gICAgICAgICAqXG4gICAgICAgICAqIEBkZWZhdWx0IGZhbHNlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmhpZGRlbiA9IGZhbHNlO1xuICAgICAgICAvKipcbiAgICAgICAgICogQGhpZGRlblxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5tYXRjaGVzTWVkaWEgPSB0cnVlO1xuICAgIH1cbn07XG5fX2RlY29yYXRlKFtcbiAgICBDb250ZW50Q2hpbGQoQ29sdW1uQ2VsbFRlbXBsYXRlRGlyZWN0aXZlLCB7IHN0YXRpYzogZmFsc2UgfSksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIENvbHVtbkNlbGxUZW1wbGF0ZURpcmVjdGl2ZSlcbl0sIENvbWJvQm94Q29sdW1uQ29tcG9uZW50LnByb3RvdHlwZSwgXCJjZWxsVGVtcGxhdGVcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIENvbnRlbnRDaGlsZChDb2x1bW5IZWFkZXJUZW1wbGF0ZURpcmVjdGl2ZSwgeyBzdGF0aWM6IGZhbHNlIH0pLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBDb2x1bW5IZWFkZXJUZW1wbGF0ZURpcmVjdGl2ZSlcbl0sIENvbWJvQm94Q29sdW1uQ29tcG9uZW50LnByb3RvdHlwZSwgXCJoZWFkZXJUZW1wbGF0ZVwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgSW5wdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgU3RyaW5nKVxuXSwgQ29tYm9Cb3hDb2x1bW5Db21wb25lbnQucHJvdG90eXBlLCBcImZpZWxkXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBJbnB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBTdHJpbmcpXG5dLCBDb21ib0JveENvbHVtbkNvbXBvbmVudC5wcm90b3R5cGUsIFwidGl0bGVcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIE51bWJlcilcbl0sIENvbWJvQm94Q29sdW1uQ29tcG9uZW50LnByb3RvdHlwZSwgXCJ3aWR0aFwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgSW5wdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgQm9vbGVhbilcbl0sIENvbWJvQm94Q29sdW1uQ29tcG9uZW50LnByb3RvdHlwZSwgXCJoaWRkZW5cIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIE9iamVjdClcbl0sIENvbWJvQm94Q29sdW1uQ29tcG9uZW50LnByb3RvdHlwZSwgXCJzdHlsZVwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgSW5wdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgT2JqZWN0KVxuXSwgQ29tYm9Cb3hDb2x1bW5Db21wb25lbnQucHJvdG90eXBlLCBcImhlYWRlclN0eWxlXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBJbnB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBPYmplY3QpXG5dLCBDb21ib0JveENvbHVtbkNvbXBvbmVudC5wcm90b3R5cGUsIFwiY2xhc3NcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIE9iamVjdClcbl0sIENvbWJvQm94Q29sdW1uQ29tcG9uZW50LnByb3RvdHlwZSwgXCJoZWFkZXJDbGFzc1wiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgSW5wdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgU3RyaW5nKVxuXSwgQ29tYm9Cb3hDb2x1bW5Db21wb25lbnQucHJvdG90eXBlLCBcIm1lZGlhXCIsIHZvaWQgMCk7XG5Db21ib0JveENvbHVtbkNvbXBvbmVudCA9IF9fZGVjb3JhdGUoW1xuICAgIENvbXBvbmVudCh7XG4gICAgICAgIHNlbGVjdG9yOiAna2VuZG8tY29tYm9ib3gtY29sdW1uJyxcbiAgICAgICAgdGVtcGxhdGU6ICcnXG4gICAgfSlcbl0sIENvbWJvQm94Q29sdW1uQ29tcG9uZW50KTtcblxuLyoqXG4gKiBQZXJzaXN0cyB0aGUgaW50aWFsbHkgcmVzb2x2ZWQgc2Nyb2xsYmFyIHdpZHRoIHZhbHVlLlxuICovXG5sZXQgU0NST0xMQkFSX1dJRFRIO1xuLyoqXG4gKiBAaGlkZGVuXG4gKlxuICogR2V0cyB0aGUgZGVmYXVsdCBzY3JvbGxiYXIgd2lkdGggYWNjb3JpbmcgdG8gdGhlIGN1cnJlbnQgZW52aXJvbm1lbnQuXG4gKi9cbmNvbnN0IHNjcm9sbGJhcldpZHRoID0gKCkgPT4ge1xuICAgIC8vIGNhbGN1bGF0ZSBzY3JvbGxiYXIgd2lkdGggb25seSBvbmNlLCB0aGVuIHJldHVybiB0aGUgbWVtb2l6ZWQgdmFsdWVcbiAgICBpZiAoaXNOYU4oU0NST0xMQkFSX1dJRFRIKSkge1xuICAgICAgICBjb25zdCBkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgZGl2LnN0eWxlLmNzc1RleHQgPSAnb3ZlcmZsb3c6IHNjcm9sbDsgb3ZlcmZsb3cteDogaGlkZGVuOyB6b29tOiAxOyBjbGVhcjogYm90aDsgZGlzcGxheTogYmxvY2s7JztcbiAgICAgICAgZGl2LmlubmVySFRNTCA9ICcmbmJzcDsnO1xuICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGRpdik7XG4gICAgICAgIFNDUk9MTEJBUl9XSURUSCA9IGRpdi5vZmZzZXRXaWR0aCAtIGRpdi5zY3JvbGxXaWR0aDtcbiAgICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChkaXYpO1xuICAgIH1cbiAgICByZXR1cm4gU0NST0xMQkFSX1dJRFRIO1xufTtcbi8qKlxuICogQ2hlY2tzIGlmIGFsbCBjb2x1bW5zIGhhdmUgYSB2YWxpZCB1c2VyLWRlZmluZWQgd2lkdGguXG4gKi9cbmNvbnN0IGFsbENvbHVtbnNXaWR0aHNTZXQgPSAoY29sdW1ucykgPT4ge1xuICAgIGlmICghaXNQcmVzZW50KGNvbHVtbnMpIHx8IGNvbHVtbnMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgcmV0dXJuIGNvbHVtbnMudG9BcnJheSgpLmV2ZXJ5KGNvbHVtbiA9PiAhaXNOYU4oY29sdW1uLndpZHRoKSAmJiBjb2x1bW4ud2lkdGggPiAwKTtcbn07XG4vKipcbiAqIEBoaWRkZW5cbiAqXG4gKiBDYWxjdWxhdGVzIHRoZSByb3cgd2lkdGggYWNjb3JkaW5nIHRvIHRoZSBwYXNzZWQgY29sdW1ucyB3aWR0aCBjb25maWd1cmF0aW9uLlxuICogSGlkZGVuIGNvbHVtbnMgYW5kIHN1Y2ggdGhhdCBkb24ndCBtYXRjaCB0aGUgcHJvdmlkZWQgbWVkaWEgcXVlcnkgYXJlIGlnbm9yZWQuXG4gKiBJZiBzb21lIG9mIHRoZSBjb2x1bW5zIGRvbid0IGhhdmUgYSBwcmVzZXQgd2lkdGggb3IgaGF2ZSBhbiBpbnZhbGlkIHdpZHRoIHZhbHVlLCB0aGUgZnVuY3Rpb24gcmV0dXJucyBgbnVsbGAuXG4gKi9cbmNvbnN0IGdldFJvd1dpZHRoRnJvbUNvbHVtbnNNZXRhID0gKGNvbHVtbnMpID0+IHtcbiAgICBpZiAoIWFsbENvbHVtbnNXaWR0aHNTZXQoY29sdW1ucykpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIGNvbnN0IGJvcmRlcnNXaWR0aCA9IDI7XG4gICAgY29uc3QgaW5pdGlhbFJvd1dpZGh0ID0gc2Nyb2xsYmFyV2lkdGgoKSArIGJvcmRlcnNXaWR0aDtcbiAgICByZXR1cm4gY29sdW1ucy5yZWR1Y2UoKHRvdGFsV2lkdGgsIGNvbHVtbikgPT4ge1xuICAgICAgICBpZiAoIWNvbHVtbi5oaWRkZW4gJiYgY29sdW1uLm1hdGNoZXNNZWRpYSkge1xuICAgICAgICAgICAgdG90YWxXaWR0aCArPSBwYXJzZUludChjb2x1bW4ud2lkdGgsIDEwKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdG90YWxXaWR0aDtcbiAgICB9LCBpbml0aWFsUm93V2lkaHQpO1xufTtcblxudmFyIE11bHRpQ29sdW1uQ29tYm9Cb3hDb21wb25lbnRfMTtcbi8qKlxuICogUmVwcmVzZW50cyB0aGUgW0tlbmRvIFVJIE11bHRpQ29sdW1uQ29tYm9Cb3ggY29tcG9uZW50IGZvciBBbmd1bGFyXSh7JSBzbHVnIG92ZXJ2aWV3X211bHRpY29sdW1uY29tYm9ib3ggJX0pLlxuICovXG5sZXQgTXVsdGlDb2x1bW5Db21ib0JveENvbXBvbmVudCA9IE11bHRpQ29sdW1uQ29tYm9Cb3hDb21wb25lbnRfMSA9IGNsYXNzIE11bHRpQ29sdW1uQ29tYm9Cb3hDb21wb25lbnQgZXh0ZW5kcyBDb21ib0JveENvbXBvbmVudCB7XG4gICAgY29uc3RydWN0b3IobG9jYWxpemF0aW9uLCBwb3B1cFNlcnZpY2UsIHNlbGVjdGlvblNlcnZpY2UsIG5hdmlnYXRpb25TZXJ2aWNlLCBkaXNhYmxlZEl0ZW1zU2VydmljZSwgZGF0YVNlcnZpY2UsIHpvbmUsIGNoYW5nZURldGVjdG9yLCByZW5kZXJlciwgd3JhcHBlciwgdG91Y2hFbmFibGVkJCQxKSB7XG4gICAgICAgIHN1cGVyKHdyYXBwZXIsIGxvY2FsaXphdGlvbiwgcG9wdXBTZXJ2aWNlLCBzZWxlY3Rpb25TZXJ2aWNlLCBuYXZpZ2F0aW9uU2VydmljZSwgZGlzYWJsZWRJdGVtc1NlcnZpY2UsIGRhdGFTZXJ2aWNlLCB6b25lLCBjaGFuZ2VEZXRlY3RvciwgcmVuZGVyZXIsIHRvdWNoRW5hYmxlZCQkMSk7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAaGlkZGVuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmhvc3RDbGFzc2VzID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5yZW1vdmVXaW5kb3dSZXNpemVMaXN0ZW5lciA9IG5vb3A7XG4gICAgICAgIC8vIHRoZSByb3cgaGVpZ2h0IGluIEBwcm9ncmVzcy9rZW5kby10aGVtZS1kZWZhdWx0XG4gICAgICAgIHRoaXMuZGVmYXVsdFZpcnR1YWxJdGVtSGVpZ2h0ID0gMzY7XG4gICAgICAgIC8vIHVzZSBhIHNtYWxsZXIgdmlydHVhbCBwYWdlIHNpemUgYXMgY29sdW1ucyB3aXRoIG11bHRpcGxlIGNlbGxzIGNhbiBjYXVzZSBwb29yIHBlcmZvcm1hbmNlXG4gICAgICAgIHRoaXMuZGVmYXVsdFZpcnR1YWxQYWdlU2l6ZSA9IDMwO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgZ2V0IGlzRGlzYWJsZWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRpc2FibGVkO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgc2V0IGhlYWRlcihoZWFkZXIpIHtcbiAgICAgICAgLy8gdXBkYXRlcyB0aGUgaGVhZGVyIHBhZGRpbmcgb24gaW5pdGlhbCByZW5kZXIgYXMgdGhlIHJlc2l6ZSBzZW56b3IgZG9lc24ndCBraWNrIGluIGFzIGVhcmx5XG4gICAgICAgIHRoaXMudXBkYXRlSGVhZGVyUGFkZGluZyhoZWFkZXIgJiYgaGVhZGVyLm5hdGl2ZUVsZW1lbnQpO1xuICAgIH1cbiAgICBnZXQgcG9wdXBXaWR0aCgpIHtcbiAgICAgICAgY29uc3Qgd3JhcHBlck9mZnNldFdpZHRoID0gdGhpcy53cmFwcGVyLm5hdGl2ZUVsZW1lbnQub2Zmc2V0V2lkdGg7XG4gICAgICAgIGNvbnN0IG1pbiA9IGAke3dyYXBwZXJPZmZzZXRXaWR0aH1weGA7XG4gICAgICAgIGNvbnN0IHdpZHRoID0gdGhpcy5wb3B1cFNldHRpbmdzLndpZHRoIHx8IGdldFJvd1dpZHRoRnJvbUNvbHVtbnNNZXRhKHRoaXMuY29sdW1ucykgfHwgd3JhcHBlck9mZnNldFdpZHRoO1xuICAgICAgICBjb25zdCBtYXggPSBpc05hTih3aWR0aCkgPyB3aWR0aCA6IGAke3dpZHRofXB4YDtcbiAgICAgICAgcmV0dXJuIHsgbWluLCBtYXggfTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIGdldCB0YWJsZVNpemVDbGFzcygpIHtcbiAgICAgICAgcmV0dXJuIGAke3RoaXMuc2l6ZSA/IGdldFNpemVDbGFzcygndGFibGUnLCB0aGlzLnNpemUpIDogJyd9YDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIGdldCBsaXN0Q29udGFpbmVyQ2xhc3NlcygpIHtcbiAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgICdrLXBvcHVwJyxcbiAgICAgICAgICAgICdrLWRyb3Bkb3duZ3JpZC1wb3B1cCdcbiAgICAgICAgXS5jb25jYXQodGhpcy5wb3B1cFNldHRpbmdzLnBvcHVwQ2xhc3MgfHwgW10pO1xuICAgIH1cbiAgICBuZ0FmdGVyVmlld0luaXQoKSB7XG4gICAgICAgIHRoaXMudXBkYXRlQ29sdW1uc01lZGlhU3RhdGUoKTtcbiAgICAgICAgdGhpcy5hZGRXaW5kb3dSZXNpemVMaXN0ZW5lcigpO1xuICAgIH1cbiAgICBuZ09uRGVzdHJveSgpIHtcbiAgICAgICAgc3VwZXIubmdPbkRlc3Ryb3koKTtcbiAgICAgICAgdGhpcy5yZW1vdmVXaW5kb3dSZXNpemVMaXN0ZW5lcigpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgdGV4dEZyb20oZGF0YUl0ZW0sIGZpZWxkKSB7XG4gICAgICAgIHJldHVybiBnZXR0ZXIkMShkYXRhSXRlbSwgZmllbGQpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICpcbiAgICAgKiBBZGRzIG9yIHJlbW92ZXMgYSBwYWRkaW5nIHZhbHVlIGF0IHRoZSBlbmQgb2YgdGhlIGhlYWRlciBjb250YWluZXIgZXF1YWwgdG8gdGhlIHNpemUgb2YgdGhlIHNjcm9sbGJhci5cbiAgICAgKiBBcyB3aGVuIHRoZSBpdGVtcyBjb250YWluZXIgaGFzIGEgc2Nyb2xsYmFyLCB0aGUgY29sdW1uIGhlYWRlcnMgYW5kIHRoZSBjZWxscyBhcmUgbWlzYWxpZ25lZC5cbiAgICAgKiBXaGVuIHRoZSBjb250YWluZXIgaGFzIGEgc2Nyb2xsYmFyLCB0aGUgcGFkZGluZyBzdHlsZSBpcyBhZGRlZCwgYW5kIHdoZW4gdGhlcmUgaXMgbm9uZSAtIGl0IGlzIHJlbW92ZWQuXG4gICAgICovXG4gICAgdXBkYXRlSGVhZGVyUGFkZGluZyhoZWFkZXIpIHtcbiAgICAgICAgaWYgKCFpc1ByZXNlbnQoaGVhZGVyKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIC8vIHRoZSBzY3JvbGxiYXIgaXMgcmVuZGVyZWQgb24gdGhlIGxlZnQgaW4gcnRsXG4gICAgICAgIGNvbnN0IGhlYWRlclBhZGRpbmdQb3NpdGlvbiA9IHRoaXMubG9jYWxpemF0aW9uLnJ0bCA/ICdwYWRkaW5nLWxlZnQnIDogJ3BhZGRpbmctcmlnaHQnO1xuICAgICAgICBpZiAodGhpcy5vcHRpb25zTGlzdC5oYXNTY3JvbGxiYXIoKSAmJiBzY3JvbGxiYXJXaWR0aCgpID4gMCkge1xuICAgICAgICAgICAgdGhpcy5yZW5kZXJlci5zZXRTdHlsZShoZWFkZXIsIGhlYWRlclBhZGRpbmdQb3NpdGlvbiwgYCR7c2Nyb2xsYmFyV2lkdGgoKX1weGApO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5yZW5kZXJlci5yZW1vdmVTdHlsZShoZWFkZXIsIGhlYWRlclBhZGRpbmdQb3NpdGlvbik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdmVyaWZ5U2V0dGluZ3MoKSB7XG4gICAgICAgIGlmICghaXNEZXZNb2RlKCkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaXNQcmVzZW50KHRoaXMuZGF0YSkgJiYgdGhpcy5kYXRhLmxlbmd0aCA+IDAgJiYgdGhpcy5kYXRhLnNvbWUoaXRlbSA9PiAhaXNPYmplY3QoaXRlbSkpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoTXVsdGlDb2x1bW5Db21ib0JveE1lc3NhZ2VzLmRhdGEpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghaXNQcmVzZW50KHRoaXMudmFsdWVGaWVsZCkgfHwgIWlzUHJlc2VudCh0aGlzLnRleHRGaWVsZCkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihNdWx0aUNvbHVtbkNvbWJvQm94TWVzc2FnZXMudGV4dEFuZFZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICBzdXBlci52ZXJpZnlTZXR0aW5ncygpO1xuICAgIH1cbiAgICBhZGRXaW5kb3dSZXNpemVMaXN0ZW5lcigpIHtcbiAgICAgICAgaWYgKCFpc0RvY3VtZW50QXZhaWxhYmxlKCkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnpvbmUucnVuT3V0c2lkZUFuZ3VsYXIoKCkgPT4gdGhpcy5yZW1vdmVXaW5kb3dSZXNpemVMaXN0ZW5lciA9IHRoaXMucmVuZGVyZXIubGlzdGVuKHdpbmRvdywgJ3Jlc2l6ZScsIHRoaXMudXBkYXRlQ29sdW1uc01lZGlhU3RhdGUuYmluZCh0aGlzKSkpO1xuICAgIH1cbiAgICB1cGRhdGVDb2x1bW5zTWVkaWFTdGF0ZSgpIHtcbiAgICAgICAgaWYgKCEoaXNQcmVzZW50KHRoaXMuY29sdW1ucykgJiYgaXNEb2N1bWVudEF2YWlsYWJsZSgpKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuY29sdW1ucy5mb3JFYWNoKGNvbHVtbiA9PiB7XG4gICAgICAgICAgICBjb25zdCBtYXRjaGVzTWVkaWEgPSAhY29sdW1uLm1lZGlhIHx8IHdpbmRvdy5tYXRjaE1lZGlhKGNvbHVtbi5tZWRpYSkubWF0Y2hlcztcbiAgICAgICAgICAgIGlmIChjb2x1bW4ubWF0Y2hlc01lZGlhICE9PSBtYXRjaGVzTWVkaWEpIHtcbiAgICAgICAgICAgICAgICBjb2x1bW4ubWF0Y2hlc01lZGlhID0gbWF0Y2hlc01lZGlhO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmlzT3Blbikge1xuICAgICAgICAgICAgICAgICAgICAvLyBlbnRlciB0aGUgem9uZSBvbmx5IGlmIHRoZSBwb3B1cCBpcyBhY3R1YWxseSBvcGVuXG4gICAgICAgICAgICAgICAgICAgIC8vIHVwZGF0ZSBpdHMgd2lkdGggaW4gY2FzZSBpdCdzIGRlcGVuZGVudCBvbiB0aGUgY29sdW1ucycgd2lkdGhcbiAgICAgICAgICAgICAgICAgICAgdGhpcy56b25lLnJ1bigoKSA9PiB0aGlzLnBvcHVwUmVmLnBvcHVwRWxlbWVudC5zdHlsZS53aWR0aCA9IHRoaXMucG9wdXBXaWR0aC5tYXgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxufTtcbl9fZGVjb3JhdGUoW1xuICAgIEhvc3RCaW5kaW5nKCdjbGFzcy5rLWRyb3Bkb3duZ3JpZCcpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBCb29sZWFuKVxuXSwgTXVsdGlDb2x1bW5Db21ib0JveENvbXBvbmVudC5wcm90b3R5cGUsIFwiaG9zdENsYXNzZXNcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIEhvc3RCaW5kaW5nKCdjbGFzcy5rLWRpc2FibGVkJyksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEJvb2xlYW4pLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246cGFyYW10eXBlc1wiLCBbXSlcbl0sIE11bHRpQ29sdW1uQ29tYm9Cb3hDb21wb25lbnQucHJvdG90eXBlLCBcImlzRGlzYWJsZWRcIiwgbnVsbCk7XG5fX2RlY29yYXRlKFtcbiAgICBDb250ZW50Q2hpbGRyZW4oQ29tYm9Cb3hDb2x1bW5Db21wb25lbnQpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBRdWVyeUxpc3QpXG5dLCBNdWx0aUNvbHVtbkNvbWJvQm94Q29tcG9uZW50LnByb3RvdHlwZSwgXCJjb2x1bW5zXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBWaWV3Q2hpbGQoJ2hlYWRlcicsIHsgc3RhdGljOiBmYWxzZSB9KSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgRWxlbWVudFJlZiksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjpwYXJhbXR5cGVzXCIsIFtFbGVtZW50UmVmXSlcbl0sIE11bHRpQ29sdW1uQ29tYm9Cb3hDb21wb25lbnQucHJvdG90eXBlLCBcImhlYWRlclwiLCBudWxsKTtcbk11bHRpQ29sdW1uQ29tYm9Cb3hDb21wb25lbnQgPSBNdWx0aUNvbHVtbkNvbWJvQm94Q29tcG9uZW50XzEgPSBfX2RlY29yYXRlKFtcbiAgICBDb21wb25lbnQoe1xuICAgICAgICBwcm92aWRlcnM6IFtcbiAgICAgICAgICAgIFNlbGVjdGlvblNlcnZpY2UsXG4gICAgICAgICAgICBEYXRhU2VydmljZSxcbiAgICAgICAgICAgIE5hdmlnYXRpb25TZXJ2aWNlLFxuICAgICAgICAgICAgRGlzYWJsZWRJdGVtc1NlcnZpY2UsXG4gICAgICAgICAgICBMb2NhbGl6YXRpb25TZXJ2aWNlLFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHByb3ZpZGU6IEwxME5fUFJFRklYLFxuICAgICAgICAgICAgICAgIHVzZVZhbHVlOiAna2VuZG8ubXVsdGljb2x1bW5jb21ib2JveCdcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgbXVsdGk6IHRydWUsXG4gICAgICAgICAgICAgICAgcHJvdmlkZTogTkdfVkFMVUVfQUNDRVNTT1IsXG4gICAgICAgICAgICAgICAgdXNlRXhpc3Rpbmc6IGZvcndhcmRSZWYoKCkgPT4gTXVsdGlDb2x1bW5Db21ib0JveENvbXBvbmVudF8xKVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBwcm92aWRlOiBLZW5kb0lucHV0LFxuICAgICAgICAgICAgICAgIHVzZUV4aXN0aW5nOiBmb3J3YXJkUmVmKCgpID0+IE11bHRpQ29sdW1uQ29tYm9Cb3hDb21wb25lbnRfMSlcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcHJvdmlkZTogRmlsdGVyYWJsZUNvbXBvbmVudCxcbiAgICAgICAgICAgICAgICB1c2VFeGlzdGluZzogZm9yd2FyZFJlZigoKSA9PiBNdWx0aUNvbHVtbkNvbWJvQm94Q29tcG9uZW50XzEpXG4gICAgICAgICAgICB9XG4gICAgICAgIF0sXG4gICAgICAgIHNlbGVjdG9yOiAna2VuZG8tbXVsdGljb2x1bW5jb21ib2JveCcsXG4gICAgICAgIHRlbXBsYXRlOiBgXG4gICAgICAgIDxuZy1jb250YWluZXJcbiAgICAgICAgICAgIGtlbmRvTXVsdGlDb2x1bW5Db21ib0JveExvY2FsaXplZE1lc3NhZ2VzXG5cbiAgICAgICAgICAgIGkxOG4tbm9EYXRhVGV4dD1cImtlbmRvLm11bHRpY29sdW1uY29tYm9ib3gubm9EYXRhVGV4dHxUaGUgdGV4dCBkaXNwbGF5ZWQgaW4gdGhlIHBvcHVwIHdoZW4gdGhlcmUgYXJlIG5vIGl0ZW1zXCJcbiAgICAgICAgICAgIG5vRGF0YVRleHQ9XCJOTyBEQVRBIEZPVU5EXCJcblxuICAgICAgICAgICAgaTE4bi1jbGVhclRpdGxlPVwia2VuZG8ubXVsdGljb2x1bW5jb21ib2JveC5jbGVhclRpdGxlfFRoZSB0aXRsZSBvZiB0aGUgY2xlYXIgYnV0dG9uXCJcbiAgICAgICAgICAgIGNsZWFyVGl0bGU9XCJjbGVhclwiXG4gICAgICAgID5cbiAgICAgICAgPC9uZy1jb250YWluZXI+XG4gICAgICAgIDxrZW5kby1zZWFyY2hiYXJcbiAgICAgICAgICAgICNzZWFyY2hiYXJcbiAgICAgICAgICAgIFtyb2xlXT1cIidjb21ib2JveCdcIlxuICAgICAgICAgICAgW2lkXT1cImZvY3VzYWJsZUlkXCJcbiAgICAgICAgICAgIFtsaXN0SWRdPVwibGlzdEJveElkXCJcbiAgICAgICAgICAgIFthY3RpdmVEZXNjZW5kYW50XT1cImFjdGl2ZURlc2NlbmRhbnRcIlxuICAgICAgICAgICAgW25vRGF0YUxhYmVsXT1cIm5vRGF0YUxhYmVsXCJcbiAgICAgICAgICAgIFt1c2VySW5wdXRdPVwidGV4dFwiXG4gICAgICAgICAgICBbc3VnZ2VzdGVkVGV4dF09XCJnZXRTdWdnZXN0aW9uKClcIlxuICAgICAgICAgICAgW2Rpc2FibGVkXT1cImRpc2FibGVkXCJcbiAgICAgICAgICAgIFtyZWFkb25seV09XCJyZWFkb25seVwiXG4gICAgICAgICAgICBbdGFiSW5kZXhdPVwidGFiSW5kZXhcIlxuICAgICAgICAgICAgW3BvcHVwT3Blbl09XCJpc09wZW5cIlxuICAgICAgICAgICAgW3BsYWNlaG9sZGVyXT1cInBsYWNlaG9sZGVyXCJcbiAgICAgICAgICAgIChvbk5hdmlnYXRlKT1cImhhbmRsZU5hdmlnYXRlKCRldmVudClcIlxuICAgICAgICAgICAgKHZhbHVlQ2hhbmdlKT1cInNlYXJjaEJhckNoYW5nZSgkZXZlbnQpXCJcbiAgICAgICAgICAgIChvbkJsdXIpPVwiaGFuZGxlQmx1cigpXCJcbiAgICAgICAgICAgIChvbkZvY3VzKT1cImhhbmRsZUZvY3VzKClcIlxuICAgICAgICA+XG4gICAgICAgIDwva2VuZG8tc2VhcmNoYmFyPlxuXG4gICAgICAgIDxzcGFuXG4gICAgICAgICAgICAqbmdJZj1cImNsZWFyQnV0dG9uICYmICFsb2FkaW5nICYmICFkaXNhYmxlZCAmJiAhcmVhZG9ubHkgJiYgdGV4dD8ubGVuZ3RoXCJcbiAgICAgICAgICAgIGNsYXNzPVwiay1jbGVhci12YWx1ZVwiXG4gICAgICAgICAgICBbc3R5bGUudmlzaWJpbGl0eV09XCJjbGVhckJ1dHRvblZpc2libGl0eVwiXG4gICAgICAgICAgICBhcmlhLWhpZGRlbj1cInRydWVcIlxuICAgICAgICAgICAgW2F0dHIudGl0bGVdPVwibWVzc2FnZUZvcignY2xlYXJUaXRsZScpXCJcbiAgICAgICAgICAgIChjbGljayk9XCJjbGVhclZhbHVlKCRldmVudClcIlxuICAgICAgICAgICAgW2tlbmRvRXZlbnRzT3V0c2lkZUFuZ3VsYXJdPVwie1xuICAgICAgICAgICAgICAgIG1vdXNlZG93bjogcHJldmVudEV2ZW50RGVmYXVsdFxuICAgICAgICAgICAgfVwiXG4gICAgICAgID5cbiAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwiay1pY29uIGstaS14XCI+PC9zcGFuPlxuICAgICAgICA8L3NwYW4+XG5cbiAgICAgICAgPGJ1dHRvblxuICAgICAgICAgICAgI3NlbGVjdFxuICAgICAgICAgICAgdGFiaW5kZXg9XCItMVwiXG4gICAgICAgICAgICBhcmlhLWhpZGRlbj1cInRydWVcIlxuICAgICAgICAgICAgdW5zZWxlY3RhYmxlPVwib25cIlxuICAgICAgICAgICAgdHlwZT1cImJ1dHRvblwiXG4gICAgICAgICAgICBjbGFzcz1cImstaW5wdXQtYnV0dG9uIGstYnV0dG9uIGstaWNvbi1idXR0b25cIlxuICAgICAgICAgICAgW25nQ2xhc3NdPVwic2VsZWN0QnV0dG9uQ2xhc3Nlc1wiXG4gICAgICAgICAgICBbYXR0ci5hcmlhLWxhYmVsXT1cIm1lc3NhZ2VGb3IoJ3NlbGVjdEJ1dHRvblRleHQnKVwiXG4gICAgICAgICAgICBba2VuZG9FdmVudHNPdXRzaWRlQW5ndWxhcl09XCJ7XG4gICAgICAgICAgICAgICAgbW91c2Vkb3duOiBwcmV2ZW50RXZlbnREZWZhdWx0XG4gICAgICAgICAgICB9XCJcbiAgICAgICAgPlxuICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJrLWJ1dHRvbi1pY29uIGstaWNvblwiIFtuZ0NsYXNzXT1cImJ1dHRvbkNsYXNzZXNcIj48L3NwYW4+XG4gICAgICAgIDwvYnV0dG9uPlxuXG4gICAgICAgIDxuZy10ZW1wbGF0ZSAjcG9wdXBUZW1wbGF0ZT5cbiAgICAgICAgICAgIDwhLS11c2VyLWRlZmluZWQgaGVhZGVyIHRlbXBsYXRlIC0tPlxuICAgICAgICAgICAgPG5nLXRlbXBsYXRlXG4gICAgICAgICAgICAgICAgKm5nSWY9XCJoZWFkZXJUZW1wbGF0ZVwiXG4gICAgICAgICAgICAgICAgW3RlbXBsYXRlQ29udGV4dF09XCJ7XG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlUmVmOiBoZWFkZXJUZW1wbGF0ZT8udGVtcGxhdGVSZWZcbiAgICAgICAgICAgICAgICB9XCJcbiAgICAgICAgICAgID5cbiAgICAgICAgICAgIDwvbmctdGVtcGxhdGU+XG5cbiAgICAgICAgICAgIDwhLS1kYXRhIHRhYmxlLS0+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwiay1kYXRhLXRhYmxlXCIgW25nQ2xhc3NdPVwidGFibGVTaXplQ2xhc3NcIj5cblxuICAgICAgICAgICAgICAgIDwhLS1ncmlkIGhlYWRlci0tPlxuICAgICAgICAgICAgICAgIDxkaXZcbiAgICAgICAgICAgICAgICAgICAgI2hlYWRlclxuICAgICAgICAgICAgICAgICAgICBjbGFzcz1cImstdGFibGUtaGVhZGVyXCJcbiAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJrLXRhYmxlLWhlYWRlci13cmFwXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8dGFibGUgY2xhc3M9XCJrLXRhYmxlXCIgcm9sZT1cInByZXNlbnRhdGlvblwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxjb2xncm91cD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPG5nLWNvbnRhaW5lciAqbmdGb3I9XCJsZXQgY29sdW1uIG9mIGNvbHVtbnNcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxjb2xcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqbmdJZj1cIiFjb2x1bW4uaGlkZGVuICYmIGNvbHVtbi5tYXRjaGVzTWVkaWFcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtzdHlsZS53aWR0aC5weF09XCJjb2x1bW4ud2lkdGhcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9uZy1jb250YWluZXI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9jb2xncm91cD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGhlYWQgY2xhc3M9XCJrLXRhYmxlLXRoZWFkXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ciBjbGFzcz1cImstdGFibGUtcm93XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bmctY29udGFpbmVyICpuZ0Zvcj1cImxldCBjb2x1bW4gb2YgY29sdW1uc1wiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0aFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqbmdJZj1cIiFjb2x1bW4uaGlkZGVuICYmIGNvbHVtbi5tYXRjaGVzTWVkaWFcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzcz1cImstdGFibGUtdGhcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbbmdTdHlsZV09XCJjb2x1bW4uaGVhZGVyU3R5bGVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbbmdDbGFzc109XCJjb2x1bW4uaGVhZGVyQ2xhc3NcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPG5nLWNvbnRhaW5lciAqbmdJZj1cIiFjb2x1bW4uaGVhZGVyVGVtcGxhdGVcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHt7IGNvbHVtbi50aXRsZSB8fCBjb2x1bW4uZmllbGQgfX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9uZy1jb250YWluZXI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxuZy10ZW1wbGF0ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKm5nSWY9XCJjb2x1bW4uaGVhZGVyVGVtcGxhdGVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW3RlbXBsYXRlQ29udGV4dF09XCJ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVSZWY6IGNvbHVtbi5oZWFkZXJUZW1wbGF0ZT8udGVtcGxhdGVSZWYsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJGltcGxpY2l0OiBjb2x1bW4sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sdW1uOiBjb2x1bW5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvbmctdGVtcGxhdGU+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90aD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvbmctY29udGFpbmVyPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RyPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGhlYWQ+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L3RhYmxlPlxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cblxuICAgICAgICAgICAgICAgIDwhLS0gaXRlbSB0ZW1wbGF0ZSAtLT5cbiAgICAgICAgICAgICAgICA8bmctdGVtcGxhdGUgI3Jvd1RlbXBsYXRlIGxldC1kYXRhSXRlbT5cbiAgICAgICAgICAgICAgICAgICAgPG5nLWNvbnRhaW5lciAqbmdGb3I9XCJsZXQgY29sdW1uIG9mIGNvbHVtbnNcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKm5nSWY9XCIhY29sdW1uLmhpZGRlbiAmJiBjb2x1bW4ubWF0Y2hlc01lZGlhXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzcz1cImstdGFibGUtdGRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtuZ0NsYXNzXT1cImNvbHVtbi5jbGFzc1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgW3N0eWxlLndpZHRoLnB4XT1cImNvbHVtbi53aWR0aFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgW25nU3R5bGVdPVwiY29sdW1uLnN0eWxlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bmctY29udGFpbmVyICpuZ0lmPVwiIWNvbHVtbi5jZWxsVGVtcGxhdGVcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge3sgdGV4dEZyb20oZGF0YUl0ZW0sIGNvbHVtbi5maWVsZCkgfX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L25nLWNvbnRhaW5lcj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bmctdGVtcGxhdGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKm5nSWY9XCJjb2x1bW4uY2VsbFRlbXBsYXRlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW3RlbXBsYXRlQ29udGV4dF09XCJ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVJlZjogY29sdW1uLmNlbGxUZW1wbGF0ZT8udGVtcGxhdGVSZWYsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkaW1wbGljaXQ6IGRhdGFJdGVtLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YUl0ZW06IGRhdGFJdGVtLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sdW1uOiBjb2x1bW5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvbmctdGVtcGxhdGU+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgIDwvbmctY29udGFpbmVyPlxuICAgICAgICAgICAgICAgIDwvbmctdGVtcGxhdGU+XG5cbiAgICAgICAgICAgICAgICA8IS0tbGlzdC0tPlxuICAgICAgICAgICAgICAgIDxrZW5kby1saXN0XG4gICAgICAgICAgICAgICAgICAgICNvcHRpb25zTGlzdFxuICAgICAgICAgICAgICAgICAgICBbaWRdPVwibGlzdEJveElkXCJcbiAgICAgICAgICAgICAgICAgICAgW29wdGlvblByZWZpeF09XCJvcHRpb25QcmVmaXhcIlxuICAgICAgICAgICAgICAgICAgICBbZGF0YV09XCJkYXRhXCJcbiAgICAgICAgICAgICAgICAgICAgW3RleHRGaWVsZF09XCJ0ZXh0RmllbGRcIlxuICAgICAgICAgICAgICAgICAgICBbdmFsdWVGaWVsZF09XCJ2YWx1ZUZpZWxkXCJcbiAgICAgICAgICAgICAgICAgICAgW3RlbXBsYXRlXT1cInsgdGVtcGxhdGVSZWY6IHJvd1RlbXBsYXRlIH1cIlxuICAgICAgICAgICAgICAgICAgICBbZ3JvdXBUZW1wbGF0ZV09XCJncm91cFRlbXBsYXRlXCJcbiAgICAgICAgICAgICAgICAgICAgW2ZpeGVkR3JvdXBUZW1wbGF0ZV09XCJmaXhlZEdyb3VwVGVtcGxhdGVcIlxuICAgICAgICAgICAgICAgICAgICBbaGVpZ2h0XT1cImxpc3RIZWlnaHRcIlxuICAgICAgICAgICAgICAgICAgICBbc2hvd109XCJpc09wZW5cIlxuICAgICAgICAgICAgICAgICAgICBbdmlydHVhbF09XCJ2aXJ0dWFsXCJcbiAgICAgICAgICAgICAgICAgICAgW3R5cGVdPVwiJ2Ryb3Bkb3duZ3JpZCdcIlxuICAgICAgICAgICAgICAgICAgICAocGFnZUNoYW5nZSk9XCJwYWdlQ2hhbmdlKCRldmVudClcIlxuICAgICAgICAgICAgICAgICAgICAobGlzdFJlc2l6ZSk9XCJ1cGRhdGVIZWFkZXJQYWRkaW5nKGhlYWRlcilcIlxuICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICA8L2tlbmRvLWxpc3Q+XG5cbiAgICAgICAgICAgICAgICA8IS0tbm8tZGF0YSB0ZW1wbGF0ZS0tPlxuICAgICAgICAgICAgICAgIDxkaXZcbiAgICAgICAgICAgICAgICAgICAgY2xhc3M9XCJrLW5vLWRhdGFcIlxuICAgICAgICAgICAgICAgICAgICAqbmdJZj1cImRhdGEubGVuZ3RoID09PSAwXCJcbiAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgIDxuZy10ZW1wbGF0ZVxuICAgICAgICAgICAgICAgICAgICAgICAgW25nSWZdPVwibm9EYXRhVGVtcGxhdGVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgW3RlbXBsYXRlQ29udGV4dF09XCJ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVSZWY6IG5vRGF0YVRlbXBsYXRlPy50ZW1wbGF0ZVJlZlxuICAgICAgICAgICAgICAgICAgICAgICAgfVwiXG4gICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgPC9uZy10ZW1wbGF0ZT5cbiAgICAgICAgICAgICAgICAgICAgPG5nLXRlbXBsYXRlIFtuZ0lmXT1cIiFub0RhdGFUZW1wbGF0ZVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdj57eyBtZXNzYWdlRm9yKCdub0RhdGFUZXh0JykgfX08L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgPC9uZy10ZW1wbGF0ZT5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cblxuICAgICAgICAgICAgICAgIDwhLS11c2VyLWRlZmluZWQgZm9vdGVyIHRlbXBsYXRlLS0+XG4gICAgICAgICAgICAgICAgPG5nLWNvbnRhaW5lciAqbmdJZj1cImZvb3RlclRlbXBsYXRlXCI+XG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJrLXRhYmxlLWZvb3RlclwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPHRhYmxlIGNsYXNzPVwiay10YWJsZVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0Zm9vdCBjbGFzcz1cImstdGFibGUtdGZvb3RcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRyIGNsYXNzPVwiay10YWJsZS1yb3dcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ZCBjbGFzcz1cImstdGFibGUtdGRcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bmctdGVtcGxhdGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW3RlbXBsYXRlQ29udGV4dF09XCJ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVJlZjogZm9vdGVyVGVtcGxhdGUudGVtcGxhdGVSZWZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvbmctdGVtcGxhdGU+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RkPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RyPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGZvb3Q+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L3RhYmxlPlxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICA8L25nLWNvbnRhaW5lcj5cblxuICAgICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgPC9uZy10ZW1wbGF0ZT5cblxuICAgICAgICA8a2VuZG8tcmVzaXplLXNlbnNvclxuICAgICAgICAgICAgKm5nSWY9XCJpc09wZW5cIlxuICAgICAgICAgICAgKHJlc2l6ZSk9XCJvblJlc2l6ZSgpXCJcbiAgICAgICAgPlxuICAgICAgICA8L2tlbmRvLXJlc2l6ZS1zZW5zb3I+XG5cbiAgICAgICAgPCEtLSB3aGVuIHRoZSBwb3B1cFNldHRpbmdzLmFwcGVuZFRvIHZhbHVlIGlzIHNldCB0byAnY29tcG9uZW50JywgdGhpcyBjb250YWluZXIgaXMgdXNlZCAtLT5cbiAgICAgICAgPG5nLWNvbnRhaW5lciAjY29udGFpbmVyPjwvbmctY29udGFpbmVyPlxuICAgIGBcbiAgICB9KSxcbiAgICBfX3BhcmFtKDEwLCBJbmplY3QoVE9VQ0hfRU5BQkxFRCkpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246cGFyYW10eXBlc1wiLCBbTG9jYWxpemF0aW9uU2VydmljZSxcbiAgICAgICAgUG9wdXBTZXJ2aWNlLFxuICAgICAgICBTZWxlY3Rpb25TZXJ2aWNlLFxuICAgICAgICBOYXZpZ2F0aW9uU2VydmljZSxcbiAgICAgICAgRGlzYWJsZWRJdGVtc1NlcnZpY2UsXG4gICAgICAgIERhdGFTZXJ2aWNlLFxuICAgICAgICBOZ1pvbmUsXG4gICAgICAgIENoYW5nZURldGVjdG9yUmVmLFxuICAgICAgICBSZW5kZXJlcjIsXG4gICAgICAgIEVsZW1lbnRSZWYsIEJvb2xlYW5dKVxuXSwgTXVsdGlDb2x1bW5Db21ib0JveENvbXBvbmVudCk7XG5cbi8qKlxuICogUmVuZGVycyB0aGUgY29udGVudCBvZiBlYWNoIG5vZGUgaW4gdGhlIERyb3BEb3duVHJlZS4gVG8gZGVmaW5lIGEgbm9kZSB0ZW1wbGF0ZSwgbmVzdCBhbiBgPG5nLXRlbXBsYXRlPmAgdGFnXG4gKiB3aXRoIHRoZSBga2VuZG9Ecm9wRG93blRyZWVOb2RlVGVtcGxhdGVgIGRpcmVjdGl2ZSBpbnNpZGUgdGhlIGA8a2VuZG8tZHJvcGRvd250cmVlPmAgdGFnLlxuICpcbiAqIFRoZSBjdXJyZW50IGRhdGEgaXRlbSBhbmQgaGllcmFyY2hpY2FsIGluZGV4IGFyZSBhdmFpbGFibGUgYXMgY29udGV4dCB2YXJpYWJsZXM6XG4gKlxuICogLSBgbGV0LWRhdGFJdGVtYCAoYGFueWApIC0gVGhlIGN1cnJlbnQgZGF0YSBpdGVtLiBBdmFpbGFibGUgYXMgaW1wbGljaXQgY29udGV4dCB2YXJpYWJsZS5cbiAqIC0gYGxldC1pbmRleD1cImluZGV4XCJgIChgc3RyaW5nYCkgLSBUaGUgY3VycmVudCBpdGVtIGhpZXJhcmNoaWNhbCBpbmRleC5cbiAqL1xubGV0IE5vZGVUZW1wbGF0ZURpcmVjdGl2ZSA9IGNsYXNzIE5vZGVUZW1wbGF0ZURpcmVjdGl2ZSB7XG4gICAgY29uc3RydWN0b3IodGVtcGxhdGVSZWYpIHtcbiAgICAgICAgdGhpcy50ZW1wbGF0ZVJlZiA9IHRlbXBsYXRlUmVmO1xuICAgIH1cbn07XG5Ob2RlVGVtcGxhdGVEaXJlY3RpdmUgPSBfX2RlY29yYXRlKFtcbiAgICBEaXJlY3RpdmUoe1xuICAgICAgICBzZWxlY3RvcjogJ1trZW5kb0Ryb3BEb3duVHJlZU5vZGVUZW1wbGF0ZV0sIFtrZW5kb011bHRpU2VsZWN0VHJlZU5vZGVUZW1wbGF0ZV0nXG4gICAgfSksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjpwYXJhbXR5cGVzXCIsIFtUZW1wbGF0ZVJlZl0pXG5dLCBOb2RlVGVtcGxhdGVEaXJlY3RpdmUpO1xuXG52YXIgRHJvcERvd25UcmVlQ29tcG9uZW50XzE7XG4vKiB0c2xpbnQ6ZGlzYWJsZTptZW1iZXItb3JkZXJpbmcgKi9cbmNvbnN0IERFRkFVTFRfUE9QVVBfU0VUVElOR1MgPSB7IGFuaW1hdGU6IHRydWUgfTtcbmNvbnN0IGhhc0NoaWxkcmVuID0gKCkgPT4gZmFsc2U7XG5jb25zdCBmZXRjaENoaWxkcmVuID0gKCkgPT4gb2YoW10pO1xuY29uc3QgaXRlbURpc2FibGVkID0gKCkgPT4gZmFsc2U7XG5jb25zdCBpc05vZGVWaXNpYmxlID0gKCkgPT4gdHJ1ZTtcbi8qKlxuICogUmVwcmVzZW50cyB0aGUgW0tlbmRvIFVJIERyb3BEb3duVHJlZSBjb21wb25lbnQgZm9yIEFuZ3VsYXJdKHslIHNsdWcgb3ZlcnZpZXdfZGR0ICV9KS5cbiAqL1xubGV0IERyb3BEb3duVHJlZUNvbXBvbmVudCA9IERyb3BEb3duVHJlZUNvbXBvbmVudF8xID0gY2xhc3MgRHJvcERvd25UcmVlQ29tcG9uZW50IHtcbiAgICBjb25zdHJ1Y3Rvcih3cmFwcGVyLCBwb3B1cFNlcnZpY2UsIG5hdmlnYXRpb25TZXJ2aWNlLCByZW5kZXJlciwgX3pvbmUsIGNkciwgbG9jYWxpemF0aW9uLCB0b3VjaEVuYWJsZWQkJDEpIHtcbiAgICAgICAgdGhpcy53cmFwcGVyID0gd3JhcHBlcjtcbiAgICAgICAgdGhpcy5wb3B1cFNlcnZpY2UgPSBwb3B1cFNlcnZpY2U7XG4gICAgICAgIHRoaXMubmF2aWdhdGlvblNlcnZpY2UgPSBuYXZpZ2F0aW9uU2VydmljZTtcbiAgICAgICAgdGhpcy5yZW5kZXJlciA9IHJlbmRlcmVyO1xuICAgICAgICB0aGlzLl96b25lID0gX3pvbmU7XG4gICAgICAgIHRoaXMuY2RyID0gY2RyO1xuICAgICAgICB0aGlzLmxvY2FsaXphdGlvbiA9IGxvY2FsaXphdGlvbjtcbiAgICAgICAgdGhpcy50b3VjaEVuYWJsZWQgPSB0b3VjaEVuYWJsZWQkJDE7XG4gICAgICAgIHRoaXMuaG9zdENsYXNzZXMgPSB0cnVlO1xuICAgICAgICB0aGlzLnJvbGUgPSAnbGlzdGJveCc7XG4gICAgICAgIHRoaXMuYXJpYUhhc1BvcHVwID0gJ3RyZWUnO1xuICAgICAgICAvKipcbiAgICAgICAgICogRmlyZXMgZWFjaCB0aW1lIHRoZSBwb3B1cCBpcyBhYm91dCB0byBvcGVuXG4gICAgICAgICAqIChbc2VlIGV4YW1wbGVdKHslIHNsdWcgb3BlbnN0YXRlX2RkdCAlfSkpLlxuICAgICAgICAgKiBUaGlzIGV2ZW50IGlzIHByZXZlbnRhYmxlLiBJZiB5b3UgY2FuY2VsIGl0LCB0aGUgcG9wdXAgd2lsbCByZW1haW4gY2xvc2VkLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5vcGVuID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICAgICAgICAvKipcbiAgICAgICAgICogRmlyZXMgYWZ0ZXIgdGhlIHBvcHVwIGhhcyBiZWVuIG9wZW5lZC5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMub3BlbmVkID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICAgICAgICAvKipcbiAgICAgICAgICogRmlyZXMgZWFjaCB0aW1lIHRoZSBwb3B1cCBpcyBhYm91dCB0byBjbG9zZVxuICAgICAgICAgKiAoW3NlZSBleGFtcGxlXSh7JSBzbHVnIG9wZW5zdGF0ZV9kZHQgJX0pKS5cbiAgICAgICAgICogVGhpcyBldmVudCBpcyBwcmV2ZW50YWJsZS4gSWYgeW91IGNhbmNlbCBpdCwgdGhlIHBvcHVwIHdpbGwgcmVtYWluIG9wZW4uXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmNsb3NlID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICAgICAgICAvKipcbiAgICAgICAgICogRmlyZXMgYWZ0ZXIgdGhlIHBvcHVwIGhhcyBiZWVuIGNsb3NlZC5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuY2xvc2VkID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICAgICAgICAvKipcbiAgICAgICAgICogRmlyZXMgd2hlbiB0aGUgdXNlciBleHBhbmRzIGEgbm9kZSBpbiB0aGUgcG9wdXAgVHJlZVZpZXcuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLm5vZGVFeHBhbmQgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBGaXJlcyB3aGVuIHRoZSB1c2VyIGNvbGxhcHNlcyBhIG5vZGUgaW4gdGhlIHBvcHVwIFRyZWVWaWV3LlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5ub2RlQ29sbGFwc2UgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBGaXJlcyBlYWNoIHRpbWUgdGhlIHVzZXIgZm9jdXNlcyB0aGUgRHJvcERvd25UcmVlLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5vbkZvY3VzID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICAgICAgICAvKipcbiAgICAgICAgICogRmlyZXMgZWFjaCB0aW1lIHRoZSBEcm9wRG93blRyZWUgZ2V0cyBibHVycmVkLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5vbkJsdXIgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBGaXJlcyBlYWNoIHRpbWUgdGhlIHZhbHVlIGlzIGNoYW5nZWRcbiAgICAgICAgICogKFtzZWUgZXhhbXBsZV0oeyUgc2x1ZyBvdmVydmlld19kZHQgJX0jdG9jLWV2ZW50cykpLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy52YWx1ZUNoYW5nZSA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEZpcmVzIHdoZW4gdGhlIHZhbHVlIG9mIHRoZSBidWlsdC1pbiBmaWx0ZXIgaW5wdXQgZWxlbWVudCBjaGFuZ2VzLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5maWx0ZXJDaGFuZ2UgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBJZiBzZXQgdG8gYHRydWVgLCByZW5kZXJzIGEgYnV0dG9uIG9uIGhvdmVyaW5nIG92ZXIgdGhlIGNvbXBvbmVudC5cbiAgICAgICAgICogQ2xpY2tpbmcgdGhpcyBidXR0b24gcmVzZXRzIHRoZSB2YWx1ZSBvZiB0aGUgY29tcG9uZW50IHRvIGB1bmRlZmluZWRgIGFuZCB0cmlnZ2VycyB0aGUgYGNoYW5nZWAgZXZlbnQuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmNsZWFyQnV0dG9uID0gdHJ1ZTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEEgZnVuY3Rpb24gd2hpY2ggZGV0ZXJtaW5lcyBpZiBhIHNwZWNpZmljIG5vZGUgaGFzIGNoaWxkIG5vZGVzLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5oYXNDaGlsZHJlbiA9IGhhc0NoaWxkcmVuO1xuICAgICAgICAvKipcbiAgICAgICAgICogQSBmdW5jdGlvbiB3aGljaCBwcm92aWRlcyB0aGUgY2hpbGQgbm9kZXMgZm9yIGEgZ2l2ZW4gcGFyZW50IG5vZGUuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmZldGNoQ2hpbGRyZW4gPSBmZXRjaENoaWxkcmVuO1xuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIGhpbnQgd2hpY2ggaXMgZGlzcGxheWVkIHdoZW4gdGhlIGNvbXBvbmVudCBpcyBlbXB0eS5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMucGxhY2Vob2xkZXIgPSBcIlwiO1xuICAgICAgICAvKipcbiAgICAgICAgICogU2V0cyB0aGUgaGVpZ2h0IG9mIHRoZSBvcHRpb25zIGxpc3QuIEJ5IGRlZmF1bHQsIGBsaXN0SGVpZ2h0YCBpcyAyMDBweC5cbiAgICAgICAgICpcbiAgICAgICAgICogPiBUaGUgYGxpc3RIZWlnaHRgIHByb3BlcnR5IGFmZmVjdHMgb25seSB0aGUgbGlzdCBvZiBvcHRpb25zIGFuZCBub3QgdGhlIHdob2xlIHBvcHVwIGNvbnRhaW5lci5cbiAgICAgICAgICogPiBUbyBzZXQgdGhlIGhlaWdodCBvZiB0aGUgcG9wdXAgY29udGFpbmVyLCB1c2UgYHBvcHVwU2V0dGluZ3MuaGVpZ2h0YC5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMubGlzdEhlaWdodCA9IDIwMDtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFNldHMgdGhlIGRpc2FibGVkIHN0YXRlIG9mIHRoZSBjb21wb25lbnQuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmRpc2FibGVkID0gZmFsc2U7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBTZXRzIHRoZSByZWFkLW9ubHkgc3RhdGUgb2YgdGhlIGNvbXBvbmVudC5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMucmVhZG9ubHkgPSBmYWxzZTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFNwZWNpZmllcyB0aGUgdHlwZSBvZiB0aGUgc2VsZWN0ZWQgdmFsdWVcbiAgICAgICAgICogKFttb3JlIGluZm9ybWF0aW9uIGFuZCBleGFtcGxlXSh7JSBzbHVnIHZhbHVlYmluZGluZ19kZHQgJX0jdG9jLXByaW1pdGl2ZS12YWx1ZXMpKS5cbiAgICAgICAgICogSWYgc2V0IHRvIGB0cnVlYCwgdGhlIHNlbGVjdGVkIHZhbHVlIGhhcyB0byBiZSBvZiBhIHByaW1pdGl2ZSB2YWx1ZS5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMudmFsdWVQcmltaXRpdmUgPSBmYWxzZTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEEgZnVuY3Rpb24gdGhhdCBpcyBleGVjdXRlZCBmb3IgZWFjaCBkYXRhIGl0ZW0gYW5kIGRldGVybWluZXMgaWYgYSBzcGVjaWZpYyBpdGVtIGlzIGRpc2FibGVkLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5pdGVtRGlzYWJsZWQgPSBpdGVtRGlzYWJsZWQ7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBIGNhbGxiYWNrIHdoaWNoIGRldGVybWluZXMgd2hldGhlciBhIHRyZWUgbm9kZSBzaG91bGQgYmUgcmVuZGVyZWQgYXMgaGlkZGVuLiBUaGUgdXRpbGl0eSAuay1kaXNwbGF5LW5vbmUgY2xhc3MgaXMgdXNlZCB0byBoaWRlIHRoZSBub2Rlcy5cbiAgICAgICAgICogVXNlZnVsIGZvciBjdXN0b20gZmlsdGVyaW5nIGltcGxlbWVudGF0aW9ucy5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuaXNOb2RlVmlzaWJsZSA9IGlzTm9kZVZpc2libGU7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBJbmRpY2F0ZXMgd2hldGhlciB0aGUgY2hpbGQgbm9kZXMgd2lsbCBiZSBmZXRjaGVkIG9uIG5vZGUgZXhwYW5kIG9yIHdpbGwgYmUgaW5pdGlhbGx5IHByZWZldGNoZWQuXG4gICAgICAgICAqIEBkZWZhdWx0IHRydWVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMubG9hZE9uRGVtYW5kID0gdHJ1ZTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFJlbmRlcnMgdGhlIGJ1aWx0LWluIGlucHV0IGVsZW1lbnQgZm9yIGZpbHRlcmluZyB0aGUgRHJvcERvd25UcmVlLlxuICAgICAgICAgKiBJZiBzZXQgdG8gYHRydWVgLCB0aGUgY29tcG9uZW50IGVtaXRzIHRoZSBgZmlsdGVyQ2hhbmdlYCBldmVudCwgd2hpY2ggY2FuIGJlIHVzZWQgdG8gW2ZpbHRlciB0aGUgRHJvcERvd25UcmVlIG1hbnVhbGx5XSh7JSBzbHVnIGZpbHRlcmluZ19kZHQgJX0jdG9jLW1hbnVhbC1maWx0ZXJpbmcpLlxuICAgICAgICAgKiBBIGJ1aWx0LWluIGZpbHRlcmluZyBpbXBsZW1lbnRhdGlvbiBpcyBhdmFpbGFibGUgdG8gdXNlIHdpdGggdGhlIFtga2VuZG9Ecm9wRG93blRyZWVIaWVyYXJjaHlCaW5kaW5nYF0oeyUgc2x1ZyBhcGlfZHJvcGRvd25zX2Ryb3Bkb3dudHJlZWhpZXJhcmNoeWJpbmRpbmdkaXJlY3RpdmUgJX0pIGFuZCBbYGtlbmRvRHJvcERvd25UcmVlRmxhdEJpbmRpbmdgXSh7JSBzbHVnIGFwaV9kcm9wZG93bnNfZHJvcGRvd250cmVlZmxhdGJpbmRpbmdkaXJlY3RpdmUgJX0pIGRpcmVjdGl2ZXMuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmZpbHRlcmFibGUgPSBmYWxzZTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBoaWRkZW5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuZmlsdGVyID0gJyc7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAaGlkZGVuXG4gICAgICAgICAqXG4gICAgICAgICAqIFVzZWQgYnkgdGhlIGtlbmRvLWxhYmVsIGFuZCBrZW5kby1mbG9hdGluZ2xhYmVsIHRvIGFjY2VzcyBhbmQgYXNzb2NpYXRlIHRoZSBmb2N1c2FibGUgZWxlbWVudCB3aXRoIHRoZSBwcm92aWRlZCBsYWJlbCB2aWEgYXJpYS1sYWJlbGxlZGJ5LlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5mb2N1c2FibGVJZCA9IGBrLSR7Z3VpZCgpfWA7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAaGlkZGVuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnNlbGVjdGVkS2V5cyA9IFtdO1xuICAgICAgICAvKipcbiAgICAgICAgICogQGhpZGRlblxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5maWx0ZXJTdGF0ZUNoYW5nZSA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBoaWRkZW5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuYWxsTm9kZXNIaWRkZW4gPSBmYWxzZTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBoaWRkZW5cbiAgICAgICAgICpcbiAgICAgICAgICogVXNlZCB0byBhc3NvY2lhdGUgdGhlIHZhbHVlIGxhYmVsIHdpdGggdGhlIHdyYXBwZXIgdmlhIGFyaWEtZGVzY3JpYmVkYnkuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnZhbHVlTGFiZWxJZCA9IGBrLSR7Z3VpZCgpfWA7XG4gICAgICAgIHRoaXMuX3BvcHVwU2V0dGluZ3MgPSBERUZBVUxUX1BPUFVQX1NFVFRJTkdTO1xuICAgICAgICB0aGlzLl90YWJpbmRleCA9IDA7XG4gICAgICAgIHRoaXMuX2lzRm9jdXNlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLl9zaXplID0gJ21lZGl1bSc7XG4gICAgICAgIHRoaXMuX3JvdW5kZWQgPSAnbWVkaXVtJztcbiAgICAgICAgdGhpcy5fZmlsbE1vZGUgPSAnc29saWQnO1xuICAgICAgICB0aGlzLnN1YnNjcmlwdGlvbnMgPSBbXTtcbiAgICAgICAgdGhpcy5vblRvdWNoZWRDYWxsYmFjayA9IG5vb3A7XG4gICAgICAgIHRoaXMub25DaGFuZ2VDYWxsYmFjayA9IG5vb3A7XG4gICAgICAgIHRoaXMuZGlyZWN0aW9uID0gbG9jYWxpemF0aW9uLnJ0bCA/ICdydGwnIDogJ2x0cic7XG4gICAgICAgIHRoaXMuc3Vic2NyaWJlRXZlbnRzKCk7XG4gICAgICAgIHRoaXMuc3Vic2NyaWJlVG91Y2hFdmVudHMoKTtcbiAgICAgICAgdGhpcy5zdWJzY3JpYmVGb2N1c0V2ZW50cygpO1xuICAgIH1cbiAgICBnZXQgaXNEaXNhYmxlZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGlzYWJsZWQ7XG4gICAgfVxuICAgIGdldCBpc0xvYWRpbmcoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmxvYWRpbmc7XG4gICAgfVxuICAgIGdldCBpZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZm9jdXNhYmxlSWQ7XG4gICAgfVxuICAgIGdldCBob3N0VGFiSW5kZXgoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnRhYmluZGV4O1xuICAgIH1cbiAgICBnZXQgaXNBcmlhRXhwYW5kZWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmlzT3BlbjtcbiAgICB9XG4gICAgZ2V0IGlzUmVhZG9ubHkoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnJlYWRvbmx5O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgaGFuZGxlQ2xpY2soKSB7XG4gICAgICAgIHRoaXMudG9nZ2xlUG9wdXAoIXRoaXMuaXNPcGVuKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIGhhbmRsZUtleWRvd24oZXZlbnQpIHtcbiAgICAgICAgaWYgKHRoaXMuZGlzYWJsZWQgfHwgdGhpcy5yZWFkb25seSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGV2ZW50RGF0YSA9IGV2ZW50O1xuICAgICAgICB0aGlzLm5hdmlnYXRpb25TZXJ2aWNlLnByb2Nlc3Moe1xuICAgICAgICAgICAgb3JpZ2luYWxFdmVudDogZXZlbnREYXRhXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBzZXQgdHJlZXZpZXcodHJlZXZpZXcpIHtcbiAgICAgICAgaWYgKHRyZWV2aWV3KSB7XG4gICAgICAgICAgICBpZiAodGhpcy5pc0ZvY3VzZWQgJiYgIXRoaXMuZmlsdGVyYWJsZSB8fCB0aGlzLnRvdWNoRW5hYmxlZCkge1xuICAgICAgICAgICAgICAgIHRyZWV2aWV3LmZvY3VzKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyB0aGUgdHJlZXZpZXcgYW5pbWF0aW9ucyBhcmUgaW5pdGlhbGx5IGRpc2FibGVkICh3ZSBkb24ndCB3YW50IGV4cGFuZCBhbmltYXRpb25zIGR1cmluZyBwb3B1cCBvcGVuaW5nKVxuICAgICAgICAgICAgLy8gcmUtZW5hYmxlcyB0aGUgYW5pbWF0aW9ucyBmb3IgdXNlciBpbnRlcmFjdGlvblxuICAgICAgICAgICAgdHJlZXZpZXcuYW5pbWF0ZSA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLl90cmVldmlldyA9IHRyZWV2aWV3O1xuICAgICAgICB9XG4gICAgfVxuICAgIGdldCB0cmVldmlldygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3RyZWV2aWV3O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZXRzIHRoZSBkYXRhIG9mIHRoZSBEcm9wRG93blRyZWUuXG4gICAgICpcbiAgICAgKiA+IFRoZSBkYXRhIGhhcyB0byBiZSBwcm92aWRlZCBpbiBhbiBhcnJheS1saWtlIGxpc3Qgd2l0aCBvYmplY3RzLlxuICAgICAqL1xuICAgIHNldCBkYXRhKGRhdGEpIHtcbiAgICAgICAgdGhpcy5fbm9kZXMgPSBkYXRhO1xuICAgICAgICB0aGlzLnNldFN0YXRlKCk7XG4gICAgfVxuICAgIGdldCBkYXRhKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fbm9kZXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNldHMgdGhlIHZhbHVlIG9mIHRoZSBEcm9wRG93blRyZWUuXG4gICAgICogSXQgY2FuIGVpdGhlciBiZSBvZiB0aGUgcHJpbWl0aXZlIChzdHJpbmcsIG51bWJlcnMpIG9yIG9mIHRoZSBjb21wbGV4IChvYmplY3RzKSB0eXBlLlxuICAgICAqIFRvIGRlZmluZSB0aGUgdHlwZSwgdXNlIHRoZSBgdmFsdWVQcmltaXRpdmVgIG9wdGlvbi5cbiAgICAgKlxuICAgICAqL1xuICAgIHNldCB2YWx1ZShuZXdWYWx1ZSkge1xuICAgICAgICB0aGlzLl92YWx1ZSA9IG5ld1ZhbHVlO1xuICAgICAgICB0aGlzLnNldFN0YXRlKCk7XG4gICAgfVxuICAgIGdldCB2YWx1ZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3ZhbHVlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDb25maWd1cmVzIHRoZSBwb3B1cCBvZiB0aGUgRHJvcERvd25UcmVlLlxuICAgICAqXG4gICAgICogVGhlIGF2YWlsYWJsZSBvcHRpb25zIGFyZTpcbiAgICAgKiAtIGBhbmltYXRlOiBCb29sZWFuYCZtZGFzaDtDb250cm9scyB0aGUgcG9wdXAgYW5pbWF0aW9uLiBCeSBkZWZhdWx0LCB0aGUgb3BlbiBhbmQgY2xvc2UgYW5pbWF0aW9ucyBhcmUgZW5hYmxlZC5cbiAgICAgKiAtIGB3aWR0aDogTnVtYmVyIHwgU3RyaW5nYCZtZGFzaDtTZXRzIHRoZSB3aWR0aCBvZiB0aGUgcG9wdXAgY29udGFpbmVyLiBCeSBkZWZhdWx0LCB0aGUgd2lkdGggb2YgdGhlIGhvc3QgZWxlbWVudCBpcyB1c2VkLiBJZiBzZXQgdG8gYGF1dG9gLCB0aGUgY29tcG9uZW50IGF1dG9tYXRpY2FsbHkgYWRqdXN0cyB0aGUgd2lkdGggb2YgdGhlIHBvcHVwIGFuZCBubyBpdGVtIGxhYmVscyBhcmUgd3JhcHBlZC5cbiAgICAgKiAtIGBoZWlnaHQ6IE51bWJlcmAmbWRhc2g7U2V0cyB0aGUgaGVpZ2h0IG9mIHRoZSBwb3B1cCBjb250YWluZXIuXG4gICAgICogLSBgcG9wdXBDbGFzczogU3RyaW5nYCZtZGFzaDtTcGVjaWZpZXMgYSBsaXN0IG9mIENTUyBjbGFzc2VzIHRoYXQgYXJlIHVzZWQgdG8gc3R5bGUgdGhlIHBvcHVwLlxuICAgICAqIC0gYGFwcGVuZFRvOiBcInJvb3RcIiB8IFwiY29tcG9uZW50XCIgfCBWaWV3Q29udGFpbmVyUmVmYCZtZGFzaDtTcGVjaWZpZXMgdGhlIGNvbXBvbmVudCB0byB3aGljaCB0aGUgcG9wdXAgd2lsbCBiZSBhcHBlbmRlZC5cbiAgICAgKi9cbiAgICBzZXQgcG9wdXBTZXR0aW5ncyhzZXR0aW5ncykge1xuICAgICAgICB0aGlzLl9wb3B1cFNldHRpbmdzID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9QT1BVUF9TRVRUSU5HUywgc2V0dGluZ3MpO1xuICAgIH1cbiAgICBnZXQgcG9wdXBTZXR0aW5ncygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3BvcHVwU2V0dGluZ3M7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEtlZXBzIHRoZSBjdXJyZW50IGBkYXRhSXRlbWAgb2JqZWN0IGluIG9yZGVyIHRvIHJlc29sdmUgc2VsZWN0aW9uLlxuICAgICAqIE5lZWRzIHRvIGJlIHByb3ZpZGVkIHdoZW4gYHZhbHVlYCBpcyBib3VuZCBpbiBhbmQgYHZhbHVlUHJpbWl0aXZlYCBpcyBzZXQgdG8gdHJ1ZS5cbiAgICAgKi9cbiAgICBzZXQgZGF0YUl0ZW0oaXRlbSkge1xuICAgICAgICB0aGlzLl9kYXRhSXRlbSA9IGl0ZW07XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoKTtcbiAgICB9XG4gICAgZ2V0IGRhdGFJdGVtKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fZGF0YUl0ZW0gPyB0aGlzLl9kYXRhSXRlbSA6IHRoaXMudmFsdWU7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNwZWNpZmllcyB0aGUgW2B0YWJpbmRleGBdKGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0hUTUwvR2xvYmFsX2F0dHJpYnV0ZXMvdGFiaW5kZXgpIG9mIHRoZSBjb21wb25lbnQuXG4gICAgICovXG4gICAgc2V0IHRhYmluZGV4KHZhbHVlKSB7XG4gICAgICAgIGNvbnN0IHByb3ZpZGVkVGFiSW5kZXggPSBOdW1iZXIodmFsdWUpO1xuICAgICAgICBjb25zdCBkZWZhdWx0VGFiSW5kZXggPSAwO1xuICAgICAgICB0aGlzLl90YWJpbmRleCA9ICFpc05hTihwcm92aWRlZFRhYkluZGV4KSA/IHByb3ZpZGVkVGFiSW5kZXggOiBkZWZhdWx0VGFiSW5kZXg7XG4gICAgfVxuICAgIGdldCB0YWJpbmRleCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGlzYWJsZWQgPyAtMSA6IHRoaXMuX3RhYmluZGV4O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZXRzIHRoZSBzaXplIG9mIHRoZSBjb21wb25lbnQuXG4gICAgICpcbiAgICAgKiBUaGUgcG9zc2libGUgdmFsdWVzIGFyZTpcbiAgICAgKiAqIGAnc21hbGwnYFxuICAgICAqICogYCdtZWRpdW0nYCAoZGVmYXVsdClcbiAgICAgKiAqIGAnbGFyZ2UnYFxuICAgICAqICogYG51bGxgXG4gICAgICpcbiAgICAgKi9cbiAgICBzZXQgc2l6ZShzaXplKSB7XG4gICAgICAgIHRoaXMucmVuZGVyZXIucmVtb3ZlQ2xhc3ModGhpcy53cmFwcGVyLm5hdGl2ZUVsZW1lbnQsIGdldFNpemVDbGFzcygncGlja2VyJywgdGhpcy5zaXplKSk7XG4gICAgICAgIGlmIChzaXplKSB7XG4gICAgICAgICAgICB0aGlzLnJlbmRlcmVyLmFkZENsYXNzKHRoaXMud3JhcHBlci5uYXRpdmVFbGVtZW50LCBnZXRTaXplQ2xhc3MoJ3BpY2tlcicsIHNpemUpKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9zaXplID0gc2l6ZTtcbiAgICB9XG4gICAgZ2V0IHNpemUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9zaXplO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZXRzIHRoZSBib3JkZXIgcmFkaXVzIG9mIHRoZSBjb21wb25lbnQuXG4gICAgICpcbiAgICAgKiBUaGUgcG9zc2libGUgdmFsdWVzIGFyZTpcbiAgICAgKiAqIGAnc21hbGwnYFxuICAgICAqICogYCdtZWRpdW0nYCAoZGVmYXVsdClcbiAgICAgKiAqIGAnbGFyZ2UnYFxuICAgICAqICogYCdmdWxsJ2BcbiAgICAgKiAqIGBudWxsYFxuICAgICAqXG4gICAgICovXG4gICAgc2V0IHJvdW5kZWQocm91bmRlZCkge1xuICAgICAgICB0aGlzLnJlbmRlcmVyLnJlbW92ZUNsYXNzKHRoaXMud3JhcHBlci5uYXRpdmVFbGVtZW50LCBnZXRSb3VuZGVkQ2xhc3ModGhpcy5yb3VuZGVkKSk7XG4gICAgICAgIGlmIChyb3VuZGVkKSB7XG4gICAgICAgICAgICB0aGlzLnJlbmRlcmVyLmFkZENsYXNzKHRoaXMud3JhcHBlci5uYXRpdmVFbGVtZW50LCBnZXRSb3VuZGVkQ2xhc3Mocm91bmRlZCkpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3JvdW5kZWQgPSByb3VuZGVkO1xuICAgIH1cbiAgICBnZXQgcm91bmRlZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3JvdW5kZWQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNldHMgdGhlIGZpbGxNb2RlIG9mIHRoZSBjb21wb25lbnQuXG4gICAgICpcbiAgICAgKiBUaGUgcG9zc2libGUgdmFsdWVzIGFyZTpcbiAgICAgKiAqIGAnZmxhdCdgXG4gICAgICogKiBgJ3NvbGlkJ2AgKGRlZmF1bHQpXG4gICAgICogKiBgJ291dGxpbmUnYFxuICAgICAqICogYG51bGxgXG4gICAgICpcbiAgICAgKi9cbiAgICBzZXQgZmlsbE1vZGUoZmlsbE1vZGUpIHtcbiAgICAgICAgdGhpcy5yZW5kZXJlci5yZW1vdmVDbGFzcyh0aGlzLndyYXBwZXIubmF0aXZlRWxlbWVudCwgZ2V0RmlsbE1vZGVDbGFzcygncGlja2VyJywgdGhpcy5maWxsTW9kZSkpO1xuICAgICAgICBpZiAoZmlsbE1vZGUpIHtcbiAgICAgICAgICAgIHRoaXMucmVuZGVyZXIuYWRkQ2xhc3ModGhpcy53cmFwcGVyLm5hdGl2ZUVsZW1lbnQsIGdldEZpbGxNb2RlQ2xhc3MoJ3BpY2tlcicsIGZpbGxNb2RlKSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fZmlsbE1vZGUgPSBmaWxsTW9kZTtcbiAgICB9XG4gICAgZ2V0IGZpbGxNb2RlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fZmlsbE1vZGU7XG4gICAgfVxuICAgIHNldCBpc0ZvY3VzZWQoaXNGb2N1c2VkKSB7XG4gICAgICAgIHRoaXMucmVuZGVyZXJbaXNGb2N1c2VkID8gJ2FkZENsYXNzJyA6ICdyZW1vdmVDbGFzcyddKHRoaXMud3JhcHBlci5uYXRpdmVFbGVtZW50LCAnay1mb2N1cycpO1xuICAgICAgICB0aGlzLl9pc0ZvY3VzZWQgPSBpc0ZvY3VzZWQ7XG4gICAgfVxuICAgIGdldCBpc0ZvY3VzZWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9pc0ZvY3VzZWQ7XG4gICAgfVxuICAgIGdldCB3aWR0aCgpIHtcbiAgICAgICAgY29uc3Qgd3JhcHBlcldpZHRoID0gdGhpcy53cmFwcGVyLm5hdGl2ZUVsZW1lbnQub2Zmc2V0V2lkdGg7XG4gICAgICAgIGNvbnN0IHdpZHRoID0gdGhpcy5wb3B1cFNldHRpbmdzLndpZHRoIHx8IHdyYXBwZXJXaWR0aDtcbiAgICAgICAgY29uc3QgbWluV2lkdGggPSBpc05hTih3cmFwcGVyV2lkdGgpID8gd3JhcHBlcldpZHRoIDogYCR7d3JhcHBlcldpZHRofXB4YDtcbiAgICAgICAgY29uc3QgbWF4V2lkdGggPSBpc05hTih3aWR0aCkgPyB3aWR0aCA6IGAke3dpZHRofXB4YDtcbiAgICAgICAgcmV0dXJuIHsgbWluOiBtaW5XaWR0aCwgbWF4OiBtYXhXaWR0aCB9O1xuICAgIH1cbiAgICBnZXQgaGVpZ2h0KCkge1xuICAgICAgICBjb25zdCBwb3B1cEhlaWdodCA9IHRoaXMucG9wdXBTZXR0aW5ncy5oZWlnaHQ7XG4gICAgICAgIHJldHVybiBpc1ByZXNlbnQocG9wdXBIZWlnaHQpID8gYCR7cG9wdXBIZWlnaHR9cHhgIDogJ2F1dG8nO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRoZSBjdXJyZW50IG9wZW4gc3RhdGUgb2YgdGhlIHBvcHVwLlxuICAgICAqL1xuICAgIGdldCBpc09wZW4oKSB7XG4gICAgICAgIHJldHVybiBpc1ByZXNlbnQodGhpcy5wb3B1cFJlZik7XG4gICAgfVxuICAgIGdldCBjbGVhckJ1dHRvblZpc2libGl0eSgpIHtcbiAgICAgICAgaWYgKHRoaXMudG91Y2hFbmFibGVkKSB7XG4gICAgICAgICAgICByZXR1cm4gJ3Zpc2libGUnO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKlxuICAgICAqIEFsaWFzIGZvciBgaXNOb2RlRXhwYW5kZWRgLiBVc2VkIGZvciBjb21wYXRpYmlsaXR5IHdpdGggdGhlIGBFeHBhbmRhYmxlQ29tcG9uZW50YCBpbnRlcmZhY2UuXG4gICAgICogUmVxdWlyZWQgZm9yIHRoZSBleHBhbmQtZGlyZWN0aXZlLlxuICAgICAqL1xuICAgIHNldCBpc0V4cGFuZGVkKGNhbGxiYWNrKSB7XG4gICAgICAgIHRoaXMuaXNOb2RlRXhwYW5kZWQgPSBjYWxsYmFjaztcbiAgICB9XG4gICAgZ2V0IGlzRXhwYW5kZWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmlzTm9kZUV4cGFuZGVkO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICpcbiAgICAgKiBBbGlhcyBmb3IgYG5vZGVFeHBhbmRgLiBVc2VkIGZvciBjb21wYXRpYmlsaXR5IHdpdGggdGhlIGBFeHBhbmRhYmxlQ29tcG9uZW50YCBpbnRlcmZhY2UuXG4gICAgICogUmVxdWlyZWQgZm9yIHRoZSBleHBhbmQtZGlyZWN0aXZlLlxuICAgICAqL1xuICAgIGdldCBleHBhbmQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm5vZGVFeHBhbmQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKlxuICAgICAqIEFsaWFzIGZvciBgbm9kZUNvbGxhcHNlYC4gVXNlZCBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIHRoZSBgRXhwYW5kYWJsZUNvbXBvbmVudGAgaW50ZXJmYWNlLlxuICAgICAqIFJlcXVpcmVkIGZvciB0aGUgZXhwYW5kLWRpcmVjdGl2ZS5cbiAgICAgKi9cbiAgICBnZXQgY29sbGFwc2UoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm5vZGVDb2xsYXBzZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqXG4gICAgICogQWxpYXMgZm9yIGBkYXRhYC4gVXNlZCBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIHRoZSBgRGF0YUJvdW5kQ29tcG9uZW50YCBpbnRlcmZhY2UuXG4gICAgICogUmVxdWlyZWQgZm9yIHRoZSBkYXRhLWJpbmRpbmcgZGlyZWN0aXZlcy5cbiAgICAgKi9cbiAgICBzZXQgbm9kZXMobm9kZXMpIHtcbiAgICAgICAgdGhpcy5kYXRhID0gbm9kZXM7XG4gICAgfVxuICAgIGdldCBub2RlcygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGF0YTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqXG4gICAgICogQWxpYXMgZm9yIGBmZXRjaENoaWxkcmVuYC4gVXNlZCBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIHRoZSBgRGF0YUJvdW5kQ29tcG9uZW50YCBpbnRlcmZhY2UuXG4gICAgICogUmVxdWlyZWQgZm9yIHRoZSBkYXRhLWJpbmRpbmcgZGlyZWN0aXZlc1xuICAgICAqL1xuICAgIHNldCBjaGlsZHJlbihjYWxsYmFjaykge1xuICAgICAgICB0aGlzLmZldGNoQ2hpbGRyZW4gPSBjYWxsYmFjaztcbiAgICB9XG4gICAgZ2V0IGNoaWxkcmVuKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5mZXRjaENoaWxkcmVuO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICpcbiAgICAgKiBBbGlhcyBmb3IgYGlzTm9kZVZpc2libGVgLiBVc2VkIGZvciBjb21wYXRpYmlsaXR5IHdpdGggdGhlIGBEYXRhQm91bmRDb21wb25lbnRgIGludGVyZmFjZS5cbiAgICAgKiBUaGUgYERhdGFCb3VuZENvbXBvbmVudGAgaW50ZXJmYWNlIGlzIHVzZWQgaW4gdGhlIGRhdGEtYmluZGluZyBkaXJlY3RpdmVzLlxuICAgICAqL1xuICAgIHNldCBpc1Zpc2libGUoY2FsbGJhY2spIHtcbiAgICAgICAgdGhpcy5pc05vZGVWaXNpYmxlID0gY2FsbGJhY2s7XG4gICAgfVxuICAgIGdldCBpc1Zpc2libGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmlzTm9kZVZpc2libGU7XG4gICAgfVxuICAgIG5nT25Jbml0KCkge1xuICAgICAgICB0aGlzLnJlbmRlcmVyLnJlbW92ZUF0dHJpYnV0ZSh0aGlzLndyYXBwZXIubmF0aXZlRWxlbWVudCwgJ3RhYmluZGV4Jyk7XG4gICAgICAgIHRoaXMuYXNzaWduQXJpYURlc2NyaWJlZEJ5KCk7XG4gICAgICAgIHRoaXMuc3Vic2NyaXB0aW9ucy5wdXNoKHRoaXMubG9jYWxpemF0aW9uXG4gICAgICAgICAgICAuY2hhbmdlcy5zdWJzY3JpYmUoKHsgcnRsIH0pID0+IHtcbiAgICAgICAgICAgIHRoaXMuZGlyZWN0aW9uID0gcnRsID8gJ3J0bCcgOiAnbHRyJztcbiAgICAgICAgICAgIHRoaXMuY2RyLm1hcmtGb3JDaGVjaygpO1xuICAgICAgICB9KSk7XG4gICAgICAgIHRoaXMuc2V0Q29tcG9uZW50Q2xhc3NlcygpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgbmdPbkRlc3Ryb3koKSB7XG4gICAgICAgIHRoaXMuZGVzdHJveVBvcHVwKCk7XG4gICAgICAgIHRoaXMudW5zdWJzY3JpYmVFdmVudHMoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIG5nT25DaGFuZ2VzKGNoYW5nZXMpIHtcbiAgICAgICAgaWYgKGFueUNoYW5nZWQoWyd0ZXh0RmllbGQnLCAndmFsdWVGaWVsZCcsICd2YWx1ZVByaW1pdGl2ZSddLCBjaGFuZ2VzLCBmYWxzZSkpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgbmdBZnRlckNvbnRlbnRDaGVja2VkKCkge1xuICAgICAgICB0aGlzLnZlcmlmeVNldHRpbmdzKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKlxuICAgICAqIFVzZWQgYnkgdGhlIGtlbmRvLWZsb2F0aW5nbGFiZWwgY29tcG9uZW50IHRvIGRldGVybWluZSBpZiB0aGUgZmxvYXRpbmcgbGFiZWxcbiAgICAgKiBzaG91bGQgYmUgcmVuZGVyZWQgaW5zaWRlIHRoZSBpbnB1dCB3aGVuIHRoZSBjb21wb25lbnQgaXMgbm90IGZvY3VzZWQuXG4gICAgICovXG4gICAgaXNFbXB0eSgpIHtcbiAgICAgICAgcmV0dXJuICF0aGlzLnRleHQgJiYgIXRoaXMucGxhY2Vob2xkZXI7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICB0b2dnbGVQb3B1cChvcGVuKSB7XG4gICAgICAgIGNvbnN0IGlzRGlzYWJsZWQgPSB0aGlzLmRpc2FibGVkIHx8IHRoaXMucmVhZG9ubHk7XG4gICAgICAgIGNvbnN0IHNhbWVTdGF0ZSA9IHRoaXMuaXNPcGVuID09PSBvcGVuO1xuICAgICAgICBpZiAoaXNEaXNhYmxlZCB8fCBzYW1lU3RhdGUpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCB0b2dnbGVQcmV2ZW50ZWQgPSB0aGlzLnRyaWdnZXJQb3B1cEV2ZW50cyhvcGVuKTtcbiAgICAgICAgaWYgKCF0b2dnbGVQcmV2ZW50ZWQpIHtcbiAgICAgICAgICAgIG9wZW4gP1xuICAgICAgICAgICAgICAgIHRoaXMuY3JlYXRlUG9wdXAoKSA6XG4gICAgICAgICAgICAgICAgdGhpcy5kZXN0cm95UG9wdXAoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgaGFuZGxlRm9jdXMoZXZlbnQpIHtcbiAgICAgICAgaWYgKGV2ZW50LnRhcmdldCAhPT0gdGhpcy53cmFwcGVyLm5hdGl2ZUVsZW1lbnQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBldmVudC5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKTtcbiAgICAgICAgaWYgKCF0aGlzLmlzRm9jdXNlZCkge1xuICAgICAgICAgICAgdGhpcy5pc0ZvY3VzZWQgPSB0cnVlO1xuICAgICAgICAgICAgaWYgKGhhc09ic2VydmVycyh0aGlzLm9uRm9jdXMpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fem9uZS5ydW4oKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm9uRm9jdXMuZW1pdCgpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBoYW5kbGVCbHVyKGUpIHtcbiAgICAgICAgY29uc3QgcmVsYXRlZFRhcmdldCA9IGUgJiYgZS5yZWxhdGVkVGFyZ2V0O1xuICAgICAgICBpZiAodGhpcy53cmFwcGVyLm5hdGl2ZUVsZW1lbnQuY29udGFpbnMocmVsYXRlZFRhcmdldCkgfHxcbiAgICAgICAgICAgICh0aGlzLmlzT3BlbiAmJiB0aGlzLnBvcHVwUmVmLnBvcHVwRWxlbWVudC5jb250YWlucyhyZWxhdGVkVGFyZ2V0KSkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmlzRm9jdXNlZCA9IGZhbHNlO1xuICAgICAgICBpZiAoaGFzT2JzZXJ2ZXJzKHRoaXMub25CbHVyKSB8fFxuICAgICAgICAgICAgaXNVbnRvdWNoZWQodGhpcy53cmFwcGVyLm5hdGl2ZUVsZW1lbnQpKSB7XG4gICAgICAgICAgICB0aGlzLl96b25lLnJ1bigoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy50b2dnbGVQb3B1cChmYWxzZSk7XG4gICAgICAgICAgICAgICAgdGhpcy5vbkJsdXIuZW1pdCgpO1xuICAgICAgICAgICAgICAgIHRoaXMub25Ub3VjaGVkQ2FsbGJhY2soKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy50b2dnbGVQb3B1cChmYWxzZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogRm9jdXNlcyBhIHNwZWNpZmljIGl0ZW0gb2YgdGhlIERyb3BEb3duVHJlZSBiYXNlZCBvbiBhIHByb3ZpZGVkIGluZGV4IGluIHRoZSBmb3JtYXQgb2YgYDFfMWAuXG4gICAgICogVGhlIHRhcmdldGVkIGl0ZW0gc2hvdWxkIGJlIGV4cGFuZGVkIGluIG9yZGVyIGZvciBpdCB0byBiZSBmb2N1c2VkLlxuICAgICAqIElmIG51bGwgb3IgaW52YWxpZCBpbmRleCBpcyBwcm92aWRlZCB0aGUgZm9jdXMgd2lsbCBiZSBzZXQgb24gdGhlIGZpcnN0IGl0ZW0uXG4gICAgICovXG4gICAgZm9jdXNJdGVtQXQoaW5kZXgpIHtcbiAgICAgICAgaWYgKHRoaXMudHJlZXZpZXcpIHtcbiAgICAgICAgICAgIGNvbnN0IGxvb2t1cCA9IHRoaXMudHJlZXZpZXcuaXRlbUxvb2t1cChpbmRleCk7XG4gICAgICAgICAgICBsZXQgaXNJdGVtRGlzYWJsZWQgPSAhaXNQcmVzZW50KGxvb2t1cCkgfHwgdGhpcy50cmVldmlldy5pc0Rpc2FibGVkKGxvb2t1cC5pdGVtLmRhdGFJdGVtLCBsb29rdXAuaXRlbS5pbmRleCk7XG4gICAgICAgICAgICBpZiAoIWlzSXRlbURpc2FibGVkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy50cmVldmlldy5mb2N1cyhpbmRleCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogRm9jdXNlcyB0aGUgRHJvcERvd25UcmVlLlxuICAgICAqL1xuICAgIGZvY3VzKCkge1xuICAgICAgICBpZiAoIXRoaXMuZGlzYWJsZWQpIHtcbiAgICAgICAgICAgIHRoaXMud3JhcHBlci5uYXRpdmVFbGVtZW50LmZvY3VzKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogQmx1cnMgdGhlIERyb3BEb3duVHJlZS5cbiAgICAgKi9cbiAgICBibHVyKCkge1xuICAgICAgICBpZiAoIXRoaXMuZGlzYWJsZWQpIHtcbiAgICAgICAgICAgIHRoaXMud3JhcHBlci5uYXRpdmVFbGVtZW50LmJsdXIoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXNldHMgdGhlIHZhbHVlIG9mIHRoZSBEcm9wRG93blRyZWUuXG4gICAgICogSWYgeW91IHVzZSB0aGUgYHJlc2V0YCBtZXRob2QgdG8gY2xlYXIgdGhlIHZhbHVlIG9mIHRoZSBjb21wb25lbnQsXG4gICAgICogdGhlIG1vZGVsIHdpbGwgbm90IHVwZGF0ZSBhdXRvbWF0aWNhbGx5IGFuZCB0aGUgYHZhbHVlQ2hhbmdlYCBldmVudCB3aWxsIG5vdCBiZSBmaXJlZC5cbiAgICAgKi9cbiAgICByZXNldCgpIHtcbiAgICAgICAgdGhpcy52YWx1ZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5kYXRhSXRlbSA9IHVuZGVmaW5lZDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVG9nZ2xlcyB0aGUgdmlzaWJpbGl0eSBvZiB0aGUgcG9wdXBcbiAgICAgKiAoW3NlZSBleGFtcGxlXSh7JSBzbHVnIG9wZW5zdGF0ZV9kZHQgJX0pKS5cbiAgICAgKiBJZiB5b3UgdXNlIHRoZSBgdG9nZ2xlYCBtZXRob2QgdG8gb3BlbiBvciBjbG9zZSB0aGUgcG9wdXAsIHRoZSBgb3BlbmAgYW5kIGBjbG9zZWAgZXZlbnRzIHdpbGwgbm90IGJlIGZpcmVkLlxuICAgICAqXG4gICAgICogQHBhcmFtIG9wZW4gLSBUaGUgc3RhdGUgb2YgdGhlIHBvcHVwLlxuICAgICAqL1xuICAgIHRvZ2dsZShvcGVuKSB7XG4gICAgICAgIC8vIFRoZSBQcm9taXNlIGlzIHJlcXVpcmVkIHRvIG9wZW4gdGhlIHBvcHVwIG9uIGxvYWQuXG4gICAgICAgIC8vIE90aGVyd2lzZSwgdGhlIFwiVmlld0NvbnRhaW5lclJlZiBub3QgZm91bmQuLi5cIiBlcnJvciB3aWxsIGJlIHRocm93bi5cbiAgICAgICAgUHJvbWlzZS5yZXNvbHZlKG51bGwpLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgY29uc3Qgc2hvdWxkT3BlbiA9IGlzUHJlc2VudChvcGVuKSA/IG9wZW4gOiAhaXNQcmVzZW50KHRoaXMucG9wdXBSZWYpO1xuICAgICAgICAgICAgdGhpcy5kZXN0cm95UG9wdXAoKTtcbiAgICAgICAgICAgIGlmIChzaG91bGRPcGVuKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jcmVhdGVQb3B1cCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIGdldCBwb3B1cENvbnRhaW5lckNsYXNzZXMoKSB7XG4gICAgICAgIGNvbnN0IGNvbnRhaW5lckNsYXNzZXMgPSBbJ2stcG9wdXAtZHJvcGRvd250cmVlJ107XG4gICAgICAgIGlmICh0aGlzLnBvcHVwU2V0dGluZ3MucG9wdXBDbGFzcykge1xuICAgICAgICAgICAgY29udGFpbmVyQ2xhc3Nlcy5wdXNoKHRoaXMucG9wdXBTZXR0aW5ncy5wb3B1cENsYXNzKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY29udGFpbmVyQ2xhc3NlcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIG9uU2VsZWN0aW9uQ2hhbmdlKHsgZGF0YUl0ZW0sIGluZGV4IH0pIHtcbiAgICAgICAgdGhpcy52YWx1ZURlcHRoID0gaW5kZXguc3BsaXQoJ18nKS5sZW5ndGggLSAxO1xuICAgICAgICBjb25zdCB2YWx1ZUZpZWxkID0gdGhpcy5nZXRGaWVsZCh0aGlzLnZhbHVlRmllbGQsIGRhdGFJdGVtKTtcbiAgICAgICAgY29uc3QgbmV3VmFsdWUgPSB0aGlzLnZhbHVlUHJpbWl0aXZlID9cbiAgICAgICAgICAgIGdldHRlcih2YWx1ZUZpZWxkKShkYXRhSXRlbSkgOlxuICAgICAgICAgICAgZGF0YUl0ZW07XG4gICAgICAgIGNvbnN0IHNob3VsZFVwZGF0ZVZhbHVlID0gbmV3VmFsdWUgIT09IHRoaXMudmFsdWU7XG4gICAgICAgIGlmIChzaG91bGRVcGRhdGVWYWx1ZSkge1xuICAgICAgICAgICAgdGhpcy52YWx1ZSA9IG5ld1ZhbHVlO1xuICAgICAgICAgICAgdGhpcy5kYXRhSXRlbSA9IGRhdGFJdGVtO1xuICAgICAgICAgICAgdGhpcy5lbWl0VmFsdWVDaGFuZ2UodGhpcy52YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy50b2dnbGVQb3B1cChmYWxzZSk7XG4gICAgICAgIHRoaXMuZm9jdXMoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIG1lc3NhZ2VGb3Ioa2V5KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmxvY2FsaXphdGlvbi5nZXQoa2V5KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIGNsZWFyVmFsdWUoZXZlbnQpIHtcbiAgICAgICAgZXZlbnQuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7XG4gICAgICAgIHRoaXMuZm9jdXMoKTtcbiAgICAgICAgdGhpcy52YWx1ZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5kYXRhSXRlbSA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5jbGVhclN0YXRlKCk7XG4gICAgICAgIHRoaXMudmFsdWVDaGFuZ2UuZW1pdCh1bmRlZmluZWQpO1xuICAgICAgICB0aGlzLmVtaXRWYWx1ZUNoYW5nZSgpO1xuICAgIH1cbiAgICBnZXQgYXBwZW5kVG8oKSB7XG4gICAgICAgIGNvbnN0IHsgYXBwZW5kVG8gfSA9IHRoaXMucG9wdXBTZXR0aW5ncztcbiAgICAgICAgaWYgKCFhcHBlbmRUbyB8fCBhcHBlbmRUbyA9PT0gJ3Jvb3QnKSB7XG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhcHBlbmRUbyA9PT0gJ2NvbXBvbmVudCcgPyB0aGlzLmNvbnRhaW5lciA6IGFwcGVuZFRvO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgcHJldmVudEV2ZW50RGVmYXVsdChldmVudCkge1xuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgd3JpdGVWYWx1ZSh2YWx1ZSkge1xuICAgICAgICAvLyBJZiB0aGUgdXNlciByZXNldHMgdGhlIHZhbHVlIGJ5IHByb3ZpZGluZyBudWxsL3VuZGVmaW5lZCB3ZSBuZWVkIHRvIHJlc2V0IHRoZSBgZGF0YUl0ZW1gXG4gICAgICAgIC8vIEJlY2F1c2UgdXBvbiBpbml0aWFsaXphdGlvbiBvZiB0aGUgY29tcG9uZW50IHRoZSBgd3JpdGVWYWx1ZWAgaXMgYmVpbmcgY2FsbGVkIHR3aWNlIC1cbiAgICAgICAgLy8gZmlyc3QgdGltZSB3aXRoIGBudWxsYCB2YWx1ZSByZWdhcmRsZXNzIG9mIHN5bmMvYXN5bmMgdmFsdWUgLSBhbiBleHRyYSBjaGVjayBpcyBhZGRlZCB0b1xuICAgICAgICAvLyBkaXN0aW5ndWlzaCBiZXR3ZWVuIGNsaWVudCByZXNldCBhbmQgaW5pdGlhbCBwaGFub3RtICdudWxsJyB2YWx1ZVxuICAgICAgICBpZiAoIWlzUHJlc2VudCh2YWx1ZSkgJiYgaXNQcmVzZW50KHRoaXMudmFsdWUpKSB7XG4gICAgICAgICAgICB0aGlzLmRhdGFJdGVtID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWUgPT09IG51bGwgPyB1bmRlZmluZWQgOiB2YWx1ZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIHJlZ2lzdGVyT25DaGFuZ2UoZm4pIHtcbiAgICAgICAgdGhpcy5vbkNoYW5nZUNhbGxiYWNrID0gZm47XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICByZWdpc3Rlck9uVG91Y2hlZChmbikge1xuICAgICAgICB0aGlzLm9uVG91Y2hlZENhbGxiYWNrID0gZm47XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBzZXREaXNhYmxlZFN0YXRlKGlzRGlzYWJsZWQpIHtcbiAgICAgICAgdGhpcy5kaXNhYmxlZCA9IGlzRGlzYWJsZWQ7XG4gICAgICAgIHRoaXMuY2RyLm1hcmtGb3JDaGVjaygpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgaGFuZGxlRmlsdGVySW5wdXRDaGFuZ2UodGVybSkge1xuICAgICAgICB0aGlzLmZpbHRlckNoYW5nZS5uZXh0KHRlcm0pO1xuICAgICAgICB0aGlzLmFsbE5vZGVzSGlkZGVuID0gdGhpcy5ub2Rlcy5ldmVyeSgobm9kZSwgaW5kZXgpID0+ICF0aGlzLmlzVmlzaWJsZShub2RlLCBTdHJpbmcoaW5kZXgpKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBnZXQgYnV0dG9uQ2xhc3NlcygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubG9hZGluZyA/ICdrLWktbG9hZGluZycgOiAnay1pLWFycm93LXMnO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgZ2V0IHNlbGVjdEJ1dHRvbkNsYXNzZXMoKSB7XG4gICAgICAgIHJldHVybiBgJHt0aGlzLnNpemUgPyBnZXRTaXplQ2xhc3MoJ2J1dHRvbicsIHRoaXMuc2l6ZSkgOiAnJ30gJHt0aGlzLmZpbGxNb2RlID8gJ2stYnV0dG9uLScgKyB0aGlzLmZpbGxNb2RlIDogJyd9ICR7dGhpcy5maWxsTW9kZSA/ICdrLWJ1dHRvbi0nICsgdGhpcy5maWxsTW9kZSArICctYmFzZScgOiAnJ31gO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgZ2V0IGZpbHRlcklucHV0Q2xhc3NlcygpIHtcbiAgICAgICAgcmV0dXJuIGAke3RoaXMuc2l6ZSA/IGdldFNpemVDbGFzcygnaW5wdXQnLCB0aGlzLnNpemUpIDogJyd9ICR7dGhpcy5maWxsTW9kZSA/ICdrLWlucHV0LScgKyB0aGlzLmZpbGxNb2RlIDogJyd9ICR7dGhpcy5yb3VuZGVkID8gZ2V0Um91bmRlZENsYXNzKHRoaXMucm91bmRlZCkgOiAnJ31gO1xuICAgIH1cbiAgICB2ZXJpZnlTZXR0aW5ncygpIHtcbiAgICAgICAgaWYgKCFpc0Rldk1vZGUoKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnZhbHVlUHJpbWl0aXZlID09PSB0cnVlICYmIGlzUHJlc2VudCh0aGlzLnZhbHVlKSAmJiB0eXBlb2YgdGhpcy52YWx1ZSA9PT0gXCJvYmplY3RcIikge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKERyb3BEb3duVHJlZU1lc3NhZ2VzLnByaW1pdGl2ZSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMudmFsdWVQcmltaXRpdmUgPT09IHRydWUgJiYgaXNQcmVzZW50KHRoaXMudmFsdWUpICYmIHR5cGVvZiB0aGlzLmRhdGFJdGVtICE9PSBcIm9iamVjdFwiKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoRHJvcERvd25UcmVlTWVzc2FnZXMuZGF0YUl0ZW0pO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnZhbHVlUHJpbWl0aXZlID09PSBmYWxzZSAmJiBpc1ByZXNlbnQodGhpcy52YWx1ZSkgJiYgdHlwZW9mIHRoaXMudmFsdWUgIT09IFwib2JqZWN0XCIpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihEcm9wRG93blRyZWVNZXNzYWdlcy5vYmplY3QpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghaXNQcmVzZW50KHRoaXMudmFsdWVGaWVsZCkgfHwgIWlzUHJlc2VudCh0aGlzLnRleHRGaWVsZCkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihEcm9wRG93blRyZWVNZXNzYWdlcy50ZXh0QW5kVmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIGlmICgoaXNBcnJheSh0aGlzLnZhbHVlRmllbGQpIHx8IGlzQXJyYXkodGhpcy50ZXh0RmllbGQpKSAmJiBpc1ByZXNlbnQodGhpcy52YWx1ZSkgJiYgIWlzUHJlc2VudCh0aGlzLnZhbHVlRGVwdGgpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoRHJvcERvd25UcmVlTWVzc2FnZXMudmFsdWVEZXB0aCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZW1pdFZhbHVlQ2hhbmdlKHZhbHVlKSB7XG4gICAgICAgIHRoaXMub25DaGFuZ2VDYWxsYmFjayh2YWx1ZSk7XG4gICAgICAgIHRoaXMudmFsdWVDaGFuZ2UuZW1pdCh2YWx1ZSk7XG4gICAgfVxuICAgIGdldFRleHQodGV4dEZpZWxkLCBkYXRhSXRlbSkge1xuICAgICAgICBpZiAoaXNQcmVzZW50KGRhdGFJdGVtKSAmJiBpc1ByZXNlbnQodGV4dEZpZWxkKSkge1xuICAgICAgICAgICAgY29uc3QgZmllbGQgPSB0aGlzLmdldEZpZWxkKHRleHRGaWVsZCwgZGF0YUl0ZW0pO1xuICAgICAgICAgICAgcmV0dXJuIGdldHRlcihmaWVsZCkoZGF0YUl0ZW0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICpcbiAgICAgKiBEZXRlcm1pbmVzIHRoZSBgdmFsdWVGaWVsZGAgYW5kIGB0ZXh0RmllbGRgIGZvciBhIHNwZWNpZmljIGxldmVsIGluIHRoZSBkYXRhIHNldFxuICAgICAqICBAcGFyYW0gZmllbGQgLSB0aGUgZmllbGQgdmFsdWUgKHN0cmluZyB8IHN0cmluZ1tdKVxuICAgICAqICBAcGFyYW0gdmFsdWUgLSBjdXJyZW50IHZhbHVlXG4gICAgICovXG4gICAgZ2V0RmllbGQoZmllbGQsIHZhbHVlKSB7XG4gICAgICAgIGNvbnN0IGZpZWxkc0NvdW50ID0gZmllbGQubGVuZ3RoIC0gMTtcbiAgICAgICAgaWYgKHR5cGVvZiBmaWVsZCA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgIC8vIElmIHRoZSBgdmFsdWVGaWVsZGAgfCBgdGV4dEZpZWxkYCBpcyB0aGUgc2FtZSBmb3IgYWxsIGxldmVsc1xuICAgICAgICAgICAgcmV0dXJuIGZpZWxkO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGlzUHJlc2VudCh0aGlzLnZhbHVlRGVwdGgpKSB7XG4gICAgICAgICAgICAvLyBXaGVuIGB2YWx1ZURlcHRoYCBjYW4gYmUgZGVmaW5lZCBmcm9tIHRoZSBpbmRleCBvbiBzZWxlY3Rpb25DaGFuZ2Ugb3IgcHJvdmlkZWQgYnkgdGhlIHVzZXJcbiAgICAgICAgICAgIHJldHVybiBmaWVsZHNDb3VudCA8IHRoaXMudmFsdWVEZXB0aCA/IGZpZWxkW2ZpZWxkc0NvdW50XSA6IGZpZWxkW3RoaXMudmFsdWVEZXB0aF07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvLyBGYWxsYmFjazogTG9vayB0byBmaW5kIGEgbWF0Y2ggb2YgZWFjaCBmaWVsZCBpbiB0aGUgY3VycmVudCBkYXRhIGl0ZW1cbiAgICAgICAgICAgIC8vIFNpZGUgZWZmZWN0IG1heSBvY2N1ciBpZiBhbGwgb2YgdGhlIGxpc3RlZCBmaWVsZHMgYXJlIHByZXNlbnQgaW4gdGhlIGRhdGEgaXRlbVxuICAgICAgICAgICAgcmV0dXJuIGZpZWxkLmZpbmQoaXRlbSA9PiBpdGVtIGluIHZhbHVlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB0cmlnZ2VyUG9wdXBFdmVudHMob3Blbikge1xuICAgICAgICBjb25zdCBldmVudEFyZ3MgPSBuZXcgUHJldmVudGFibGVFdmVudCgpO1xuICAgICAgICBpZiAob3Blbikge1xuICAgICAgICAgICAgdGhpcy5vcGVuLmVtaXQoZXZlbnRBcmdzKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuY2xvc2UuZW1pdChldmVudEFyZ3MpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBldmVudEFyZ3MuaXNEZWZhdWx0UHJldmVudGVkKCk7XG4gICAgfVxuICAgIGNyZWF0ZVBvcHVwKCkge1xuICAgICAgICBjb25zdCBob3Jpem9udGFsQWxpZ24gPSB0aGlzLmRpcmVjdGlvbiA9PT0gXCJydGxcIiA/IFwicmlnaHRcIiA6IFwibGVmdFwiO1xuICAgICAgICBjb25zdCBhbmNob3JQb3NpdGlvbiA9IHsgaG9yaXpvbnRhbDogaG9yaXpvbnRhbEFsaWduLCB2ZXJ0aWNhbDogJ2JvdHRvbScgfTtcbiAgICAgICAgY29uc3QgcG9wdXBQb3NpdGlvbiA9IHsgaG9yaXpvbnRhbDogaG9yaXpvbnRhbEFsaWduLCB2ZXJ0aWNhbDogJ3RvcCcgfTtcbiAgICAgICAgdGhpcy5wb3B1cFJlZiA9IHRoaXMucG9wdXBTZXJ2aWNlLm9wZW4oe1xuICAgICAgICAgICAgYW5jaG9yOiB0aGlzLndyYXBwZXIsXG4gICAgICAgICAgICBhcHBlbmRUbzogdGhpcy5hcHBlbmRUbyxcbiAgICAgICAgICAgIGFuY2hvckFsaWduOiBhbmNob3JQb3NpdGlvbixcbiAgICAgICAgICAgIGNvbnRlbnQ6IHRoaXMucG9wdXBUZW1wbGF0ZSxcbiAgICAgICAgICAgIHBvcHVwQWxpZ246IHBvcHVwUG9zaXRpb24sXG4gICAgICAgICAgICBwb3NpdGlvbk1vZGU6ICdhYnNvbHV0ZScsXG4gICAgICAgICAgICBwb3B1cENsYXNzOiB0aGlzLnBvcHVwQ29udGFpbmVyQ2xhc3Nlc1xuICAgICAgICB9KTtcbiAgICAgICAgY29uc3QgcG9wdXBXcmFwcGVyID0gdGhpcy5wb3B1cFJlZi5wb3B1cEVsZW1lbnQ7XG4gICAgICAgIGNvbnN0IHsgbWluLCBtYXggfSA9IHRoaXMud2lkdGg7XG4gICAgICAgIHBvcHVwV3JhcHBlci5zdHlsZS5taW5XaWR0aCA9IG1pbjtcbiAgICAgICAgcG9wdXBXcmFwcGVyLnN0eWxlLndpZHRoID0gbWF4O1xuICAgICAgICBwb3B1cFdyYXBwZXIuc3R5bGUuaGVpZ2h0ID0gdGhpcy5oZWlnaHQ7XG4gICAgICAgIHBvcHVwV3JhcHBlci5zZXRBdHRyaWJ1dGUoXCJkaXJcIiwgdGhpcy5kaXJlY3Rpb24pO1xuICAgICAgICB0aGlzLnBvcHVwUmVmLnBvcHVwT3Blbi5zdWJzY3JpYmUoKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5jZHIuZGV0ZWN0Q2hhbmdlcygpO1xuICAgICAgICAgICAgdGhpcy5vcGVuZWQuZW1pdCgpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5wb3B1cFJlZi5wb3B1cENsb3NlLnN1YnNjcmliZSgoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmNsb3NlZC5lbWl0KCk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBkZXN0cm95UG9wdXAoKSB7XG4gICAgICAgIGlmICh0aGlzLnBvcHVwUmVmKSB7XG4gICAgICAgICAgICB0aGlzLnBvcHVwUmVmLmNsb3NlKCk7XG4gICAgICAgICAgICB0aGlzLnBvcHVwUmVmID0gbnVsbDtcbiAgICAgICAgICAgIGlmICh0aGlzLmZpbHRlciAhPT0gXCJcIikge1xuICAgICAgICAgICAgICAgIHRoaXMuZmlsdGVyID0gXCJcIjtcbiAgICAgICAgICAgICAgICB0aGlzLmFsbE5vZGVzSGlkZGVuID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgaWYgKGhhc09ic2VydmVycyh0aGlzLmZpbHRlckNoYW5nZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fem9uZS5ydW4oKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5maWx0ZXJDaGFuZ2UuZW1pdChcIlwiKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGhhbmRsZUVzY2FwZSgpIHtcbiAgICAgICAgdGhpcy50b2dnbGVQb3B1cChmYWxzZSk7XG4gICAgICAgIHRoaXMuZm9jdXMoKTtcbiAgICB9XG4gICAgc2V0U3RhdGUoKSB7XG4gICAgICAgIGlmIChpc1ByZXNlbnQodGhpcy52YWx1ZSkgJiYgaXNQcmVzZW50KHRoaXMuZGF0YUl0ZW0pICYmIGlzUHJlc2VudCh0aGlzLnZhbHVlRmllbGQpKSB7XG4gICAgICAgICAgICB0aGlzLnRleHQgPSB0aGlzLmdldFRleHQodGhpcy50ZXh0RmllbGQsIHRoaXMuZGF0YUl0ZW0pO1xuICAgICAgICAgICAgY29uc3QgdmFsdWVGaWVsZCA9IHRoaXMuZ2V0RmllbGQodGhpcy52YWx1ZUZpZWxkLCB0aGlzLmRhdGFJdGVtKTtcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0QnkgPSB2YWx1ZUZpZWxkO1xuICAgICAgICAgICAgdGhpcy5zZWxlY3RlZEtleXMgPSBbZ2V0dGVyKHZhbHVlRmllbGQpKHRoaXMuZGF0YUl0ZW0pXTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuY2xlYXJTdGF0ZSgpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuY2RyLm1hcmtGb3JDaGVjaygpO1xuICAgIH1cbiAgICBjbGVhclN0YXRlKCkge1xuICAgICAgICB0aGlzLnRleHQgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMuc2VsZWN0ZWRLZXlzID0gW107XG4gICAgfVxuICAgIHN1YnNjcmliZUV2ZW50cygpIHtcbiAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25zLnB1c2godGhpcy5uYXZpZ2F0aW9uU2VydmljZS5vcGVuLnN1YnNjcmliZSgoKSA9PiB0aGlzLnRvZ2dsZVBvcHVwKHRydWUpKSwgdGhpcy5uYXZpZ2F0aW9uU2VydmljZS5jbG9zZS5zdWJzY3JpYmUoKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy50b2dnbGVQb3B1cChmYWxzZSk7XG4gICAgICAgICAgICB0aGlzLmZvY3VzKCk7XG4gICAgICAgIH0pLCB0aGlzLm5hdmlnYXRpb25TZXJ2aWNlLmVudGVyXG4gICAgICAgICAgICAucGlwZSh0YXAoKGV2ZW50KSA9PiBldmVudC5vcmlnaW5hbEV2ZW50LnByZXZlbnREZWZhdWx0KCkpKVxuICAgICAgICAgICAgLnN1YnNjcmliZSgoKSA9PiB0aGlzLnRvZ2dsZVBvcHVwKHRydWUpKSwgdGhpcy5uYXZpZ2F0aW9uU2VydmljZS5lc2NcbiAgICAgICAgICAgIC5zdWJzY3JpYmUoKCkgPT4gdGhpcy5oYW5kbGVFc2NhcGUoKSksIHRoaXMubmF2aWdhdGlvblNlcnZpY2UudGFiLnN1YnNjcmliZSgoKSA9PiB0aGlzLmZvY3VzKCkpLCB0aGlzLm5hdmlnYXRpb25TZXJ2aWNlLmRvd24uc3Vic2NyaWJlKChldmVudCkgPT4ge1xuICAgICAgICAgICAgaWYgKCF0aGlzLnRyZWV2aWV3KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZXZlbnQub3JpZ2luYWxFdmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgaWYgKCF0aGlzLnRyZWV2aWV3LmlzQWN0aXZlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy50cmVldmlldy5mb2N1cygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KSwgdGhpcy5uYXZpZ2F0aW9uU2VydmljZS51cC5zdWJzY3JpYmUoKGV2ZW50KSA9PiB7XG4gICAgICAgICAgICBpZiAoIXRoaXMudHJlZXZpZXcpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBldmVudC5vcmlnaW5hbEV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICBpZiAodGhpcy5maWx0ZXJhYmxlICYmIHRoaXMudHJlZXZpZXdbJ25hdmlnYXRpb25TZXJ2aWNlJ11bJ2FjdGl2ZUluZGV4J10gPT09ICcwJykge1xuICAgICAgICAgICAgICAgIHRoaXMuZmlsdGVySW5wdXQubmF0aXZlRWxlbWVudC5mb2N1cygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHN1YnNjcmliZVRvdWNoRXZlbnRzKCkge1xuICAgICAgICBpZiAoIWlzRG9jdW1lbnRBdmFpbGFibGUoKSB8fCAhdGhpcy50b3VjaEVuYWJsZWQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl96b25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+IFxuICAgICAgICAvLyBSb2xsIHVwIERyb3BEb3duVHJlZSBvbiBpT1Mgd2hlbiB0YXBwZWQgb3V0c2lkZVxuICAgICAgICB0aGlzLnRvdWNoc3RhcnREaXNwb3NlSGFuZGxlciA9IHRoaXMucmVuZGVyZXIubGlzdGVuKGRvY3VtZW50LCAndG91Y2hzdGFydCcsIChlKSA9PiB7XG4gICAgICAgICAgICBjb25zdCB0YXJnZXQgPSBlLnRhcmdldDtcbiAgICAgICAgICAgIGlmICh0aGlzLmlzRm9jdXNlZCAmJiAhaW5Ecm9wRG93bih0aGlzLndyYXBwZXIsIHRhcmdldCwgdGhpcy5wb3B1cFJlZikpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl96b25lLnJ1bigoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmlzT3Blbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50cmVldmlldy5ibHVyKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5ibHVyKCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgc3Vic2NyaWJlRm9jdXNFdmVudHMoKSB7XG4gICAgICAgIGlmIChpc0RvY3VtZW50QXZhaWxhYmxlKCkpIHtcbiAgICAgICAgICAgIHRoaXMuaGFuZGxlRm9jdXMgPSB0aGlzLmhhbmRsZUZvY3VzLmJpbmQodGhpcyk7XG4gICAgICAgICAgICB0aGlzLmhhbmRsZURvY3VtZW50Qmx1ciA9IHRoaXMuaGFuZGxlRG9jdW1lbnRCbHVyLmJpbmQodGhpcyk7XG4gICAgICAgICAgICB0aGlzLl96b25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCB1c2VDYXB0dXJlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdmb2N1cycsIHRoaXMuaGFuZGxlRm9jdXMsIHVzZUNhcHR1cmUpO1xuICAgICAgICAgICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2JsdXInLCB0aGlzLmhhbmRsZURvY3VtZW50Qmx1ciwgdXNlQ2FwdHVyZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB1blN1YnNjcmliZUZvY3VzRXZlbnRzKCkge1xuICAgICAgICBpZiAoaXNEb2N1bWVudEF2YWlsYWJsZSgpKSB7XG4gICAgICAgICAgICBjb25zdCB1c2VDYXB0dXJlID0gdHJ1ZTtcbiAgICAgICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2ZvY3VzJywgdGhpcy5oYW5kbGVGb2N1cywgdXNlQ2FwdHVyZSk7XG4gICAgICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdibHVyJywgdGhpcy5oYW5kbGVEb2N1bWVudEJsdXIsIHVzZUNhcHR1cmUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHVuc3Vic2NyaWJlRXZlbnRzKCkge1xuICAgICAgICB0aGlzLnN1YnNjcmlwdGlvbnMuZm9yRWFjaChzdWIgPT4gc3ViLnVuc3Vic2NyaWJlKCkpO1xuICAgICAgICB0aGlzLnVuU3Vic2NyaWJlRm9jdXNFdmVudHMoKTtcbiAgICAgICAgaWYgKHRoaXMudG91Y2hzdGFydERpc3Bvc2VIYW5kbGVyKSB7XG4gICAgICAgICAgICB0aGlzLnRvdWNoc3RhcnREaXNwb3NlSGFuZGxlcigpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGhhbmRsZURvY3VtZW50Qmx1cihldmVudCkge1xuICAgICAgICBpZiAoZXZlbnQudGFyZ2V0ICE9PSB0aGlzLndyYXBwZXIubmF0aXZlRWxlbWVudCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGV2ZW50LnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO1xuICAgICAgICB0aGlzLmhhbmRsZUJsdXIoZXZlbnQpO1xuICAgIH1cbiAgICBhc3NpZ25BcmlhRGVzY3JpYmVkQnkoKSB7XG4gICAgICAgIGNvbnN0IGN1cnJlbnRWYWx1ZSA9IHRoaXMud3JhcHBlci5uYXRpdmVFbGVtZW50LmdldEF0dHJpYnV0ZSgnYXJpYS1kZXNjcmliZWRieScpIHx8ICcnO1xuICAgICAgICAvLyBhZGQgdG8gdGhlIGN1cnJlbnQgdmFsdWUgLSBkb24ndCByZXBsYWNlIGl0ICh0aGUgYXJpYS1kZXNjcmliZWRieSBpcyB1c2VkIGJ5IHRoZSBGb3JtRmllbGQgY29tcG9uZW50IGFzIHdlbGwpXG4gICAgICAgIGNvbnN0IG5ld1ZhbHVlID0gYCR7dGhpcy52YWx1ZUxhYmVsSWR9ICR7Y3VycmVudFZhbHVlLnRyaW0oKX1gLnRyaW0oKTtcbiAgICAgICAgdGhpcy5yZW5kZXJlci5zZXRBdHRyaWJ1dGUodGhpcy53cmFwcGVyLm5hdGl2ZUVsZW1lbnQsICdhcmlhLWRlc2NyaWJlZGJ5JywgbmV3VmFsdWUpO1xuICAgIH1cbiAgICBzZXRDb21wb25lbnRDbGFzc2VzKCkge1xuICAgICAgICBpZiAodGhpcy5zaXplKSB7XG4gICAgICAgICAgICB0aGlzLnJlbmRlcmVyLmFkZENsYXNzKHRoaXMud3JhcHBlci5uYXRpdmVFbGVtZW50LCBnZXRTaXplQ2xhc3MoJ3BpY2tlcicsIHRoaXMuc2l6ZSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnJvdW5kZWQpIHtcbiAgICAgICAgICAgIHRoaXMucmVuZGVyZXIuYWRkQ2xhc3ModGhpcy53cmFwcGVyLm5hdGl2ZUVsZW1lbnQsIGdldFJvdW5kZWRDbGFzcyh0aGlzLnJvdW5kZWQpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5maWxsTW9kZSkge1xuICAgICAgICAgICAgdGhpcy5yZW5kZXJlci5hZGRDbGFzcyh0aGlzLndyYXBwZXIubmF0aXZlRWxlbWVudCwgZ2V0RmlsbE1vZGVDbGFzcygncGlja2VyJywgdGhpcy5maWxsTW9kZSkpO1xuICAgICAgICB9XG4gICAgfVxufTtcbl9fZGVjb3JhdGUoW1xuICAgIEhvc3RCaW5kaW5nKCdjbGFzcy5rLWRyb3Bkb3dudHJlZScpLFxuICAgIEhvc3RCaW5kaW5nKCdjbGFzcy5rLXBpY2tlcicpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBCb29sZWFuKVxuXSwgRHJvcERvd25UcmVlQ29tcG9uZW50LnByb3RvdHlwZSwgXCJob3N0Q2xhc3Nlc1wiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgSG9zdEJpbmRpbmcoJ2NsYXNzLmstZGlzYWJsZWQnKSxcbiAgICBIb3N0QmluZGluZygnYXR0ci5hcmlhLWRpc2FibGVkJyksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEJvb2xlYW4pLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246cGFyYW10eXBlc1wiLCBbXSlcbl0sIERyb3BEb3duVHJlZUNvbXBvbmVudC5wcm90b3R5cGUsIFwiaXNEaXNhYmxlZFwiLCBudWxsKTtcbl9fZGVjb3JhdGUoW1xuICAgIEhvc3RCaW5kaW5nKCdjbGFzcy5rLWxvYWRpbmcnKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgQm9vbGVhbiksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjpwYXJhbXR5cGVzXCIsIFtdKVxuXSwgRHJvcERvd25UcmVlQ29tcG9uZW50LnByb3RvdHlwZSwgXCJpc0xvYWRpbmdcIiwgbnVsbCk7XG5fX2RlY29yYXRlKFtcbiAgICBIb3N0QmluZGluZygnYXR0ci5pZCcpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBTdHJpbmcpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246cGFyYW10eXBlc1wiLCBbXSlcbl0sIERyb3BEb3duVHJlZUNvbXBvbmVudC5wcm90b3R5cGUsIFwiaWRcIiwgbnVsbCk7XG5fX2RlY29yYXRlKFtcbiAgICBIb3N0QmluZGluZygnYXR0ci5kaXInKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgU3RyaW5nKVxuXSwgRHJvcERvd25UcmVlQ29tcG9uZW50LnByb3RvdHlwZSwgXCJkaXJlY3Rpb25cIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIEhvc3RCaW5kaW5nKCdhdHRyLnRhYmluZGV4JyksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIE51bWJlciksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjpwYXJhbXR5cGVzXCIsIFtdKVxuXSwgRHJvcERvd25UcmVlQ29tcG9uZW50LnByb3RvdHlwZSwgXCJob3N0VGFiSW5kZXhcIiwgbnVsbCk7XG5fX2RlY29yYXRlKFtcbiAgICBIb3N0QmluZGluZygnYXR0ci5yb2xlJyksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIFN0cmluZylcbl0sIERyb3BEb3duVHJlZUNvbXBvbmVudC5wcm90b3R5cGUsIFwicm9sZVwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgSG9zdEJpbmRpbmcoJ2F0dHIuYXJpYS1oYXNwb3B1cCcpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBTdHJpbmcpXG5dLCBEcm9wRG93blRyZWVDb21wb25lbnQucHJvdG90eXBlLCBcImFyaWFIYXNQb3B1cFwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgSG9zdEJpbmRpbmcoJ2F0dHIuYXJpYS1leHBhbmRlZCcpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBCb29sZWFuKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnBhcmFtdHlwZXNcIiwgW10pXG5dLCBEcm9wRG93blRyZWVDb21wb25lbnQucHJvdG90eXBlLCBcImlzQXJpYUV4cGFuZGVkXCIsIG51bGwpO1xuX19kZWNvcmF0ZShbXG4gICAgSG9zdEJpbmRpbmcoJ2F0dHIucmVhZG9ubHknKSxcbiAgICBIb3N0QmluZGluZygnYXR0ci5hcmlhLXJlYWRvbmx5JyksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEJvb2xlYW4pLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246cGFyYW10eXBlc1wiLCBbXSlcbl0sIERyb3BEb3duVHJlZUNvbXBvbmVudC5wcm90b3R5cGUsIFwiaXNSZWFkb25seVwiLCBudWxsKTtcbl9fZGVjb3JhdGUoW1xuICAgIEhvc3RMaXN0ZW5lcignY2xpY2snKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgRnVuY3Rpb24pLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246cGFyYW10eXBlc1wiLCBbXSksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjpyZXR1cm50eXBlXCIsIHZvaWQgMClcbl0sIERyb3BEb3duVHJlZUNvbXBvbmVudC5wcm90b3R5cGUsIFwiaGFuZGxlQ2xpY2tcIiwgbnVsbCk7XG5fX2RlY29yYXRlKFtcbiAgICBIb3N0TGlzdGVuZXIoJ2tleWRvd24nLCBbJyRldmVudCddKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgRnVuY3Rpb24pLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246cGFyYW10eXBlc1wiLCBbT2JqZWN0XSksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjpyZXR1cm50eXBlXCIsIHZvaWQgMClcbl0sIERyb3BEb3duVHJlZUNvbXBvbmVudC5wcm90b3R5cGUsIFwiaGFuZGxlS2V5ZG93blwiLCBudWxsKTtcbl9fZGVjb3JhdGUoW1xuICAgIENvbnRlbnRDaGlsZChOb0RhdGFUZW1wbGF0ZURpcmVjdGl2ZSwgeyBzdGF0aWM6IGZhbHNlIH0pLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBOb0RhdGFUZW1wbGF0ZURpcmVjdGl2ZSlcbl0sIERyb3BEb3duVHJlZUNvbXBvbmVudC5wcm90b3R5cGUsIFwibm9EYXRhVGVtcGxhdGVcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIENvbnRlbnRDaGlsZChIZWFkZXJUZW1wbGF0ZURpcmVjdGl2ZSwgeyBzdGF0aWM6IGZhbHNlIH0pLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBIZWFkZXJUZW1wbGF0ZURpcmVjdGl2ZSlcbl0sIERyb3BEb3duVHJlZUNvbXBvbmVudC5wcm90b3R5cGUsIFwiaGVhZGVyVGVtcGxhdGVcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIENvbnRlbnRDaGlsZChGb290ZXJUZW1wbGF0ZURpcmVjdGl2ZSwgeyBzdGF0aWM6IGZhbHNlIH0pLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBGb290ZXJUZW1wbGF0ZURpcmVjdGl2ZSlcbl0sIERyb3BEb3duVHJlZUNvbXBvbmVudC5wcm90b3R5cGUsIFwiZm9vdGVyVGVtcGxhdGVcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIENvbnRlbnRDaGlsZChOb2RlVGVtcGxhdGVEaXJlY3RpdmUsIHsgc3RhdGljOiBmYWxzZSB9KSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgTm9kZVRlbXBsYXRlRGlyZWN0aXZlKVxuXSwgRHJvcERvd25UcmVlQ29tcG9uZW50LnByb3RvdHlwZSwgXCJub2RlVGVtcGxhdGVcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIENvbnRlbnRDaGlsZChWYWx1ZVRlbXBsYXRlRGlyZWN0aXZlLCB7IHN0YXRpYzogZmFsc2UgfSksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIFZhbHVlVGVtcGxhdGVEaXJlY3RpdmUpXG5dLCBEcm9wRG93blRyZWVDb21wb25lbnQucHJvdG90eXBlLCBcInZhbHVlVGVtcGxhdGVcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIFZpZXdDaGlsZCgncG9wdXBUZW1wbGF0ZScsIHsgc3RhdGljOiB0cnVlIH0pLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBUZW1wbGF0ZVJlZilcbl0sIERyb3BEb3duVHJlZUNvbXBvbmVudC5wcm90b3R5cGUsIFwicG9wdXBUZW1wbGF0ZVwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgVmlld0NoaWxkKCdjb250YWluZXInLCB7IHJlYWQ6IFZpZXdDb250YWluZXJSZWYsIHN0YXRpYzogdHJ1ZSB9KSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgVmlld0NvbnRhaW5lclJlZilcbl0sIERyb3BEb3duVHJlZUNvbXBvbmVudC5wcm90b3R5cGUsIFwiY29udGFpbmVyXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBWaWV3Q2hpbGQoJ3RyZWV2aWV3JywgeyBzdGF0aWM6IGZhbHNlIH0pLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBUcmVlVmlld0NvbXBvbmVudCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjpwYXJhbXR5cGVzXCIsIFtUcmVlVmlld0NvbXBvbmVudF0pXG5dLCBEcm9wRG93blRyZWVDb21wb25lbnQucHJvdG90eXBlLCBcInRyZWV2aWV3XCIsIG51bGwpO1xuX19kZWNvcmF0ZShbXG4gICAgVmlld0NoaWxkKCdmaWx0ZXJJbnB1dCcsIHsgc3RhdGljOiBmYWxzZSB9KSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgRWxlbWVudFJlZilcbl0sIERyb3BEb3duVHJlZUNvbXBvbmVudC5wcm90b3R5cGUsIFwiZmlsdGVySW5wdXRcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIE91dHB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBFdmVudEVtaXR0ZXIpXG5dLCBEcm9wRG93blRyZWVDb21wb25lbnQucHJvdG90eXBlLCBcIm9wZW5cIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIE91dHB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBFdmVudEVtaXR0ZXIpXG5dLCBEcm9wRG93blRyZWVDb21wb25lbnQucHJvdG90eXBlLCBcIm9wZW5lZFwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgT3V0cHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEV2ZW50RW1pdHRlcilcbl0sIERyb3BEb3duVHJlZUNvbXBvbmVudC5wcm90b3R5cGUsIFwiY2xvc2VcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIE91dHB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBFdmVudEVtaXR0ZXIpXG5dLCBEcm9wRG93blRyZWVDb21wb25lbnQucHJvdG90eXBlLCBcImNsb3NlZFwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgT3V0cHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEV2ZW50RW1pdHRlcilcbl0sIERyb3BEb3duVHJlZUNvbXBvbmVudC5wcm90b3R5cGUsIFwibm9kZUV4cGFuZFwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgT3V0cHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEV2ZW50RW1pdHRlcilcbl0sIERyb3BEb3duVHJlZUNvbXBvbmVudC5wcm90b3R5cGUsIFwibm9kZUNvbGxhcHNlXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBPdXRwdXQoJ2ZvY3VzJyksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEV2ZW50RW1pdHRlcilcbl0sIERyb3BEb3duVHJlZUNvbXBvbmVudC5wcm90b3R5cGUsIFwib25Gb2N1c1wiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgT3V0cHV0KCdibHVyJyksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEV2ZW50RW1pdHRlcilcbl0sIERyb3BEb3duVHJlZUNvbXBvbmVudC5wcm90b3R5cGUsIFwib25CbHVyXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBPdXRwdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgRXZlbnRFbWl0dGVyKVxuXSwgRHJvcERvd25UcmVlQ29tcG9uZW50LnByb3RvdHlwZSwgXCJ2YWx1ZUNoYW5nZVwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgT3V0cHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEV2ZW50RW1pdHRlcilcbl0sIERyb3BEb3duVHJlZUNvbXBvbmVudC5wcm90b3R5cGUsIFwiZmlsdGVyQ2hhbmdlXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBJbnB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBCb29sZWFuKVxuXSwgRHJvcERvd25UcmVlQ29tcG9uZW50LnByb3RvdHlwZSwgXCJsb2FkaW5nXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBJbnB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBCb29sZWFuKVxuXSwgRHJvcERvd25UcmVlQ29tcG9uZW50LnByb3RvdHlwZSwgXCJjbGVhckJ1dHRvblwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgSW5wdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgQXJyYXkpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246cGFyYW10eXBlc1wiLCBbQXJyYXldKVxuXSwgRHJvcERvd25UcmVlQ29tcG9uZW50LnByb3RvdHlwZSwgXCJkYXRhXCIsIG51bGwpO1xuX19kZWNvcmF0ZShbXG4gICAgSW5wdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgT2JqZWN0KSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnBhcmFtdHlwZXNcIiwgW09iamVjdF0pXG5dLCBEcm9wRG93blRyZWVDb21wb25lbnQucHJvdG90eXBlLCBcInZhbHVlXCIsIG51bGwpO1xuX19kZWNvcmF0ZShbXG4gICAgSW5wdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgT2JqZWN0KVxuXSwgRHJvcERvd25UcmVlQ29tcG9uZW50LnByb3RvdHlwZSwgXCJ0ZXh0RmllbGRcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIE9iamVjdClcbl0sIERyb3BEb3duVHJlZUNvbXBvbmVudC5wcm90b3R5cGUsIFwidmFsdWVGaWVsZFwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgSW5wdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgTnVtYmVyKVxuXSwgRHJvcERvd25UcmVlQ29tcG9uZW50LnByb3RvdHlwZSwgXCJ2YWx1ZURlcHRoXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBJbnB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBGdW5jdGlvbilcbl0sIERyb3BEb3duVHJlZUNvbXBvbmVudC5wcm90b3R5cGUsIFwiaGFzQ2hpbGRyZW5cIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEZ1bmN0aW9uKVxuXSwgRHJvcERvd25UcmVlQ29tcG9uZW50LnByb3RvdHlwZSwgXCJmZXRjaENoaWxkcmVuXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBJbnB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBTdHJpbmcpXG5dLCBEcm9wRG93blRyZWVDb21wb25lbnQucHJvdG90eXBlLCBcInBsYWNlaG9sZGVyXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBJbnB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBPYmplY3QpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246cGFyYW10eXBlc1wiLCBbT2JqZWN0XSlcbl0sIERyb3BEb3duVHJlZUNvbXBvbmVudC5wcm90b3R5cGUsIFwicG9wdXBTZXR0aW5nc1wiLCBudWxsKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIE9iamVjdCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjpwYXJhbXR5cGVzXCIsIFtPYmplY3RdKVxuXSwgRHJvcERvd25UcmVlQ29tcG9uZW50LnByb3RvdHlwZSwgXCJkYXRhSXRlbVwiLCBudWxsKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIE51bWJlcilcbl0sIERyb3BEb3duVHJlZUNvbXBvbmVudC5wcm90b3R5cGUsIFwibGlzdEhlaWdodFwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgSW5wdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgQm9vbGVhbilcbl0sIERyb3BEb3duVHJlZUNvbXBvbmVudC5wcm90b3R5cGUsIFwiZGlzYWJsZWRcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEJvb2xlYW4pXG5dLCBEcm9wRG93blRyZWVDb21wb25lbnQucHJvdG90eXBlLCBcInJlYWRvbmx5XCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBJbnB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBCb29sZWFuKVxuXSwgRHJvcERvd25UcmVlQ29tcG9uZW50LnByb3RvdHlwZSwgXCJ2YWx1ZVByaW1pdGl2ZVwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgSW5wdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgTnVtYmVyKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnBhcmFtdHlwZXNcIiwgW051bWJlcl0pXG5dLCBEcm9wRG93blRyZWVDb21wb25lbnQucHJvdG90eXBlLCBcInRhYmluZGV4XCIsIG51bGwpO1xuX19kZWNvcmF0ZShbXG4gICAgSW5wdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgU3RyaW5nKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnBhcmFtdHlwZXNcIiwgW1N0cmluZ10pXG5dLCBEcm9wRG93blRyZWVDb21wb25lbnQucHJvdG90eXBlLCBcInNpemVcIiwgbnVsbCk7XG5fX2RlY29yYXRlKFtcbiAgICBJbnB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBTdHJpbmcpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246cGFyYW10eXBlc1wiLCBbU3RyaW5nXSlcbl0sIERyb3BEb3duVHJlZUNvbXBvbmVudC5wcm90b3R5cGUsIFwicm91bmRlZFwiLCBudWxsKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIFN0cmluZyksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjpwYXJhbXR5cGVzXCIsIFtTdHJpbmddKVxuXSwgRHJvcERvd25UcmVlQ29tcG9uZW50LnByb3RvdHlwZSwgXCJmaWxsTW9kZVwiLCBudWxsKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEZ1bmN0aW9uKVxuXSwgRHJvcERvd25UcmVlQ29tcG9uZW50LnByb3RvdHlwZSwgXCJpdGVtRGlzYWJsZWRcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEZ1bmN0aW9uKVxuXSwgRHJvcERvd25UcmVlQ29tcG9uZW50LnByb3RvdHlwZSwgXCJpc05vZGVFeHBhbmRlZFwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgSW5wdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgRnVuY3Rpb24pXG5dLCBEcm9wRG93blRyZWVDb21wb25lbnQucHJvdG90eXBlLCBcImlzTm9kZVZpc2libGVcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEJvb2xlYW4pXG5dLCBEcm9wRG93blRyZWVDb21wb25lbnQucHJvdG90eXBlLCBcImxvYWRPbkRlbWFuZFwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgSW5wdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgQm9vbGVhbilcbl0sIERyb3BEb3duVHJlZUNvbXBvbmVudC5wcm90b3R5cGUsIFwiZmlsdGVyYWJsZVwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgSW5wdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgU3RyaW5nKVxuXSwgRHJvcERvd25UcmVlQ29tcG9uZW50LnByb3RvdHlwZSwgXCJmaWx0ZXJcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIFN0cmluZylcbl0sIERyb3BEb3duVHJlZUNvbXBvbmVudC5wcm90b3R5cGUsIFwiZm9jdXNhYmxlSWRcIiwgdm9pZCAwKTtcbkRyb3BEb3duVHJlZUNvbXBvbmVudCA9IERyb3BEb3duVHJlZUNvbXBvbmVudF8xID0gX19kZWNvcmF0ZShbXG4gICAgQ29tcG9uZW50KHtcbiAgICAgICAgZXhwb3J0QXM6ICdrZW5kb0Ryb3BEb3duVHJlZScsXG4gICAgICAgIHByb3ZpZGVyczogW1xuICAgICAgICAgICAgRGF0YVNlcnZpY2UsXG4gICAgICAgICAgICBTZWxlY3Rpb25TZXJ2aWNlLFxuICAgICAgICAgICAgTmF2aWdhdGlvblNlcnZpY2UsXG4gICAgICAgICAgICBEaXNhYmxlZEl0ZW1zU2VydmljZSxcbiAgICAgICAgICAgIExvY2FsaXphdGlvblNlcnZpY2UsXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcHJvdmlkZTogTDEwTl9QUkVGSVgsXG4gICAgICAgICAgICAgICAgdXNlVmFsdWU6ICdrZW5kby5kcm9wZG93bnRyZWUnXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIG11bHRpOiB0cnVlLFxuICAgICAgICAgICAgICAgIHByb3ZpZGU6IE5HX1ZBTFVFX0FDQ0VTU09SLFxuICAgICAgICAgICAgICAgIHVzZUV4aXN0aW5nOiBmb3J3YXJkUmVmKCgpID0+IERyb3BEb3duVHJlZUNvbXBvbmVudF8xKVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBwcm92aWRlOiBLZW5kb0lucHV0LFxuICAgICAgICAgICAgICAgIHVzZUV4aXN0aW5nOiBmb3J3YXJkUmVmKCgpID0+IERyb3BEb3duVHJlZUNvbXBvbmVudF8xKVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBwcm92aWRlOiBEYXRhQm91bmRDb21wb25lbnQsXG4gICAgICAgICAgICAgICAgdXNlRXhpc3Rpbmc6IGZvcndhcmRSZWYoKCkgPT4gRHJvcERvd25UcmVlQ29tcG9uZW50XzEpXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHByb3ZpZGU6IEV4cGFuZGFibGVDb21wb25lbnQsXG4gICAgICAgICAgICAgICAgdXNlRXhpc3Rpbmc6IGZvcndhcmRSZWYoKCkgPT4gRHJvcERvd25UcmVlQ29tcG9uZW50XzEpXG4gICAgICAgICAgICB9XG4gICAgICAgIF0sXG4gICAgICAgIHNlbGVjdG9yOiAna2VuZG8tZHJvcGRvd250cmVlJyxcbiAgICAgICAgdGVtcGxhdGU6IGBcbiAgICAgICAgPG5nLWNvbnRhaW5lciBrZW5kb0Ryb3BEb3duVHJlZUxvY2FsaXplZE1lc3NhZ2VzXG4gICAgICAgICAgICBpMThuLW5vRGF0YVRleHQ9XCJrZW5kby5kcm9wZG93bnRyZWUubm9EYXRhVGV4dHxUaGUgdGV4dCBkaXNwbGF5ZWQgaW4gdGhlIHBvcHVwIHdoZW4gdGhlcmUgYXJlIG5vIGl0ZW1zXCJcbiAgICAgICAgICAgIG5vRGF0YVRleHQ9XCJOTyBEQVRBIEZPVU5EXCJcblxuICAgICAgICAgICAgaTE4bi1jbGVhclRpdGxlPVwia2VuZG8uZHJvcGRvd250cmVlLmNsZWFyVGl0bGV8VGhlIHRpdGxlIG9mIHRoZSBjbGVhciBidXR0b25cIlxuICAgICAgICAgICAgY2xlYXJUaXRsZT1cImNsZWFyXCJcblxuICAgICAgICAgICAgaTE4bi1zZWxlY3RCdXR0b25UZXh0PVwia2VuZG8uZHJvcGRvd250cmVlLnNlbGVjdEJ1dHRvblRleHR8VGhlIHRleHQgc2V0IGFzIGFyaWEtbGFiZWwgb24gdGhlIHNlbGVjdCBidXR0b25cIlxuICAgICAgICAgICAgc2VsZWN0QnV0dG9uVGV4dD1cIlNlbGVjdFwiXG4gICAgICAgID5cbiAgICAgICAgPC9uZy1jb250YWluZXI+XG4gICAgICAgIDxzcGFuXG4gICAgICAgICAgICBbYXR0ci5pZF09XCJ2YWx1ZUxhYmVsSWRcIlxuICAgICAgICAgICAgY2xhc3M9XCJrLWlucHV0LWlubmVyXCJcbiAgICAgICAgICAgIHJvbGU9XCJvcHRpb25cIlxuICAgICAgICA+XG4gICAgICAgICAgICA8c3BhbiBjbGFzcz1cImstaW5wdXQtdmFsdWUtdGV4dFwiPlxuICAgICAgICAgICAgICAgIDxuZy10ZW1wbGF0ZSAqbmdJZj1cInZhbHVlVGVtcGxhdGVcIlxuICAgICAgICAgICAgICAgICAgICBbdGVtcGxhdGVDb250ZXh0XT1cIntcbiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlUmVmOiB2YWx1ZVRlbXBsYXRlLnRlbXBsYXRlUmVmLFxuICAgICAgICAgICAgICAgICAgICAgICAgJGltcGxpY2l0OiBkYXRhSXRlbVxuICAgICAgICAgICAgICAgICAgICB9XCI+XG4gICAgICAgICAgICAgICAgPC9uZy10ZW1wbGF0ZT5cbiAgICAgICAgICAgICAgICA8bmctdGVtcGxhdGUgW25nSWZdPVwiIXZhbHVlVGVtcGxhdGVcIj4ge3sgdGV4dCB8fCBwbGFjZWhvbGRlciB9fSA8L25nLXRlbXBsYXRlPlxuICAgICAgICAgICAgPC9zcGFuPlxuICAgICAgICA8L3NwYW4+XG4gICAgICAgIDxzcGFuXG4gICAgICAgICAgICAqbmdJZj1cIiFsb2FkaW5nICYmICFyZWFkb25seSAmJiBjbGVhckJ1dHRvbiAmJiB0ZXh0Py5sZW5ndGggJiYgIWRpc2FibGVkXCJcbiAgICAgICAgICAgIGNsYXNzPVwiay1jbGVhci12YWx1ZVwiXG4gICAgICAgICAgICBbc3R5bGUudmlzaWJpbGl0eV09XCJjbGVhckJ1dHRvblZpc2libGl0eVwiXG4gICAgICAgICAgICBhcmlhLWhpZGRlbj1cInRydWVcIlxuICAgICAgICAgICAgW2F0dHIudGl0bGVdPVwibWVzc2FnZUZvcignY2xlYXJUaXRsZScpXCJcbiAgICAgICAgICAgIChjbGljayk9XCJjbGVhclZhbHVlKCRldmVudClcIlxuICAgICAgICA+XG4gICAgICAgICAgICA8c3BhbiBjbGFzcz1cImstaWNvbiBrLWkteFwiPjwvc3Bhbj5cbiAgICAgICAgPC9zcGFuPlxuICAgICAgICA8YnV0dG9uXG4gICAgICAgICAgICB0YWJpbmRleD1cIi0xXCJcbiAgICAgICAgICAgIHR5cGU9XCJidXR0b25cIlxuICAgICAgICAgICAgYXJpYS1oaWRkZW49XCJ0cnVlXCJcbiAgICAgICAgICAgIGNsYXNzPVwiay1pbnB1dC1idXR0b24gay1idXR0b24gay1pY29uLWJ1dHRvblwiXG4gICAgICAgICAgICBbbmdDbGFzc109XCJzZWxlY3RCdXR0b25DbGFzc2VzXCJcbiAgICAgICAgICAgIFthdHRyLmFyaWEtbGFiZWxdPVwibWVzc2FnZUZvcignc2VsZWN0QnV0dG9uVGV4dCcpXCJcbiAgICAgICAgPlxuICAgICAgICAgICAgPHNwYW5cbiAgICAgICAgICAgICAgICBjbGFzcz1cImstYnV0dG9uLWljb24gay1pY29uXCJcbiAgICAgICAgICAgICAgICBbbmdDbGFzc109XCJidXR0b25DbGFzc2VzXCJcbiAgICAgICAgICAgID48L3NwYW4+XG4gICAgICAgIDwvYnV0dG9uPlxuICAgICAgICA8bmctdGVtcGxhdGUgI3BvcHVwVGVtcGxhdGU+XG4gICAgICAgICAgICA8c3BhblxuICAgICAgICAgICAgICAgICpuZ0lmPVwiZmlsdGVyYWJsZVwiXG4gICAgICAgICAgICAgICAgY2xhc3M9XCJrLWxpc3QtZmlsdGVyXCJcbiAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICA8c3BhblxuICAgICAgICAgICAgICAgICAgICBjbGFzcz1cImstdGV4dGJveCBrLWlucHV0XCJcbiAgICAgICAgICAgICAgICAgICAgW25nQ2xhc3NdPVwiZmlsdGVySW5wdXRDbGFzc2VzXCJcbiAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwiay1pbnB1dC1wcmVmaXhcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwiay1pbnB1dC1pY29uIGstaWNvbiBrLWktc2VhcmNoXCI+PC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgIDxpbnB1dFxuICAgICAgICAgICAgICAgICAgICAgICAgI2ZpbHRlcklucHV0XG4gICAgICAgICAgICAgICAgICAgICAgICAoaW5wdXQpPVwiaGFuZGxlRmlsdGVySW5wdXRDaGFuZ2UoJGV2ZW50LnRhcmdldC52YWx1ZSlcIlxuICAgICAgICAgICAgICAgICAgICAgICAgW2ZpbHRlcklucHV0XT1cImZpbHRlcmFibGUgJiYgIXRvdWNoRW5hYmxlZFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAoa2V5ZG93bi5hcnJvd2Rvd24pPVwiaGFuZGxlS2V5ZG93bigkZXZlbnQpXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIChrZXlkb3duLmFsdC5hcnJvd3VwKT1cImhhbmRsZUtleWRvd24oJGV2ZW50KVwiXG4gICAgICAgICAgICAgICAgICAgICAgICBbKG5nTW9kZWwpXT1cImZpbHRlclwiXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGFzcz1cImstaW5wdXQtaW5uZXJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgcm9sZT1cInRleHRib3hcIlxuICAgICAgICAgICAgICAgICAgICAgICAgYXJpYS1oYXNwb3B1cD1cInRydWVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgYXJpYS1leHBhbmRlZD1cImZhbHNlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhYmluZGV4PVwiMFwiXG4gICAgICAgICAgICAgICAgICAgICAgICBhcmlhLWRpc2FibGVkPVwiZmFsc2VcIlxuICAgICAgICAgICAgICAgICAgICAgICAgYXJpYS1yZWFkb25seT1cImZhbHNlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIFtrZW5kb0V2ZW50c091dHNpZGVBbmd1bGFyXT1cIntcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibHVyOiBoYW5kbGVCbHVyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XCJcbiAgICAgICAgICAgICAgICAgICAgICAgIFtzY29wZV09XCJ0aGlzXCJcbiAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICAgIDwhLS1oZWFkZXIgdGVtcGxhdGUtLT5cbiAgICAgICAgICAgIDxuZy10ZW1wbGF0ZVxuICAgICAgICAgICAgICAgICpuZ0lmPVwiaGVhZGVyVGVtcGxhdGVcIlxuICAgICAgICAgICAgICAgIFt0ZW1wbGF0ZUNvbnRleHRdPVwie1xuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVJlZjogaGVhZGVyVGVtcGxhdGU/LnRlbXBsYXRlUmVmXG4gICAgICAgICAgICAgICAgfVwiPlxuICAgICAgICAgICAgPC9uZy10ZW1wbGF0ZT5cbiAgICAgICAgICAgIDxrZW5kby10cmVldmlld1xuICAgICAgICAgICAgICAgICN0cmVldmlld1xuICAgICAgICAgICAgICAgICpuZ0lmPVwiZGF0YS5sZW5ndGggIT09IDAgJiYgIWFsbE5vZGVzSGlkZGVuXCJcbiAgICAgICAgICAgICAgICBbc2l6ZV09XCJzaXplXCJcbiAgICAgICAgICAgICAgICBbbm9kZXNdPVwiZGF0YVwiXG4gICAgICAgICAgICAgICAgW3N0eWxlLm1heEhlaWdodC5weF09XCJsaXN0SGVpZ2h0XCJcbiAgICAgICAgICAgICAgICBbYW5pbWF0ZV09XCJmYWxzZVwiXG4gICAgICAgICAgICAgICAgWyhzZWxlY3RlZEtleXMpXT1cInNlbGVjdGVkS2V5c1wiXG4gICAgICAgICAgICAgICAgW3NlbGVjdEJ5XT1cInNlbGVjdEJ5XCJcbiAgICAgICAgICAgICAgICBbdGV4dEZpZWxkXT1cInRleHRGaWVsZFwiXG4gICAgICAgICAgICAgICAga2VuZG9UcmVlVmlld1NlbGVjdGFibGVcbiAgICAgICAgICAgICAgICBbY2hpbGRyZW5dPVwiY2hpbGRyZW5cIlxuICAgICAgICAgICAgICAgIFtoYXNDaGlsZHJlbl09XCJoYXNDaGlsZHJlblwiXG4gICAgICAgICAgICAgICAgW2xvYWRPbkRlbWFuZF09XCJsb2FkT25EZW1hbmRcIlxuICAgICAgICAgICAgICAgIFtpc0V4cGFuZGVkXT1cImlzTm9kZUV4cGFuZGVkXCJcbiAgICAgICAgICAgICAgICBbaXNEaXNhYmxlZF09XCJpdGVtRGlzYWJsZWRcIlxuICAgICAgICAgICAgICAgIFtub2RlVGVtcGxhdGVdPVwibm9kZVRlbXBsYXRlXCJcbiAgICAgICAgICAgICAgICBbZmlsdGVyXT1cImZpbHRlclwiXG4gICAgICAgICAgICAgICAgW2lzVmlzaWJsZV09XCJpc05vZGVWaXNpYmxlXCJcbiAgICAgICAgICAgICAgICAoZm9jdXNvdXQpPVwiaGFuZGxlQmx1cigkZXZlbnQpXCJcbiAgICAgICAgICAgICAgICAoa2V5ZG93bik9XCJoYW5kbGVLZXlkb3duKCRldmVudClcIlxuICAgICAgICAgICAgICAgIChzZWxlY3Rpb25DaGFuZ2UpPVwib25TZWxlY3Rpb25DaGFuZ2UoJGV2ZW50KVwiXG4gICAgICAgICAgICAgICAgKGV4cGFuZCk9XCJub2RlRXhwYW5kLmVtaXQoJGV2ZW50KVwiXG4gICAgICAgICAgICAgICAgKGNvbGxhcHNlKT1cIm5vZGVDb2xsYXBzZS5lbWl0KCRldmVudClcIlxuICAgICAgICAgICAgPlxuICAgICAgICAgICAgPC9rZW5kby10cmVldmlldz5cbiAgICAgICAgICAgIDwhLS1mb290ZXIgdGVtcGxhdGUtLT5cbiAgICAgICAgICAgIDxuZy10ZW1wbGF0ZVxuICAgICAgICAgICAgICAgICpuZ0lmPVwiZm9vdGVyVGVtcGxhdGVcIlxuICAgICAgICAgICAgICAgIFt0ZW1wbGF0ZUNvbnRleHRdPVwie1xuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVJlZjogZm9vdGVyVGVtcGxhdGU/LnRlbXBsYXRlUmVmXG4gICAgICAgICAgICAgICAgfVwiPlxuICAgICAgICAgICAgPC9uZy10ZW1wbGF0ZT5cbiAgICAgICAgICAgIDwhLS1uby1kYXRhIHRlbXBsYXRlLS0+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwiay1uby1kYXRhXCIgKm5nSWY9XCJkYXRhLmxlbmd0aCA9PT0gMCB8fCBhbGxOb2Rlc0hpZGRlblwiPlxuICAgICAgICAgICAgICAgIDxuZy10ZW1wbGF0ZSBbbmdJZl09XCJub0RhdGFUZW1wbGF0ZVwiXG4gICAgICAgICAgICAgICAgICAgIFt0ZW1wbGF0ZUNvbnRleHRdPVwie1xuICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVSZWY6IG5vRGF0YVRlbXBsYXRlPy50ZW1wbGF0ZVJlZlxuICAgICAgICAgICAgICAgICAgICB9XCI+XG4gICAgICAgICAgICAgICAgPC9uZy10ZW1wbGF0ZT5cbiAgICAgICAgICAgICAgICA8bmctdGVtcGxhdGUgW25nSWZdPVwiIW5vRGF0YVRlbXBsYXRlXCI+XG4gICAgICAgICAgICAgICAgICAgIDxkaXY+e3sgbWVzc2FnZUZvcignbm9EYXRhVGV4dCcpIH19PC9kaXY+XG4gICAgICAgICAgICAgICAgPC9uZy10ZW1wbGF0ZT5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L25nLXRlbXBsYXRlPlxuICAgICAgICA8bmctY29udGFpbmVyICNjb250YWluZXI+PC9uZy1jb250YWluZXI+XG4gICAgYCxcbiAgICAgICAgY2hhbmdlRGV0ZWN0aW9uOiBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneS5PblB1c2hcbiAgICB9KSxcbiAgICBfX3BhcmFtKDcsIE9wdGlvbmFsKCkpLCBfX3BhcmFtKDcsIEluamVjdChUT1VDSF9FTkFCTEVEKSksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjpwYXJhbXR5cGVzXCIsIFtFbGVtZW50UmVmLFxuICAgICAgICBQb3B1cFNlcnZpY2UsXG4gICAgICAgIE5hdmlnYXRpb25TZXJ2aWNlLFxuICAgICAgICBSZW5kZXJlcjIsXG4gICAgICAgIE5nWm9uZSxcbiAgICAgICAgQ2hhbmdlRGV0ZWN0b3JSZWYsXG4gICAgICAgIExvY2FsaXphdGlvblNlcnZpY2UsIEJvb2xlYW5dKVxuXSwgRHJvcERvd25UcmVlQ29tcG9uZW50KTtcblxudmFyIE11bHRpU2VsZWN0VHJlZUNvbXBvbmVudF8xO1xuLyogdHNsaW50OmRpc2FibGU6bWVtYmVyLW9yZGVyaW5nICovXG5jb25zdCBERUZBVUxUX1BPUFVQX1NFVFRJTkdTJDEgPSB7IGFuaW1hdGU6IHRydWUgfTtcbmNvbnN0IERFRkFVTFRfQ0hFQ0tBQkxFX1NFVFRJTkdTID0geyBjaGVja0NoaWxkcmVuOiB0cnVlLCBjaGVja09uQ2xpY2s6IHRydWUgfTtcbmNvbnN0IGhhc0NoaWxkcmVuJDEgPSAoKSA9PiBmYWxzZTtcbmNvbnN0IGZldGNoQ2hpbGRyZW4kMSA9ICgpID0+IG9mKFtdKTtcbmNvbnN0IGl0ZW1EaXNhYmxlZCQxID0gKCkgPT4gZmFsc2U7XG5jb25zdCBpc05vZGVWaXNpYmxlJDEgPSAoKSA9PiB0cnVlO1xuLyoqXG4gKiBSZXByZXNlbnRzIHRoZSBbS2VuZG8gVUkgTXVsdGlTZWxlY3RUcmVlIGNvbXBvbmVudCBmb3IgQW5ndWxhcl0oeyUgc2x1ZyBvdmVydmlld19tdWx0aXNlbGVjdHRyZWUgJX0pLlxuICovXG5sZXQgTXVsdGlTZWxlY3RUcmVlQ29tcG9uZW50ID0gTXVsdGlTZWxlY3RUcmVlQ29tcG9uZW50XzEgPSBjbGFzcyBNdWx0aVNlbGVjdFRyZWVDb21wb25lbnQge1xuICAgIGNvbnN0cnVjdG9yKHdyYXBwZXIsIHBvcHVwU2VydmljZSwgcmVuZGVyZXIsIG5hdmlnYXRpb25TZXJ2aWNlLCBfem9uZSwgbG9jYWxpemF0aW9uLCBjZHIsIHRvdWNoRW5hYmxlZCQkMSkge1xuICAgICAgICB0aGlzLndyYXBwZXIgPSB3cmFwcGVyO1xuICAgICAgICB0aGlzLnBvcHVwU2VydmljZSA9IHBvcHVwU2VydmljZTtcbiAgICAgICAgdGhpcy5yZW5kZXJlciA9IHJlbmRlcmVyO1xuICAgICAgICB0aGlzLm5hdmlnYXRpb25TZXJ2aWNlID0gbmF2aWdhdGlvblNlcnZpY2U7XG4gICAgICAgIHRoaXMuX3pvbmUgPSBfem9uZTtcbiAgICAgICAgdGhpcy5sb2NhbGl6YXRpb24gPSBsb2NhbGl6YXRpb247XG4gICAgICAgIHRoaXMuY2RyID0gY2RyO1xuICAgICAgICB0aGlzLnRvdWNoRW5hYmxlZCA9IHRvdWNoRW5hYmxlZCQkMTtcbiAgICAgICAgdGhpcy5ob3N0Q2xhc3NlcyA9IHRydWU7XG4gICAgICAgIHRoaXMucm9sZSA9ICdjb21ib2JveCc7XG4gICAgICAgIHRoaXMuYXJpYUhhc1BvcHVwID0gJ3RyZWUnO1xuICAgICAgICAvKipcbiAgICAgICAgICogU2V0cyB0aGUgbGV2ZWxzIGluIHRoZSBkYXRhIHNldCB3aGVyZSB0aGUgdmFsdWVzIGNhbiBiZSBmb3VuZCB3aGVuIGB2YWx1ZUZpZWxkYCBpcyBhbiBBcnJheS5cbiAgICAgICAgICogVGhlIGZpZWxkIHNlcnZlcyB0byBjb3JyZWN0bHkgYWxsb2NhdGUgYSBkYXRhIGl0ZW0gdXNlZCB3aGVuIHRoZSBNdWx0aVNlbGVjdFRyZWUgaXMgaW5pdGlhbGl6ZWQgd2l0aCBhIHZhbHVlLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy52YWx1ZURlcHRoID0gW107XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgaGludCB3aGljaCBpcyBkaXNwbGF5ZWQgd2hlbiB0aGUgY29tcG9uZW50IGlzIGVtcHR5LlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5wbGFjZWhvbGRlciA9IFwiXCI7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBTZXRzIHRoZSBoZWlnaHQgb2YgdGhlIG9wdGlvbnMgbGlzdC4gQnkgZGVmYXVsdCwgYGxpc3RIZWlnaHRgIGlzIDIwMHB4LlxuICAgICAgICAgKlxuICAgICAgICAgKiA+IFRoZSBgbGlzdEhlaWdodGAgcHJvcGVydHkgYWZmZWN0cyBvbmx5IHRoZSBsaXN0IG9mIG9wdGlvbnMgYW5kIG5vdCB0aGUgd2hvbGUgcG9wdXAgY29udGFpbmVyLlxuICAgICAgICAgKiA+IFRvIHNldCB0aGUgaGVpZ2h0IG9mIHRoZSBwb3B1cCBjb250YWluZXIsIHVzZSBgcG9wdXBTZXR0aW5ncy5oZWlnaHRgLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5saXN0SGVpZ2h0ID0gMjAwO1xuICAgICAgICAvKipcbiAgICAgICAgICogU2V0cyB0aGUgZGlzYWJsZWQgc3RhdGUgb2YgdGhlIGNvbXBvbmVudC5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuZGlzYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFNldHMgdGhlIHJlYWQtb25seSBzdGF0ZSBvZiB0aGUgY29tcG9uZW50LlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5yZWFkb25seSA9IGZhbHNlO1xuICAgICAgICAvKipcbiAgICAgICAgICogU3BlY2lmaWVzIHRoZSB0eXBlIG9mIHRoZSBzZWxlY3RlZCB2YWx1ZVxuICAgICAgICAgKiAoW21vcmUgaW5mb3JtYXRpb24gYW5kIGV4YW1wbGVdKHslIHNsdWcgdmFsdWViaW5kaW5nX211bHRpc2VsZWN0dHJlZSAlfSN0b2MtcHJpbWl0aXZlLXZhbHVlcykpLlxuICAgICAgICAgKiBJZiBzZXQgdG8gYHRydWVgLCB0aGUgc2VsZWN0ZWQgdmFsdWUgaGFzIHRvIGJlIGEgcHJpbWl0aXZlIG9uZS5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMudmFsdWVQcmltaXRpdmUgPSBmYWxzZTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEluZGljYXRlcyB3aGV0aGVyIHRoZSBjaGlsZCBub2RlcyB3aWxsIGJlIGZldGNoZWQgb24gbm9kZSBleHBhbmQgb3Igd2lsbCBiZSBpbml0aWFsbHkgcHJlZmV0Y2hlZC5cbiAgICAgICAgICogQGRlZmF1bHQgZmFsc2VcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMubG9hZE9uRGVtYW5kID0gZmFsc2U7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAaGlkZGVuXG4gICAgICAgICAqXG4gICAgICAgICAqIFVzZWQgYnkgdGhlIGtlbmRvLWxhYmVsIGFuZCBrZW5kby1mbG9hdGluZ2xhYmVsIHRvIGFjY2VzcyBhbmQgYXNzb2NpYXRlIHRoZSBmb2N1c2FibGUgZWxlbWVudCB3aXRoIHRoZSBwcm92aWRlZCBsYWJlbCB2aWEgYXJpYS1sYWJlbGxlZGJ5LlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5mb2N1c2FibGVJZCA9IGBrLSR7Z3VpZCgpfWA7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBJZiBzZXQgdG8gYHRydWVgLCByZW5kZXJzIGEgYnV0dG9uIG9uIGhvdmVyaW5nIG92ZXIgdGhlIGNvbXBvbmVudC5cbiAgICAgICAgICogQ2xpY2tpbmcgdGhpcyBidXR0b24gcmVzZXRzIHRoZSB2YWx1ZSBvZiB0aGUgY29tcG9uZW50IHRvIGB1bmRlZmluZWRgIGFuZCB0cmlnZ2VycyB0aGUgYGNoYW5nZWAgZXZlbnQuXG4gICAgICAgICAqIEBkZWZhdWx0IHRydWVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuY2xlYXJCdXR0b24gPSB0cnVlO1xuICAgICAgICAvKipcbiAgICAgICAgICogUmVuZGVycyB0aGUgYnVpbHQtaW4gaW5wdXQgZWxlbWVudCBmb3IgZmlsdGVyaW5nIHRoZSBNdWx0aVNlbGVjdFRyZWUuXG4gICAgICAgICAqIElmIHNldCB0byBgdHJ1ZWAsIHRoZSBjb21wb25lbnQgZW1pdHMgdGhlIGBmaWx0ZXJDaGFuZ2VgIGV2ZW50LCB3aGljaCBjYW4gYmUgdXNlZCB0byBbZmlsdGVyIHRoZSBNdWx0aVNlbGVjdFRyZWUgbWFudWFsbHldKHslIHNsdWcgZmlsdGVyaW5nX211bHRpc2VsZWN0dHJlZSAlfSN0b2MtbWFudWFsLWZpbHRlcmluZykuXG4gICAgICAgICAqIEEgYnVpbHQtaW4gZmlsdGVyaW5nIGltcGxlbWVudGF0aW9uIGlzIGF2YWlsYWJsZSB0byB1c2Ugd2l0aCB0aGUgW2BrZW5kb011bHRpU2VsZWN0VHJlZUhpZXJhcmNoeUJpbmRpbmdgXSh7JSBzbHVnIGFwaV9kcm9wZG93bnNfbXVsdGlzZWxlY3R0cmVlaGllcmFyY2h5YmluZGluZ2RpcmVjdGl2ZSAlfSkgYW5kIFtga2VuZG9NdWx0aVNlbGVjdFRyZWVGbGF0QmluZGluZ2BdKHslIHNsdWcgYXBpX2Ryb3Bkb3duc19tdWx0aXNlbGVjdHRyZWVmbGF0YmluZGluZ2RpcmVjdGl2ZSAlfSkgZGlyZWN0aXZlcy5cbiAgICAgICAgICogQGRlZmF1bHQgZmFsc2VcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuZmlsdGVyYWJsZSA9IGZhbHNlO1xuICAgICAgICAvKipcbiAgICAgICAgICogSWYgYGNoZWNr0JBsbGAgaXMgc2V0IHRvIGB0cnVlYCBhbmQgdGhlIGNoZWNrYm94ZXMgYXJlIGVuYWJsZWQsIGEgdHJpLXN0YXRlIGNoZWNrYm94IGFwcGVhcnMgYWJvdmUgdGhlIGVtYmVkZGVkIHRyZWV2aWV3LlxuICAgICAgICAgKiBDbGlja2luZyB0aGUgY2hlY2tib3ggY2hlY2tzIG9yIHVuY2hlY2tzIGFsbCBlbmFibGVkIGl0ZW1zIG9mIHRoZSB0cmVldmlldyB0aGF0IGFyZSBsb2FkZWQuXG4gICAgICAgICAqIEBkZWZhdWx0IGZhbHNlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmNoZWNrQWxsID0gZmFsc2U7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBIGZ1bmN0aW9uIHdoaWNoIGRldGVybWluZXMgaWYgYSBzcGVjaWZpYyBub2RlIGhhcyBjaGlsZCBub2Rlcy5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuaGFzQ2hpbGRyZW4gPSBoYXNDaGlsZHJlbiQxO1xuICAgICAgICAvKipcbiAgICAgICAgICogQSBmdW5jdGlvbiB3aGljaCBwcm92aWRlcyB0aGUgY2hpbGQgbm9kZXMgZm9yIGEgZ2l2ZW4gcGFyZW50IG5vZGUuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmZldGNoQ2hpbGRyZW4gPSBmZXRjaENoaWxkcmVuJDE7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBIGNhbGxiYWNrIHdoaWNoIGRldGVybWluZXMgd2hldGhlciBhIHRyZWUgbm9kZSBzaG91bGQgYmUgcmVuZGVyZWQgYXMgaGlkZGVuLiBUaGUgdXRpbGl0eSAuay1kaXNwbGF5LW5vbmUgY2xhc3MgaXMgdXNlZCB0byBoaWRlIHRoZSBub2Rlcy5cbiAgICAgICAgICogVXNlZnVsIGZvciBjdXN0b20gZmlsdGVyaW5nIGltcGxlbWVudGF0aW9ucy5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuaXNOb2RlVmlzaWJsZSA9IGlzTm9kZVZpc2libGUkMTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEEgZnVuY3Rpb24gdGhhdCBpcyBleGVjdXRlZCBmb3IgZWFjaCBkYXRhIGl0ZW0gYW5kIGRldGVybWluZXMgaWYgYSBzcGVjaWZpYyBpdGVtIGlzIGRpc2FibGVkLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5pdGVtRGlzYWJsZWQgPSBpdGVtRGlzYWJsZWQkMTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEEgdXNlci1kZWZpbmVkIGNhbGxiYWNrIGZ1bmN0aW9uIHdoaWNoIHJlY2VpdmVzIGFuIGFycmF5IG9mIHNlbGVjdGVkIGRhdGEgaXRlbXMgYW5kIG1hcHMgdGhlbSB0byBhbiBhcnJheSBvZiB0YWdzLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAcGFyYW0geyBBbnlbXSB9IGRhdGFJdGVtcyAtIFRoZSBzZWxlY3RlZCBkYXRhIGl0ZW1zIGZyb20gdGhlIGxpc3QuXG4gICAgICAgICAqIEByZXR1cm5zIHsgQW55W10gfSAtIFRoZSB0YWdzIHRoYXQgd2lsbCBiZSByZW5kZXJlZCBieSB0aGUgY29tcG9uZW50LlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy50YWdNYXBwZXIgPSAodGFncykgPT4gdGFncyB8fCBbXTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEZpcmVzIGVhY2ggdGltZSB0aGUgdXNlciBmb2N1c2VzIHRoZSBNdWx0aVNlbGVjdFRyZWUuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLm9uRm9jdXMgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBGaXJlcyBlYWNoIHRpbWUgdGhlIE11bHRpU2VsZWN0VHJlZSBnZXRzIGJsdXJyZWQuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLm9uQmx1ciA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEZpcmVzIGVhY2ggdGltZSB0aGUgcG9wdXAgaXMgYWJvdXQgdG8gb3BlblxuICAgICAgICAgKiAoW3NlZSBleGFtcGxlXSh7JSBzbHVnIG9wZW5zdGF0ZV9tdWx0aXNlbGVjdHRyZWUgJX0pKS5cbiAgICAgICAgICogVGhpcyBldmVudCBpcyBwcmV2ZW50YWJsZS4gSWYgeW91IGNhbmNlbCBpdCwgdGhlIHBvcHVwIHdpbGwgcmVtYWluIGNsb3NlZC5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMub3BlbiA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEZpcmVzIGFmdGVyIHRoZSBwb3B1cCBoYXMgYmVlbiBvcGVuZWQuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLm9wZW5lZCA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEZpcmVzIGVhY2ggdGltZSB0aGUgcG9wdXAgaXMgYWJvdXQgdG8gY2xvc2VcbiAgICAgICAgICogKFtzZWUgZXhhbXBsZV0oeyUgc2x1ZyBvcGVuc3RhdGVfbXVsdGlzZWxlY3R0cmVlICV9KSkuXG4gICAgICAgICAqIFRoaXMgZXZlbnQgaXMgcHJldmVudGFibGUuIElmIHlvdSBjYW5jZWwgaXQsIHRoZSBwb3B1cCB3aWxsIHJlbWFpbiBvcGVuLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5jbG9zZSA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEZpcmVzIGFmdGVyIHRoZSBwb3B1cCBoYXMgYmVlbiBjbG9zZWQuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmNsb3NlZCA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEZpcmVzIHdoZW4gdGhlIHVzZXIgZXhwYW5kcyBhIG5vZGUgaW4gdGhlIHBvcHVwIFRyZWVWaWV3LlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5ub2RlRXhwYW5kID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICAgICAgICAvKipcbiAgICAgICAgICogRmlyZXMgd2hlbiB0aGUgdXNlciBjb2xsYXBzZXMgYSBub2RlIGluIHRoZSBwb3B1cCBUcmVlVmlldy5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMubm9kZUNvbGxhcHNlID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICAgICAgICAvKipcbiAgICAgICAgICogRmlyZXMgZWFjaCB0aW1lIHRoZSB2YWx1ZSBpcyBjaGFuZ2VkXG4gICAgICAgICAqIChbc2VlIGV4YW1wbGVdKHslIHNsdWcgb3ZlcnZpZXdfbXVsdGlzZWxlY3R0cmVlICV9I3RvYy1ldmVudHMpKS5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMudmFsdWVDaGFuZ2UgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBGaXJlcyBlYWNoIHRpbWUgYSB0YWcgaXMgYWJvdXQgdG8gYmUgcmVtb3ZlZC5cbiAgICAgICAgICogVGhpcyBldmVudCBpcyBwcmV2ZW50YWJsZS4gSWYgeW91IGNhbmNlbCBpdCwgdGhlIHRhZyB3aWxsIG5vdCBiZSByZW1vdmVkLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5yZW1vdmVUYWcgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBGaXJlcyB3aGVuIHRoZSB2YWx1ZSBvZiB0aGUgYnVpbHQtaW4gZmlsdGVyIGlucHV0IGVsZW1lbnQgY2hhbmdlcy5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuZmlsdGVyQ2hhbmdlID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICAgICAgICAvKipcbiAgICAgICAgICogQGhpZGRlblxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5maWx0ZXJTdGF0ZUNoYW5nZSA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBoaWRkZW5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuY2hlY2tlZEl0ZW1zID0gW107XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAaGlkZGVuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmNoZWNrQnkgPSAoaXRlbSkgPT4gaXRlbTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBoaWRkZW5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuc2hvd0FmdGVyID0gMDtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBoaWRkZW5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuYWxsTm9kZXNIaWRkZW4gPSBmYWxzZTtcbiAgICAgICAgdGhpcy50YWdMaXN0SWQgPSBndWlkKCk7XG4gICAgICAgIHRoaXMudGFnUHJlZml4ID0gXCJ0YWctXCIgKyBndWlkKCk7XG4gICAgICAgIHRoaXMuZm9jdXNlZFRhZ0luZGV4ID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLl92YWx1ZSA9IFtdO1xuICAgICAgICB0aGlzLl90YWJpbmRleCA9IDA7XG4gICAgICAgIHRoaXMuX3BvcHVwU2V0dGluZ3MgPSBERUZBVUxUX1BPUFVQX1NFVFRJTkdTJDE7XG4gICAgICAgIHRoaXMuX2NoZWNrYWJsZVNldHRpbmdzID0gREVGQVVMVF9DSEVDS0FCTEVfU0VUVElOR1M7XG4gICAgICAgIHRoaXMuX2lzRm9jdXNlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLl9zaXplID0gJ21lZGl1bSc7XG4gICAgICAgIHRoaXMuX3JvdW5kZWQgPSAnbWVkaXVtJztcbiAgICAgICAgdGhpcy5fZmlsbE1vZGUgPSAnc29saWQnO1xuICAgICAgICB0aGlzLnN1YnNjcmlwdGlvbnMgPSBbXTtcbiAgICAgICAgdGhpcy5sYXN0QWN0aW9uID0gJ2NoZWNrJztcbiAgICAgICAgdGhpcy5vblRvdWNoZWRDYWxsYmFjayA9IG5vb3A7XG4gICAgICAgIHRoaXMub25DaGFuZ2VDYWxsYmFjayA9IG5vb3A7XG4gICAgICAgIHRoaXMuZGlyZWN0aW9uID0gbG9jYWxpemF0aW9uLnJ0bCA/ICdydGwnIDogJ2x0cic7XG4gICAgICAgIHRoaXMuc3Vic2NyaWJlRXZlbnRzKCk7XG4gICAgICAgIHRoaXMuc3Vic2NyaWJlRm9jdXNFdmVudHMoKTtcbiAgICB9XG4gICAgZ2V0IGlzRGlzYWJsZWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRpc2FibGVkO1xuICAgIH1cbiAgICBnZXQgaXNMb2FkaW5nKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5sb2FkaW5nO1xuICAgIH1cbiAgICBnZXQgaWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmZvY3VzYWJsZUlkO1xuICAgIH1cbiAgICBnZXQgaG9zdFRhYkluZGV4KCkge1xuICAgICAgICByZXR1cm4gdGhpcy50YWJpbmRleDtcbiAgICB9XG4gICAgZ2V0IGlzQXJpYUV4cGFuZGVkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5pc09wZW47XG4gICAgfVxuICAgIGdldCBpc1JlYWRvbmx5KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5yZWFkb25seTtcbiAgICB9XG4gICAgZ2V0IGFyaWFEZXNjcmliZWRCeSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudGFnTGlzdElkO1xuICAgIH1cbiAgICBnZXQgYXJpYUFjdGl2ZURlc2NlbmRhbnQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmZvY3VzZWRUYWdJZDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIGhhbmRsZUNsaWNrKCkge1xuICAgICAgICB0aGlzLnRvZ2dsZVBvcHVwKCF0aGlzLmlzT3Blbik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBoYW5kbGVLZXlkb3duKGV2ZW50KSB7XG4gICAgICAgIGNvbnN0IGRlbGV0ZVRhZyA9IHRoaXMuaXNXcmFwcGVyQWN0aXZlICYmIGV2ZW50LmtleUNvZGUgPT09IEtleXMuQmFja3NwYWNlICYmIHRoaXMudGFncy5sZW5ndGggPiAwO1xuICAgICAgICBpZiAoZGVsZXRlVGFnKSB7XG4gICAgICAgICAgICB0aGlzLmhhbmRsZUJhY2tzcGFjZSgpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmRpc2FibGVkIHx8IHRoaXMucmVhZG9ubHkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBldmVudERhdGEgPSBldmVudDtcbiAgICAgICAgY29uc3QgYWN0aW9uID0gdGhpcy5uYXZpZ2F0aW9uU2VydmljZS5wcm9jZXNzKHtcbiAgICAgICAgICAgIG9yaWdpbmFsRXZlbnQ6IGV2ZW50RGF0YVxuICAgICAgICB9KTtcbiAgICAgICAgaWYgKGFjdGlvbiA9PT0gTmF2aWdhdGlvbkFjdGlvbi5PcGVuKSB7XG4gICAgICAgICAgICBldmVudERhdGEucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzZXQgdHJlZXZpZXcodHJlZXZpZXcpIHtcbiAgICAgICAgdGhpcy5fdHJlZXZpZXcgPSB0cmVldmlldztcbiAgICAgICAgaWYgKHRyZWV2aWV3KSB7XG4gICAgICAgICAgICAvLyBJZiBmaWx0ZXJpbmcgaXMgZW5hYmxlZCwgZm9jdXMgdGhlIFRyZWVWaWV3IG9uIG1vYmlsZSBkZXZpY2VzIGluc3RlYWQgb2YgdGhlIGZpbHRlciBpbnB1dFxuICAgICAgICAgICAgaWYgKHRoaXMuaXNGb2N1c2VkICYmICF0aGlzLmZpbHRlcmFibGUgJiYgIXRoaXMuY2hlY2tBbGwgfHwgdGhpcy50b3VjaEVuYWJsZWQpIHtcbiAgICAgICAgICAgICAgICB0cmVldmlldy5mb2N1cygpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiB0aGUgdHJlZXZpZXcgYW5pbWF0aW9ucyBhcmUgaW5pdGlhbGx5IGRpc2FibGVkICh3ZSBkb24ndCB3YW50IGV4cGFuZCBhbmltYXRpb25zIGR1cmluZyBwb3B1cCBvcGVuaW5nKVxuICAgICAgICAgICAgICogcmUtZW5hYmxlcyB0aGUgYW5pbWF0aW9ucyBmb3IgdXNlciBpbnRlcmFjdGlvblxuICAgICAgICAgICAgICogVGhlIFByb21pc2UgaXMgcmVxdWlyZWQgdG8gcHJvcGVybHkgY2hhbmdlIHRoZSBgYW5pbWF0ZWAgcHJvcGVydHkgd2hlblxuICAgICAgICAgICAgICogdGhlIHBvcHVwIGlzIGFwcGVuZGVkIHRvIGEgY29udGFpbmVyIGFuZCBvcGVuZWQgdXBvbiBpbml0aWFsaXphdGlvbi5cbiAgICAgICAgICAgICAqIE90aGVyd2lzZSwgdGhlIFwiRXhwcmVzc2lvbiBoYXMgY2hhbmdlZC4uLlwiIHR5cGUgZXJyb3Igd2lsbCBiZSB0aHJvd24uXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIFByb21pc2UucmVzb2x2ZShudWxsKS50aGVuKCgpID0+IHRoaXMudHJlZXZpZXcuYW5pbWF0ZSA9IHRydWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGdldCB0cmVldmlldygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3RyZWV2aWV3O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTcGVjaWZpZXMgdGhlIFtgdGFiaW5kZXhgXShodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9IVE1ML0dsb2JhbF9hdHRyaWJ1dGVzL3RhYmluZGV4KSBvZiB0aGUgY29tcG9uZW50LlxuICAgICAqL1xuICAgIHNldCB0YWJpbmRleCh2YWx1ZSkge1xuICAgICAgICBjb25zdCBwcm92aWRlZFRhYkluZGV4ID0gcGFyc2VOdW1iZXIodmFsdWUpO1xuICAgICAgICBjb25zdCBkZWZhdWx0VGFiSW5kZXggPSAwO1xuICAgICAgICB0aGlzLl90YWJpbmRleCA9ICFpc05hTihwcm92aWRlZFRhYkluZGV4KSA/IHByb3ZpZGVkVGFiSW5kZXggOiBkZWZhdWx0VGFiSW5kZXg7XG4gICAgfVxuICAgIGdldCB0YWJpbmRleCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGlzYWJsZWQgPyAtMSA6IHRoaXMuX3RhYmluZGV4O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZXRzIHRoZSBzaXplIG9mIHRoZSBjb21wb25lbnQuXG4gICAgICpcbiAgICAgKiBUaGUgcG9zc2libGUgdmFsdWVzIGFyZTpcbiAgICAgKiAqIGAnc21hbGwnYFxuICAgICAqICogYCdtZWRpdW0nYCAoZGVmYXVsdClcbiAgICAgKiAqIGAnbGFyZ2UnYFxuICAgICAqICogYG51bGxgXG4gICAgICpcbiAgICAgKi9cbiAgICBzZXQgc2l6ZShzaXplKSB7XG4gICAgICAgIHRoaXMucmVuZGVyZXIucmVtb3ZlQ2xhc3ModGhpcy53cmFwcGVyLm5hdGl2ZUVsZW1lbnQsIGdldFNpemVDbGFzcygnaW5wdXQnLCB0aGlzLnNpemUpKTtcbiAgICAgICAgaWYgKHNpemUpIHtcbiAgICAgICAgICAgIHRoaXMucmVuZGVyZXIuYWRkQ2xhc3ModGhpcy53cmFwcGVyLm5hdGl2ZUVsZW1lbnQsIGdldFNpemVDbGFzcygnaW5wdXQnLCBzaXplKSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fc2l6ZSA9IHNpemU7XG4gICAgfVxuICAgIGdldCBzaXplKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fc2l6ZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2V0cyB0aGUgYm9yZGVyIHJhZGl1cyBvZiB0aGUgY29tcG9uZW50LlxuICAgICAqXG4gICAgICogVGhlIHBvc3NpYmxlIHZhbHVlcyBhcmU6XG4gICAgICogKiBgJ3NtYWxsJ2BcbiAgICAgKiAqIGAnbWVkaXVtJ2AgKGRlZmF1bHQpXG4gICAgICogKiBgJ2xhcmdlJ2BcbiAgICAgKiAqIGAnZnVsbCdgXG4gICAgICogKiBgbnVsbGBcbiAgICAgKlxuICAgICAqL1xuICAgIHNldCByb3VuZGVkKHJvdW5kZWQpIHtcbiAgICAgICAgdGhpcy5yZW5kZXJlci5yZW1vdmVDbGFzcyh0aGlzLndyYXBwZXIubmF0aXZlRWxlbWVudCwgZ2V0Um91bmRlZENsYXNzKHRoaXMucm91bmRlZCkpO1xuICAgICAgICBpZiAocm91bmRlZCkge1xuICAgICAgICAgICAgdGhpcy5yZW5kZXJlci5hZGRDbGFzcyh0aGlzLndyYXBwZXIubmF0aXZlRWxlbWVudCwgZ2V0Um91bmRlZENsYXNzKHJvdW5kZWQpKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9yb3VuZGVkID0gcm91bmRlZDtcbiAgICB9XG4gICAgZ2V0IHJvdW5kZWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9yb3VuZGVkO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZXRzIHRoZSBmaWxsTW9kZSBvZiB0aGUgY29tcG9uZW50LlxuICAgICAqXG4gICAgICogVGhlIHBvc3NpYmxlIHZhbHVlcyBhcmU6XG4gICAgICogKiBgJ2ZsYXQnYFxuICAgICAqICogYCdzb2xpZCdgIChkZWZhdWx0KVxuICAgICAqICogYCdvdXRsaW5lJ2BcbiAgICAgKiAqIGBudWxsYFxuICAgICAqXG4gICAgICovXG4gICAgc2V0IGZpbGxNb2RlKGZpbGxNb2RlKSB7XG4gICAgICAgIHRoaXMucmVuZGVyZXIucmVtb3ZlQ2xhc3ModGhpcy53cmFwcGVyLm5hdGl2ZUVsZW1lbnQsIGdldEZpbGxNb2RlQ2xhc3MoJ2lucHV0JywgdGhpcy5maWxsTW9kZSkpO1xuICAgICAgICBpZiAoZmlsbE1vZGUpIHtcbiAgICAgICAgICAgIHRoaXMucmVuZGVyZXIuYWRkQ2xhc3ModGhpcy53cmFwcGVyLm5hdGl2ZUVsZW1lbnQsIGdldEZpbGxNb2RlQ2xhc3MoJ2lucHV0JywgZmlsbE1vZGUpKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9maWxsTW9kZSA9IGZpbGxNb2RlO1xuICAgIH1cbiAgICBnZXQgZmlsbE1vZGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9maWxsTW9kZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ29uZmlndXJlcyB0aGUgcG9wdXAgb2YgdGhlIE11bHRpU2VsZWN0VHJlZS5cbiAgICAgKlxuICAgICAqIFRoZSBhdmFpbGFibGUgb3B0aW9ucyBhcmU6XG4gICAgICogLSBgYW5pbWF0ZTogQm9vbGVhbmAmbWRhc2g7Q29udHJvbHMgdGhlIHBvcHVwIGFuaW1hdGlvbi4gQnkgZGVmYXVsdCwgdGhlIG9wZW4gYW5kIGNsb3NlIGFuaW1hdGlvbnMgYXJlIGVuYWJsZWQuXG4gICAgICogLSBgd2lkdGg6IE51bWJlciB8IFN0cmluZ2AmbWRhc2g7U2V0cyB0aGUgd2lkdGggb2YgdGhlIHBvcHVwIGNvbnRhaW5lci4gQnkgZGVmYXVsdCwgdGhlIHdpZHRoIG9mIHRoZSBob3N0IGVsZW1lbnQgaXMgdXNlZC4gSWYgc2V0IHRvIGBhdXRvYCwgdGhlIGNvbXBvbmVudCBhdXRvbWF0aWNhbGx5IGFkanVzdHMgdGhlIHdpZHRoIG9mIHRoZSBwb3B1cCBhbmQgbm8gaXRlbSBsYWJlbHMgYXJlIHdyYXBwZWQuXG4gICAgICogLSBgaGVpZ2h0OiBOdW1iZXJgJm1kYXNoO1NldHMgdGhlIGhlaWdodCBvZiB0aGUgcG9wdXAgY29udGFpbmVyLlxuICAgICAqIC0gYHBvcHVwQ2xhc3M6IFN0cmluZ2AmbWRhc2g7U3BlY2lmaWVzIGEgbGlzdCBvZiBDU1MgY2xhc3NlcyB0aGF0IGFyZSB1c2VkIHRvIHN0eWxlIHRoZSBwb3B1cC5cbiAgICAgKiAtIGBhcHBlbmRUbzogXCJyb290XCIgfCBcImNvbXBvbmVudFwiIHwgVmlld0NvbnRhaW5lclJlZmAmbWRhc2g7U3BlY2lmaWVzIHRoZSBjb21wb25lbnQgdG8gd2hpY2ggdGhlIHBvcHVwIHdpbGwgYmUgYXBwZW5kZWQuXG4gICAgICovXG4gICAgc2V0IHBvcHVwU2V0dGluZ3Moc2V0dGluZ3MpIHtcbiAgICAgICAgdGhpcy5fcG9wdXBTZXR0aW5ncyA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfUE9QVVBfU0VUVElOR1MkMSwgc2V0dGluZ3MpO1xuICAgICAgICAvLyBgZGV0ZWN0Q2hhbmdlc2AgbmVlZGVkLCBvdGhlcndpc2UgdXBvbiB2YWx1ZSBpbml0aWFsaXphdGlvbiBhbmQgYGFwcGVuZFRvYCBwcm9wZXJ0eVxuICAgICAgICAvLyBhbiBlcnJvciBpcyB0aHJvd24gPT4gRXhwcmVzc2lvbkNoYW5nZWRBZnRlckl0SGFzQmVlbkNoZWNrZWRFcnJvclxuICAgICAgICB0aGlzLmNkci5kZXRlY3RDaGFuZ2VzKCk7XG4gICAgfVxuICAgIGdldCBwb3B1cFNldHRpbmdzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fcG9wdXBTZXR0aW5ncztcbiAgICB9XG4gICAgLyoqXG4gICAgICogRGVmaW5lcyB0aGUgY2hlY2thYmxlIHNldHRpbmdzIG9mIHRoZSBNdWx0aVNlbGVjVHJlZSBub2Rlcy5cbiAgICAgKiBJZiBubyB2YWx1ZSBpcyBwcm92aWRlZCwgdGhlIGRlZmF1bHQgW2BDaGVja2FibGVTZXR0aW5nc2BdKHslIHNsdWcgYXBpX2Ryb3Bkb3duc19tdWx0aXNlbGVjdHRyZWVjaGVja2FibGVzZXR0aW5ncyAlfSkgYXJlIGFwcGxpZWQuXG4gICAgICovXG4gICAgc2V0IGNoZWNrYWJsZVNldHRpbmdzKHNldHRpbmdzKSB7XG4gICAgICAgIHRoaXMuX2NoZWNrYWJsZVNldHRpbmdzID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9DSEVDS0FCTEVfU0VUVElOR1MsIHNldHRpbmdzKTtcbiAgICB9XG4gICAgZ2V0IGNoZWNrYWJsZVNldHRpbmdzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fY2hlY2thYmxlU2V0dGluZ3M7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNldHMgdGhlIGRhdGEgb2YgdGhlIE11bHRpU2VsZWN0VHJlZS5cbiAgICAgKlxuICAgICAqID4gVGhlIGRhdGEgaGFzIHRvIGJlIHByb3ZpZGVkIGluIGFuIGFycmF5LWxpa2UgbGlzdCB3aXRoIG9iamVjdHMuXG4gICAgICovXG4gICAgc2V0IGRhdGEoZGF0YSkge1xuICAgICAgICB0aGlzLl9ub2RlcyA9IGRhdGE7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoKTtcbiAgICB9XG4gICAgZ2V0IGRhdGEoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9ub2RlcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2V0cyB0aGUgdmFsdWUgb2YgdGhlIE11bHRpU2VsZWN0VHJlZS5cbiAgICAgKiBJdCBjYW4gZWl0aGVyIGJlIG9mIHRoZSBwcmltaXRpdmUgKHN0cmluZywgbnVtYmVycykgb3Igb2YgdGhlIGNvbXBsZXggKG9iamVjdHMpIHR5cGUuXG4gICAgICogVG8gZGVmaW5lIHRoZSB0eXBlLCB1c2UgdGhlIGB2YWx1ZVByaW1pdGl2ZWAgb3B0aW9uLlxuICAgICAqXG4gICAgICovXG4gICAgc2V0IHZhbHVlKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuX3ZhbHVlID0gdmFsdWUgPyB2YWx1ZSA6IFtdO1xuICAgICAgICB0aGlzLnNldFN0YXRlKCk7XG4gICAgfVxuICAgIGdldCB2YWx1ZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3ZhbHVlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBLZWVwcyB0aGUgY3VycmVudCBgZGF0YUl0ZW1zYCBvYmplY3QgaW4gb3JkZXIgdG8gcmVzb2x2ZSBzZWxlY3Rpb24uXG4gICAgICogTmVlZHMgdG8gYmUgcHJvdmlkZWQgd2hlbiB3aGVuIHByb2dyYW1tYXRpY2FsbHkgc2V0dGluZyBhIGB2YWx1ZWAgYW5kIGB2YWx1ZVByaW1pdGl2ZWAgaXMgc2V0IHRvIGB0cnVlYC5cbiAgICAgKi9cbiAgICBzZXQgZGF0YUl0ZW1zKGl0ZW1zKSB7XG4gICAgICAgIHRoaXMuX2RhdGFJdGVtcyA9IChpdGVtcyB8fCBbXSkubWFwKChpdGVtLCBpbmRleCkgPT4ge1xuICAgICAgICAgICAgaWYgKGhhc1Byb3BzKGl0ZW0sIFsnZGF0YUl0ZW0nLCAnaW5kZXgnLCAnbGV2ZWwnXSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gaXRlbTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgZGF0YUl0ZW06IGl0ZW0sXG4gICAgICAgICAgICAgICAgaW5kZXg6IG51bGwsXG4gICAgICAgICAgICAgICAgbGV2ZWw6IHRoaXMudmFsdWVEZXB0aFtpbmRleF0gfHwgMFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoKTtcbiAgICB9XG4gICAgZ2V0IGRhdGFJdGVtcygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2RhdGFJdGVtcyB8fCB0aGlzLnZhbHVlLm1hcCgodmFsdWUsIGluZGV4KSA9PiAoe1xuICAgICAgICAgICAgZGF0YUl0ZW06IHZhbHVlLFxuICAgICAgICAgICAgaW5kZXg6IG51bGwsXG4gICAgICAgICAgICBsZXZlbDogdGhpcy52YWx1ZURlcHRoW2luZGV4XSB8fCAwXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIGdldCBmb2N1c2VkVGFnSWQoKSB7XG4gICAgICAgIGlmICghaXNQcmVzZW50KHRoaXMuZm9jdXNlZFRhZ0luZGV4KSB8fCB0aGlzLmlzT3Blbikge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgZGF0YUl0ZW0gPSB0aGlzLnRhZ3NbdGhpcy5mb2N1c2VkVGFnSW5kZXhdO1xuICAgICAgICByZXR1cm4gYCR7dGhpcy50YWdQcmVmaXh9LSR7dmFsdWVGcm9tKHsgZGF0YUl0ZW0gfSwgdGhpcy52YWx1ZUZpZWxkKX1gO1xuICAgIH1cbiAgICBzZXQgaXNGb2N1c2VkKGlzRm9jdXNlZCkge1xuICAgICAgICB0aGlzLnJlbmRlcmVyW2lzRm9jdXNlZCA/ICdhZGRDbGFzcycgOiAncmVtb3ZlQ2xhc3MnXSh0aGlzLndyYXBwZXIubmF0aXZlRWxlbWVudCwgJ2stZm9jdXMnKTtcbiAgICAgICAgdGhpcy5faXNGb2N1c2VkID0gaXNGb2N1c2VkO1xuICAgIH1cbiAgICBnZXQgaXNGb2N1c2VkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5faXNGb2N1c2VkO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRoZSBjdXJyZW50IG9wZW4gc3RhdGUgb2YgdGhlIHBvcHVwLlxuICAgICAqL1xuICAgIGdldCBpc09wZW4oKSB7XG4gICAgICAgIHJldHVybiBpc1ByZXNlbnQodGhpcy5wb3B1cFJlZik7XG4gICAgfVxuICAgIGdldCB3aWR0aCgpIHtcbiAgICAgICAgY29uc3Qgd3JhcHBlcldpZHRoID0gdGhpcy53cmFwcGVyLm5hdGl2ZUVsZW1lbnQub2Zmc2V0V2lkdGg7XG4gICAgICAgIGNvbnN0IHdpZHRoID0gdGhpcy5wb3B1cFNldHRpbmdzLndpZHRoIHx8IHdyYXBwZXJXaWR0aDtcbiAgICAgICAgY29uc3QgbWluV2lkdGggPSBpc05hTih3cmFwcGVyV2lkdGgpID8gd3JhcHBlcldpZHRoIDogYCR7d3JhcHBlcldpZHRofXB4YDtcbiAgICAgICAgY29uc3QgbWF4V2lkdGggPSBpc05hTih3aWR0aCkgPyB3aWR0aCA6IGAke3dpZHRofXB4YDtcbiAgICAgICAgcmV0dXJuIHsgbWluOiBtaW5XaWR0aCwgbWF4OiBtYXhXaWR0aCB9O1xuICAgIH1cbiAgICBnZXQgaGVpZ2h0KCkge1xuICAgICAgICBjb25zdCBwb3B1cEhlaWdodCA9IHRoaXMucG9wdXBTZXR0aW5ncy5oZWlnaHQ7XG4gICAgICAgIHJldHVybiBpc1ByZXNlbnQocG9wdXBIZWlnaHQpID8gYCR7cG9wdXBIZWlnaHR9cHhgIDogJ2F1dG8nO1xuICAgIH1cbiAgICBnZXQgYXBwZW5kVG8oKSB7XG4gICAgICAgIGNvbnN0IHsgYXBwZW5kVG8gfSA9IHRoaXMucG9wdXBTZXR0aW5ncztcbiAgICAgICAgaWYgKCFhcHBlbmRUbyB8fCBhcHBlbmRUbyA9PT0gJ3Jvb3QnKSB7XG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhcHBlbmRUbyA9PT0gJ2NvbXBvbmVudCcgPyB0aGlzLmNvbnRhaW5lciA6IGFwcGVuZFRvO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgZ2V0IHBvcHVwQ29udGFpbmVyQ2xhc3NlcygpIHtcbiAgICAgICAgY29uc3QgY29udGFpbmVyQ2xhc3NlcyA9IFsnay1wb3B1cC1kcm9wZG93bnRyZWUnXTtcbiAgICAgICAgaWYgKHRoaXMucG9wdXBTZXR0aW5ncy5wb3B1cENsYXNzKSB7XG4gICAgICAgICAgICBjb250YWluZXJDbGFzc2VzLnB1c2godGhpcy5wb3B1cFNldHRpbmdzLnBvcHVwQ2xhc3MpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBjb250YWluZXJDbGFzc2VzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICpcbiAgICAgKiBBbGlhcyBmb3IgYGRhdGFgLiBVc2VkIGZvciBjb21wYXRpYmlsaXR5IHdpdGggdGhlIGBEYXRhQm91bmRDb21wb25lbnRgIGludGVyZmFjZS5cbiAgICAgKiBSZXF1aXJlZCBmb3IgdGhlIGRhdGEtYmluZGluZyBkaXJlY3RpdmVzLlxuICAgICAqL1xuICAgIHNldCBub2Rlcyhub2Rlcykge1xuICAgICAgICB0aGlzLmRhdGEgPSBub2RlcztcbiAgICB9XG4gICAgZ2V0IG5vZGVzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kYXRhO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICpcbiAgICAgKiBBbGlhcyBmb3IgYGZldGNoQ2hpbGRyZW5gLiBVc2VkIGZvciBjb21wYXRpYmlsaXR5IHdpdGggdGhlIGBEYXRhQm91bmRDb21wb25lbnRgIGludGVyZmFjZS5cbiAgICAgKiBSZXF1aXJlZCBmb3IgdGhlIGRhdGEtYmluZGluZyBkaXJlY3RpdmVzXG4gICAgICovXG4gICAgc2V0IGNoaWxkcmVuKGNhbGxiYWNrKSB7XG4gICAgICAgIHRoaXMuZmV0Y2hDaGlsZHJlbiA9IGNhbGxiYWNrO1xuICAgIH1cbiAgICBnZXQgY2hpbGRyZW4oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmZldGNoQ2hpbGRyZW47XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKlxuICAgICAqIEFsaWFzIGZvciBgbm9kZUV4cGFuZGAuIFVzZWQgZm9yIGNvbXBhdGliaWxpdHkgd2l0aCB0aGUgYEV4cGFuZGFibGVDb21wb25lbnRgIGludGVyZmFjZS5cbiAgICAgKiBSZXF1aXJlZCBmb3IgdGhlIGV4cGFuZC1kaXJlY3RpdmUuXG4gICAgICovXG4gICAgZ2V0IGV4cGFuZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubm9kZUV4cGFuZDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqXG4gICAgICogQWxpYXMgZm9yIGBub2RlQ29sbGFwc2VgLiBVc2VkIGZvciBjb21wYXRpYmlsaXR5IHdpdGggdGhlIGBFeHBhbmRhYmxlQ29tcG9uZW50YCBpbnRlcmZhY2UuXG4gICAgICogUmVxdWlyZWQgZm9yIHRoZSBleHBhbmQtZGlyZWN0aXZlLlxuICAgICAqL1xuICAgIGdldCBjb2xsYXBzZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubm9kZUNvbGxhcHNlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICpcbiAgICAgKiBBbGlhcyBmb3IgYGlzTm9kZUV4cGFuZGVkYC4gVXNlZCBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIHRoZSBgRXhwYW5kYWJsZUNvbXBvbmVudGAgaW50ZXJmYWNlLlxuICAgICAqIFJlcXVpcmVkIGZvciB0aGUgZXhwYW5kLWRpcmVjdGl2ZS5cbiAgICAgKi9cbiAgICBzZXQgaXNFeHBhbmRlZChjYWxsYmFjaykge1xuICAgICAgICB0aGlzLmlzTm9kZUV4cGFuZGVkID0gY2FsbGJhY2s7XG4gICAgfVxuICAgIGdldCBpc0V4cGFuZGVkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5pc05vZGVFeHBhbmRlZDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqXG4gICAgICogQWxpYXMgZm9yIGBpc05vZGVWaXNpYmxlYC4gVXNlZCBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIHRoZSBgRGF0YUJvdW5kQ29tcG9uZW50YCBpbnRlcmZhY2UuXG4gICAgICogVGhlIGBEYXRhQm91bmRDb21wb25lbnRgIGludGVyZmFjZSBpcyB1c2VkIGluIHRoZSBkYXRhLWJpbmRpbmcgZGlyZWN0aXZlcy5cbiAgICAgKi9cbiAgICBzZXQgaXNWaXNpYmxlKGNhbGxiYWNrKSB7XG4gICAgICAgIHRoaXMuaXNOb2RlVmlzaWJsZSA9IGNhbGxiYWNrO1xuICAgIH1cbiAgICBnZXQgaXNWaXNpYmxlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5pc05vZGVWaXNpYmxlO1xuICAgIH1cbiAgICBnZXQgaXNUYWdGb2N1c2VkKCkge1xuICAgICAgICByZXR1cm4gIXRoaXMuaXNPcGVuICYmIHRoaXMuZm9jdXNlZFRhZ0luZGV4ICE9PSB1bmRlZmluZWQ7XG4gICAgfVxuICAgIGdldCBpc1RyZWVWaWV3QWN0aXZlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy50cmVldmlldyAmJiB0aGlzLnRyZWV2aWV3LmlzQWN0aXZlO1xuICAgIH1cbiAgICBnZXQgaXNXcmFwcGVyQWN0aXZlKCkge1xuICAgICAgICByZXR1cm4gZG9jdW1lbnQuYWN0aXZlRWxlbWVudCA9PT0gdGhpcy53cmFwcGVyLm5hdGl2ZUVsZW1lbnQ7XG4gICAgfVxuICAgIGdldCBpc0ZpbHRlckFjdGl2ZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZmlsdGVySW5wdXQgJiYgZG9jdW1lbnQuYWN0aXZlRWxlbWVudCA9PT0gdGhpcy5maWx0ZXJJbnB1dC5uYXRpdmVFbGVtZW50O1xuICAgIH1cbiAgICBnZXQgaXNDaGVja0FsbEFjdGl2ZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY2hlY2tBbGxJbnB1dCAmJiBkb2N1bWVudC5hY3RpdmVFbGVtZW50ID09PSB0aGlzLmNoZWNrQWxsSW5wdXQubmF0aXZlRWxlbWVudDtcbiAgICB9XG4gICAgbmdPbkluaXQoKSB7XG4gICAgICAgIHRoaXMucmVuZGVyZXIucmVtb3ZlQXR0cmlidXRlKHRoaXMud3JhcHBlci5uYXRpdmVFbGVtZW50LCAndGFiaW5kZXgnKTtcbiAgICAgICAgdGhpcy5yZW5kZXJlci5zZXRBdHRyaWJ1dGUodGhpcy53cmFwcGVyLm5hdGl2ZUVsZW1lbnQsICdhcmlhLWV4cGFuZGVkJywgU3RyaW5nKHRoaXMuaXNPcGVuKSk7XG4gICAgICAgIHRoaXMuc3Vic2NyaXB0aW9ucy5wdXNoKHRoaXMubG9jYWxpemF0aW9uXG4gICAgICAgICAgICAuY2hhbmdlcy5zdWJzY3JpYmUoKHsgcnRsIH0pID0+IHtcbiAgICAgICAgICAgIHRoaXMuZGlyZWN0aW9uID0gcnRsID8gJ3J0bCcgOiAnbHRyJztcbiAgICAgICAgICAgIHRoaXMuY2RyLm1hcmtGb3JDaGVjaygpO1xuICAgICAgICB9KSk7XG4gICAgICAgIHRoaXMuc2V0Q29tcG9uZW50Q2xhc3NlcygpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgbmdPbkRlc3Ryb3koKSB7XG4gICAgICAgIHRoaXMuZGVzdHJveVBvcHVwKCk7XG4gICAgICAgIHRoaXMudW5zdWJzY3JpYmVFdmVudHMoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIG5nT25DaGFuZ2VzKGNoYW5nZXMpIHtcbiAgICAgICAgaWYgKGFueUNoYW5nZWQoWyd0ZXh0RmllbGQnLCAndmFsdWVGaWVsZCcsICd2YWx1ZVByaW1pdGl2ZSddLCBjaGFuZ2VzLCBmYWxzZSkpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoYW55Q2hhbmdlZChbJ3ZhbHVlRGVwdGgnLCAndmFsdWUnLCAnZGF0YUl0ZW1zJ10sIGNoYW5nZXMsIGZhbHNlKSkge1xuICAgICAgICAgICAgaWYgKGNoYW5nZXMudmFsdWUgJiYgIWNoYW5nZXMuZGF0YUl0ZW1zICYmICF0aGlzLnZhbHVlUHJpbWl0aXZlKSB7XG4gICAgICAgICAgICAgICAgLy8gVXBkYXRlIHRoZSBkYXRhSXRlbXMgaWYgdGhlIHZhbHVlIGlzIHVwZGF0ZWQgcHJvZ3JhbW1hdGljYWxseSAobm9uLXByaW1pdGl2ZSB2YWx1ZXMgb25seSlcbiAgICAgICAgICAgICAgICAvLyBJbiB0aGUgcHJpbWl0aXZlIGNhc2UsIHRoZSBjbGllbnQgc2hvdWxkIHVwZGF0ZSB0aGUgZGF0YUl0ZW1zIGFzIHdlbGxcbiAgICAgICAgICAgICAgICB0aGlzLmRhdGFJdGVtcyA9IHRoaXMudmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBSZS1tYXAgdGhlIGRhdGFJdGVtcyBiZWNhdXNlIGB2YWx1ZURlcHRoYCBpcyBub3QgeWV0IGF2YWlsYWJsZSB3aGVuIHRoZSBjaGVjayBkaXJlY3RpdmUgcGFyc2VzIHRoZSBpdGVtc1xuICAgICAgICAgICAgICAgIHRoaXMuZGF0YUl0ZW1zID0gdGhpcy5kYXRhSXRlbXMubWFwKChpdGVtLCBpbmRleCkgPT4gKE9iamVjdC5hc3NpZ24oe30sIGl0ZW0sIHsgbGV2ZWw6IHRoaXMudmFsdWVEZXB0aFtpbmRleF0gfHwgMCB9KSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBuZ0FmdGVyQ29udGVudENoZWNrZWQoKSB7XG4gICAgICAgIHRoaXMudmVyaWZ5U2V0dGluZ3MoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqXG4gICAgICogVXNlZCBieSB0aGUga2VuZG8tZmxvYXRpbmdsYWJlbCBjb21wb25lbnQgdG8gZGV0ZXJtaW5lIGlmIHRoZSBmbG9hdGluZyBsYWJlbFxuICAgICAqIHNob3VsZCBiZSByZW5kZXJlZCBpbnNpZGUgdGhlIGlucHV0IHdoZW4gdGhlIGNvbXBvbmVudCBpcyBub3QgZm9jdXNlZC5cbiAgICAgKi9cbiAgICBpc0VtcHR5KCkge1xuICAgICAgICByZXR1cm4gIUJvb2xlYW4odGhpcy5wbGFjZWhvbGRlcikgJiYgKCFpc1ByZXNlbnQodGhpcy52YWx1ZSkgfHwgdGhpcy52YWx1ZS5sZW5ndGggPT09IDApO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBGb2N1c2VzIHRoZSBNdWx0aVNlbGVjdFRyZWUuXG4gICAgICovXG4gICAgZm9jdXMoKSB7XG4gICAgICAgIGlmICghdGhpcy5kaXNhYmxlZCkge1xuICAgICAgICAgICAgdGhpcy53cmFwcGVyLm5hdGl2ZUVsZW1lbnQuZm9jdXMoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBCbHVycyB0aGUgTXVsdGlTZWxlY3RUcmVlLlxuICAgICAqL1xuICAgIGJsdXIoKSB7XG4gICAgICAgIGlmICghdGhpcy5kaXNhYmxlZCkge1xuICAgICAgICAgICAgdGhpcy53cmFwcGVyLm5hdGl2ZUVsZW1lbnQuYmx1cigpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEZvY3VzZXMgYSBzcGVjaWZpYyBpdGVtIG9mIHRoZSBNdWx0aVNlbGVjdFRyZWUgYmFzZWQgb24gYSBwcm92aWRlZCBpbmRleCBpbiB0aGUgZm9ybWF0IG9mIGAxXzFgLlxuICAgICAqIFRoZSB0YXJnZXRlZCBpdGVtIHNob3VsZCBiZSBleHBhbmRlZCBpbiBvcmRlciBmb3IgaXQgdG8gYmUgZm9jdXNlZC5cbiAgICAgKiBJZiBudWxsIG9yIGludmFsaWQgaW5kZXggaXMgcHJvdmlkZWQgdGhlIGZvY3VzIHdpbGwgYmUgc2V0IG9uIHRoZSBmaXJzdCBpdGVtLlxuICAgICAqL1xuICAgIGZvY3VzSXRlbUF0KGluZGV4KSB7XG4gICAgICAgIGlmICh0aGlzLnRyZWV2aWV3KSB7XG4gICAgICAgICAgICBjb25zdCBsb29rdXAgPSB0aGlzLnRyZWV2aWV3Lml0ZW1Mb29rdXAoaW5kZXgpO1xuICAgICAgICAgICAgY29uc3QgaXNJdGVtRGlzYWJsZWQgPSAhaXNQcmVzZW50KGxvb2t1cCkgfHwgdGhpcy50cmVldmlldy5pc0Rpc2FibGVkKGxvb2t1cC5pdGVtLmRhdGFJdGVtLCBsb29rdXAuaXRlbS5pbmRleCk7XG4gICAgICAgICAgICBpZiAoIWlzSXRlbURpc2FibGVkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy50cmVldmlldy5mb2N1cyhpbmRleCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVzZXRzIHRoZSB2YWx1ZSBvZiB0aGUgTXVsdGlTZWxlY3RUcmVlLlxuICAgICAqIElmIHlvdSB1c2UgdGhlIGByZXNldGAgbWV0aG9kIHRvIGNsZWFyIHRoZSB2YWx1ZSBvZiB0aGUgY29tcG9uZW50LFxuICAgICAqIHRoZSBtb2RlbCB3aWxsIG5vdCB1cGRhdGUgYXV0b21hdGljYWxseSBhbmQgdGhlIGB2YWx1ZUNoYW5nZWAgZXZlbnQgd2lsbCBub3QgYmUgZmlyZWQuXG4gICAgICovXG4gICAgcmVzZXQoKSB7XG4gICAgICAgIHRoaXMudmFsdWUgPSBbXTtcbiAgICAgICAgdGhpcy5kYXRhSXRlbXMgPSBbXTtcbiAgICAgICAgdGhpcy52YWx1ZURlcHRoID0gW107XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRvZ2dsZXMgdGhlIHZpc2liaWxpdHkgb2YgdGhlIHBvcHVwXG4gICAgICogKFtzZWUgZXhhbXBsZV0oeyUgc2x1ZyBvcGVuc3RhdGVfbXVsdGlzZWxlY3R0cmVlICV9KSkuXG4gICAgICogSWYgeW91IHVzZSB0aGUgYHRvZ2dsZWAgbWV0aG9kIHRvIG9wZW4gb3IgY2xvc2UgdGhlIHBvcHVwLCB0aGUgYG9wZW5gIGFuZCBgY2xvc2VgIGV2ZW50cyB3aWxsIG5vdCBiZSBmaXJlZC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBvcGVuIC0gVGhlIHN0YXRlIG9mIHRoZSBwb3B1cC5cbiAgICAgKi9cbiAgICB0b2dnbGUob3Blbikge1xuICAgICAgICAvLyBUaGUgUHJvbWlzZSBpcyByZXF1aXJlZCB0byBvcGVuIHRoZSBwb3B1cCBvbiBsb2FkLlxuICAgICAgICAvLyBPdGhlcndpc2UsIHRoZSBcIlZpZXdDb250YWluZXJSZWYgbm90IGZvdW5kLi4uXCIgZXJyb3Igd2lsbCBiZSB0aHJvd24uXG4gICAgICAgIFByb21pc2UucmVzb2x2ZShudWxsKS50aGVuKCgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHNob3VsZE9wZW4gPSBpc1ByZXNlbnQob3BlbikgPyBvcGVuIDogIWlzUHJlc2VudCh0aGlzLnBvcHVwUmVmKTtcbiAgICAgICAgICAgIHRoaXMuZGVzdHJveVBvcHVwKCk7XG4gICAgICAgICAgICBpZiAoc2hvdWxkT3Blbikge1xuICAgICAgICAgICAgICAgIHRoaXMuY3JlYXRlUG9wdXAoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBoYW5kbGVGb2N1cyhldmVudCkge1xuICAgICAgICBpZiAoZXZlbnQudGFyZ2V0ICE9PSB0aGlzLndyYXBwZXIubmF0aXZlRWxlbWVudCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGV2ZW50LnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO1xuICAgICAgICBpZiAoIXRoaXMuaXNGb2N1c2VkKSB7XG4gICAgICAgICAgICB0aGlzLmlzRm9jdXNlZCA9IHRydWU7XG4gICAgICAgICAgICBpZiAoaGFzT2JzZXJ2ZXJzKHRoaXMub25Gb2N1cykpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl96b25lLnJ1bigoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMub25Gb2N1cy5lbWl0KCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBSZS1mb2N1cyB0aGUgdHJlZXZpZXcgaWYgYGNsb3NlYCBpcyBwcmV2ZW50ZWRcbiAgICAgICAgICAgIGlmICh0aGlzLmlzT3BlbiAmJiB0aGlzLnRyZWV2aWV3KSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMubGFzdE5vZGVPbkZvY3VzKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubGFzdE5vZGVPbkZvY3VzLnNldEF0dHJpYnV0ZSgndGFiaW5kZXgnLCAnMCcpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLnRyZWV2aWV3LmZvY3VzKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIGhhbmRsZUJsdXIoZSkge1xuICAgICAgICBjb25zdCByZWxhdGVkVGFyZ2V0ID0gZSAmJiBlLnJlbGF0ZWRUYXJnZXQ7XG4gICAgICAgIGlmICh0aGlzLndyYXBwZXIubmF0aXZlRWxlbWVudC5jb250YWlucyhyZWxhdGVkVGFyZ2V0KSB8fFxuICAgICAgICAgICAgKHRoaXMuaXNPcGVuICYmIHRoaXMucG9wdXBSZWYucG9wdXBFbGVtZW50LmNvbnRhaW5zKHJlbGF0ZWRUYXJnZXQpKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuaXNGb2N1c2VkID0gZmFsc2U7XG4gICAgICAgIHRoaXMudG9nZ2xlUG9wdXAoZmFsc2UpO1xuICAgICAgICBpZiAoaGFzT2JzZXJ2ZXJzKHRoaXMub25CbHVyKSB8fFxuICAgICAgICAgICAgaXNVbnRvdWNoZWQodGhpcy53cmFwcGVyLm5hdGl2ZUVsZW1lbnQpKSB7XG4gICAgICAgICAgICB0aGlzLl96b25lLnJ1bigoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5vbkJsdXIuZW1pdCgpO1xuICAgICAgICAgICAgICAgIHRoaXMub25Ub3VjaGVkQ2FsbGJhY2soKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBoYW5kbGVOb2RlQ2xpY2sobm9kZSkge1xuICAgICAgICBpZiAoIXRoaXMuaXNGb2N1c2VkKSB7XG4gICAgICAgICAgICAvLyBSZS1mb2N1cyB0aGUgTXVsdGlTZWxlY3RUcmVlIHdoZW4gcG9wdXAgY2xvc2UgaXMgcHJldmVudGVkIGFuZCBhIG5vZGUgaXMgY2xpY2tlZFxuICAgICAgICAgICAgLy8gT24gY2xpY2sgdGhlIGZvY3VzIHNob3VsZCBiZSBvbiB0aGUgY2xpY2tlZCBlbGVtZW50IHdoaWNoIGlzIHdoeSB3ZSBuZWVkIHRvIHVwZGF0ZSB0aGUgbGFzdE5vZGVPbkZvY3VzXG4gICAgICAgICAgICBjb25zdCBwYXJlbnQgPSBub2RlLm9yaWdpbmFsRXZlbnQudGFyZ2V0LnBhcmVudEVsZW1lbnQucGFyZW50RWxlbWVudDtcbiAgICAgICAgICAgIHRoaXMubGFzdE5vZGVPbkZvY3VzID0gcGFyZW50O1xuICAgICAgICAgICAgdGhpcy5mb2N1cygpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICB0b2dnbGVQb3B1cChvcGVuKSB7XG4gICAgICAgIGNvbnN0IGlzRGlzYWJsZWQgPSB0aGlzLmRpc2FibGVkIHx8IHRoaXMucmVhZG9ubHk7XG4gICAgICAgIGNvbnN0IHNhbWVTdGF0ZSA9IHRoaXMuaXNPcGVuID09PSBvcGVuO1xuICAgICAgICB0aGlzLl96b25lLnJ1bigoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmZvY3VzZWRUYWdJbmRleCA9IHVuZGVmaW5lZDtcbiAgICAgICAgfSk7XG4gICAgICAgIGlmIChpc0Rpc2FibGVkIHx8IHNhbWVTdGF0ZSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHRvZ2dsZVByZXZlbnRlZCA9IHRoaXMudHJpZ2dlclBvcHVwRXZlbnRzKG9wZW4pO1xuICAgICAgICBpZiAoIXRvZ2dsZVByZXZlbnRlZCkge1xuICAgICAgICAgICAgb3BlbiA/XG4gICAgICAgICAgICAgICAgdGhpcy5jcmVhdGVQb3B1cCgpIDpcbiAgICAgICAgICAgICAgICB0aGlzLmRlc3Ryb3lQb3B1cCgpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5yZW1vdmVUcmVlVmlld0Zyb21UYWJPcmRlcigpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBtZXNzYWdlRm9yKGtleSkge1xuICAgICAgICByZXR1cm4gdGhpcy5sb2NhbGl6YXRpb24uZ2V0KGtleSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBoYW5kbGVDaGVja2VkSXRlbXNDaGFuZ2UoaXRlbXMpIHtcbiAgICAgICAgdGhpcy52YWx1ZURlcHRoID0gaXRlbXMubWFwKGl0ZW0gPT4gaXRlbS5sZXZlbCk7XG4gICAgICAgIHRoaXMubGFzdEFjdGlvbiA9IGl0ZW1zLmxlbmd0aCA+IHRoaXMuZGF0YUl0ZW1zLmxlbmd0aCA/ICdjaGVjaycgOiAndW5jaGVjayc7XG4gICAgICAgIHRoaXMuZGF0YUl0ZW1zID0gaXRlbXMuc2xpY2UoKTtcbiAgICAgICAgdGhpcy51cGRhdGVWYWx1ZSh0aGlzLmRhdGFJdGVtcyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBoYW5kbGVSZW1vdmVUYWcoeyB0YWcsIGluZGV4IH0pIHtcbiAgICAgICAgaWYgKHRoaXMuZGlzYWJsZWQgfHwgdGhpcy5yZWFkb25seSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGV2ZW50QXJncyA9IG5ldyBSZW1vdmVUYWdFdmVudCh0YWcpO1xuICAgICAgICB0aGlzLnJlbW92ZVRhZy5lbWl0KGV2ZW50QXJncyk7XG4gICAgICAgIGlmIChldmVudEFyZ3MuaXNEZWZhdWx0UHJldmVudGVkKCkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICAvLyBSZW1vdmUgdGFncyBiYXNlZCBvbiB0aGVpciBwb3NpdGlvbiBpbmRleFxuICAgICAgICBpZiAodGFnIGluc3RhbmNlb2YgQXJyYXkpIHtcbiAgICAgICAgICAgIC8vIFJlbW92ZSBncm91cCB0YWdcbiAgICAgICAgICAgIHRoaXMuZGF0YUl0ZW1zID0gdGhpcy5kYXRhSXRlbXMuZmlsdGVyKChfaXRlbSwgaSkgPT4gaSA8IHRoaXMuc2hvd0FmdGVyIHx8IHRoaXMuZGlzYWJsZWRJbmRpY2VzLmhhcyhpKSk7XG4gICAgICAgICAgICB0aGlzLnZhbHVlRGVwdGggPSB0aGlzLnZhbHVlRGVwdGguZmlsdGVyKChfaXRlbSwgaSkgPT4gaSA8IHRoaXMuc2hvd0FmdGVyIHx8IHRoaXMuZGlzYWJsZWRJbmRpY2VzLmhhcyhpKSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvLyBSZW1vdmUgc2luZ2xlIHRhZ1xuICAgICAgICAgICAgdGhpcy5kYXRhSXRlbXMgPSB0aGlzLmRhdGFJdGVtcy5maWx0ZXIoKF9pdGVtLCBpKSA9PiBpICE9PSBpbmRleCB8fCB0aGlzLmRpc2FibGVkSW5kaWNlcy5oYXMoaSkpO1xuICAgICAgICAgICAgdGhpcy52YWx1ZURlcHRoID0gdGhpcy52YWx1ZURlcHRoLmZpbHRlcigoX2l0ZW0sIGkpID0+IGkgIT09IGluZGV4IHx8IHRoaXMuZGlzYWJsZWRJbmRpY2VzLmhhcyhpKSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy51cGRhdGVWYWx1ZSh0aGlzLmRhdGFJdGVtcyk7XG4gICAgICAgIC8vIGZvY3VzIHRoZSB3cmFwcGVyIGlmIHRoZSBjb21wb25lbnQgaXMgbm90IGZvY3VzZWQgLSB0aGUgZmxvYXRpbmcgbGFiZWwgcmVhY3RzIHRvIGZvY3VzL2JsdXJcbiAgICAgICAgaWYgKCF0aGlzLmlzRm9jdXNlZCkge1xuICAgICAgICAgICAgdGhpcy5mb2N1cygpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBoYW5kbGVUYWdNYXBwZXJDaGFuZ2Uoc2hvd0FmdGVyKSB7XG4gICAgICAgIHRoaXMuc2hvd0FmdGVyID0gcGFyc2VOdW1iZXIoc2hvd0FmdGVyKTtcbiAgICAgICAgdGhpcy5zZXRUYWdzKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBjbGVhckFsbChldmVudCkge1xuICAgICAgICBldmVudC5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKTtcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgdGhpcy5mb2N1cygpO1xuICAgICAgICB0aGlzLnZhbHVlID0gdGhpcy52YWx1ZS5maWx0ZXIoKF9pdGVtLCBpbmRleCkgPT4gdGhpcy5kaXNhYmxlZEluZGljZXMuaGFzKGluZGV4KSk7XG4gICAgICAgIHRoaXMuZGF0YUl0ZW1zID0gdGhpcy5kYXRhSXRlbXMuZmlsdGVyKChfaXRlbSwgaW5kZXgpID0+IHRoaXMuZGlzYWJsZWRJbmRpY2VzLmhhcyhpbmRleCkpO1xuICAgICAgICB0aGlzLnZhbHVlRGVwdGggPSB0aGlzLnZhbHVlRGVwdGguZmlsdGVyKChfZGVwdGgsIGluZGV4KSA9PiB0aGlzLmRpc2FibGVkSW5kaWNlcy5oYXMoaW5kZXgpKTtcbiAgICAgICAgdGhpcy5lbWl0VmFsdWVDaGFuZ2UodGhpcy52YWx1ZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICB3cml0ZVZhbHVlKHZhbHVlKSB7XG4gICAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZSB8fCBbXTtcbiAgICAgICAgLy8gVXBkYXRlIHRoZSBkYXRhSXRlbXMgaWYgdGhlIHZhbHVlIGlzIHVwZGF0ZWQgcHJvZ3JhbW1hdGljYWxseSAobm9uLXByaW1pdGl2ZSB2YWx1ZXMgb25seSlcbiAgICAgICAgLy8gSW4gdGhlIHByaW1pdGl2ZSBjYXNlLCB0aGUgY2xpZW50IHNob3VsZCB1cGRhdGUgdGhlIGRhdGFJdGVtcyBhcyB3ZWxsXG4gICAgICAgIGlmICghdGhpcy52YWx1ZVByaW1pdGl2ZSkge1xuICAgICAgICAgICAgdGhpcy5kYXRhSXRlbXMgPSB0aGlzLnZhbHVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICByZWdpc3Rlck9uQ2hhbmdlKGZuKSB7XG4gICAgICAgIHRoaXMub25DaGFuZ2VDYWxsYmFjayA9IGZuO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgcmVnaXN0ZXJPblRvdWNoZWQoZm4pIHtcbiAgICAgICAgdGhpcy5vblRvdWNoZWRDYWxsYmFjayA9IGZuO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgc2V0RGlzYWJsZWRTdGF0ZShpc0Rpc2FibGVkKSB7XG4gICAgICAgIHRoaXMuZGlzYWJsZWQgPSBpc0Rpc2FibGVkO1xuICAgICAgICB0aGlzLmNkci5tYXJrRm9yQ2hlY2soKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIGhhbmRsZUZpbHRlcklucHV0Q2hhbmdlKHRlcm0pIHtcbiAgICAgICAgdGhpcy5maWx0ZXJDaGFuZ2UubmV4dCh0ZXJtKTtcbiAgICAgICAgdGhpcy5hbGxOb2Rlc0hpZGRlbiA9IHRoaXMubm9kZXMuZXZlcnkoKG5vZGUsIGluZGV4KSA9PiAhdGhpcy5pc1Zpc2libGUobm9kZSwgU3RyaW5nKGluZGV4KSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgZ2V0IGZpbHRlcklucHV0Q2xhc3NlcygpIHtcbiAgICAgICAgcmV0dXJuIGAke3RoaXMuc2l6ZSA/IGdldFNpemVDbGFzcygnaW5wdXQnLCB0aGlzLnNpemUpIDogJyd9ICR7dGhpcy5maWxsTW9kZSA/ICdrLWlucHV0LScgKyB0aGlzLmZpbGxNb2RlIDogJyd9ICR7dGhpcy5yb3VuZGVkID8gZ2V0Um91bmRlZENsYXNzKHRoaXMucm91bmRlZCkgOiAnJ31gO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgZ2V0IGNoZWNrQWxsQ2hlY2tib3hDbGFzc2VzKCkge1xuICAgICAgICByZXR1cm4gYCR7dGhpcy5zaXplID8gZ2V0U2l6ZUNsYXNzKCdjaGVja2JveCcsIHRoaXMuc2l6ZSkgOiAnJ31gO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgdG9nZ2xlQ2hlY2tBbGwoKSB7XG4gICAgICAgIHRoaXMuY2hlY2tBbGxJbnB1dC5uYXRpdmVFbGVtZW50LmZvY3VzKCk7XG4gICAgICAgIHRoaXMuY2hlY2tBbGxJbnB1dC5uYXRpdmVFbGVtZW50LmNsaWNrKCk7XG4gICAgfVxuICAgIHZlcmlmeVNldHRpbmdzKCkge1xuICAgICAgICBpZiAoIWlzRGV2TW9kZSgpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFpc1ByZXNlbnQodGhpcy52YWx1ZUZpZWxkKSB8fCAhaXNQcmVzZW50KHRoaXMudGV4dEZpZWxkKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKE11bHRpU2VsZWN0VHJlZU1lc3NhZ2VzLnRleHRBbmRWYWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFpc0FycmF5KHRoaXMudmFsdWUpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoTXVsdGlTZWxlY3RUcmVlTWVzc2FnZXMuYXJyYXkpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnZhbHVlLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnZhbHVlUHJpbWl0aXZlICYmIHRoaXMudmFsdWUuc29tZShpdGVtID0+IGlzT2JqZWN0KGl0ZW0pKSkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihNdWx0aVNlbGVjdFRyZWVNZXNzYWdlcy5wcmltaXRpdmUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgaXNFdmVyeURhdGFJdGVtT2JqZWN0ID0gdGhpcy5kYXRhSXRlbXMuZXZlcnkoaXRlbSA9PiBpc09iamVjdChpdGVtLmRhdGFJdGVtKSk7XG4gICAgICAgICAgICBpZiAodGhpcy52YWx1ZVByaW1pdGl2ZSAmJiAhaXNBcnJheSh0aGlzLmRhdGFJdGVtcykpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoTXVsdGlTZWxlY3RUcmVlTWVzc2FnZXMuZGF0YUl0ZW1zKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLnZhbHVlUHJpbWl0aXZlICYmICFpc0V2ZXJ5RGF0YUl0ZW1PYmplY3QpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoTXVsdGlTZWxlY3RUcmVlTWVzc2FnZXMuZGF0YUl0ZW1zKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLnZhbHVlUHJpbWl0aXZlICYmIHRoaXMuZGF0YUl0ZW1zLmxlbmd0aCAhPT0gdGhpcy52YWx1ZS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoTXVsdGlTZWxlY3RUcmVlTWVzc2FnZXMuZGF0YUl0ZW1zTGVuZ3RoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghdGhpcy52YWx1ZVByaW1pdGl2ZSAmJiAhaXNPYmplY3RBcnJheSh0aGlzLnZhbHVlKSkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihNdWx0aVNlbGVjdFRyZWVNZXNzYWdlcy5vYmplY3QpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKChpc0FycmF5KHRoaXMudmFsdWVGaWVsZCkgfHwgaXNBcnJheSh0aGlzLnRleHRGaWVsZCkpICYmICFpc0FycmF5KHRoaXMudmFsdWVEZXB0aCkpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoTXVsdGlTZWxlY3RUcmVlTWVzc2FnZXMudmFsdWVEZXB0aCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoKGlzQXJyYXkodGhpcy52YWx1ZUZpZWxkKSB8fCBpc0FycmF5KHRoaXMudGV4dEZpZWxkKSkgJiYgdGhpcy52YWx1ZURlcHRoLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihNdWx0aVNlbGVjdFRyZWVNZXNzYWdlcy52YWx1ZURlcHRoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICgoaXNBcnJheSh0aGlzLnZhbHVlRmllbGQpIHx8IGlzQXJyYXkodGhpcy50ZXh0RmllbGQpKSAmJiB0aGlzLnZhbHVlRGVwdGgubGVuZ3RoICE9PSB0aGlzLnZhbHVlLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihNdWx0aVNlbGVjdFRyZWVNZXNzYWdlcy52YWx1ZURlcHRoTGVuZ3RoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBlbWl0VmFsdWVDaGFuZ2UodmFsdWUpIHtcbiAgICAgICAgdGhpcy5vbkNoYW5nZUNhbGxiYWNrKHZhbHVlKTtcbiAgICAgICAgdGhpcy52YWx1ZUNoYW5nZS5lbWl0KHZhbHVlKTtcbiAgICB9XG4gICAgdHJpZ2dlclBvcHVwRXZlbnRzKG9wZW4pIHtcbiAgICAgICAgY29uc3QgZXZlbnRBcmdzID0gbmV3IFByZXZlbnRhYmxlRXZlbnQoKTtcbiAgICAgICAgb3BlbiA/XG4gICAgICAgICAgICB0aGlzLm9wZW4uZW1pdChldmVudEFyZ3MpIDpcbiAgICAgICAgICAgIHRoaXMuY2xvc2UuZW1pdChldmVudEFyZ3MpO1xuICAgICAgICByZXR1cm4gZXZlbnRBcmdzLmlzRGVmYXVsdFByZXZlbnRlZCgpO1xuICAgIH1cbiAgICBjcmVhdGVQb3B1cCgpIHtcbiAgICAgICAgY29uc3QgaG9yaXpvbnRhbEFsaWduID0gdGhpcy5kaXJlY3Rpb24gPT09IFwicnRsXCIgPyBcInJpZ2h0XCIgOiBcImxlZnRcIjtcbiAgICAgICAgY29uc3QgYW5jaG9yUG9zaXRpb24gPSB7IGhvcml6b250YWw6IGhvcml6b250YWxBbGlnbiwgdmVydGljYWw6ICdib3R0b20nIH07XG4gICAgICAgIGNvbnN0IHBvcHVwUG9zaXRpb24gPSB7IGhvcml6b250YWw6IGhvcml6b250YWxBbGlnbiwgdmVydGljYWw6ICd0b3AnIH07XG4gICAgICAgIHRoaXMucG9wdXBSZWYgPSB0aGlzLnBvcHVwU2VydmljZS5vcGVuKHtcbiAgICAgICAgICAgIGFuY2hvcjogdGhpcy53cmFwcGVyLFxuICAgICAgICAgICAgYXBwZW5kVG86IHRoaXMuYXBwZW5kVG8sXG4gICAgICAgICAgICBhbmNob3JBbGlnbjogYW5jaG9yUG9zaXRpb24sXG4gICAgICAgICAgICBjb250ZW50OiB0aGlzLnBvcHVwVGVtcGxhdGUsXG4gICAgICAgICAgICBwb3B1cEFsaWduOiBwb3B1cFBvc2l0aW9uLFxuICAgICAgICAgICAgcG9zaXRpb25Nb2RlOiAnYWJzb2x1dGUnLFxuICAgICAgICAgICAgcG9wdXBDbGFzczogdGhpcy5wb3B1cENvbnRhaW5lckNsYXNzZXNcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IHBvcHVwV3JhcHBlciA9IHRoaXMucG9wdXBSZWYucG9wdXBFbGVtZW50O1xuICAgICAgICBjb25zdCB7IG1pbiwgbWF4IH0gPSB0aGlzLndpZHRoO1xuICAgICAgICBwb3B1cFdyYXBwZXIuc3R5bGUubWluV2lkdGggPSBtaW47XG4gICAgICAgIHBvcHVwV3JhcHBlci5zdHlsZS53aWR0aCA9IG1heDtcbiAgICAgICAgcG9wdXBXcmFwcGVyLnN0eWxlLmhlaWdodCA9IHRoaXMuaGVpZ2h0O1xuICAgICAgICB0aGlzLnJlbmRlcmVyLnNldEF0dHJpYnV0ZShwb3B1cFdyYXBwZXIsICdkaXInLCB0aGlzLmRpcmVjdGlvbik7XG4gICAgICAgIHRoaXMucmVuZGVyZXIuc2V0QXR0cmlidXRlKHRoaXMud3JhcHBlci5uYXRpdmVFbGVtZW50LCAnYXJpYS1leHBhbmRlZCcsICd0cnVlJyk7XG4gICAgICAgIHRoaXMucG9wdXBSZWYucG9wdXBPcGVuLnN1YnNjcmliZSgoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmNkci5kZXRlY3RDaGFuZ2VzKCk7XG4gICAgICAgICAgICB0aGlzLm9wZW5lZC5lbWl0KCk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnBvcHVwUmVmLnBvcHVwQ2xvc2Uuc3Vic2NyaWJlKCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuY2xvc2VkLmVtaXQoKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGRlc3Ryb3lQb3B1cCgpIHtcbiAgICAgICAgaWYgKHRoaXMucG9wdXBSZWYpIHtcbiAgICAgICAgICAgIHRoaXMucG9wdXBSZWYuY2xvc2UoKTtcbiAgICAgICAgICAgIHRoaXMucG9wdXBSZWYgPSBudWxsO1xuICAgICAgICAgICAgdGhpcy5yZW5kZXJlci5zZXRBdHRyaWJ1dGUodGhpcy53cmFwcGVyLm5hdGl2ZUVsZW1lbnQsICdhcmlhLWV4cGFuZGVkJywgJ2ZhbHNlJyk7XG4gICAgICAgICAgICBpZiAodGhpcy5maWx0ZXIgIT09IFwiXCIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmZpbHRlciA9IFwiXCI7XG4gICAgICAgICAgICAgICAgdGhpcy5hbGxOb2Rlc0hpZGRlbiA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGlmIChoYXNPYnNlcnZlcnModGhpcy5maWx0ZXJDaGFuZ2UpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3pvbmUucnVuKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZmlsdGVyQ2hhbmdlLmVtaXQoXCJcIik7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBzdWJzY3JpYmVFdmVudHMoKSB7XG4gICAgICAgIHRoaXMuc3Vic2NyaXB0aW9ucy5wdXNoKHRoaXMubmF2aWdhdGlvblNlcnZpY2Uub3Blbi5zdWJzY3JpYmUoKCkgPT4gdGhpcy50b2dnbGVQb3B1cCh0cnVlKSksIHRoaXMubmF2aWdhdGlvblNlcnZpY2UuZW50ZXJcbiAgICAgICAgICAgIC5waXBlKHRhcCgoZXZlbnQpID0+IGV2ZW50Lm9yaWdpbmFsRXZlbnQucHJldmVudERlZmF1bHQoKSkpXG4gICAgICAgICAgICAuc3Vic2NyaWJlKCgpID0+IHRoaXMudG9nZ2xlUG9wdXAodHJ1ZSkpLCBtZXJnZSh0aGlzLm5hdmlnYXRpb25TZXJ2aWNlLmNsb3NlLCB0aGlzLm5hdmlnYXRpb25TZXJ2aWNlLmVzYykuc3Vic2NyaWJlKCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuZm9jdXMoKTtcbiAgICAgICAgICAgIHRoaXMudG9nZ2xlUG9wdXAoZmFsc2UpO1xuICAgICAgICB9KSwgdGhpcy5uYXZpZ2F0aW9uU2VydmljZS50YWIuc3Vic2NyaWJlKHRoaXMuaGFuZGxlVGFiS2V5LmJpbmQodGhpcykpLCB0aGlzLm5hdmlnYXRpb25TZXJ2aWNlLnVwLnN1YnNjcmliZSh0aGlzLmhhbmRsZVVwS2V5LmJpbmQodGhpcykpLCB0aGlzLm5hdmlnYXRpb25TZXJ2aWNlLmRvd24uc3Vic2NyaWJlKHRoaXMuaGFuZGxlRG93bktleS5iaW5kKHRoaXMpKSwgdGhpcy5uYXZpZ2F0aW9uU2VydmljZS5sZWZ0XG4gICAgICAgICAgICAucGlwZShmaWx0ZXIoKCkgPT4gIXRoaXMuaXNUcmVlVmlld0FjdGl2ZSkpXG4gICAgICAgICAgICAuc3Vic2NyaWJlKHRoaXMuZGlyZWN0aW9uID09PSAncnRsJyA/IHRoaXMuaGFuZGxlUmlnaHRLZXkuYmluZCh0aGlzKSA6IHRoaXMuaGFuZGxlTGVmdEtleS5iaW5kKHRoaXMpKSwgdGhpcy5uYXZpZ2F0aW9uU2VydmljZS5yaWdodFxuICAgICAgICAgICAgLnBpcGUoZmlsdGVyKCgpID0+ICF0aGlzLmlzVHJlZVZpZXdBY3RpdmUpKVxuICAgICAgICAgICAgLnN1YnNjcmliZSh0aGlzLmRpcmVjdGlvbiA9PT0gJ3J0bCcgPyB0aGlzLmhhbmRsZUxlZnRLZXkuYmluZCh0aGlzKSA6IHRoaXMuaGFuZGxlUmlnaHRLZXkuYmluZCh0aGlzKSksIHRoaXMubmF2aWdhdGlvblNlcnZpY2UuaG9tZS5waXBlKGZpbHRlcigoKSA9PiAhdGhpcy5pc09wZW4pKS5zdWJzY3JpYmUodGhpcy5oYW5kbGVIb21lLmJpbmQodGhpcykpLCB0aGlzLm5hdmlnYXRpb25TZXJ2aWNlLmVuZC5waXBlKGZpbHRlcigoKSA9PiAhdGhpcy5pc09wZW4pKS5zdWJzY3JpYmUodGhpcy5oYW5kbGVFbmQuYmluZCh0aGlzKSksIHRoaXMubmF2aWdhdGlvblNlcnZpY2UuYmFja3NwYWNlLnBpcGUoZmlsdGVyKCgpID0+IHRoaXMuaXNUYWdGb2N1c2VkKSkuc3Vic2NyaWJlKHRoaXMuaGFuZGxlQmFja3NwYWNlLmJpbmQodGhpcykpLCB0aGlzLm5hdmlnYXRpb25TZXJ2aWNlLmRlbGV0ZS5waXBlKGZpbHRlcigoKSA9PiB0aGlzLmlzVGFnRm9jdXNlZCkpLnN1YnNjcmliZSh0aGlzLmhhbmRsZURlbGV0ZS5iaW5kKHRoaXMpKSk7XG4gICAgfVxuICAgIHN1YnNjcmliZUZvY3VzRXZlbnRzKCkge1xuICAgICAgICBpZiAoaXNEb2N1bWVudEF2YWlsYWJsZSgpKSB7XG4gICAgICAgICAgICB0aGlzLmhhbmRsZUZvY3VzID0gdGhpcy5oYW5kbGVGb2N1cy5iaW5kKHRoaXMpO1xuICAgICAgICAgICAgdGhpcy5oYW5kbGVEb2N1bWVudEJsdXIgPSB0aGlzLmhhbmRsZURvY3VtZW50Qmx1ci5iaW5kKHRoaXMpO1xuICAgICAgICAgICAgdGhpcy5fem9uZS5ydW5PdXRzaWRlQW5ndWxhcigoKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgdXNlQ2FwdHVyZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZm9jdXMnLCB0aGlzLmhhbmRsZUZvY3VzLCB1c2VDYXB0dXJlKTtcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdibHVyJywgdGhpcy5oYW5kbGVEb2N1bWVudEJsdXIsIHVzZUNhcHR1cmUpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdW5TdWJzY3JpYmVGb2N1c0V2ZW50cygpIHtcbiAgICAgICAgaWYgKGlzRG9jdW1lbnRBdmFpbGFibGUoKSkge1xuICAgICAgICAgICAgY29uc3QgdXNlQ2FwdHVyZSA9IHRydWU7XG4gICAgICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdmb2N1cycsIHRoaXMuaGFuZGxlRm9jdXMsIHVzZUNhcHR1cmUpO1xuICAgICAgICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignYmx1cicsIHRoaXMuaGFuZGxlRG9jdW1lbnRCbHVyLCB1c2VDYXB0dXJlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBoYW5kbGVEb2N1bWVudEJsdXIoZXZlbnQpIHtcbiAgICAgICAgaWYgKGV2ZW50LnRhcmdldCAhPT0gdGhpcy53cmFwcGVyLm5hdGl2ZUVsZW1lbnQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBldmVudC5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKTtcbiAgICAgICAgdGhpcy5oYW5kbGVCbHVyKGV2ZW50KTtcbiAgICB9XG4gICAgaGFuZGxlVGFiS2V5KCkge1xuICAgICAgICB0aGlzLmZvY3VzKCk7XG4gICAgICAgIGlmICh0aGlzLmlzT3Blbikge1xuICAgICAgICAgICAgdGhpcy50cmVldmlldy5ibHVyKCk7XG4gICAgICAgICAgICB0aGlzLnJlbW92ZVRyZWVWaWV3RnJvbVRhYk9yZGVyKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaGFuZGxlVXBLZXkoZXZlbnQpIHtcbiAgICAgICAgaWYgKCF0aGlzLnRyZWV2aWV3KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgZXZlbnQub3JpZ2luYWxFdmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAvLyBQcmV2ZW50IHRvZ2dsaW5nIHRoZSBmb2N1cyBiZXR3ZWVuIHRoZSBmaWx0ZXJJbnB1dCBhbmQgdGhlIHdyYXBwZXIgZWxlbWVudHMgd2l0aCBgdXBgIGtleVxuICAgICAgICBpZiAodGhpcy5pc1dyYXBwZXJBY3RpdmUpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBpc0ZpcnN0Tm9kZUFjdGl2ZSA9IHRoaXMudHJlZXZpZXdbJ25hdmlnYXRpb25TZXJ2aWNlJ11bJ2FjdGl2ZUluZGV4J10gPT09ICcwJztcbiAgICAgICAgLy8gQ3VycmVudCBmb2N1cyBpcyBvbiB0aGUgZmlsdGVyIGlucHV0ID0+IHNob3VsZCBmb2N1cyB0aGUgd3JhcHBlclxuICAgICAgICBpZiAodGhpcy5maWx0ZXJhYmxlICYmIHRoaXMuaXNGaWx0ZXJBY3RpdmUpIHtcbiAgICAgICAgICAgIHRoaXMuZm9jdXMoKTtcbiAgICAgICAgICAgIC8vIEN1cnJlbnQgZm9jdXMgaXMgb24gdGhlIHRyZWV2aWV3IGZpcnN0IG5vZGUgPT4gc2hvdWxkIGZvY3VzIHRoZSBjaGVjayBhbGwgY2hlY2tib3ggaWYgZW5hYmxlZFxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHRoaXMuY2hlY2tBbGwgJiYgIXRoaXMuaXNDaGVja0FsbEFjdGl2ZSAmJiBpc0ZpcnN0Tm9kZUFjdGl2ZSkge1xuICAgICAgICAgICAgdGhpcy5jaGVja0FsbElucHV0Lm5hdGl2ZUVsZW1lbnQuZm9jdXMoKTtcbiAgICAgICAgICAgIC8vIEN1cnJlbnQgZm9jdXMgaXMgZWl0aGVyIG9uIHRoZSBjaGVjayBhbGwgY2hlY2tib3ggb3IgdGhlIHRyZWV2aWV3J3MgZmlyc3Qgbm9kZVxuICAgICAgICAgICAgLy8gPT4gc2hvdWxkIGZvY3VzIGVpdGhlciB0aGUgZmlsdGVyIGlucHV0IChpZiBlbmFibGVkKSBvciB0aGUgd3JhcHBlclxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHRoaXMuaXNDaGVja0FsbEFjdGl2ZSB8fCBpc0ZpcnN0Tm9kZUFjdGl2ZSkge1xuICAgICAgICAgICAgdGhpcy5maWx0ZXJhYmxlID9cbiAgICAgICAgICAgICAgICB0aGlzLmZpbHRlcklucHV0Lm5hdGl2ZUVsZW1lbnQuZm9jdXMoKSA6XG4gICAgICAgICAgICAgICAgdGhpcy5mb2N1cygpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGhhbmRsZURvd25LZXkoZXZlbnQpIHtcbiAgICAgICAgaWYgKCF0aGlzLnRyZWV2aWV3KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgZXZlbnQub3JpZ2luYWxFdmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAvLyBDdXJyZW50IGZvY3VzIGlzIG9uIHRoZSB3cmFwcGVyID0+IHNob3VsZCBmb2N1cyB0aGUgZmlsdGVyIGlucHV0XG4gICAgICAgIGlmICh0aGlzLmZpbHRlcmFibGUgJiYgdGhpcy5pc1dyYXBwZXJBY3RpdmUpIHtcbiAgICAgICAgICAgIHRoaXMuZmlsdGVySW5wdXQubmF0aXZlRWxlbWVudC5mb2N1cygpO1xuICAgICAgICAgICAgLy8gQ3VycmVudCBmb2N1cyBpcyBvbiB0aGUgd3JhcHBlci9maWx0ZXIgaW5wdXQgPT4gc2hvdWxkIGZvY3VzIGNoZWNrIGFsbCBjaGVja2JveCBpZiBlbmFibGVkXG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodGhpcy5jaGVja0FsbCAmJiAodGhpcy5pc1dyYXBwZXJBY3RpdmUgfHwgdGhpcy5pc0ZpbHRlckFjdGl2ZSkpIHtcbiAgICAgICAgICAgIHRoaXMuY2hlY2tBbGxJbnB1dC5uYXRpdmVFbGVtZW50LmZvY3VzKCk7XG4gICAgICAgICAgICAvLyBTaG91bGQgZm9jdXMgdGhlIHRyZWV2aWV3IGlmIGZpbHRlcmFibGUgYW5kIGNoZWNrIGFsbCBhcmUgZGlzYWJsZWRcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICghdGhpcy50cmVldmlldy5pc0FjdGl2ZSkge1xuICAgICAgICAgICAgdGhpcy50cmVldmlldy5mb2N1cygpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZm9jdXNlZFRhZ0luZGV4ID0gdW5kZWZpbmVkO1xuICAgIH1cbiAgICBoYW5kbGVSaWdodEtleShldmVudCkge1xuICAgICAgICBldmVudC5vcmlnaW5hbEV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGNvbnN0IGxhc3QgPSB0aGlzLnRhZ3MubGVuZ3RoIC0gMTtcbiAgICAgICAgaWYgKHRoaXMuZm9jdXNlZFRhZ0luZGV4ID09PSBsYXN0KSB7XG4gICAgICAgICAgICB0aGlzLmZvY3VzZWRUYWdJbmRleCA9IHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0aGlzLmZvY3VzZWRUYWdJbmRleCA8IGxhc3QpIHtcbiAgICAgICAgICAgIHRoaXMuZm9jdXNlZFRhZ0luZGV4Kys7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoIXRoaXMuZm9jdXNlZFRhZ0luZGV4KSB7XG4gICAgICAgICAgICB0aGlzLmZvY3VzZWRUYWdJbmRleCA9IDA7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaGFuZGxlTGVmdEtleShldmVudCkge1xuICAgICAgICBldmVudC5vcmlnaW5hbEV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGlmICh0aGlzLmZvY3VzZWRUYWdJbmRleCA9PT0gdW5kZWZpbmVkIHx8IHRoaXMuZm9jdXNlZFRhZ0luZGV4IDwgMCkge1xuICAgICAgICAgICAgdGhpcy5mb2N1c2VkVGFnSW5kZXggPSB0aGlzLnRhZ3MubGVuZ3RoIC0gMTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0aGlzLmZvY3VzZWRUYWdJbmRleCAhPT0gMCkge1xuICAgICAgICAgICAgdGhpcy5mb2N1c2VkVGFnSW5kZXgtLTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBoYW5kbGVFbmQoZXZlbnQpIHtcbiAgICAgICAgZXZlbnQub3JpZ2luYWxFdmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICB0aGlzLmZvY3VzZWRUYWdJbmRleCA9IHRoaXMudGFncy5sZW5ndGggLSAxO1xuICAgIH1cbiAgICBoYW5kbGVIb21lKGV2ZW50KSB7XG4gICAgICAgIGV2ZW50Lm9yaWdpbmFsRXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgdGhpcy5mb2N1c2VkVGFnSW5kZXggPSAwO1xuICAgIH1cbiAgICBoYW5kbGVCYWNrc3BhY2UoKSB7XG4gICAgICAgIGlmICh0aGlzLmZvY3VzZWRUYWdJbmRleCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aGlzLmhhbmRsZURlbGV0ZSgpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgdGFnID0gdGhpcy50YWdzW3RoaXMudGFncy5sZW5ndGggLSAxXTtcbiAgICAgICAgICAgIGNvbnN0IGluZGV4ID0gdGhpcy50YWdzLmxlbmd0aCAtIDE7XG4gICAgICAgICAgICB0aGlzLmhhbmRsZVJlbW92ZVRhZyh7IHRhZywgaW5kZXggfSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaGFuZGxlRGVsZXRlKCkge1xuICAgICAgICBjb25zdCB0YWcgPSB0aGlzLnRhZ3NbdGhpcy5mb2N1c2VkVGFnSW5kZXhdO1xuICAgICAgICBjb25zdCBpbmRleCA9IHRoaXMuZm9jdXNlZFRhZ0luZGV4O1xuICAgICAgICB0aGlzLmhhbmRsZVJlbW92ZVRhZyh7IHRhZywgaW5kZXggfSk7XG4gICAgICAgIGlmICh0aGlzLmZvY3VzZWRUYWdJbmRleCA9PT0gdGhpcy50YWdzLmxlbmd0aCkge1xuICAgICAgICAgICAgdGhpcy5mb2N1c2VkVGFnSW5kZXggPSB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdW5zdWJzY3JpYmVFdmVudHMoKSB7XG4gICAgICAgIHRoaXMuc3Vic2NyaXB0aW9ucy5mb3JFYWNoKHN1YiA9PiBzdWIudW5zdWJzY3JpYmUoKSk7XG4gICAgICAgIHRoaXMudW5TdWJzY3JpYmVGb2N1c0V2ZW50cygpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZW1vdmUgdGhlIGBUcmVlVmlld2AgZnJvbSB0aGUgdGFiIG9yZGVyLCBvdGhlcndpc2UgYSBmb2N1cyBsb29wIGJldHdlZW4gdGhlIHBhZ2UgZWxlbWVudHMgd2lsbCBvY2N1clxuICAgICAqIGFuZCB0aGUgdXNlciB3aWxsIG5vdCBiZSBhYmxlIHRvIHRhYiB0byB0aGUgcmVzdCBvZiB0aGUgYnJvd3NlciBlbGVtZW50c1xuICAgICAqL1xuICAgIHJlbW92ZVRyZWVWaWV3RnJvbVRhYk9yZGVyKCkge1xuICAgICAgICBjb25zdCBub2RlcyA9IHRoaXMudHJlZXZpZXcuZWxlbWVudC5uYXRpdmVFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2xpJyk7XG4gICAgICAgIG5vZGVzLmZvckVhY2goaXRlbSA9PiB7XG4gICAgICAgICAgICBpZiAoaXRlbS5nZXRBdHRyaWJ1dGUoJ3RhYmluZGV4JykgPT09ICcwJykge1xuICAgICAgICAgICAgICAgIHRoaXMubGFzdE5vZGVPbkZvY3VzID0gaXRlbTtcbiAgICAgICAgICAgICAgICB0aGlzLmxhc3ROb2RlT25Gb2N1cy5zZXRBdHRyaWJ1dGUoJ3RhYmluZGV4JywgJy0xJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBzZXRTdGF0ZSgpIHtcbiAgICAgICAgaWYgKGlzUHJlc2VudCh0aGlzLmRhdGFJdGVtcykgJiYgaXNQcmVzZW50KHRoaXMudmFsdWVGaWVsZCkpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0VGFncygpO1xuICAgICAgICAgICAgdGhpcy5jaGVja2VkSXRlbXMgPSB0aGlzLmRhdGFJdGVtcy5zbGljZSgpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuY2RyLm1hcmtGb3JDaGVjaygpO1xuICAgIH1cbiAgICBzZXRUYWdzKCkge1xuICAgICAgICBjb25zdCBzb3VyY2UgPSB0aGlzLmRhdGFJdGVtcy5tYXAoaXRlbSA9PiBpdGVtLmRhdGFJdGVtKTtcbiAgICAgICAgdGhpcy50YWdzID0gdGhpcy50YWdNYXBwZXIoc291cmNlKTtcbiAgICAgICAgdGhpcy5kaXNhYmxlZEluZGljZXMgPSB0aGlzLmRpc2FibGVkSXRlbXNNYXBwZXIoKTtcbiAgICB9XG4gICAgdXBkYXRlVmFsdWUodmFsdWUpIHtcbiAgICAgICAgY29uc3QgbmV3VmFsdWUgPSB0aGlzLnZhbHVlUHJpbWl0aXZlID9cbiAgICAgICAgICAgIHZhbHVlLm1hcChpdGVtID0+IHZhbHVlRnJvbShpdGVtLCB0aGlzLnZhbHVlRmllbGQpKSA6XG4gICAgICAgICAgICB2YWx1ZS5tYXAoaXRlbSA9PiBpdGVtLmRhdGFJdGVtKTtcbiAgICAgICAgdGhpcy52YWx1ZSA9IG5ld1ZhbHVlO1xuICAgICAgICB0aGlzLmVtaXRWYWx1ZUNoYW5nZSh0aGlzLnZhbHVlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqXG4gICAgICogRGV0ZXJtaW5lcyB3aGljaCBvZiB0aGUgcHJvdmlkZWQgdGFncyBzaG91bGQgYmUgZGlzYWJsZWQgYW5kIHN0b3JlcyB0aGVpciBwb3NpdGlvbiBpbmRpY2VzXG4gICAgICovXG4gICAgZGlzYWJsZWRJdGVtc01hcHBlcigpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBTZXQodGhpcy5kYXRhSXRlbXMucmVkdWNlKChpbmRpY2VzLCBpdGVtLCBpbmRleCkgPT4ge1xuICAgICAgICAgICAgaWYgKHRoaXMuaXRlbURpc2FibGVkKGl0ZW0uZGF0YUl0ZW0sIGl0ZW0uaW5kZXgpKSB7XG4gICAgICAgICAgICAgICAgaW5kaWNlcy5wdXNoKGluZGV4KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBpbmRpY2VzO1xuICAgICAgICB9LCBbXSkpO1xuICAgIH1cbiAgICBzZXRDb21wb25lbnRDbGFzc2VzKCkge1xuICAgICAgICBpZiAodGhpcy5zaXplKSB7XG4gICAgICAgICAgICB0aGlzLnJlbmRlcmVyLmFkZENsYXNzKHRoaXMud3JhcHBlci5uYXRpdmVFbGVtZW50LCBnZXRTaXplQ2xhc3MoJ2lucHV0JywgdGhpcy5zaXplKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMucm91bmRlZCkge1xuICAgICAgICAgICAgdGhpcy5yZW5kZXJlci5hZGRDbGFzcyh0aGlzLndyYXBwZXIubmF0aXZlRWxlbWVudCwgZ2V0Um91bmRlZENsYXNzKHRoaXMucm91bmRlZCkpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmZpbGxNb2RlKSB7XG4gICAgICAgICAgICB0aGlzLnJlbmRlcmVyLmFkZENsYXNzKHRoaXMud3JhcHBlci5uYXRpdmVFbGVtZW50LCBnZXRGaWxsTW9kZUNsYXNzKCdpbnB1dCcsIHRoaXMuZmlsbE1vZGUpKTtcbiAgICAgICAgfVxuICAgIH1cbn07XG5fX2RlY29yYXRlKFtcbiAgICBIb3N0QmluZGluZygnY2xhc3Muay1kcm9wZG93bnRyZWUnKSxcbiAgICBIb3N0QmluZGluZygnY2xhc3Muay1pbnB1dCcpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBCb29sZWFuKVxuXSwgTXVsdGlTZWxlY3RUcmVlQ29tcG9uZW50LnByb3RvdHlwZSwgXCJob3N0Q2xhc3Nlc1wiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgSG9zdEJpbmRpbmcoJ2NsYXNzLmstZGlzYWJsZWQnKSxcbiAgICBIb3N0QmluZGluZygnYXR0ci5hcmlhLWRpc2FibGVkJyksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEJvb2xlYW4pLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246cGFyYW10eXBlc1wiLCBbXSlcbl0sIE11bHRpU2VsZWN0VHJlZUNvbXBvbmVudC5wcm90b3R5cGUsIFwiaXNEaXNhYmxlZFwiLCBudWxsKTtcbl9fZGVjb3JhdGUoW1xuICAgIEhvc3RCaW5kaW5nKCdjbGFzcy5rLWxvYWRpbmcnKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgQm9vbGVhbiksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjpwYXJhbXR5cGVzXCIsIFtdKVxuXSwgTXVsdGlTZWxlY3RUcmVlQ29tcG9uZW50LnByb3RvdHlwZSwgXCJpc0xvYWRpbmdcIiwgbnVsbCk7XG5fX2RlY29yYXRlKFtcbiAgICBIb3N0QmluZGluZygnYXR0ci5pZCcpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBTdHJpbmcpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246cGFyYW10eXBlc1wiLCBbXSlcbl0sIE11bHRpU2VsZWN0VHJlZUNvbXBvbmVudC5wcm90b3R5cGUsIFwiaWRcIiwgbnVsbCk7XG5fX2RlY29yYXRlKFtcbiAgICBIb3N0QmluZGluZygnYXR0ci5kaXInKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgU3RyaW5nKVxuXSwgTXVsdGlTZWxlY3RUcmVlQ29tcG9uZW50LnByb3RvdHlwZSwgXCJkaXJlY3Rpb25cIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIEhvc3RCaW5kaW5nKCdhdHRyLnRhYmluZGV4JyksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIE51bWJlciksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjpwYXJhbXR5cGVzXCIsIFtdKVxuXSwgTXVsdGlTZWxlY3RUcmVlQ29tcG9uZW50LnByb3RvdHlwZSwgXCJob3N0VGFiSW5kZXhcIiwgbnVsbCk7XG5fX2RlY29yYXRlKFtcbiAgICBIb3N0QmluZGluZygnYXR0ci5yb2xlJyksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIFN0cmluZylcbl0sIE11bHRpU2VsZWN0VHJlZUNvbXBvbmVudC5wcm90b3R5cGUsIFwicm9sZVwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgSG9zdEJpbmRpbmcoJ2F0dHIuYXJpYS1leHBhbmRlZCcpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBCb29sZWFuKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnBhcmFtdHlwZXNcIiwgW10pXG5dLCBNdWx0aVNlbGVjdFRyZWVDb21wb25lbnQucHJvdG90eXBlLCBcImlzQXJpYUV4cGFuZGVkXCIsIG51bGwpO1xuX19kZWNvcmF0ZShbXG4gICAgSG9zdEJpbmRpbmcoJ2F0dHIuYXJpYS1oYXNwb3B1cCcpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBTdHJpbmcpXG5dLCBNdWx0aVNlbGVjdFRyZWVDb21wb25lbnQucHJvdG90eXBlLCBcImFyaWFIYXNQb3B1cFwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgSG9zdEJpbmRpbmcoJ2F0dHIucmVhZG9ubHknKSxcbiAgICBIb3N0QmluZGluZygnYXR0ci5hcmlhLXJlYWRvbmx5JyksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEJvb2xlYW4pLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246cGFyYW10eXBlc1wiLCBbXSlcbl0sIE11bHRpU2VsZWN0VHJlZUNvbXBvbmVudC5wcm90b3R5cGUsIFwiaXNSZWFkb25seVwiLCBudWxsKTtcbl9fZGVjb3JhdGUoW1xuICAgIEhvc3RCaW5kaW5nKCdhdHRyLmFyaWEtZGVzY3JpYmVkYnknKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgU3RyaW5nKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnBhcmFtdHlwZXNcIiwgW10pXG5dLCBNdWx0aVNlbGVjdFRyZWVDb21wb25lbnQucHJvdG90eXBlLCBcImFyaWFEZXNjcmliZWRCeVwiLCBudWxsKTtcbl9fZGVjb3JhdGUoW1xuICAgIEhvc3RCaW5kaW5nKCdhdHRyLmFyaWEtYWN0aXZlZGVzY2VuZGFudCcpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBTdHJpbmcpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246cGFyYW10eXBlc1wiLCBbXSlcbl0sIE11bHRpU2VsZWN0VHJlZUNvbXBvbmVudC5wcm90b3R5cGUsIFwiYXJpYUFjdGl2ZURlc2NlbmRhbnRcIiwgbnVsbCk7XG5fX2RlY29yYXRlKFtcbiAgICBIb3N0TGlzdGVuZXIoJ2NsaWNrJyksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEZ1bmN0aW9uKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnBhcmFtdHlwZXNcIiwgW10pLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246cmV0dXJudHlwZVwiLCB2b2lkIDApXG5dLCBNdWx0aVNlbGVjdFRyZWVDb21wb25lbnQucHJvdG90eXBlLCBcImhhbmRsZUNsaWNrXCIsIG51bGwpO1xuX19kZWNvcmF0ZShbXG4gICAgSG9zdExpc3RlbmVyKCdrZXlkb3duJywgWyckZXZlbnQnXSksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEZ1bmN0aW9uKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnBhcmFtdHlwZXNcIiwgW09iamVjdF0pLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246cmV0dXJudHlwZVwiLCB2b2lkIDApXG5dLCBNdWx0aVNlbGVjdFRyZWVDb21wb25lbnQucHJvdG90eXBlLCBcImhhbmRsZUtleWRvd25cIiwgbnVsbCk7XG5fX2RlY29yYXRlKFtcbiAgICBDb250ZW50Q2hpbGQoSGVhZGVyVGVtcGxhdGVEaXJlY3RpdmUsIHsgc3RhdGljOiBmYWxzZSB9KSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgSGVhZGVyVGVtcGxhdGVEaXJlY3RpdmUpXG5dLCBNdWx0aVNlbGVjdFRyZWVDb21wb25lbnQucHJvdG90eXBlLCBcImhlYWRlclRlbXBsYXRlXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBDb250ZW50Q2hpbGQoRm9vdGVyVGVtcGxhdGVEaXJlY3RpdmUsIHsgc3RhdGljOiBmYWxzZSB9KSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgRm9vdGVyVGVtcGxhdGVEaXJlY3RpdmUpXG5dLCBNdWx0aVNlbGVjdFRyZWVDb21wb25lbnQucHJvdG90eXBlLCBcImZvb3RlclRlbXBsYXRlXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBDb250ZW50Q2hpbGQoTm9kZVRlbXBsYXRlRGlyZWN0aXZlLCB7IHN0YXRpYzogZmFsc2UgfSksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIE5vZGVUZW1wbGF0ZURpcmVjdGl2ZSlcbl0sIE11bHRpU2VsZWN0VHJlZUNvbXBvbmVudC5wcm90b3R5cGUsIFwibm9kZVRlbXBsYXRlXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBDb250ZW50Q2hpbGQoTm9EYXRhVGVtcGxhdGVEaXJlY3RpdmUsIHsgc3RhdGljOiBmYWxzZSB9KSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgTm9EYXRhVGVtcGxhdGVEaXJlY3RpdmUpXG5dLCBNdWx0aVNlbGVjdFRyZWVDb21wb25lbnQucHJvdG90eXBlLCBcIm5vRGF0YVRlbXBsYXRlXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBDb250ZW50Q2hpbGQoVGFnVGVtcGxhdGVEaXJlY3RpdmUsIHsgc3RhdGljOiBmYWxzZSB9KSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgVGFnVGVtcGxhdGVEaXJlY3RpdmUpXG5dLCBNdWx0aVNlbGVjdFRyZWVDb21wb25lbnQucHJvdG90eXBlLCBcInRhZ1RlbXBsYXRlXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBDb250ZW50Q2hpbGQoR3JvdXBUYWdUZW1wbGF0ZURpcmVjdGl2ZSwgeyBzdGF0aWM6IGZhbHNlIH0pLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBHcm91cFRhZ1RlbXBsYXRlRGlyZWN0aXZlKVxuXSwgTXVsdGlTZWxlY3RUcmVlQ29tcG9uZW50LnByb3RvdHlwZSwgXCJncm91cFRhZ1RlbXBsYXRlXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBWaWV3Q2hpbGQoJ3BvcHVwVGVtcGxhdGUnLCB7IHN0YXRpYzogdHJ1ZSB9KSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgVGVtcGxhdGVSZWYpXG5dLCBNdWx0aVNlbGVjdFRyZWVDb21wb25lbnQucHJvdG90eXBlLCBcInBvcHVwVGVtcGxhdGVcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIFZpZXdDaGlsZCgnY29udGFpbmVyJywgeyByZWFkOiBWaWV3Q29udGFpbmVyUmVmLCBzdGF0aWM6IHRydWUgfSksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIFZpZXdDb250YWluZXJSZWYpXG5dLCBNdWx0aVNlbGVjdFRyZWVDb21wb25lbnQucHJvdG90eXBlLCBcImNvbnRhaW5lclwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgVmlld0NoaWxkKCd0cmVldmlldycsIHsgc3RhdGljOiBmYWxzZSB9KSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgVHJlZVZpZXdDb21wb25lbnQpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246cGFyYW10eXBlc1wiLCBbVHJlZVZpZXdDb21wb25lbnRdKVxuXSwgTXVsdGlTZWxlY3RUcmVlQ29tcG9uZW50LnByb3RvdHlwZSwgXCJ0cmVldmlld1wiLCBudWxsKTtcbl9fZGVjb3JhdGUoW1xuICAgIFZpZXdDaGlsZCgnZmlsdGVySW5wdXQnLCB7IHN0YXRpYzogZmFsc2UgfSksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEVsZW1lbnRSZWYpXG5dLCBNdWx0aVNlbGVjdFRyZWVDb21wb25lbnQucHJvdG90eXBlLCBcImZpbHRlcklucHV0XCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBWaWV3Q2hpbGQoJ2NoZWNrQWxsSW5wdXQnLCB7IHN0YXRpYzogZmFsc2UgfSksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEVsZW1lbnRSZWYpXG5dLCBNdWx0aVNlbGVjdFRyZWVDb21wb25lbnQucHJvdG90eXBlLCBcImNoZWNrQWxsSW5wdXRcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIE51bWJlciksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjpwYXJhbXR5cGVzXCIsIFtOdW1iZXJdKVxuXSwgTXVsdGlTZWxlY3RUcmVlQ29tcG9uZW50LnByb3RvdHlwZSwgXCJ0YWJpbmRleFwiLCBudWxsKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIFN0cmluZyksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjpwYXJhbXR5cGVzXCIsIFtTdHJpbmddKVxuXSwgTXVsdGlTZWxlY3RUcmVlQ29tcG9uZW50LnByb3RvdHlwZSwgXCJzaXplXCIsIG51bGwpO1xuX19kZWNvcmF0ZShbXG4gICAgSW5wdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgU3RyaW5nKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnBhcmFtdHlwZXNcIiwgW1N0cmluZ10pXG5dLCBNdWx0aVNlbGVjdFRyZWVDb21wb25lbnQucHJvdG90eXBlLCBcInJvdW5kZWRcIiwgbnVsbCk7XG5fX2RlY29yYXRlKFtcbiAgICBJbnB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBTdHJpbmcpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246cGFyYW10eXBlc1wiLCBbU3RyaW5nXSlcbl0sIE11bHRpU2VsZWN0VHJlZUNvbXBvbmVudC5wcm90b3R5cGUsIFwiZmlsbE1vZGVcIiwgbnVsbCk7XG5fX2RlY29yYXRlKFtcbiAgICBJbnB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBPYmplY3QpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246cGFyYW10eXBlc1wiLCBbT2JqZWN0XSlcbl0sIE11bHRpU2VsZWN0VHJlZUNvbXBvbmVudC5wcm90b3R5cGUsIFwicG9wdXBTZXR0aW5nc1wiLCBudWxsKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIE9iamVjdCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjpwYXJhbXR5cGVzXCIsIFtPYmplY3RdKVxuXSwgTXVsdGlTZWxlY3RUcmVlQ29tcG9uZW50LnByb3RvdHlwZSwgXCJjaGVja2FibGVTZXR0aW5nc1wiLCBudWxsKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEFycmF5KSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnBhcmFtdHlwZXNcIiwgW0FycmF5XSlcbl0sIE11bHRpU2VsZWN0VHJlZUNvbXBvbmVudC5wcm90b3R5cGUsIFwiZGF0YVwiLCBudWxsKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEFycmF5KSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnBhcmFtdHlwZXNcIiwgW0FycmF5XSlcbl0sIE11bHRpU2VsZWN0VHJlZUNvbXBvbmVudC5wcm90b3R5cGUsIFwidmFsdWVcIiwgbnVsbCk7XG5fX2RlY29yYXRlKFtcbiAgICBJbnB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBBcnJheSksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjpwYXJhbXR5cGVzXCIsIFtBcnJheV0pXG5dLCBNdWx0aVNlbGVjdFRyZWVDb21wb25lbnQucHJvdG90eXBlLCBcImRhdGFJdGVtc1wiLCBudWxsKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIE9iamVjdClcbl0sIE11bHRpU2VsZWN0VHJlZUNvbXBvbmVudC5wcm90b3R5cGUsIFwidGV4dEZpZWxkXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBJbnB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBPYmplY3QpXG5dLCBNdWx0aVNlbGVjdFRyZWVDb21wb25lbnQucHJvdG90eXBlLCBcInZhbHVlRmllbGRcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEFycmF5KVxuXSwgTXVsdGlTZWxlY3RUcmVlQ29tcG9uZW50LnByb3RvdHlwZSwgXCJ2YWx1ZURlcHRoXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBJbnB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBCb29sZWFuKVxuXSwgTXVsdGlTZWxlY3RUcmVlQ29tcG9uZW50LnByb3RvdHlwZSwgXCJsb2FkaW5nXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBJbnB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBTdHJpbmcpXG5dLCBNdWx0aVNlbGVjdFRyZWVDb21wb25lbnQucHJvdG90eXBlLCBcInBsYWNlaG9sZGVyXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBJbnB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBOdW1iZXIpXG5dLCBNdWx0aVNlbGVjdFRyZWVDb21wb25lbnQucHJvdG90eXBlLCBcImxpc3RIZWlnaHRcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEJvb2xlYW4pXG5dLCBNdWx0aVNlbGVjdFRyZWVDb21wb25lbnQucHJvdG90eXBlLCBcImRpc2FibGVkXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBJbnB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBCb29sZWFuKVxuXSwgTXVsdGlTZWxlY3RUcmVlQ29tcG9uZW50LnByb3RvdHlwZSwgXCJyZWFkb25seVwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgSW5wdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgQm9vbGVhbilcbl0sIE11bHRpU2VsZWN0VHJlZUNvbXBvbmVudC5wcm90b3R5cGUsIFwidmFsdWVQcmltaXRpdmVcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEJvb2xlYW4pXG5dLCBNdWx0aVNlbGVjdFRyZWVDb21wb25lbnQucHJvdG90eXBlLCBcImxvYWRPbkRlbWFuZFwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgSW5wdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgU3RyaW5nKVxuXSwgTXVsdGlTZWxlY3RUcmVlQ29tcG9uZW50LnByb3RvdHlwZSwgXCJmb2N1c2FibGVJZFwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgSW5wdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgQm9vbGVhbilcbl0sIE11bHRpU2VsZWN0VHJlZUNvbXBvbmVudC5wcm90b3R5cGUsIFwiY2xlYXJCdXR0b25cIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEJvb2xlYW4pXG5dLCBNdWx0aVNlbGVjdFRyZWVDb21wb25lbnQucHJvdG90eXBlLCBcImZpbHRlcmFibGVcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEJvb2xlYW4pXG5dLCBNdWx0aVNlbGVjdFRyZWVDb21wb25lbnQucHJvdG90eXBlLCBcImNoZWNrQWxsXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBJbnB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBGdW5jdGlvbilcbl0sIE11bHRpU2VsZWN0VHJlZUNvbXBvbmVudC5wcm90b3R5cGUsIFwiaGFzQ2hpbGRyZW5cIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEZ1bmN0aW9uKVxuXSwgTXVsdGlTZWxlY3RUcmVlQ29tcG9uZW50LnByb3RvdHlwZSwgXCJmZXRjaENoaWxkcmVuXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBJbnB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBGdW5jdGlvbilcbl0sIE11bHRpU2VsZWN0VHJlZUNvbXBvbmVudC5wcm90b3R5cGUsIFwiaXNOb2RlRXhwYW5kZWRcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEZ1bmN0aW9uKVxuXSwgTXVsdGlTZWxlY3RUcmVlQ29tcG9uZW50LnByb3RvdHlwZSwgXCJpc05vZGVWaXNpYmxlXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBJbnB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBGdW5jdGlvbilcbl0sIE11bHRpU2VsZWN0VHJlZUNvbXBvbmVudC5wcm90b3R5cGUsIFwiaXRlbURpc2FibGVkXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBJbnB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBPYmplY3QpXG5dLCBNdWx0aVNlbGVjdFRyZWVDb21wb25lbnQucHJvdG90eXBlLCBcInRhZ01hcHBlclwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgT3V0cHV0KCdmb2N1cycpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBFdmVudEVtaXR0ZXIpXG5dLCBNdWx0aVNlbGVjdFRyZWVDb21wb25lbnQucHJvdG90eXBlLCBcIm9uRm9jdXNcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIE91dHB1dCgnYmx1cicpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBFdmVudEVtaXR0ZXIpXG5dLCBNdWx0aVNlbGVjdFRyZWVDb21wb25lbnQucHJvdG90eXBlLCBcIm9uQmx1clwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgT3V0cHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEV2ZW50RW1pdHRlcilcbl0sIE11bHRpU2VsZWN0VHJlZUNvbXBvbmVudC5wcm90b3R5cGUsIFwib3BlblwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgT3V0cHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEV2ZW50RW1pdHRlcilcbl0sIE11bHRpU2VsZWN0VHJlZUNvbXBvbmVudC5wcm90b3R5cGUsIFwib3BlbmVkXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBPdXRwdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgRXZlbnRFbWl0dGVyKVxuXSwgTXVsdGlTZWxlY3RUcmVlQ29tcG9uZW50LnByb3RvdHlwZSwgXCJjbG9zZVwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgT3V0cHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEV2ZW50RW1pdHRlcilcbl0sIE11bHRpU2VsZWN0VHJlZUNvbXBvbmVudC5wcm90b3R5cGUsIFwiY2xvc2VkXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBPdXRwdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgRXZlbnRFbWl0dGVyKVxuXSwgTXVsdGlTZWxlY3RUcmVlQ29tcG9uZW50LnByb3RvdHlwZSwgXCJub2RlRXhwYW5kXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBPdXRwdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgRXZlbnRFbWl0dGVyKVxuXSwgTXVsdGlTZWxlY3RUcmVlQ29tcG9uZW50LnByb3RvdHlwZSwgXCJub2RlQ29sbGFwc2VcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIE91dHB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBFdmVudEVtaXR0ZXIpXG5dLCBNdWx0aVNlbGVjdFRyZWVDb21wb25lbnQucHJvdG90eXBlLCBcInZhbHVlQ2hhbmdlXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBPdXRwdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgRXZlbnRFbWl0dGVyKVxuXSwgTXVsdGlTZWxlY3RUcmVlQ29tcG9uZW50LnByb3RvdHlwZSwgXCJyZW1vdmVUYWdcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIE91dHB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBFdmVudEVtaXR0ZXIpXG5dLCBNdWx0aVNlbGVjdFRyZWVDb21wb25lbnQucHJvdG90eXBlLCBcImZpbHRlckNoYW5nZVwiLCB2b2lkIDApO1xuTXVsdGlTZWxlY3RUcmVlQ29tcG9uZW50ID0gTXVsdGlTZWxlY3RUcmVlQ29tcG9uZW50XzEgPSBfX2RlY29yYXRlKFtcbiAgICBDb21wb25lbnQoe1xuICAgICAgICBleHBvcnRBczogJ2tlbmRvTXVsdGlTZWxlY3RUcmVlJyxcbiAgICAgICAgcHJvdmlkZXJzOiBbXG4gICAgICAgICAgICBMb2NhbGl6YXRpb25TZXJ2aWNlLFxuICAgICAgICAgICAgTmF2aWdhdGlvblNlcnZpY2UsXG4gICAgICAgICAgICBEYXRhU2VydmljZSxcbiAgICAgICAgICAgIERpc2FibGVkSXRlbXNTZXJ2aWNlLFxuICAgICAgICAgICAgU2VsZWN0aW9uU2VydmljZSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBwcm92aWRlOiBMMTBOX1BSRUZJWCxcbiAgICAgICAgICAgICAgICB1c2VWYWx1ZTogJ2tlbmRvLm11bHRpc2VsZWN0dHJlZSdcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgbXVsdGk6IHRydWUsXG4gICAgICAgICAgICAgICAgcHJvdmlkZTogTkdfVkFMVUVfQUNDRVNTT1IsXG4gICAgICAgICAgICAgICAgdXNlRXhpc3Rpbmc6IGZvcndhcmRSZWYoKCkgPT4gTXVsdGlTZWxlY3RUcmVlQ29tcG9uZW50XzEpXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHByb3ZpZGU6IERhdGFCb3VuZENvbXBvbmVudCxcbiAgICAgICAgICAgICAgICB1c2VFeGlzdGluZzogZm9yd2FyZFJlZigoKSA9PiBNdWx0aVNlbGVjdFRyZWVDb21wb25lbnRfMSlcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcHJvdmlkZTogRXhwYW5kYWJsZUNvbXBvbmVudCxcbiAgICAgICAgICAgICAgICB1c2VFeGlzdGluZzogZm9yd2FyZFJlZigoKSA9PiBNdWx0aVNlbGVjdFRyZWVDb21wb25lbnRfMSlcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcHJvdmlkZTogS2VuZG9JbnB1dCxcbiAgICAgICAgICAgICAgICB1c2VFeGlzdGluZzogZm9yd2FyZFJlZigoKSA9PiBNdWx0aVNlbGVjdFRyZWVDb21wb25lbnRfMSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgXSxcbiAgICAgICAgc2VsZWN0b3I6ICdrZW5kby1tdWx0aXNlbGVjdHRyZWUnLFxuICAgICAgICB0ZW1wbGF0ZTogYFxuICAgICAgICA8bmctY29udGFpbmVyIGtlbmRvTXVsdGlTZWxlY3RUcmVlTG9jYWxpemVkTWVzc2FnZXNcbiAgICAgICAgICAgIGkxOG4tbm9EYXRhVGV4dD1cImtlbmRvLm11bHRpc2VsZWN0dHJlZS5ub0RhdGFUZXh0fFRoZSB0ZXh0IGRpc3BsYXllZCBpbiB0aGUgcG9wdXAgd2hlbiB0aGVyZSBhcmUgbm8gaXRlbXNcIlxuICAgICAgICAgICAgbm9EYXRhVGV4dD1cIk5PIERBVEEgRk9VTkRcIlxuXG4gICAgICAgICAgICBpMThuLWNsZWFyVGl0bGU9XCJrZW5kby5tdWx0aXNlbGVjdHRyZWUuY2xlYXJUaXRsZXxUaGUgdGl0bGUgb2YgdGhlIGNsZWFyIGJ1dHRvblwiXG4gICAgICAgICAgICBjbGVhclRpdGxlPVwiY2xlYXJcIlxuXG4gICAgICAgICAgICBpMThuLWNoZWNrQWxsVGV4dD1cImtlbmRvLm11bHRpc2VsZWN0dHJlZS5jaGVja0FsbFRleHR8VGhlIHRleHQgZGlzcGxheWVkIGZvciB0aGUgY2hlY2stYWxsIGNoZWNrYm94XCJcbiAgICAgICAgICAgIGNoZWNrQWxsVGV4dD1cIkNoZWNrIGFsbFwiXG4gICAgICAgID5cbiAgICAgICAgPC9uZy1jb250YWluZXI+XG4gICAgICAgIDxrZW5kby10YWdsaXN0XG4gICAgICAgICAgICBbc2l6ZV09XCJzaXplXCJcbiAgICAgICAgICAgIFtyb3VuZGVkXT1cInJvdW5kZWRcIlxuICAgICAgICAgICAgW2ZpbGxNb2RlXT1cImZpbGxNb2RlXCJcbiAgICAgICAgICAgIFtpZF09XCJ0YWdMaXN0SWRcIlxuICAgICAgICAgICAgW3RhZ3NdPVwidGFnc1wiXG4gICAgICAgICAgICBbZm9jdXNlZF09XCJmb2N1c2VkVGFnSW5kZXhcIlxuICAgICAgICAgICAgW3RleHRGaWVsZF09XCJ0ZXh0RmllbGRcIlxuICAgICAgICAgICAgW3ZhbHVlRmllbGRdPVwidmFsdWVGaWVsZFwiXG4gICAgICAgICAgICBbdmFsdWVEZXB0aF09XCJ2YWx1ZURlcHRoXCJcbiAgICAgICAgICAgIFtkaXNhYmxlZF09XCJkaXNhYmxlZFwiXG4gICAgICAgICAgICBbdGFnUHJlZml4XT1cInRhZ1ByZWZpeFwiXG4gICAgICAgICAgICBbdGVtcGxhdGVdPVwidGFnVGVtcGxhdGVcIlxuICAgICAgICAgICAgW2dyb3VwVGVtcGxhdGVdPVwiZ3JvdXBUYWdUZW1wbGF0ZVwiXG4gICAgICAgICAgICBbZGlzYWJsZWRJbmRpY2VzXT1cImRpc2FibGVkSW5kaWNlc1wiXG4gICAgICAgICAgICAocmVtb3ZlVGFnKT1cImhhbmRsZVJlbW92ZVRhZygkZXZlbnQpXCJcbiAgICAgICAgPlxuICAgICAgICAgICAgPHNwYW4gKm5nSWY9XCIhdGFncyB8fCAhdGFncy5sZW5ndGhcIlxuICAgICAgICAgICAgICAgIGNsYXNzPVwiay1pbnB1dC1pbm5lciBrLXJlYWRvbmx5XCJcbiAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cImstaW5wdXQtdmFsdWUtdGV4dFwiPnt7IHBsYWNlaG9sZGVyIH19PC9zcGFuPlxuICAgICAgICAgICAgPC9zcGFuPlxuICAgICAgICA8L2tlbmRvLXRhZ2xpc3Q+XG4gICAgICAgIDxzcGFuXG4gICAgICAgICAgICAqbmdJZj1cIiFkaXNhYmxlZCAmJiAhbG9hZGluZyAmJiAhcmVhZG9ubHkgJiYgY2xlYXJCdXR0b24gJiYgdGFncz8ubGVuZ3RoXCJcbiAgICAgICAgICAgIGNsYXNzPVwiay1jbGVhci12YWx1ZVwiXG4gICAgICAgICAgICBbYXR0ci50aXRsZV09XCJtZXNzYWdlRm9yKCdjbGVhclRpdGxlJylcIlxuICAgICAgICAgICAgcm9sZT1cImJ1dHRvblwiXG4gICAgICAgICAgICB0YWJpbmRleD1cIi0xXCJcbiAgICAgICAgICAgIChjbGljayk9XCJjbGVhckFsbCgkZXZlbnQpXCJcbiAgICAgICAgPlxuICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJrLWljb24gay1pLXhcIj48L3NwYW4+XG4gICAgICAgIDwvc3Bhbj5cbiAgICAgICAgPHNwYW5cbiAgICAgICAgICAgICpuZ0lmPVwibG9hZGluZ1wiXG4gICAgICAgICAgICBjbGFzcz1cImstaWNvbiBrLWktbG9hZGluZ1wiXG4gICAgICAgID5cbiAgICAgICAgPC9zcGFuPlxuICAgICAgICA8bmctdGVtcGxhdGUgI3BvcHVwVGVtcGxhdGU+XG4gICAgICAgICAgICA8c3BhblxuICAgICAgICAgICAgICAgICpuZ0lmPVwiZmlsdGVyYWJsZVwiXG4gICAgICAgICAgICAgICAgY2xhc3M9XCJrLWxpc3QtZmlsdGVyXCJcbiAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICA8c3BhblxuICAgICAgICAgICAgICAgICAgICBjbGFzcz1cImstdGV4dGJveCBrLWlucHV0XCJcbiAgICAgICAgICAgICAgICAgICAgW25nQ2xhc3NdPVwiZmlsdGVySW5wdXRDbGFzc2VzXCJcbiAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwiay1pbnB1dC1wcmVmaXhcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwiay1pbnB1dC1pY29uIGstaWNvbiBrLWktc2VhcmNoXCI+PC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgIDxpbnB1dFxuICAgICAgICAgICAgICAgICAgICAgICAgI2ZpbHRlcklucHV0XG4gICAgICAgICAgICAgICAgICAgICAgICAoaW5wdXQpPVwiaGFuZGxlRmlsdGVySW5wdXRDaGFuZ2UoJGV2ZW50LnRhcmdldC52YWx1ZSlcIlxuICAgICAgICAgICAgICAgICAgICAgICAgW2ZpbHRlcklucHV0XT1cImZpbHRlcmFibGUgJiYgIXRvdWNoRW5hYmxlZFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAoa2V5ZG93bik9XCJoYW5kbGVLZXlkb3duKCRldmVudClcIlxuICAgICAgICAgICAgICAgICAgICAgICAgWyhuZ01vZGVsKV09XCJmaWx0ZXJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3M9XCJrLWlucHV0LWlubmVyXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJvbGU9XCJ0ZXh0Ym94XCJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyaWEtaGFzcG9wdXA9XCJ0cnVlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyaWEtZXhwYW5kZWQ9XCJmYWxzZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWJpbmRleD1cIjBcIlxuICAgICAgICAgICAgICAgICAgICAgICAgYXJpYS1kaXNhYmxlZD1cImZhbHNlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyaWEtcmVhZG9ubHk9XCJmYWxzZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICBba2VuZG9FdmVudHNPdXRzaWRlQW5ndWxhcl09XCJ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYmx1cjogaGFuZGxlQmx1clxuICAgICAgICAgICAgICAgICAgICAgICAgfVwiXG4gICAgICAgICAgICAgICAgICAgICAgICBbc2NvcGVdPVwidGhpc1wiXG4gICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICA8IS0taGVhZGVyIHRlbXBsYXRlLS0+XG4gICAgICAgICAgICA8bmctdGVtcGxhdGVcbiAgICAgICAgICAgICAgICAqbmdJZj1cImhlYWRlclRlbXBsYXRlXCJcbiAgICAgICAgICAgICAgICBbdGVtcGxhdGVDb250ZXh0XT1cIntcbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVSZWY6IGhlYWRlclRlbXBsYXRlPy50ZW1wbGF0ZVJlZlxuICAgICAgICAgICAgICAgIH1cIj5cbiAgICAgICAgICAgIDwvbmctdGVtcGxhdGU+XG4gICAgICAgICAgICA8ZGl2ICpuZ0lmPVwiY2hlY2tBbGxcIiBjbGFzcz1cImstY2hlY2stYWxsXCI+XG4gICAgICAgICAgICAgICAgPGlucHV0XG4gICAgICAgICAgICAgICAgICAgICNjaGVja0FsbElucHV0XG4gICAgICAgICAgICAgICAgICAgIFtjaGVja0FsbF09XCIhZmlsdGVyYWJsZSAmJiAhdG91Y2hFbmFibGVkXCJcbiAgICAgICAgICAgICAgICAgICAgdHlwZT1cImNoZWNrYm94XCJcbiAgICAgICAgICAgICAgICAgICAgY2xhc3M9XCJrLWNoZWNrYm94XCJcbiAgICAgICAgICAgICAgICAgICAgW25nQ2xhc3NdPVwiY2hlY2tBbGxDaGVja2JveENsYXNzZXNcIlxuICAgICAgICAgICAgICAgICAgICByb2xlPVwiY2hlY2tib3hcIlxuICAgICAgICAgICAgICAgICAgICB0YWJpbmRleD1cIjBcIlxuICAgICAgICAgICAgICAgICAgICBhcmlhLWRpc2FibGVkPVwiZmFsc2VcIlxuICAgICAgICAgICAgICAgICAgICBhcmlhLXJlYWRvbmx5PVwiZmFsc2VcIlxuICAgICAgICAgICAgICAgICAgICBbdHJlZXZpZXddPVwidHJlZXZpZXdcIlxuICAgICAgICAgICAgICAgICAgICBbY2hlY2tlZEl0ZW1zXT1cImNoZWNrZWRJdGVtc1wiXG4gICAgICAgICAgICAgICAgICAgIFt2YWx1ZUZpZWxkXT1cInZhbHVlRmllbGRcIlxuICAgICAgICAgICAgICAgICAgICBbbGFzdEFjdGlvbl09XCJsYXN0QWN0aW9uXCJcbiAgICAgICAgICAgICAgICAgICAgKGNoZWNrZWRJdGVtc0NoYW5nZSk9XCJoYW5kbGVDaGVja2VkSXRlbXNDaGFuZ2UoJGV2ZW50KVwiXG4gICAgICAgICAgICAgICAgICAgIChrZXlkb3duKT1cImhhbmRsZUtleWRvd24oJGV2ZW50KVwiXG4gICAgICAgICAgICAgICAgICAgIFtrZW5kb0V2ZW50c091dHNpZGVBbmd1bGFyXT1cIntcbiAgICAgICAgICAgICAgICAgICAgICAgIGJsdXI6IGhhbmRsZUJsdXJcbiAgICAgICAgICAgICAgICAgICAgfVwiXG4gICAgICAgICAgICAgICAgICAgIFtzY29wZV09XCJ0aGlzXCJcbiAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgPHNwYW5cbiAgICAgICAgICAgICAgICAgICAgY2xhc3M9XCJrLWNoZWNrYm94LWxhYmVsXCJcbiAgICAgICAgICAgICAgICAgICAgKGNsaWNrKT1cInRvZ2dsZUNoZWNrQWxsKClcIlxuICAgICAgICAgICAgICAgICAgICAobW91c2Vkb3duKT1cIiRldmVudC5wcmV2ZW50RGVmYXVsdCgpXCJcbiAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgIHt7IG1lc3NhZ2VGb3IoJ2NoZWNrQWxsVGV4dCcpIH19XG4gICAgICAgICAgICAgICAgPC9zcGFuPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8a2VuZG8tdHJlZXZpZXdcbiAgICAgICAgICAgICAgICAjdHJlZXZpZXdcbiAgICAgICAgICAgICAgICBbc2l6ZV09XCJzaXplXCJcbiAgICAgICAgICAgICAgICBbbm9kZXNdPVwiZGF0YVwiXG4gICAgICAgICAgICAgICAgW3N0eWxlLm1heEhlaWdodC5weF09XCJsaXN0SGVpZ2h0XCJcbiAgICAgICAgICAgICAgICBbYW5pbWF0ZV09XCJmYWxzZVwiXG4gICAgICAgICAgICAgICAga2VuZG9NdWx0aVNlbGVjdFRyZWVDaGVja2FibGVcbiAgICAgICAgICAgICAgICBbY2hlY2thYmxlXT1cImNoZWNrYWJsZVNldHRpbmdzXCJcbiAgICAgICAgICAgICAgICBbY2hlY2tlZEl0ZW1zXT1cImNoZWNrZWRJdGVtc1wiXG4gICAgICAgICAgICAgICAgW3ZhbHVlRmllbGRdPVwidmFsdWVGaWVsZFwiXG4gICAgICAgICAgICAgICAgW3RleHRGaWVsZF09XCJ0ZXh0RmllbGRcIlxuICAgICAgICAgICAgICAgIFtjaGlsZHJlbl09XCJjaGlsZHJlblwiXG4gICAgICAgICAgICAgICAgW2hhc0NoaWxkcmVuXT1cImhhc0NoaWxkcmVuXCJcbiAgICAgICAgICAgICAgICBbaXNFeHBhbmRlZF09XCJpc05vZGVFeHBhbmRlZFwiXG4gICAgICAgICAgICAgICAgW2lzRGlzYWJsZWRdPVwiaXRlbURpc2FibGVkXCJcbiAgICAgICAgICAgICAgICBbbm9kZVRlbXBsYXRlXT1cIm5vZGVUZW1wbGF0ZVwiXG4gICAgICAgICAgICAgICAgW2xvYWRPbkRlbWFuZF09XCJsb2FkT25EZW1hbmRcIlxuICAgICAgICAgICAgICAgIFtmaWx0ZXJdPVwiZmlsdGVyXCJcbiAgICAgICAgICAgICAgICBbaXNWaXNpYmxlXT1cImlzTm9kZVZpc2libGVcIlxuICAgICAgICAgICAgICAgIChrZXlkb3duKT1cImhhbmRsZUtleWRvd24oJGV2ZW50KVwiXG4gICAgICAgICAgICAgICAgKG5vZGVDbGljayk9XCJoYW5kbGVOb2RlQ2xpY2soJGV2ZW50KVwiXG4gICAgICAgICAgICAgICAgKGV4cGFuZCk9XCJub2RlRXhwYW5kLmVtaXQoJGV2ZW50KVwiXG4gICAgICAgICAgICAgICAgKGNvbGxhcHNlKT1cIm5vZGVDb2xsYXBzZS5lbWl0KCRldmVudClcIlxuICAgICAgICAgICAgICAgIChjaGVja2VkSXRlbXNDaGFuZ2UpPVwiaGFuZGxlQ2hlY2tlZEl0ZW1zQ2hhbmdlKCRldmVudClcIlxuICAgICAgICAgICAgICAgIFtrZW5kb0V2ZW50c091dHNpZGVBbmd1bGFyXT1cIntcbiAgICAgICAgICAgICAgICAgICAgZm9jdXNvdXQ6IGhhbmRsZUJsdXJcbiAgICAgICAgICAgICAgICB9XCJcbiAgICAgICAgICAgICAgICBbc2NvcGVdPVwidGhpc1wiXG4gICAgICAgICAgICA+XG4gICAgICAgICAgICA8L2tlbmRvLXRyZWV2aWV3PlxuICAgICAgICAgICAgPCEtLWZvb3RlciB0ZW1wbGF0ZS0tPlxuICAgICAgICAgICAgPG5nLXRlbXBsYXRlXG4gICAgICAgICAgICAgICAgKm5nSWY9XCJmb290ZXJUZW1wbGF0ZVwiXG4gICAgICAgICAgICAgICAgW3RlbXBsYXRlQ29udGV4dF09XCJ7XG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlUmVmOiBmb290ZXJUZW1wbGF0ZT8udGVtcGxhdGVSZWZcbiAgICAgICAgICAgICAgICB9XCI+XG4gICAgICAgICAgICA8L25nLXRlbXBsYXRlPlxuICAgICAgICAgICAgPCEtLW5vLWRhdGEgdGVtcGxhdGUtLT5cbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJrLW5vLWRhdGFcIiAqbmdJZj1cImRhdGE/Lmxlbmd0aCA9PT0gMCB8fCBhbGxOb2Rlc0hpZGRlblwiPlxuICAgICAgICAgICAgICAgIDxuZy10ZW1wbGF0ZSBbbmdJZl09XCJub0RhdGFUZW1wbGF0ZVwiXG4gICAgICAgICAgICAgICAgICAgIFt0ZW1wbGF0ZUNvbnRleHRdPVwie1xuICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVSZWY6IG5vRGF0YVRlbXBsYXRlPy50ZW1wbGF0ZVJlZlxuICAgICAgICAgICAgICAgICAgICB9XCI+XG4gICAgICAgICAgICAgICAgPC9uZy10ZW1wbGF0ZT5cbiAgICAgICAgICAgICAgICA8bmctdGVtcGxhdGUgW25nSWZdPVwiIW5vRGF0YVRlbXBsYXRlXCI+XG4gICAgICAgICAgICAgICAgICAgIDxkaXY+e3sgbWVzc2FnZUZvcignbm9EYXRhVGV4dCcpIH19PC9kaXY+XG4gICAgICAgICAgICAgICAgPC9uZy10ZW1wbGF0ZT5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L25nLXRlbXBsYXRlPlxuICAgICAgICA8bmctY29udGFpbmVyICNjb250YWluZXI+PC9uZy1jb250YWluZXI+XG4gICAgYFxuICAgIH0pLFxuICAgIF9fcGFyYW0oNywgT3B0aW9uYWwoKSksIF9fcGFyYW0oNywgSW5qZWN0KFRPVUNIX0VOQUJMRUQpKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnBhcmFtdHlwZXNcIiwgW0VsZW1lbnRSZWYsXG4gICAgICAgIFBvcHVwU2VydmljZSxcbiAgICAgICAgUmVuZGVyZXIyLFxuICAgICAgICBOYXZpZ2F0aW9uU2VydmljZSxcbiAgICAgICAgTmdab25lLFxuICAgICAgICBMb2NhbGl6YXRpb25TZXJ2aWNlLFxuICAgICAgICBDaGFuZ2VEZXRlY3RvclJlZiwgQm9vbGVhbl0pXG5dLCBNdWx0aVNlbGVjdFRyZWVDb21wb25lbnQpO1xuXG4vKipcbiAqIEEgZGlyZWN0aXZlIHdoaWNoIGVuY2Fwc3VsYXRlcyB0aGUgcmV0cmlldmFsIG9mIHRoZSBjaGlsZCBub2RlcyB3aGVuIGZsYXQgZGF0YSBpcyBwcm92aWRlZC5cbiAqL1xubGV0IERyb3BEb3duVHJlZUZsYXRCaW5kaW5nRGlyZWN0aXZlID0gY2xhc3MgRHJvcERvd25UcmVlRmxhdEJpbmRpbmdEaXJlY3RpdmUgZXh0ZW5kcyBGbGF0RGF0YUJpbmRpbmdEaXJlY3RpdmUge1xuICAgIGNvbnN0cnVjdG9yKGRyb3BEb3duVHJlZSkge1xuICAgICAgICBzdXBlcihkcm9wRG93blRyZWUpO1xuICAgIH1cbn07XG5fX2RlY29yYXRlKFtcbiAgICBJbnB1dCgna2VuZG9Ecm9wRG93blRyZWVGbGF0QmluZGluZycpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBBcnJheSlcbl0sIERyb3BEb3duVHJlZUZsYXRCaW5kaW5nRGlyZWN0aXZlLnByb3RvdHlwZSwgXCJub2Rlc1wiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgSW5wdXQoJ3ZhbHVlRmllbGQnKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgU3RyaW5nKVxuXSwgRHJvcERvd25UcmVlRmxhdEJpbmRpbmdEaXJlY3RpdmUucHJvdG90eXBlLCBcImlkRmllbGRcIiwgdm9pZCAwKTtcbkRyb3BEb3duVHJlZUZsYXRCaW5kaW5nRGlyZWN0aXZlID0gX19kZWNvcmF0ZShbXG4gICAgRGlyZWN0aXZlKHtcbiAgICAgICAgc2VsZWN0b3I6ICdba2VuZG9Ecm9wRG93blRyZWVGbGF0QmluZGluZ10nXG4gICAgfSksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjpwYXJhbXR5cGVzXCIsIFtEYXRhQm91bmRDb21wb25lbnRdKVxuXSwgRHJvcERvd25UcmVlRmxhdEJpbmRpbmdEaXJlY3RpdmUpO1xuXG4vKipcbiAqIEEgZGlyZWN0aXZlIHdoaWNoIGVuY2Fwc3VsYXRlcyB0aGUgcmV0cmlldmFsIG9mIHRoZSBjaGlsZCBub2RlcyB3aGVuIGhpZXJhcmNoaWNhbCBkYXRhIGlzIHByb3ZpZGVkLlxuICovXG5sZXQgRHJvcERvd25UcmVlSGllcmFyY2h5QmluZGluZ0RpcmVjdGl2ZSA9IGNsYXNzIERyb3BEb3duVHJlZUhpZXJhcmNoeUJpbmRpbmdEaXJlY3RpdmUgZXh0ZW5kcyBIaWVyYXJjaHlCaW5kaW5nRGlyZWN0aXZlIHtcbiAgICBjb25zdHJ1Y3Rvcihkcm9wRG93blRyZWUpIHtcbiAgICAgICAgc3VwZXIoZHJvcERvd25UcmVlKTtcbiAgICAgICAgdGhpcy5kcm9wRG93blRyZWUgPSBkcm9wRG93blRyZWU7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRoZSBub2RlcyB3aGljaCB3aWxsIGJlIGRpc3BsYXllZCBieSB0aGUgRHJvcERvd25UcmVlLlxuICAgICAqL1xuICAgIHNldCBkYXRhKG5vZGVzKSB7XG4gICAgICAgIHRoaXMuZHJvcERvd25UcmVlLm5vZGVzID0gbm9kZXM7XG4gICAgICAgIHRoaXMubm9kZXMgPSBub2RlcztcbiAgICB9XG59O1xuX19kZWNvcmF0ZShbXG4gICAgSW5wdXQoJ2tlbmRvRHJvcERvd25UcmVlSGllcmFyY2h5QmluZGluZycpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBBcnJheSksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjpwYXJhbXR5cGVzXCIsIFtBcnJheV0pXG5dLCBEcm9wRG93blRyZWVIaWVyYXJjaHlCaW5kaW5nRGlyZWN0aXZlLnByb3RvdHlwZSwgXCJkYXRhXCIsIG51bGwpO1xuRHJvcERvd25UcmVlSGllcmFyY2h5QmluZGluZ0RpcmVjdGl2ZSA9IF9fZGVjb3JhdGUoW1xuICAgIERpcmVjdGl2ZSh7XG4gICAgICAgIHNlbGVjdG9yOiAnW2tlbmRvRHJvcERvd25UcmVlSGllcmFyY2h5QmluZGluZ10nXG4gICAgfSksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjpwYXJhbXR5cGVzXCIsIFtEYXRhQm91bmRDb21wb25lbnRdKVxuXSwgRHJvcERvd25UcmVlSGllcmFyY2h5QmluZGluZ0RpcmVjdGl2ZSk7XG5cbi8qKlxuICogQSBkaXJlY3RpdmUgd2hpY2ggZW5jYXBzdWxhdGVzIHRoZSByZXRyaWV2YWwgb2YgdGhlIGNoaWxkIG5vZGVzIHdoZW4gZmxhdCBkYXRhIGlzIHByb3ZpZGVkLlxuICovXG5sZXQgTXVsdGlTZWxlY3RUcmVlRmxhdEJpbmRpbmdEaXJlY3RpdmUgPSBjbGFzcyBNdWx0aVNlbGVjdFRyZWVGbGF0QmluZGluZ0RpcmVjdGl2ZSBleHRlbmRzIEZsYXREYXRhQmluZGluZ0RpcmVjdGl2ZSB7XG4gICAgY29uc3RydWN0b3IobXVsdGlTZWxlY3RUcmVlKSB7XG4gICAgICAgIHN1cGVyKG11bHRpU2VsZWN0VHJlZSk7XG4gICAgfVxufTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCdrZW5kb011bHRpU2VsZWN0VHJlZUZsYXRCaW5kaW5nJyksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEFycmF5KVxuXSwgTXVsdGlTZWxlY3RUcmVlRmxhdEJpbmRpbmdEaXJlY3RpdmUucHJvdG90eXBlLCBcIm5vZGVzXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBJbnB1dCgndmFsdWVGaWVsZCcpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBTdHJpbmcpXG5dLCBNdWx0aVNlbGVjdFRyZWVGbGF0QmluZGluZ0RpcmVjdGl2ZS5wcm90b3R5cGUsIFwiaWRGaWVsZFwiLCB2b2lkIDApO1xuTXVsdGlTZWxlY3RUcmVlRmxhdEJpbmRpbmdEaXJlY3RpdmUgPSBfX2RlY29yYXRlKFtcbiAgICBEaXJlY3RpdmUoe1xuICAgICAgICBzZWxlY3RvcjogJ1trZW5kb011bHRpU2VsZWN0VHJlZUZsYXRCaW5kaW5nXSdcbiAgICB9KSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnBhcmFtdHlwZXNcIiwgW0RhdGFCb3VuZENvbXBvbmVudF0pXG5dLCBNdWx0aVNlbGVjdFRyZWVGbGF0QmluZGluZ0RpcmVjdGl2ZSk7XG5cbi8qKlxuICogQSBkaXJlY3RpdmUgd2hpY2ggZW5jYXBzdWxhdGVzIHRoZSByZXRyaWV2YWwgb2YgdGhlIGNoaWxkIG5vZGVzIHdoZW4gaGllcmFyY2hpY2FsIGRhdGEgaXMgcHJvdmlkZWQuXG4gKi9cbmxldCBNdWx0aVNlbGVjdFRyZWVIaWVyYXJjaHlCaW5kaW5nRGlyZWN0aXZlID0gY2xhc3MgTXVsdGlTZWxlY3RUcmVlSGllcmFyY2h5QmluZGluZ0RpcmVjdGl2ZSBleHRlbmRzIEhpZXJhcmNoeUJpbmRpbmdEaXJlY3RpdmUge1xuICAgIGNvbnN0cnVjdG9yKG11bHRpU2VsZWN0VHJlZSkge1xuICAgICAgICBzdXBlcihtdWx0aVNlbGVjdFRyZWUpO1xuICAgICAgICB0aGlzLm11bHRpU2VsZWN0VHJlZSA9IG11bHRpU2VsZWN0VHJlZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVGhlIG5vZGVzIHdoaWNoIHdpbGwgYmUgZGlzcGxheWVkIGJ5IHRoZSBNdWx0aVNlbGVjdFRyZWUuXG4gICAgICovXG4gICAgc2V0IGRhdGEobm9kZXMpIHtcbiAgICAgICAgdGhpcy5tdWx0aVNlbGVjdFRyZWUubm9kZXMgPSBub2RlcztcbiAgICAgICAgdGhpcy5ub2RlcyA9IG5vZGVzO1xuICAgIH1cbn07XG5fX2RlY29yYXRlKFtcbiAgICBJbnB1dCgna2VuZG9NdWx0aVNlbGVjdFRyZWVIaWVyYXJjaHlCaW5kaW5nJyksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEFycmF5KSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnBhcmFtdHlwZXNcIiwgW0FycmF5XSlcbl0sIE11bHRpU2VsZWN0VHJlZUhpZXJhcmNoeUJpbmRpbmdEaXJlY3RpdmUucHJvdG90eXBlLCBcImRhdGFcIiwgbnVsbCk7XG5NdWx0aVNlbGVjdFRyZWVIaWVyYXJjaHlCaW5kaW5nRGlyZWN0aXZlID0gX19kZWNvcmF0ZShbXG4gICAgRGlyZWN0aXZlKHtcbiAgICAgICAgc2VsZWN0b3I6ICdba2VuZG9NdWx0aVNlbGVjdFRyZWVIaWVyYXJjaHlCaW5kaW5nXSdcbiAgICB9KSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnBhcmFtdHlwZXNcIiwgW0RhdGFCb3VuZENvbXBvbmVudF0pXG5dLCBNdWx0aVNlbGVjdFRyZWVIaWVyYXJjaHlCaW5kaW5nRGlyZWN0aXZlKTtcblxuLyoqXG4gKiBBIGRpcmVjdGl2ZSB3aGljaCBtYW5hZ2VzIHRoZSBleHBhbmRlZCBzdGF0ZSBvZiB0aGUgcG9wdXAgVHJlZVZpZXcuXG4gKi9cbmxldCBEcm9wRG93blRyZWVzRXhwYW5kRGlyZWN0aXZlID0gY2xhc3MgRHJvcERvd25UcmVlc0V4cGFuZERpcmVjdGl2ZSBleHRlbmRzIEV4cGFuZERpcmVjdGl2ZSB7XG4gICAgY29uc3RydWN0b3IoZHJvcERvd25UcmVlKSB7XG4gICAgICAgIHN1cGVyKGRyb3BEb3duVHJlZSk7XG4gICAgfVxufTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCdpc05vZGVFeHBhbmRlZCcpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBGdW5jdGlvbilcbl0sIERyb3BEb3duVHJlZXNFeHBhbmREaXJlY3RpdmUucHJvdG90eXBlLCBcImlzRXhwYW5kZWRcIiwgdm9pZCAwKTtcbkRyb3BEb3duVHJlZXNFeHBhbmREaXJlY3RpdmUgPSBfX2RlY29yYXRlKFtcbiAgICBEaXJlY3RpdmUoe1xuICAgICAgICBzZWxlY3RvcjogJ1trZW5kb0Ryb3BEb3duVHJlZUV4cGFuZGFibGVdLCBba2VuZG9NdWx0aVNlbGVjdFRyZWVFeHBhbmRhYmxlXSdcbiAgICB9KSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnBhcmFtdHlwZXNcIiwgW0V4cGFuZGFibGVDb21wb25lbnRdKVxuXSwgRHJvcERvd25UcmVlc0V4cGFuZERpcmVjdGl2ZSk7XG5cbi8qKlxuICogQGhpZGRlblxuICovXG5sZXQgVGFnTGlzdENvbXBvbmVudCA9IGNsYXNzIFRhZ0xpc3RDb21wb25lbnQge1xuICAgIGNvbnN0cnVjdG9yKHJlbmRlcmVyLCBob3N0RWxlbWVudCkge1xuICAgICAgICB0aGlzLnJlbmRlcmVyID0gcmVuZGVyZXI7XG4gICAgICAgIHRoaXMuaG9zdEVsZW1lbnQgPSBob3N0RWxlbWVudDtcbiAgICAgICAgdGhpcy5yb3VuZGVkID0gJ21lZGl1bSc7XG4gICAgICAgIHRoaXMuZmlsbE1vZGUgPSAnc29saWQnO1xuICAgICAgICAvKipcbiAgICAgICAgICogQSBjb2xsZWN0aW9uIHdpdGggdGhlIGRpc2FibGVkIHRhZ3MnIGluZGljZXMuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmRpc2FibGVkSW5kaWNlcyA9IG5ldyBTZXQoKTtcbiAgICAgICAgdGhpcy5yZW1vdmVUYWcgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gICAgICAgIHRoaXMuaG9zdENsYXNzZXMgPSB0cnVlO1xuICAgICAgICB0aGlzLl9zaXplID0gJ21lZGl1bSc7XG4gICAgfVxuICAgIHNldCBzaXplKHNpemUpIHtcbiAgICAgICAgdGhpcy5yZW5kZXJlci5yZW1vdmVDbGFzcyh0aGlzLmhvc3RFbGVtZW50Lm5hdGl2ZUVsZW1lbnQsIGdldFNpemVDbGFzcygnY2hpcC1saXN0JywgdGhpcy5zaXplKSk7XG4gICAgICAgIGlmIChzaXplKSB7XG4gICAgICAgICAgICB0aGlzLnJlbmRlcmVyLmFkZENsYXNzKHRoaXMuaG9zdEVsZW1lbnQubmF0aXZlRWxlbWVudCwgZ2V0U2l6ZUNsYXNzKCdjaGlwLWxpc3QnLCBzaXplKSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fc2l6ZSA9IHNpemU7XG4gICAgfVxuICAgIGdldCBzaXplKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fc2l6ZTtcbiAgICB9XG4gICAgZ2V0IGhvc3RJZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaWQ7XG4gICAgfVxuICAgIHRhZ1Byb3AodGFnLCBwcm9wLCBpbmRleCkge1xuICAgICAgICBjb25zdCBwcm9wRmllbGQgPSBwcm9wICYmIHRoaXMuZ2V0UHJvcEZpZWxkKHRhZywgcHJvcCwgaW5kZXgpO1xuICAgICAgICByZXR1cm4gZ2V0dGVyJDEodGFnLCBwcm9wRmllbGQpO1xuICAgIH1cbiAgICBpc1RhZ0Rpc2FibGVkKHRhZywgcG9zaXRpb25JbmRleCkge1xuICAgICAgICBpZiAodGhpcy5pc0dyb3VwVGFnKHRhZykpIHtcbiAgICAgICAgICAgIC8qKiBUaGUgYHBvc2l0aW9uSW5kZXhgIGlzIHVzZWQgdG8gZGV0ZXJtaW5lIGFmdGVyIGhvdyBtYW55IHNpbmdsZSB0YWdzIGlzIHRoZSBncm91cCB0YWcgZGlzcGxheWVkID0+XG4gICAgICAgICAgICAgKiA9PiBpdCBpcyB1c2VkIHRvIGluY3JlbWVudCB0aGUgaW5kaWNlcyBpbnNpZGUgdGhlIGdyb3VwIHRhZyBzbyB0aGF0IHdlIGRldGVybWluZSB0aGUgYWN0dWFsIHBvc2l0aW9uIGluZGV4XG4gICAgICAgICAgICAgKiBvZiBlYWNoIGdyb3VwIHRhZyBpdGVtIGFzIHRoZXkgYXBwZWFyIGluIHRoZSBgdmFsdWVgIChpbXBvcnRhbnQgdG8gY2hlY2sgYWdhaW5zdCBgZGlzYWJsZWRJbmRpY2VzYClcbiAgICAgICAgICAgICAqIGUuZy4gYGRpc2FibGVkSW5kaWNlcyA9IFswLCAxXWAgJiYgYHRhZ3MgPSBbJ1NtYWxsJywgWydNZWRpdW0nLCAnTGFyZ2UnXV1gID0+IHdpdGhvdXQgdGhlIGluY3JlbWVudGF0aW9uIHdpdGhcbiAgICAgICAgICAgICAqIGBwb3NpdGlvbkluZGV4YCwgdGhlIGdyb3VwIHRhZyB3b3VsZCB5aWVsZCBbMCwgMV0gYXMgaW5kaWNlcywgd2hpbGUgaXQgc2hvdWxkIHlpZWxkIFsxLCAyXVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICByZXR1cm4gdGFnLmV2ZXJ5KChfdGFnLCBpbmRleCkgPT4gdGhpcy5kaXNhYmxlZEluZGljZXMuaGFzKGluZGV4ICsgcG9zaXRpb25JbmRleCkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLmRpc2FibGVkSW5kaWNlcy5oYXMocG9zaXRpb25JbmRleCk7XG4gICAgfVxuICAgIGRlbGV0ZVRhZyhldmVudCwgdGFnLCBpbmRleCkge1xuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBldmVudC5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKTtcbiAgICAgICAgaWYgKCF0aGlzLmRpc2FibGVkICYmIGV2ZW50LndoaWNoID09PSAxKSB7XG4gICAgICAgICAgICB0aGlzLnJlbW92ZVRhZy5lbWl0KHsgdGFnLCBpbmRleCB9KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpdGVtSWQodGFnLCBpbmRleCkge1xuICAgICAgICBpZiAodGFnKSB7IC8vYmVjYXVzZSBvZiBjdXN0b20gdmFsdWVzXG4gICAgICAgICAgICByZXR1cm4gdGhpcy50YWdQcmVmaXggKyBcIi1cIiArIHRoaXMudGFnUHJvcCh0YWcsIHRoaXMudmFsdWVGaWVsZCwgaW5kZXgpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGlzR3JvdXBUYWcodGFnKSB7XG4gICAgICAgIHJldHVybiB0YWcgaW5zdGFuY2VvZiBBcnJheTtcbiAgICB9XG4gICAgdGFnQXJpYUhpZGRlbihpbmRleCkge1xuICAgICAgICByZXR1cm4gaXNQcmVzZW50KHRoaXMuZm9jdXNlZCkgJiYgdGhpcy5mb2N1c2VkICE9PSBpbmRleDtcbiAgICB9XG4gICAgZ2V0UHJvcEZpZWxkKHRhZywgcHJvcCwgaW5kZXgpIHtcbiAgICAgICAgLy8gTmVlZGVkIGZvciBNdWx0aVNlbGVjdFRyZWUgdmFsdWUgYmluZGluZyAoSGV0ZXJvZ2VuZW91cyBEYXRhKVxuICAgICAgICBjb25zdCBmaWVsZHNDb3VudCA9IHByb3AubGVuZ3RoIC0gMTtcbiAgICAgICAgaWYgKHR5cGVvZiBwcm9wID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgcmV0dXJuIHByb3A7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodGhpcy52YWx1ZURlcHRoKSB7XG4gICAgICAgICAgICBjb25zdCBkZXB0aCA9IHRoaXMudmFsdWVEZXB0aFtpbmRleF07XG4gICAgICAgICAgICByZXR1cm4gZmllbGRzQ291bnQgPCBkZXB0aCA/IHByb3BbZmllbGRzQ291bnRdIDogcHJvcFtkZXB0aF07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gcHJvcC5maW5kKGl0ZW0gPT4gaXRlbSBpbiB0YWcpO1xuICAgICAgICB9XG4gICAgfVxufTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEFycmF5KVxuXSwgVGFnTGlzdENvbXBvbmVudC5wcm90b3R5cGUsIFwidGFnc1wiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgSW5wdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgT2JqZWN0KVxuXSwgVGFnTGlzdENvbXBvbmVudC5wcm90b3R5cGUsIFwidGV4dEZpZWxkXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBJbnB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBTdHJpbmcpXG5dLCBUYWdMaXN0Q29tcG9uZW50LnByb3RvdHlwZSwgXCJ2YWx1ZUZpZWxkXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBJbnB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBBcnJheSlcbl0sIFRhZ0xpc3RDb21wb25lbnQucHJvdG90eXBlLCBcInZhbHVlRGVwdGhcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIE51bWJlcilcbl0sIFRhZ0xpc3RDb21wb25lbnQucHJvdG90eXBlLCBcImZvY3VzZWRcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIFRhZ1RlbXBsYXRlRGlyZWN0aXZlKVxuXSwgVGFnTGlzdENvbXBvbmVudC5wcm90b3R5cGUsIFwidGVtcGxhdGVcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEdyb3VwVGFnVGVtcGxhdGVEaXJlY3RpdmUpXG5dLCBUYWdMaXN0Q29tcG9uZW50LnByb3RvdHlwZSwgXCJncm91cFRlbXBsYXRlXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBJbnB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBCb29sZWFuKVxuXSwgVGFnTGlzdENvbXBvbmVudC5wcm90b3R5cGUsIFwiZGlzYWJsZWRcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIFN0cmluZylcbl0sIFRhZ0xpc3RDb21wb25lbnQucHJvdG90eXBlLCBcInRhZ1ByZWZpeFwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgSW5wdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgU3RyaW5nKVxuXSwgVGFnTGlzdENvbXBvbmVudC5wcm90b3R5cGUsIFwiaWRcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIFN0cmluZyksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjpwYXJhbXR5cGVzXCIsIFtTdHJpbmddKVxuXSwgVGFnTGlzdENvbXBvbmVudC5wcm90b3R5cGUsIFwic2l6ZVwiLCBudWxsKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIFN0cmluZylcbl0sIFRhZ0xpc3RDb21wb25lbnQucHJvdG90eXBlLCBcInJvdW5kZWRcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIFN0cmluZylcbl0sIFRhZ0xpc3RDb21wb25lbnQucHJvdG90eXBlLCBcImZpbGxNb2RlXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBJbnB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBTZXQpXG5dLCBUYWdMaXN0Q29tcG9uZW50LnByb3RvdHlwZSwgXCJkaXNhYmxlZEluZGljZXNcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIE91dHB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBFdmVudEVtaXR0ZXIpXG5dLCBUYWdMaXN0Q29tcG9uZW50LnByb3RvdHlwZSwgXCJyZW1vdmVUYWdcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIEhvc3RCaW5kaW5nKCdjbGFzcy5rLWlucHV0LXZhbHVlcycpLFxuICAgIEhvc3RCaW5kaW5nKCdjbGFzcy5rLWNoaXAtbGlzdCcpLFxuICAgIEhvc3RCaW5kaW5nKCdjbGFzcy5rLXNlbGVjdGlvbi1tdWx0aXBsZScpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBCb29sZWFuKVxuXSwgVGFnTGlzdENvbXBvbmVudC5wcm90b3R5cGUsIFwiaG9zdENsYXNzZXNcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIEhvc3RCaW5kaW5nKCdhdHRyLmlkJyksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIFN0cmluZyksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjpwYXJhbXR5cGVzXCIsIFtdKVxuXSwgVGFnTGlzdENvbXBvbmVudC5wcm90b3R5cGUsIFwiaG9zdElkXCIsIG51bGwpO1xuVGFnTGlzdENvbXBvbmVudCA9IF9fZGVjb3JhdGUoW1xuICAgIENvbXBvbmVudCh7XG4gICAgICAgIHNlbGVjdG9yOiAna2VuZG8tdGFnbGlzdCcsXG4gICAgICAgIHRlbXBsYXRlOiBgXG4gICAgICAgIDxkaXZcbiAgICAgICAgICAgICpuZ0Zvcj1cImxldCB0YWcgb2YgdGFnczsgbGV0IGluZGV4ID0gaW5kZXg7XCJcbiAgICAgICAgICAgIFthdHRyLmlkXT1cIml0ZW1JZCh0YWcsIGluZGV4KVwiXG4gICAgICAgICAgICBbYXR0ci5hcmlhLWhpZGRlbl09XCJ0YWdBcmlhSGlkZGVuKGluZGV4KVwiXG4gICAgICAgICAgICBjbGFzcz1cImstY2hpcFwiXG4gICAgICAgICAgICBbbmdDbGFzc109XCJ7XG4gICAgICAgICAgICAgICAgJ2stZm9jdXMnOiBpbmRleCA9PT0gZm9jdXNlZCxcbiAgICAgICAgICAgICAgICAnay1kaXNhYmxlZCc6IGlzVGFnRGlzYWJsZWQodGFnLCBpbmRleCksXG4gICAgICAgICAgICAgICAgJ2stY2hpcC1zbSc6IHNpemUgPT09ICdzbWFsbCcsXG4gICAgICAgICAgICAgICAgJ2stY2hpcC1tZCc6IHNpemUgPT09ICdtZWRpdW0nLFxuICAgICAgICAgICAgICAgICdrLWNoaXAtbGcnOiBzaXplID09PSAnbGFyZ2UnLFxuICAgICAgICAgICAgICAgICdrLXJvdW5kZWQtc20nOiByb3VuZGVkID09PSAnc21hbGwnLFxuICAgICAgICAgICAgICAgICdrLXJvdW5kZWQtbWQnOiByb3VuZGVkID09PSAnbWVkaXVtJyxcbiAgICAgICAgICAgICAgICAnay1yb3VuZGVkLWxnJzogcm91bmRlZCA9PT0gJ2xhcmdlJyxcbiAgICAgICAgICAgICAgICAnay1yb3VuZGVkLWZ1bGwnOiByb3VuZGVkID09PSAnZnVsbCcsXG4gICAgICAgICAgICAgICAgJ2stY2hpcC1zb2xpZCBrLWNoaXAtc29saWQtYmFzZSc6IGZpbGxNb2RlID09PSAnc29saWQnLFxuICAgICAgICAgICAgICAgICdrLWNoaXAtZmxhdCBrLWNoaXAtZmxhdC1iYXNlJzogZmlsbE1vZGUgPT09ICdmbGF0JyxcbiAgICAgICAgICAgICAgICAnay1jaGlwLW91dGxpbmUgay1jaGlwLW91dGxpbmUtYmFzZSc6IGZpbGxNb2RlID09PSAnb3V0bGluZSdcbiAgICAgICAgICAgIH1cIlxuICAgICAgICA+XG4gICAgICAgICAgICA8c3BhbiBjbGFzcz1cImstY2hpcC1jb250ZW50XCI+XG4gICAgICAgICAgICAgICAgPG5nLXRlbXBsYXRlICpuZ0lmPVwiaXNHcm91cFRhZyh0YWcpOyB0aGVuIGdyb3VwVGFnIGVsc2Ugc2luZ2xlVGFnXCI+PC9uZy10ZW1wbGF0ZT5cbiAgICAgICAgICAgICAgICA8bmctdGVtcGxhdGUgI2dyb3VwVGFnPlxuICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cImstY2hpcC1sYWJlbCBrLXRleHQtZWxsaXBzaXNcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxuZy10ZW1wbGF0ZSAqbmdJZj1cImdyb3VwVGVtcGxhdGVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFt0ZW1wbGF0ZUNvbnRleHRdPVwie1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlUmVmOiBncm91cFRlbXBsYXRlLnRlbXBsYXRlUmVmLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRpbXBsaWNpdDogdGFnXG4gICAgICAgICAgICAgICAgICAgICAgICB9XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L25nLXRlbXBsYXRlPlxuICAgICAgICAgICAgICAgICAgICAgICAgPG5nLXRlbXBsYXRlIFtuZ0lmXT1cIiFncm91cFRlbXBsYXRlXCI+e3sgdGFnLmxlbmd0aCB9fSB7eyB0YWcubGVuZ3RoID09PSAxID8gJ2l0ZW0nIDogJ2l0ZW1zJyB9fSBzZWxlY3RlZDwvbmctdGVtcGxhdGU+XG4gICAgICAgICAgICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICAgICAgICA8L25nLXRlbXBsYXRlPlxuICAgICAgICAgICAgICAgIDxuZy10ZW1wbGF0ZSAjc2luZ2xlVGFnPlxuICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cImstY2hpcC1sYWJlbCBrLXRleHQtZWxsaXBzaXNcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxuZy10ZW1wbGF0ZSAqbmdJZj1cInRlbXBsYXRlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbdGVtcGxhdGVDb250ZXh0XT1cIntcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVJlZjogdGVtcGxhdGUudGVtcGxhdGVSZWYsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJGltcGxpY2l0OiB0YWdcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvbmctdGVtcGxhdGU+XG4gICAgICAgICAgICAgICAgICAgICAgICA8bmctdGVtcGxhdGUgW25nSWZdPVwiIXRlbXBsYXRlXCI+e3sgdGFnUHJvcCh0YWcsIHRleHRGaWVsZCwgaW5kZXgpIH19PC9uZy10ZW1wbGF0ZT5cbiAgICAgICAgICAgICAgICAgICAgPC9zcGFuPlxuICAgICAgICAgICAgICAgIDwvbmctdGVtcGxhdGU+XG4gICAgICAgICAgICA8L3NwYW4+XG5cbiAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwiay1jaGlwLWFjdGlvbnNcIj5cbiAgICAgICAgICAgICAgICA8c3BhbiBhcmlhLWxhYmVsPVwiZGVsZXRlXCIgW2F0dHIuYXJpYS1oaWRkZW5dPVwiaW5kZXggIT09IGZvY3VzZWRcIiBjbGFzcz1cImstY2hpcC1hY3Rpb24gay1jaGlwLXJlbW92ZS1hY3Rpb25cIj5cbiAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJrLWljb24gay1pLXgtY2lyY2xlXCIgKG1vdXNlZG93bik9XCJkZWxldGVUYWcoJGV2ZW50LCB0YWcsIGluZGV4KVwiPlxuICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgICAgPC9zcGFuPlxuICAgICAgICAgICAgPC9zcGFuPlxuICAgICAgICA8L2Rpdj5cbiAgICAgICAgPG5nLWNvbnRlbnQ+PC9uZy1jb250ZW50PlxuICBgXG4gICAgfSksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjpwYXJhbXR5cGVzXCIsIFtSZW5kZXJlcjIsXG4gICAgICAgIEVsZW1lbnRSZWZdKVxuXSwgVGFnTGlzdENvbXBvbmVudCk7XG5cbi8qKlxuICogQGhpZGRlblxuICovXG5jbGFzcyBNZXNzYWdlcyBleHRlbmRzIENvbXBvbmVudE1lc3NhZ2VzIHtcbn1cbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIFN0cmluZylcbl0sIE1lc3NhZ2VzLnByb3RvdHlwZSwgXCJub0RhdGFUZXh0XCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBJbnB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBTdHJpbmcpXG5dLCBNZXNzYWdlcy5wcm90b3R5cGUsIFwiY2xlYXJUaXRsZVwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgSW5wdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgU3RyaW5nKVxuXSwgTWVzc2FnZXMucHJvdG90eXBlLCBcImNoZWNrQWxsVGV4dFwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgSW5wdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgU3RyaW5nKVxuXSwgTWVzc2FnZXMucHJvdG90eXBlLCBcInNlbGVjdEJ1dHRvblRleHRcIiwgdm9pZCAwKTtcblxudmFyIExvY2FsaXplZE1lc3NhZ2VzRGlyZWN0aXZlXzE7XG4vKipcbiAqIEBoaWRkZW5cbiAqL1xubGV0IExvY2FsaXplZE1lc3NhZ2VzRGlyZWN0aXZlID0gTG9jYWxpemVkTWVzc2FnZXNEaXJlY3RpdmVfMSA9IGNsYXNzIExvY2FsaXplZE1lc3NhZ2VzRGlyZWN0aXZlIGV4dGVuZHMgTWVzc2FnZXMge1xuICAgIGNvbnN0cnVjdG9yKHNlcnZpY2UpIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5zZXJ2aWNlID0gc2VydmljZTtcbiAgICB9XG59O1xuTG9jYWxpemVkTWVzc2FnZXNEaXJlY3RpdmUgPSBMb2NhbGl6ZWRNZXNzYWdlc0RpcmVjdGl2ZV8xID0gX19kZWNvcmF0ZShbXG4gICAgRGlyZWN0aXZlKHtcbiAgICAgICAgcHJvdmlkZXJzOiBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcHJvdmlkZTogTWVzc2FnZXMsXG4gICAgICAgICAgICAgICAgdXNlRXhpc3Rpbmc6IGZvcndhcmRSZWYoKCkgPT4gTG9jYWxpemVkTWVzc2FnZXNEaXJlY3RpdmVfMSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgXSxcbiAgICAgICAgc2VsZWN0b3I6IGBcbiAgICBba2VuZG9Ecm9wRG93bkxpc3RMb2NhbGl6ZWRNZXNzYWdlc10sXG4gICAgW2tlbmRvRHJvcERvd25UcmVlTG9jYWxpemVkTWVzc2FnZXNdLFxuICAgIFtrZW5kb0NvbWJvQm94TG9jYWxpemVkTWVzc2FnZXNdLFxuICAgIFtrZW5kb011bHRpQ29sdW1uQ29tYm9Cb3hMb2NhbGl6ZWRNZXNzYWdlc10sXG4gICAgW2tlbmRvQXV0b0NvbXBsZXRlTG9jYWxpemVkTWVzc2FnZXNdLFxuICAgIFtrZW5kb011bHRpU2VsZWN0TG9jYWxpemVkTWVzc2FnZXNdLFxuICAgIFtrZW5kb011bHRpU2VsZWN0VHJlZUxvY2FsaXplZE1lc3NhZ2VzXVxuICBgXG4gICAgfSksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjpwYXJhbXR5cGVzXCIsIFtMb2NhbGl6YXRpb25TZXJ2aWNlXSlcbl0sIExvY2FsaXplZE1lc3NhZ2VzRGlyZWN0aXZlKTtcblxudmFyIEN1c3RvbU1lc3NhZ2VzQ29tcG9uZW50XzE7XG4vKipcbiAqIEN1c3RvbSBjb21wb25lbnQgbWVzc2FnZXMgb3ZlcnJpZGUgZGVmYXVsdCBjb21wb25lbnQgbWVzc2FnZXNcbiAqIChbc2VlIGV4YW1wbGVdKHslIHNsdWcgcnRsX2Ryb3Bkb3ducyAlfSN0b2MtbWVzc2FnZXMpKS5cbiAqL1xubGV0IEN1c3RvbU1lc3NhZ2VzQ29tcG9uZW50ID0gQ3VzdG9tTWVzc2FnZXNDb21wb25lbnRfMSA9IGNsYXNzIEN1c3RvbU1lc3NhZ2VzQ29tcG9uZW50IGV4dGVuZHMgTWVzc2FnZXMge1xuICAgIGNvbnN0cnVjdG9yKHNlcnZpY2UpIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5zZXJ2aWNlID0gc2VydmljZTtcbiAgICB9XG4gICAgZ2V0IG92ZXJyaWRlKCkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG59O1xuQ3VzdG9tTWVzc2FnZXNDb21wb25lbnQgPSBDdXN0b21NZXNzYWdlc0NvbXBvbmVudF8xID0gX19kZWNvcmF0ZShbXG4gICAgQ29tcG9uZW50KHtcbiAgICAgICAgcHJvdmlkZXJzOiBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcHJvdmlkZTogTWVzc2FnZXMsXG4gICAgICAgICAgICAgICAgdXNlRXhpc3Rpbmc6IGZvcndhcmRSZWYoKCkgPT4gQ3VzdG9tTWVzc2FnZXNDb21wb25lbnRfMSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgXSxcbiAgICAgICAgc2VsZWN0b3I6ICdrZW5kby1kcm9wZG93bmxpc3QtbWVzc2FnZXMsa2VuZG8tY29tYm9ib3gtbWVzc2FnZXMsa2VuZG8tbXVsdGljb2x1bW5jb21ib2JveC1tZXNzYWdlcyxrZW5kby1hdXRvY29tcGxldGUtbWVzc2FnZXMsa2VuZG8tbXVsdGlzZWxlY3QtbWVzc2FnZXMsa2VuZG8tZHJvcGRvd250cmVlLW1lc3NhZ2VzLGtlbmRvLW11bHRpc2VsZWN0dHJlZS1tZXNzYWdlcycsXG4gICAgICAgIHRlbXBsYXRlOiBgYFxuICAgIH0pLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246cGFyYW10eXBlc1wiLCBbTG9jYWxpemF0aW9uU2VydmljZV0pXG5dLCBDdXN0b21NZXNzYWdlc0NvbXBvbmVudCk7XG5cbmNvbnN0IERFRkFVTFRfRklMVEVSX1NFVFRJTkdTID0ge1xuICAgIGNhc2VTZW5zaXRpdmU6IGZhbHNlLFxuICAgIG9wZXJhdG9yOiAnc3RhcnRzV2l0aCdcbn07XG4vKipcbiAqIEltcGxlbWVudHMgYW4gZXZlbnQgaGFuZGxlciBmb3IgdGhlIGBmaWx0ZXJDaGFuZ2VgIGV2ZW50IG9mIGEgRHJvcERvd25zIGNvbXBvbmVudFxuICogd2hpY2ggcGVyZm9ybXMgc2ltcGxlIGRhdGEgZmlsdGVyaW5nLlxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGB0c1xuICogX0BDb21wb25lbnQoe1xuICogc2VsZWN0b3I6ICdteS1hcHAnLFxuICogdGVtcGxhdGU6IGBcbiAqICA8a2VuZG8tYXV0b2NvbXBsZXRlXG4gKiAgICAgIFtkYXRhXT1cImRhdGFcIlxuICogICAgICBrZW5kb0Ryb3BEb3duRmlsdGVyXG4gKiAgICAgIHBsYWNlaG9sZGVyPVwiZS5nLiBBbmRvcnJhXCJcbiAqICA+XG4gKiAgPC9rZW5kby1hdXRvY29tcGxldGU+XG4gKiBgXG4gKiB9KVxuICogY2xhc3MgQXBwQ29tcG9uZW50IHtcbiAqICAgICBwdWJsaWMgZGF0YTogQXJyYXk8c3RyaW5nPiA9IFtcIkFsYmFuaWFcIiwgXCJBbmRvcnJhXCIsIFwiQXJtZW5pYVwiLCBcIkF1c3RyaWFcIiwgXCJBemVyYmFpamFuXCJdO1xuICogfVxuICogYGBgXG4gKiA+IEN1cnJlbnRseSwgdGhlIGJ1aWx0LWluIGZpbHRlcmluZyBkb2VzIG5vdCB3b3JrIHdpdGggW2dyb3VwZWQgZGF0YV0oeyUgc2x1ZyBhcGlfa2VuZG8tZGF0YS1xdWVyeV9ncm91cGJ5ICV9KS5cbiAqL1xubGV0IEZpbHRlckRpcmVjdGl2ZSA9IGNsYXNzIEZpbHRlckRpcmVjdGl2ZSB7XG4gICAgY29uc3RydWN0b3IoY29tcG9uZW50KSB7XG4gICAgICAgIHRoaXMuY29tcG9uZW50ID0gY29tcG9uZW50O1xuICAgICAgICAvKipcbiAgICAgICAgICogQGhpZGRlblxuICAgICAgICAgKlxuICAgICAgICAgKiBTZXRzIHdoZXRoZXIgdGhlIGZpbHRlcmluZyBmdW5jdGlvbmFsaXR5IGlzIGVuYWJsZWQgb24gY29tcG9uZW50IGluaXQuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmZpbHRlcmFibGUgPSB0cnVlO1xuICAgICAgICB0aGlzLl9kYXRhID0gW107XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRoZSBpbml0aWFsIGRhdGEgdGhhdCB3aWxsIGJlIHVzZWQgYXMgYSBzb3VyY2UgYXJyYXkgZm9yIHRoZSBmaWx0ZXJpbmcgb3BlcmF0aW9ucy5cbiAgICAgKi9cbiAgICBzZXQgZGF0YShkYXRhKSB7XG4gICAgICAgIHRoaXMuX2RhdGEgPSBkYXRhIHx8IFtdO1xuICAgIH1cbiAgICBnZXQgZGF0YSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2RhdGE7XG4gICAgfVxuICAgIG5nT25Jbml0KCkge1xuICAgICAgICB0aGlzLmNvbXBvbmVudC5maWx0ZXJhYmxlID0gdGhpcy5maWx0ZXJhYmxlO1xuICAgICAgICB0aGlzLmZpbHRlckNoYW5nZVN1YnNjcmlwdGlvbiA9IHRoaXMuY29tcG9uZW50LmZpbHRlckNoYW5nZVxuICAgICAgICAgICAgLnN1YnNjcmliZSh0aGlzLmhhbmRsZUZpbHRlckNoYW5nZS5iaW5kKHRoaXMpKTtcbiAgICB9XG4gICAgbmdPbkRlc3Ryb3koKSB7XG4gICAgICAgIGlmIChpc1ByZXNlbnQodGhpcy5maWx0ZXJDaGFuZ2VTdWJzY3JpcHRpb24pKSB7XG4gICAgICAgICAgICB0aGlzLmZpbHRlckNoYW5nZVN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGhhbmRsZUZpbHRlckNoYW5nZShxdWVyeSkge1xuICAgICAgICB0aGlzLmNvbXBvbmVudC5kYXRhID0gdGhpcy5kYXRhLmZpbHRlcihpdGVtID0+IHRoaXMubWF0Y2hlc0FueUZpZWxkKGl0ZW0sIHF1ZXJ5KSk7XG4gICAgfVxuICAgIG1hdGNoZXNBbnlGaWVsZChpdGVtLCBxdWVyeSkge1xuICAgICAgICBjb25zdCBub3JtYWxpemVkUXVlcnkgPSB0aGlzLm5vcm1hbGl6ZVZhbHVlKHF1ZXJ5KTtcbiAgICAgICAgY29uc3QgeyBmaWVsZHMgfSA9IHRoaXMuZmlsdGVyU2V0dGluZ3M7XG4gICAgICAgIC8vIGlmIG5vIGZpbHRlciBmaWVsZHMgYXJlIHByZXNlbnQsIHdlIGFyZSBkZWFsaW5nIHdpdGggcHJpbWl0aXZlIGRhdGFcbiAgICAgICAgaWYgKGZpZWxkcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNoZWNrSXRlbShpdGVtLCBub3JtYWxpemVkUXVlcnkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmaWVsZHMuc29tZShmaWVsZCA9PiB0aGlzLmNoZWNrSXRlbShnZXR0ZXIkMShpdGVtLCBmaWVsZCksIG5vcm1hbGl6ZWRRdWVyeSkpO1xuICAgIH1cbiAgICBjaGVja0l0ZW0odGFyZ2V0LCBxdWVyeSkge1xuICAgICAgICB0YXJnZXQgPSB0aGlzLm5vcm1hbGl6ZVZhbHVlKHRhcmdldCk7XG4gICAgICAgIGlmICh0aGlzLmZpbHRlclNldHRpbmdzLm9wZXJhdG9yID09PSAnY29udGFpbnMnKSB7XG4gICAgICAgICAgICByZXR1cm4gdGFyZ2V0LmluZGV4T2YocXVlcnkpICE9PSAtMTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB0YXJnZXQuaW5kZXhPZihxdWVyeSkgPT09IDA7XG4gICAgICAgIH1cbiAgICB9XG4gICAgbm9ybWFsaXplVmFsdWUodmFsdWUpIHtcbiAgICAgICAgY29uc3Qgbm9ybWFsaXplZFZhbHVlID0gaXNQcmVzZW50KHZhbHVlKSA/IHZhbHVlLnRvU3RyaW5nKCkgOiAnJztcbiAgICAgICAgcmV0dXJuIHRoaXMuZmlsdGVyU2V0dGluZ3MuY2FzZVNlbnNpdGl2ZSA/IG5vcm1hbGl6ZWRWYWx1ZSA6IG5vcm1hbGl6ZWRWYWx1ZS50b0xvd2VyQ2FzZSgpO1xuICAgIH1cbiAgICBnZXRGaWx0ZXJGaWVsZHMocHJvdmlkZWRGaWVsZHMpIHtcbiAgICAgICAgLy8gaWdub3JlIHByb3ZpZGVkIGZpZWxkcyBpZiB0aGUgY29tcG9uZW50IGRlYWxzIHdpdGggcHJpbWl0aXZlIGRhdGFcbiAgICAgICAgaWYgKCF0aGlzLmNvbXBvbmVudC50ZXh0RmllbGQgJiYgIXRoaXMuY29tcG9uZW50LnZhbHVlRmllbGQpIHtcbiAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaXNBcnJheShwcm92aWRlZEZpZWxkcykgJiYgcHJvdmlkZWRGaWVsZHMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgcmV0dXJuIHByb3ZpZGVkRmllbGRzO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgLy8gdGhlIGF1dG9jb21wbGV0ZSB1c2VzIGB2YWx1ZUZpZWxkYCBmb3IgdGV4dCBleHRyYWN0aW9uXG4gICAgICAgICAgICBjb25zdCB0ZXh0RmllbGQgPSB0aGlzLmNvbXBvbmVudC50ZXh0RmllbGQgfHwgdGhpcy5jb21wb25lbnQudmFsdWVGaWVsZDtcbiAgICAgICAgICAgIHJldHVybiBbdGV4dEZpZWxkXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBnZXQgZmlsdGVyU2V0dGluZ3MoKSB7XG4gICAgICAgIGNvbnN0IHNldHRpbmdzID0gdGhpcy5yYXdTZXR0aW5ncztcbiAgICAgICAgY29uc3QgcHJvdmlkZWRGaWVsZHMgPSBpc1ByZXNlbnQoc2V0dGluZ3MpICYmIHR5cGVvZiBzZXR0aW5ncyA9PT0gJ29iamVjdCcgPyBzZXR0aW5ncy5maWVsZHMgOiBbXTtcbiAgICAgICAgcmV0dXJuIE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfRklMVEVSX1NFVFRJTkdTLCBzZXR0aW5ncywgeyBmaWVsZHM6IHRoaXMuZ2V0RmlsdGVyRmllbGRzKHByb3ZpZGVkRmllbGRzKSB9KTtcbiAgICB9XG59O1xuX19kZWNvcmF0ZShbXG4gICAgSW5wdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgQXJyYXkpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246cGFyYW10eXBlc1wiLCBbQXJyYXldKVxuXSwgRmlsdGVyRGlyZWN0aXZlLnByb3RvdHlwZSwgXCJkYXRhXCIsIG51bGwpO1xuX19kZWNvcmF0ZShbXG4gICAgSW5wdXQoJ2tlbmRvRHJvcERvd25GaWx0ZXInKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgT2JqZWN0KVxuXSwgRmlsdGVyRGlyZWN0aXZlLnByb3RvdHlwZSwgXCJyYXdTZXR0aW5nc1wiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgSW5wdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgQm9vbGVhbilcbl0sIEZpbHRlckRpcmVjdGl2ZS5wcm90b3R5cGUsIFwiZmlsdGVyYWJsZVwiLCB2b2lkIDApO1xuRmlsdGVyRGlyZWN0aXZlID0gX19kZWNvcmF0ZShbXG4gICAgRGlyZWN0aXZlKHtcbiAgICAgICAgc2VsZWN0b3I6ICdba2VuZG9Ecm9wRG93bkZpbHRlcl0nXG4gICAgfSksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjpwYXJhbXR5cGVzXCIsIFtGaWx0ZXJhYmxlQ29tcG9uZW50XSlcbl0sIEZpbHRlckRpcmVjdGl2ZSk7XG5cbi8qKlxuICogQGhpZGRlblxuICovXG5sZXQgRmlsdGVySW5wdXREaXJlY3RpdmUgPSBjbGFzcyBGaWx0ZXJJbnB1dERpcmVjdGl2ZSB7XG4gICAgY29uc3RydWN0b3IoZWxlbWVudCwgem9uZSkge1xuICAgICAgICB0aGlzLmVsZW1lbnQgPSBlbGVtZW50O1xuICAgICAgICB0aGlzLnpvbmUgPSB6b25lO1xuICAgIH1cbiAgICBuZ09uQ2hhbmdlcygpIHtcbiAgICAgICAgaWYgKHRoaXMuZm9jdXNlZCkge1xuICAgICAgICAgICAgdGhpcy5uZXh0VGljaygoKSA9PiB0aGlzLmVsZW1lbnQubmF0aXZlRWxlbWVudC5mb2N1cygpKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBuZXh0VGljayhmbikge1xuICAgICAgICB0aGlzLnpvbmUucnVuT3V0c2lkZUFuZ3VsYXIoKCkgPT4gc2V0VGltZW91dChmbikpO1xuICAgIH1cbn07XG5fX2RlY29yYXRlKFtcbiAgICBJbnB1dCgnZmlsdGVySW5wdXQnKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgQm9vbGVhbilcbl0sIEZpbHRlcklucHV0RGlyZWN0aXZlLnByb3RvdHlwZSwgXCJmb2N1c2VkXCIsIHZvaWQgMCk7XG5GaWx0ZXJJbnB1dERpcmVjdGl2ZSA9IF9fZGVjb3JhdGUoW1xuICAgIERpcmVjdGl2ZSh7XG4gICAgICAgIHNlbGVjdG9yOiAnW2ZpbHRlcklucHV0XScgLy8gdHNsaW50OmRpc2FibGUtbGluZVxuICAgIH0pLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246cGFyYW10eXBlc1wiLCBbRWxlbWVudFJlZixcbiAgICAgICAgTmdab25lXSlcbl0sIEZpbHRlcklucHV0RGlyZWN0aXZlKTtcblxuY29uc3QgU0hBUkVEX0RJUkVDVElWRVMgPSBbXG4gICAgSGVhZGVyVGVtcGxhdGVEaXJlY3RpdmUsXG4gICAgRm9vdGVyVGVtcGxhdGVEaXJlY3RpdmUsXG4gICAgSXRlbVRlbXBsYXRlRGlyZWN0aXZlLFxuICAgIEdyb3VwVGVtcGxhdGVEaXJlY3RpdmUsXG4gICAgRml4ZWRHcm91cFRlbXBsYXRlRGlyZWN0aXZlLFxuICAgIE5vRGF0YVRlbXBsYXRlRGlyZWN0aXZlLFxuICAgIFZhbHVlVGVtcGxhdGVEaXJlY3RpdmUsXG4gICAgVGFnVGVtcGxhdGVEaXJlY3RpdmUsXG4gICAgR3JvdXBUYWdUZW1wbGF0ZURpcmVjdGl2ZSxcbiAgICBMb2NhbGl6ZWRNZXNzYWdlc0RpcmVjdGl2ZSxcbiAgICBDdXN0b21NZXNzYWdlc0NvbXBvbmVudCxcbiAgICBGaWx0ZXJEaXJlY3RpdmUsXG4gICAgRmlsdGVySW5wdXREaXJlY3RpdmVcbl07XG4vKipcbiAqIEBoaWRkZW5cbiAqXG4gKiBUaGUgZXhwb3J0ZWQgcGFja2FnZSBtb2R1bGUuXG4gKlxuICogVGhlIHBhY2thZ2UgZXhwb3J0czpcbiAqIC0gYEl0ZW1UZW1wbGF0ZURpcmVjdGl2ZWAmbWRhc2g7VGhlIGl0ZW0gdGVtcGxhdGUgZGlyZWN0aXZlLlxuICogLSBgVmFsdWVUZW1wbGF0ZURpcmVjdGl2ZWAmbWRhc2g7VGhlIHZhbHVlIHRlbXBsYXRlIGRpcmVjdGl2ZS5cbiAqIC0gYEhlYWRlclRlbXBsYXRlRGlyZWN0aXZlYCZtZGFzaDtUaGUgaGVhZGVyIHRlbXBsYXRlIGRpcmVjdGl2ZS5cbiAqIC0gYEZvb3RlclRlbXBsYXRlRGlyZWN0aXZlYCZtZGFzaDtUaGUgZm9vdGVyIHRlbXBsYXRlIGRpcmVjdGl2ZS5cbiAqIC0gYE5vRGF0YVRlbXBsYXRlRGlyZWN0aXZlYCZtZGFzaDtUaGUgbm9EYXRhIHRlbXBsYXRlIGRpcmVjdGl2ZS5cbiAqIC0gYFRhZ1RlbXBsYXRlRGlyZWN0aXZlYCZtZGFzaDtUaGUgdGFnIHRlbXBsYXRlIGRpcmVjdGl2ZS5cbiAqIC0gYFN1bW1hcnlUYWdUZW1wbGF0ZURpcmVjdGl2ZWAmbWRhc2g7VGhlIHN1bW1hcnkgdGFnIHRlbXBsYXRlIGRpcmVjdGl2ZS5cbiAqL1xubGV0IFNoYXJlZERpcmVjdGl2ZXNNb2R1bGUgPSBjbGFzcyBTaGFyZWREaXJlY3RpdmVzTW9kdWxlIHtcbn07XG5TaGFyZWREaXJlY3RpdmVzTW9kdWxlID0gX19kZWNvcmF0ZShbXG4gICAgTmdNb2R1bGUoe1xuICAgICAgICBkZWNsYXJhdGlvbnM6IFtTSEFSRURfRElSRUNUSVZFU10sXG4gICAgICAgIGV4cG9ydHM6IFtTSEFSRURfRElSRUNUSVZFU11cbiAgICB9KVxuXSwgU2hhcmVkRGlyZWN0aXZlc01vZHVsZSk7XG5cbi8qKlxuICogQGhpZGRlblxuICovXG5sZXQgU2VsZWN0YWJsZURpcmVjdGl2ZSA9IGNsYXNzIFNlbGVjdGFibGVEaXJlY3RpdmUge1xuICAgIGNvbnN0cnVjdG9yKHNlbGVjdGlvblNlcnZpY2UpIHtcbiAgICAgICAgdGhpcy5jaGVja2JveGVzID0geyBlbmFibGVkOiBmYWxzZSB9O1xuICAgICAgICAvLyBASG9zdEJpbmRpbmcoJ2F0dHIub2Zmc2V0LWluZGV4JylcbiAgICAgICAgLy8gQElucHV0KCkgcHVibGljIG9mZnNldEluZGV4OiBudW1iZXI7XG4gICAgICAgIHRoaXMubXVsdGlwbGVTZWxlY3Rpb24gPSBmYWxzZTtcbiAgICAgICAgdGhpcy5zZWxlY3Rpb25TZXJ2aWNlID0gc2VsZWN0aW9uU2VydmljZTtcbiAgICB9XG4gICAgZ2V0IGZvY3VzZWRDbGFzc05hbWUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNlbGVjdGlvblNlcnZpY2UuaXNGb2N1c2VkKHRoaXMuaW5kZXgpO1xuICAgIH1cbiAgICBnZXQgc2VsZWN0ZWRDbGFzc05hbWUoKSB7XG4gICAgICAgIHJldHVybiAhdGhpcy5jaGVja2JveGVzLmVuYWJsZWQgJiYgdGhpcy5zZWxlY3Rpb25TZXJ2aWNlLmlzU2VsZWN0ZWQodGhpcy5pbmRleCk7XG4gICAgfVxuICAgIG9uQ2xpY2soZXZlbnQpIHtcbiAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgIGlmICh0aGlzLmNoZWNrYm94ZXMuZW5hYmxlZCAmJiAhdGhpcy5jaGVja2JveGVzLmNoZWNrT25DbGljaykge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm11bHRpcGxlU2VsZWN0aW9uKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5zZWxlY3Rpb25TZXJ2aWNlLmlzU2VsZWN0ZWQodGhpcy5pbmRleCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGlvblNlcnZpY2UudW5zZWxlY3QodGhpcy5pbmRleCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGlvblNlcnZpY2UuYWRkKHRoaXMuaW5kZXgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5zZWxlY3Rpb25TZXJ2aWNlLmNoYW5nZSh0aGlzLmluZGV4KTtcbiAgICAgICAgfVxuICAgIH1cbn07XG5fX2RlY29yYXRlKFtcbiAgICBIb3N0QmluZGluZygnYXR0ci5pbmRleCcpLFxuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIE51bWJlcilcbl0sIFNlbGVjdGFibGVEaXJlY3RpdmUucHJvdG90eXBlLCBcImluZGV4XCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBJbnB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBPYmplY3QpXG5dLCBTZWxlY3RhYmxlRGlyZWN0aXZlLnByb3RvdHlwZSwgXCJjaGVja2JveGVzXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBIb3N0QmluZGluZygnc3R5bGUuaGVpZ2h0LnB4JyksXG4gICAgSG9zdEJpbmRpbmcoJ3N0eWxlLm1pbkhlaWdodC5weCcpLFxuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIE51bWJlcilcbl0sIFNlbGVjdGFibGVEaXJlY3RpdmUucHJvdG90eXBlLCBcImhlaWdodFwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgSW5wdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgQm9vbGVhbilcbl0sIFNlbGVjdGFibGVEaXJlY3RpdmUucHJvdG90eXBlLCBcIm11bHRpcGxlU2VsZWN0aW9uXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBIb3N0QmluZGluZygnY2xhc3Muay1mb2N1cycpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBCb29sZWFuKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnBhcmFtdHlwZXNcIiwgW10pXG5dLCBTZWxlY3RhYmxlRGlyZWN0aXZlLnByb3RvdHlwZSwgXCJmb2N1c2VkQ2xhc3NOYW1lXCIsIG51bGwpO1xuX19kZWNvcmF0ZShbXG4gICAgSG9zdEJpbmRpbmcoJ2NsYXNzLmstc2VsZWN0ZWQnKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgQm9vbGVhbiksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjpwYXJhbXR5cGVzXCIsIFtdKVxuXSwgU2VsZWN0YWJsZURpcmVjdGl2ZS5wcm90b3R5cGUsIFwic2VsZWN0ZWRDbGFzc05hbWVcIiwgbnVsbCk7XG5fX2RlY29yYXRlKFtcbiAgICBIb3N0TGlzdGVuZXIoJ2NsaWNrJywgWyckZXZlbnQnXSksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEZ1bmN0aW9uKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnBhcmFtdHlwZXNcIiwgW09iamVjdF0pLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246cmV0dXJudHlwZVwiLCB2b2lkIDApXG5dLCBTZWxlY3RhYmxlRGlyZWN0aXZlLnByb3RvdHlwZSwgXCJvbkNsaWNrXCIsIG51bGwpO1xuU2VsZWN0YWJsZURpcmVjdGl2ZSA9IF9fZGVjb3JhdGUoW1xuICAgIERpcmVjdGl2ZSh7XG4gICAgICAgIHNlbGVjdG9yOiAnW2tlbmRvRHJvcERvd25zU2VsZWN0YWJsZV0nXG4gICAgfSksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjpwYXJhbXR5cGVzXCIsIFtTZWxlY3Rpb25TZXJ2aWNlXSlcbl0sIFNlbGVjdGFibGVEaXJlY3RpdmUpO1xuXG4vKipcbiAqIEBoaWRkZW5cbiAqL1xubGV0IFRlbXBsYXRlQ29udGV4dERpcmVjdGl2ZSA9IGNsYXNzIFRlbXBsYXRlQ29udGV4dERpcmVjdGl2ZSB7XG4gICAgY29uc3RydWN0b3Iodmlld0NvbnRhaW5lclJlZikge1xuICAgICAgICB0aGlzLnZpZXdDb250YWluZXJSZWYgPSB2aWV3Q29udGFpbmVyUmVmO1xuICAgIH1cbiAgICBzZXQgdGVtcGxhdGVDb250ZXh0KGNvbnRleHQpIHtcbiAgICAgICAgaWYgKHRoaXMuaW5zZXJ0ZWRWaWV3UmVmKSB7XG4gICAgICAgICAgICB0aGlzLnZpZXdDb250YWluZXJSZWYucmVtb3ZlKHRoaXMudmlld0NvbnRhaW5lclJlZi5pbmRleE9mKHRoaXMuaW5zZXJ0ZWRWaWV3UmVmKSk7XG4gICAgICAgICAgICB0aGlzLmluc2VydGVkVmlld1JlZiA9IHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY29udGV4dC50ZW1wbGF0ZVJlZikge1xuICAgICAgICAgICAgdGhpcy5pbnNlcnRlZFZpZXdSZWYgPSB0aGlzLnZpZXdDb250YWluZXJSZWYuY3JlYXRlRW1iZWRkZWRWaWV3KGNvbnRleHQudGVtcGxhdGVSZWYsIGNvbnRleHQpO1xuICAgICAgICB9XG4gICAgfVxufTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIE9iamVjdCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjpwYXJhbXR5cGVzXCIsIFtPYmplY3RdKVxuXSwgVGVtcGxhdGVDb250ZXh0RGlyZWN0aXZlLnByb3RvdHlwZSwgXCJ0ZW1wbGF0ZUNvbnRleHRcIiwgbnVsbCk7XG5UZW1wbGF0ZUNvbnRleHREaXJlY3RpdmUgPSBfX2RlY29yYXRlKFtcbiAgICBEaXJlY3RpdmUoe1xuICAgICAgICBzZWxlY3RvcjogJ1t0ZW1wbGF0ZUNvbnRleHRdJyAvLyB0c2xpbnQ6ZGlzYWJsZS1saW5lXG4gICAgfSksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjpwYXJhbXR5cGVzXCIsIFtWaWV3Q29udGFpbmVyUmVmXSlcbl0sIFRlbXBsYXRlQ29udGV4dERpcmVjdGl2ZSk7XG5cbi8qKlxuICogQGhpZGRlblxuICpcbiAqIEEgZGlyZWN0aXZlIHdoaWNoIG1hbmFnZXMgdGhlIGluLW1lbW9yeSBjaGVja2VkIHN0YXRlIG9mIHRoZSBNdWx0aVNlbGVjdFRyZWUgbm9kZXMuXG4gKi9cbmNsYXNzIEJhc2VDaGVja0RpcmVjdGl2ZSB7XG4gICAgYWRkSXRlbShpdGVtKSB7XG4gICAgICAgIGlmICh0aGlzLmlzSXRlbUNoZWNrZWQoaXRlbSkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBsZXZlbCA9IGdldEhpZXJhcmNoaWNhbEl0ZW1MZXZlbChpdGVtLmluZGV4KTtcbiAgICAgICAgY29uc3QgY2FuZGlkYXRlID0gT2JqZWN0LmFzc2lnbih7fSwgaXRlbSwgeyBsZXZlbCB9KTtcbiAgICAgICAgdGhpcy5jaGVja2VkSXRlbXMucHVzaChjYW5kaWRhdGUpO1xuICAgICAgICB0aGlzLmNoZWNrZWRLZXlzLmFkZCh0aGlzLmdldEtleShjYW5kaWRhdGUpKTtcbiAgICB9XG4gICAgcmVtb3ZlSXRlbShpdGVtKSB7XG4gICAgICAgIGlmICghdGhpcy5pc0l0ZW1DaGVja2VkKGl0ZW0pKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgbGV2ZWwgPSBnZXRIaWVyYXJjaGljYWxJdGVtTGV2ZWwoaXRlbS5pbmRleCk7XG4gICAgICAgIGNvbnN0IGNhbmRpZGF0ZSA9IE9iamVjdC5hc3NpZ24oe30sIGl0ZW0sIHsgbGV2ZWwgfSk7XG4gICAgICAgIHRoaXMuY2hlY2tlZEl0ZW1zID0gdGhpcy5jaGVja2VkSXRlbXNcbiAgICAgICAgICAgIC5maWx0ZXIoaXRlbSA9PiB2YWx1ZUZyb20oaXRlbSwgdGhpcy52YWx1ZUZpZWxkKSAhPT0gdmFsdWVGcm9tKGNhbmRpZGF0ZSwgdGhpcy52YWx1ZUZpZWxkKSk7XG4gICAgICAgIHRoaXMuY2hlY2tlZEtleXMuZGVsZXRlKHRoaXMuZ2V0S2V5KGNhbmRpZGF0ZSkpO1xuICAgIH1cbiAgICBpc0l0ZW1DaGVja2VkKGl0ZW0pIHtcbiAgICAgICAgY29uc3QgbGV2ZWwgPSBpdGVtLmluZGV4LnNwbGl0KCdfJykubGVuZ3RoIC0gMTtcbiAgICAgICAgaXRlbS5sZXZlbCA9IGxldmVsO1xuICAgICAgICByZXR1cm4gdGhpcy5jaGVja2VkS2V5cy5oYXModGhpcy5nZXRLZXkoaXRlbSkpO1xuICAgIH1cbiAgICB1cGRhdGVJdGVtcygpIHtcbiAgICAgICAgdGhpcy5jaGVja2VkSXRlbXMgPSB0aGlzLmNoZWNrZWRJdGVtcyB8fCBbXTtcbiAgICAgICAgdGhpcy5jaGVja2VkS2V5cyA9IG5ldyBTZXQodGhpcy5jaGVja2VkSXRlbXMubWFwKGl0ZW0gPT4gdGhpcy5nZXRLZXkoaXRlbSkpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQWRkcyB0aGUgaXRlbSdzIGRlcHRoIHRvIHRoZSBpdGVtJ3MgdmFsdWUgdG8gYWxsb3cgZHVwbGljYXRlIHZhbHVlcyBvbiBkaWZmZXJlbnQgbGV2ZWxzLlxuICAgICAqXG4gICAgICogQHBhcmFtIGl0ZW0gLSBUaGUgY2hlY2tlZCBrZXkuXG4gICAgICogQHJldHVybnMgeyBzdHJpbmcgfSAtIEEgc3RyaW5nIGtleSBjb25zaXN0aW5nIG9mIHRoZSBpdGVtJ3MgYHZhbHVlRmllbGRgIHZhbHVlIGFuZCBpdHMgZGVwdGguXG4gICAgICovXG4gICAgZ2V0S2V5KGl0ZW0pIHtcbiAgICAgICAgaWYgKGlzQXJyYXkodGhpcy52YWx1ZUZpZWxkKSkge1xuICAgICAgICAgICAgcmV0dXJuIHZhbHVlRnJvbShpdGVtLCB0aGlzLnZhbHVlRmllbGQpICsgJ18nICsgaXRlbS5sZXZlbDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdmFsdWVGcm9tKGl0ZW0sIHRoaXMudmFsdWVGaWVsZCk7XG4gICAgfVxufVxuX19kZWNvcmF0ZShbXG4gICAgSW5wdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgT2JqZWN0KVxuXSwgQmFzZUNoZWNrRGlyZWN0aXZlLnByb3RvdHlwZSwgXCJ2YWx1ZUZpZWxkXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBJbnB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBBcnJheSlcbl0sIEJhc2VDaGVja0RpcmVjdGl2ZS5wcm90b3R5cGUsIFwiY2hlY2tlZEl0ZW1zXCIsIHZvaWQgMCk7XG5cbi8qKlxuICogQGhpZGRlblxuICpcbiAqIEEgZGlyZWN0aXZlIHdoaWNoIG1hbmFnZXMgdGhlIGluLW1lbW9yeSBjaGVja2VkIHN0YXRlIG9mIHRoZSBNdWx0aVNlbGVjdFRyZWUgbm9kZXMuXG4gKi9cbmxldCBDaGVja0RpcmVjdGl2ZSA9IGNsYXNzIENoZWNrRGlyZWN0aXZlIGV4dGVuZHMgQmFzZUNoZWNrRGlyZWN0aXZlIHtcbiAgICBjb25zdHJ1Y3Rvcih0cmVlVmlldykge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLnRyZWVWaWV3ID0gdHJlZVZpZXc7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBGaXJlcyB3aGVuIHRoZSBgY2hlY2tlZEl0ZW1zYCBjb2xsZWN0aW9uIHdhcyB1cGRhdGVkLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5jaGVja2VkSXRlbXNDaGFuZ2UgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBIb2xkcyBhIFNldCB3aXRoIGp1c3QgdGhlIGNoZWNrZWQgaXRlbSBrZXlzLlxuICAgICAgICAgKlxuICAgICAgICAgKiBTaG91bGQgYmUgdXBkYXRlZCBlYWNoIHRpbWUgdGhlIGBjaGVja2VkSXRlbXNgIHZhbHVlIG9yIGNvbnRlbnQgaXMgY2hhbmdlZC5cbiAgICAgICAgICogQ2FuIGJlIHVzZWQgZm9yIGVmZmljaWVudCBsb29rLXVwIG9mIHdoZXRoZXIgYW4gaXRlbSBpcyBjaGVja2VkIG9yIG5vdCAoTygxKSBhY2Nlc3MgdGltZSkuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmNoZWNrZWRLZXlzID0gbmV3IFNldCgpO1xuICAgICAgICB0aGlzLnN1YnNjcmlwdGlvbnMgPSBuZXcgU3Vic2NyaXB0aW9uKCk7XG4gICAgICAgIHRoaXMuc3Vic2NyaXB0aW9ucy5hZGQodGhpcy50cmVlVmlldy5jaGVja2VkQ2hhbmdlXG4gICAgICAgICAgICAuc3Vic2NyaWJlKHRoaXMuaGFuZGxlQ2hlY2tlZENoYW5nZS5iaW5kKHRoaXMpKSk7XG4gICAgICAgIHRoaXMudHJlZVZpZXcuaXNDaGVja2VkID0gdGhpcy5nZXRDaGVja2VkU3RhdGUuYmluZCh0aGlzKTtcbiAgICB9XG4gICAgbmdPbkNoYW5nZXMoY2hhbmdlcykge1xuICAgICAgICBpZiAoaXNQcmVzZW50KGNoYW5nZXMuY2hlY2thYmxlKSkge1xuICAgICAgICAgICAgdGhpcy50b2dnbGVDaGVja09uQ2xpY2soKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaXNQcmVzZW50KGNoYW5nZXMuY2hlY2tlZEl0ZW1zKSkge1xuICAgICAgICAgICAgdGhpcy51cGRhdGVJdGVtcygpO1xuICAgICAgICB9XG4gICAgfVxuICAgIG5nT25EZXN0cm95KCkge1xuICAgICAgICB0aGlzLnN1YnNjcmlwdGlvbnMudW5zdWJzY3JpYmUoKTtcbiAgICAgICAgdGhpcy51bnN1YnNjcmliZUNsaWNrKCk7XG4gICAgfVxuICAgIGdldENoZWNrZWRTdGF0ZShkYXRhSXRlbSwgaW5kZXgpIHtcbiAgICAgICAgaWYgKHRoaXMuaXNJdGVtQ2hlY2tlZCh7IGRhdGFJdGVtLCBpbmRleCB9KSkge1xuICAgICAgICAgICAgcmV0dXJuICdjaGVja2VkJztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0aGlzLmNoZWNrYWJsZS5jaGVja0NoaWxkcmVuICYmIHRoaXMuaXNJdGVtSW5kZXRlcm1pbmF0ZSh0aGlzLnRyZWVWaWV3Lml0ZW1Mb29rdXAoaW5kZXgpKSkge1xuICAgICAgICAgICAgcmV0dXJuICdpbmRldGVybWluYXRlJztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiAnbm9uZSc7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaGFuZGxlQ2hlY2tlZENoYW5nZShub2RlKSB7XG4gICAgICAgIHRoaXMuY2hlY2tOb2RlKG5vZGUpO1xuICAgICAgICAvLyBwYXJlbnRzIHNob3VsZCBiZSBjaGVja2VkIGlmIGBjaGVja0NoaWxkcmVuYCBpcyBzZXQgdG8gYHRydWVgIChzaW5nbGUgY29uZmlnIG9wdGlvbiBmb3IgYm90aClcbiAgICAgICAgY29uc3QgY2hlY2tQYXJlbnRzID0gdGhpcy5jaGVja2FibGUuY2hlY2tDaGlsZHJlbjtcbiAgICAgICAgaWYgKGNoZWNrUGFyZW50cykge1xuICAgICAgICAgICAgdGhpcy5jaGVja1BhcmVudHMobm9kZS5wYXJlbnQpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuY2hlY2tlZEl0ZW1zQ2hhbmdlLmVtaXQodGhpcy5jaGVja2VkSXRlbXMuc2xpY2UoKSk7XG4gICAgfVxuICAgIHRvZ2dsZUNoZWNrT25DbGljaygpIHtcbiAgICAgICAgdGhpcy51bnN1YnNjcmliZUNsaWNrKCk7XG4gICAgICAgIGlmICh0aGlzLmNoZWNrYWJsZS5jaGVja09uQ2xpY2spIHtcbiAgICAgICAgICAgIHRoaXMuY2xpY2tTdWJzY3JpcHRpb24gPSB0aGlzLnRyZWVWaWV3Lm5vZGVDbGlja1xuICAgICAgICAgICAgICAgIC5waXBlKGZpbHRlcihldmVudCA9PiBldmVudC50eXBlID09PSAnY2xpY2snKSlcbiAgICAgICAgICAgICAgICAuc3Vic2NyaWJlKGV2ZW50ID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBsb29rdXAgPSB0aGlzLnRyZWVWaWV3Lml0ZW1Mb29rdXAoZXZlbnQuaXRlbS5pbmRleCk7XG4gICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVDaGVja2VkQ2hhbmdlKGxvb2t1cCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB1bnN1YnNjcmliZUNsaWNrKCkge1xuICAgICAgICBpZiAodGhpcy5jbGlja1N1YnNjcmlwdGlvbikge1xuICAgICAgICAgICAgdGhpcy5jbGlja1N1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpO1xuICAgICAgICAgICAgdGhpcy5jbGlja1N1YnNjcmlwdGlvbiA9IG51bGw7XG4gICAgICAgIH1cbiAgICB9XG4gICAgY2hlY2tOb2RlKGxvb2t1cCkge1xuICAgICAgICBpZiAodGhpcy50cmVlVmlldy5pc0Rpc2FibGVkKGxvb2t1cC5pdGVtLmRhdGFJdGVtLCBsb29rdXAuaXRlbS5pbmRleCkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCB0YXJnZXQgPSBsb29rdXAuaXRlbTtcbiAgICAgICAgY29uc3QgcGVuZGluZ0NoZWNrID0gW3RhcmdldF07XG4gICAgICAgIC8vIFRPRE86IGV4dHJhY3QgaW4gYSBzZXBhcmF0ZSBgY2hlY2tDaGlsZHJlbmAgbWV0aG9kP1xuICAgICAgICBpZiAodGhpcy5jaGVja2FibGUuY2hlY2tDaGlsZHJlbikge1xuICAgICAgICAgICAgY29uc3QgZmlsdGVyJCQxID0gKGl0ZW0pID0+IHRoaXMudHJlZVZpZXcuaXNWaXNpYmxlKGl0ZW0uZGF0YUl0ZW0sIGl0ZW0uaW5kZXgpICYmXG4gICAgICAgICAgICAgICAgIXRoaXMudHJlZVZpZXcuaXNEaXNhYmxlZChpdGVtLmRhdGFJdGVtLCBpdGVtLmluZGV4KTtcbiAgICAgICAgICAgIGZldGNoRGVzY2VuZGVudE5vZGVzKGxvb2t1cCwgZmlsdGVyJCQxKVxuICAgICAgICAgICAgICAgIC5mb3JFYWNoKGxvb2t1cCA9PiBwZW5kaW5nQ2hlY2sucHVzaChsb29rdXAuaXRlbSkpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHNob3VsZENoZWNrID0gIXRoaXMuaXNJdGVtQ2hlY2tlZCh0YXJnZXQpO1xuICAgICAgICBwZW5kaW5nQ2hlY2suZm9yRWFjaChpdGVtID0+IHtcbiAgICAgICAgICAgIGlmIChzaG91bGRDaGVjaykge1xuICAgICAgICAgICAgICAgIHRoaXMuYWRkSXRlbShpdGVtKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlSXRlbShpdGVtKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGNoZWNrUGFyZW50cyhwYXJlbnQpIHtcbiAgICAgICAgbGV0IGN1cnJlbnRQYXJlbnQgPSBwYXJlbnQ7XG4gICAgICAgIHdoaWxlIChjdXJyZW50UGFyZW50KSB7XG4gICAgICAgICAgICBjb25zdCBhbGxDaGlsZHJlblNlbGVjdGVkID0gY3VycmVudFBhcmVudC5jaGlsZHJlbi5ldmVyeShpdGVtID0+IHRoaXMuaXNJdGVtQ2hlY2tlZChpdGVtKSk7XG4gICAgICAgICAgICBpZiAoYWxsQ2hpbGRyZW5TZWxlY3RlZCkge1xuICAgICAgICAgICAgICAgIHRoaXMuYWRkSXRlbShjdXJyZW50UGFyZW50Lml0ZW0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVJdGVtKGN1cnJlbnRQYXJlbnQuaXRlbSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjdXJyZW50UGFyZW50ID0gY3VycmVudFBhcmVudC5wYXJlbnQ7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaXNJdGVtSW5kZXRlcm1pbmF0ZShsb29rdXApIHtcbiAgICAgICAgY29uc3QgY2hpbGRyZW4gPSBsb29rdXAuY2hpbGRyZW47XG4gICAgICAgIGlmICghQXJyYXkuaXNBcnJheShjaGlsZHJlbikgfHwgY2hpbGRyZW4ubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgbGV0IGluZGV4ID0gMDtcbiAgICAgICAgbGV0IGNoaWxkID0gY2hpbGRyZW5baW5kZXhdO1xuICAgICAgICB3aGlsZSAoaXNQcmVzZW50KGNoaWxkKSkge1xuICAgICAgICAgICAgaWYgKHRoaXMuaXNJdGVtQ2hlY2tlZChjaGlsZC5pdGVtKSB8fCB0aGlzLmlzSXRlbUluZGV0ZXJtaW5hdGUoY2hpbGQpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpbmRleCArPSAxO1xuICAgICAgICAgICAgY2hpbGQgPSBjaGlsZHJlbltpbmRleF07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbn07XG5fX2RlY29yYXRlKFtcbiAgICBJbnB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBPYmplY3QpXG5dLCBDaGVja0RpcmVjdGl2ZS5wcm90b3R5cGUsIFwiY2hlY2thYmxlXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBJbnB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBPYmplY3QpXG5dLCBDaGVja0RpcmVjdGl2ZS5wcm90b3R5cGUsIFwidmFsdWVGaWVsZFwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgSW5wdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgQXJyYXkpXG5dLCBDaGVja0RpcmVjdGl2ZS5wcm90b3R5cGUsIFwiY2hlY2tlZEl0ZW1zXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBPdXRwdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgRXZlbnRFbWl0dGVyKVxuXSwgQ2hlY2tEaXJlY3RpdmUucHJvdG90eXBlLCBcImNoZWNrZWRJdGVtc0NoYW5nZVwiLCB2b2lkIDApO1xuQ2hlY2tEaXJlY3RpdmUgPSBfX2RlY29yYXRlKFtcbiAgICBEaXJlY3RpdmUoe1xuICAgICAgICBzZWxlY3RvcjogJ1trZW5kb011bHRpU2VsZWN0VHJlZUNoZWNrYWJsZV0nXG4gICAgfSksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjpwYXJhbXR5cGVzXCIsIFtUcmVlVmlld0NvbXBvbmVudF0pXG5dLCBDaGVja0RpcmVjdGl2ZSk7XG5cbi8qKlxuICogQGhpZGRlblxuICpcbiAqIEEgZGlyZWN0aXZlIHdoaWNoIG1hbmFnZXMgdGhlIGluLW1lbW9yeSBjaGVja2VkIHN0YXRlIG9mIHRoZSBNdWx0aVNlbGVjdFRyZWUgbm9kZXMuXG4gKi9cbmxldCBDaGVja0FsbERpcmVjdGl2ZSA9IGNsYXNzIENoZWNrQWxsRGlyZWN0aXZlIGV4dGVuZHMgQmFzZUNoZWNrRGlyZWN0aXZlIHtcbiAgICBjb25zdHJ1Y3RvcihlbGVtZW50LCB6b25lLCBjZHIsIHJlbmRlcmVyKSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMuZWxlbWVudCA9IGVsZW1lbnQ7XG4gICAgICAgIHRoaXMuem9uZSA9IHpvbmU7XG4gICAgICAgIHRoaXMuY2RyID0gY2RyO1xuICAgICAgICB0aGlzLnJlbmRlcmVyID0gcmVuZGVyZXI7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBGaXJlcyB3aGVuIHRoZSBgY2hlY2tlZEl0ZW1zYCBjb2xsZWN0aW9uIHdhcyB1cGRhdGVkLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5jaGVja2VkSXRlbXNDaGFuZ2UgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBIb2xkcyBhIFNldCB3aXRoIGp1c3QgdGhlIGNoZWNrZWQgaXRlbSBrZXlzLlxuICAgICAgICAgKlxuICAgICAgICAgKiBTaG91bGQgYmUgdXBkYXRlZCBlYWNoIHRpbWUgdGhlIGBjaGVja2VkSXRlbXNgIHZhbHVlIG9yIGNvbnRlbnQgaXMgY2hhbmdlZC5cbiAgICAgICAgICogQ2FuIGJlIHVzZWQgZm9yIGVmZmljaWVudCBsb29rLXVwIG9mIHdoZXRoZXIgYW4gaXRlbSBpcyBjaGVja2VkIG9yIG5vdCAoTygxKSBhY2Nlc3MgdGltZSkuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmNoZWNrZWRLZXlzID0gbmV3IFNldCgpO1xuICAgIH1cbiAgICBoYW5kbGVDaGFuZ2UoZXZlbnQpIHtcbiAgICAgICAgLy8gTmVlZCB0byBzdG9yZSB0aGUgY3VycmVudCBjaGVja2JveCBzdGF0ZSBhdCB0aGUgbW9tZW50IG9mIGNsaWNrXG4gICAgICAgIHRoaXMuY3VycmVudENoZWNrZWRTdGF0ZSA9IGV2ZW50LmNoZWNrZWQ7XG4gICAgICAgIHRoaXMuY3VycmVudEluZGV0ZXJtaW5hdGVTdGF0ZSA9IHRoaXMuaXNJbmRldGVybWluYXRlO1xuICAgICAgICB0aGlzLnRyZWV2aWV3Lm5vZGVzLm1hcCgoX3ZhbHVlLCBpbmRleCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgaXRlbUluZGV4ID0gU3RyaW5nKGluZGV4KTtcbiAgICAgICAgICAgIGNvbnN0IGl0ZW1Mb29rdXAgPSB0aGlzLnRyZWV2aWV3Lml0ZW1Mb29rdXAoaXRlbUluZGV4KTtcbiAgICAgICAgICAgIHRoaXMuY2hlY2tOb2RlKGl0ZW1Mb29rdXApO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5jaGVja2VkSXRlbXNDaGFuZ2UuZW1pdCh0aGlzLmNoZWNrZWRJdGVtcy5zbGljZSgpKTtcbiAgICB9XG4gICAgZ2V0IGlzSW5kZXRlcm1pbmF0ZSgpIHtcbiAgICAgICAgY29uc3QgaXNJbmRldGVybWluYXRlID0gdGhpcy50cmVldmlldy5ub2Rlcy5zb21lKChfbm9kZSwgaW5kZXgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGl0ZW1JbmRleCA9IFN0cmluZyhpbmRleCk7XG4gICAgICAgICAgICBjb25zdCBpdGVtTG9va3VwID0gdGhpcy50cmVldmlldy5pdGVtTG9va3VwKGl0ZW1JbmRleCk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zb21lQ2hlY2tlZChpdGVtTG9va3VwKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiB0aGlzLmlzQ2hlY2tlZCA/IGZhbHNlIDogaXNJbmRldGVybWluYXRlO1xuICAgIH1cbiAgICBnZXQgaXNDaGVja2VkKCkge1xuICAgICAgICBjb25zdCBpc0NoZWNrZWQgPSB0aGlzLnRyZWV2aWV3Lm5vZGVzLmV2ZXJ5KChfbm9kZSwgaW5kZXgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGl0ZW1JbmRleCA9IFN0cmluZyhpbmRleCk7XG4gICAgICAgICAgICBjb25zdCBpdGVtTG9va3VwID0gdGhpcy50cmVldmlldy5pdGVtTG9va3VwKGl0ZW1JbmRleCk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5hbGxDaGVja2VkKGl0ZW1Mb29rdXApO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGlzQ2hlY2tlZDtcbiAgICB9XG4gICAgbmdPbkNoYW5nZXMoY2hhbmdlcykge1xuICAgICAgICBpZiAoaXNQcmVzZW50KGNoYW5nZXMuY2hlY2tlZEl0ZW1zKSkge1xuICAgICAgICAgICAgdGhpcy51cGRhdGVJdGVtcygpO1xuICAgICAgICAgICAgdGhpcy5yZW5kZXJlci5zZXRQcm9wZXJ0eSh0aGlzLmVsZW1lbnQubmF0aXZlRWxlbWVudCwgJ2NoZWNrZWQnLCB0aGlzLmlzQ2hlY2tlZCk7XG4gICAgICAgICAgICB0aGlzLnJlbmRlcmVyLnNldFByb3BlcnR5KHRoaXMuZWxlbWVudC5uYXRpdmVFbGVtZW50LCAnaW5kZXRlcm1pbmF0ZScsIHRoaXMuaXNJbmRldGVybWluYXRlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBuZ09uSW5pdCgpIHtcbiAgICAgICAgaWYgKHRoaXMuZm9jdXNlZCkge1xuICAgICAgICAgICAgdGhpcy5uZXh0VGljaygoKSA9PiB0aGlzLmVsZW1lbnQubmF0aXZlRWxlbWVudC5mb2N1cygpKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBuZXh0VGljayhmbikge1xuICAgICAgICB0aGlzLnpvbmUucnVuT3V0c2lkZUFuZ3VsYXIoKCkgPT4gc2V0VGltZW91dChmbikpO1xuICAgIH1cbiAgICBjaGVja05vZGUoaXRlbUxvb2t1cCkge1xuICAgICAgICBpZiAodGhpcy50cmVldmlldy5pc0Rpc2FibGVkKGl0ZW1Mb29rdXAuaXRlbS5kYXRhSXRlbSwgaXRlbUxvb2t1cC5pdGVtLmluZGV4KSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHBlbmRpbmdDaGVjayA9IFtdO1xuICAgICAgICBjb25zdCBmaWx0ZXIkJDEgPSAoaXRlbSkgPT4gdGhpcy50cmVldmlldy5pc1Zpc2libGUoaXRlbS5kYXRhSXRlbSwgaXRlbS5pbmRleCkgJiZcbiAgICAgICAgICAgICF0aGlzLnRyZWV2aWV3LmlzRGlzYWJsZWQoaXRlbS5kYXRhSXRlbSwgaXRlbS5pbmRleCk7XG4gICAgICAgIHBlbmRpbmdDaGVjay5wdXNoKGl0ZW1Mb29rdXAuaXRlbSk7XG4gICAgICAgIGZldGNoRGVzY2VuZGVudE5vZGVzKGl0ZW1Mb29rdXAsIGZpbHRlciQkMSlcbiAgICAgICAgICAgIC5mb3JFYWNoKGxvb2t1cCA9PiBwZW5kaW5nQ2hlY2sucHVzaChsb29rdXAuaXRlbSkpO1xuICAgICAgICBwZW5kaW5nQ2hlY2suZm9yRWFjaChpdGVtID0+IHtcbiAgICAgICAgICAgIGlmICh0aGlzLmN1cnJlbnRJbmRldGVybWluYXRlU3RhdGUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmxhc3RBY3Rpb24gPT09ICdjaGVjaycgP1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmFkZEl0ZW0oaXRlbSkgOlxuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZUl0ZW0oaXRlbSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5jdXJyZW50Q2hlY2tlZFN0YXRlID9cbiAgICAgICAgICAgICAgICB0aGlzLmFkZEl0ZW0oaXRlbSkgOlxuICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlSXRlbShpdGVtKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGFsbENoZWNrZWQobG9va3VwKSB7XG4gICAgICAgIGNvbnN0IGNoaWxkcmVuID0gbG9va3VwICYmIGxvb2t1cC5jaGlsZHJlbjtcbiAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KGNoaWxkcmVuKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGNoaWxkcmVuQ2hlY2tlZCA9IGNoaWxkcmVuLmV2ZXJ5KGNoaWxkID0+IHtcbiAgICAgICAgICAgIGlmIChjaGlsZC5jaGlsZHJlbi5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5pc0l0ZW1DaGVja2VkKGNoaWxkLml0ZW0pICYmIHRoaXMuYWxsQ2hlY2tlZChjaGlsZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5pc0l0ZW1DaGVja2VkKGNoaWxkLml0ZW0pO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGNoaWxkcmVuQ2hlY2tlZCAmJiB0aGlzLmlzSXRlbUNoZWNrZWQobG9va3VwLml0ZW0pO1xuICAgIH1cbiAgICBzb21lQ2hlY2tlZChsb29rdXApIHtcbiAgICAgICAgY29uc3QgY2hpbGRyZW4gPSBsb29rdXAgJiYgbG9va3VwLmNoaWxkcmVuO1xuICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkoY2hpbGRyZW4pKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgY2hpbGRyZW5DaGVja2VkID0gY2hpbGRyZW4uc29tZShjaGlsZCA9PiB7XG4gICAgICAgICAgICBpZiAoY2hpbGQuY2hpbGRyZW4ubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuaXNJdGVtQ2hlY2tlZChjaGlsZC5pdGVtKSB8fCB0aGlzLnNvbWVDaGVja2VkKGNoaWxkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzLmlzSXRlbUNoZWNrZWQoY2hpbGQuaXRlbSk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gY2hpbGRyZW5DaGVja2VkIHx8IHRoaXMuaXNJdGVtQ2hlY2tlZChsb29rdXAuaXRlbSk7XG4gICAgfVxufTtcbl9fZGVjb3JhdGUoW1xuICAgIElucHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIFN0cmluZylcbl0sIENoZWNrQWxsRGlyZWN0aXZlLnByb3RvdHlwZSwgXCJsYXN0QWN0aW9uXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBJbnB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBUcmVlVmlld0NvbXBvbmVudClcbl0sIENoZWNrQWxsRGlyZWN0aXZlLnByb3RvdHlwZSwgXCJ0cmVldmlld1wiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgSW5wdXQoKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgQXJyYXkpXG5dLCBDaGVja0FsbERpcmVjdGl2ZS5wcm90b3R5cGUsIFwiY2hlY2tlZEl0ZW1zXCIsIHZvaWQgMCk7XG5fX2RlY29yYXRlKFtcbiAgICBJbnB1dCgpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBPYmplY3QpXG5dLCBDaGVja0FsbERpcmVjdGl2ZS5wcm90b3R5cGUsIFwidmFsdWVGaWVsZFwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgSW5wdXQoJ2NoZWNrQWxsJyksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEJvb2xlYW4pXG5dLCBDaGVja0FsbERpcmVjdGl2ZS5wcm90b3R5cGUsIFwiZm9jdXNlZFwiLCB2b2lkIDApO1xuX19kZWNvcmF0ZShbXG4gICAgT3V0cHV0KCksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEV2ZW50RW1pdHRlcilcbl0sIENoZWNrQWxsRGlyZWN0aXZlLnByb3RvdHlwZSwgXCJjaGVja2VkSXRlbXNDaGFuZ2VcIiwgdm9pZCAwKTtcbl9fZGVjb3JhdGUoW1xuICAgIEhvc3RMaXN0ZW5lcignY2hhbmdlJywgWyckZXZlbnQudGFyZ2V0J10pLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBGdW5jdGlvbiksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjpwYXJhbXR5cGVzXCIsIFtPYmplY3RdKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnJldHVybnR5cGVcIiwgdm9pZCAwKVxuXSwgQ2hlY2tBbGxEaXJlY3RpdmUucHJvdG90eXBlLCBcImhhbmRsZUNoYW5nZVwiLCBudWxsKTtcbkNoZWNrQWxsRGlyZWN0aXZlID0gX19kZWNvcmF0ZShbXG4gICAgRGlyZWN0aXZlKHtcbiAgICAgICAgc2VsZWN0b3I6ICdbY2hlY2tBbGxdJyAvLyB0c2xpbnQ6ZGlzYWJsZS1saW5lXG4gICAgfSksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjpwYXJhbXR5cGVzXCIsIFtFbGVtZW50UmVmLCBOZ1pvbmUsIENoYW5nZURldGVjdG9yUmVmLCBSZW5kZXJlcjJdKVxuXSwgQ2hlY2tBbGxEaXJlY3RpdmUpO1xuXG5jb25zdCBJTlRFUk5BTF9ESVJFQ1RJVkVTID0gW1xuICAgIExpc3RDb21wb25lbnQsXG4gICAgTGlzdEl0ZW1EaXJlY3RpdmUsXG4gICAgU2VsZWN0YWJsZURpcmVjdGl2ZSxcbiAgICBTZWFyY2hCYXJDb21wb25lbnQsXG4gICAgVGVtcGxhdGVDb250ZXh0RGlyZWN0aXZlLFxuICAgIFRhZ0xpc3RDb21wb25lbnQsXG4gICAgQ2hlY2tEaXJlY3RpdmUsXG4gICAgQ2hlY2tBbGxEaXJlY3RpdmVcbl07XG4vKipcbiAqIEBoaWRkZW5cbiAqL1xubGV0IFNoYXJlZE1vZHVsZSA9IGNsYXNzIFNoYXJlZE1vZHVsZSB7XG59O1xuU2hhcmVkTW9kdWxlID0gX19kZWNvcmF0ZShbXG4gICAgTmdNb2R1bGUoe1xuICAgICAgICBkZWNsYXJhdGlvbnM6IFtJTlRFUk5BTF9ESVJFQ1RJVkVTXSxcbiAgICAgICAgZXhwb3J0czogW0lOVEVSTkFMX0RJUkVDVElWRVMsIENvbW1vbk1vZHVsZSwgRm9ybXNNb2R1bGUsIFBvcHVwTW9kdWxlLCBSZXNpemVTZW5zb3JNb2R1bGUsIFNoYXJlZERpcmVjdGl2ZXNNb2R1bGUsIEV2ZW50c01vZHVsZV0sXG4gICAgICAgIGltcG9ydHM6IFtDb21tb25Nb2R1bGUsIEZvcm1zTW9kdWxlLCBQb3B1cE1vZHVsZSwgUmVzaXplU2Vuc29yTW9kdWxlLCBTaGFyZWREaXJlY3RpdmVzTW9kdWxlLCBFdmVudHNNb2R1bGVdXG4gICAgfSlcbl0sIFNoYXJlZE1vZHVsZSk7XG5cbi8qKlxuICogQSBkaXJlY3RpdmUgd2hpY2ggY29uZmlndXJlcyB0aGUgTXVsdGlTZWxlY3RUcmVlIHRvIHNob3cgb25lIHNpbmdsZSBzdW1tYXJ5IHRhZyBmb3IgYWxsIHNlbGVjdGVkIGRhdGEgaXRlbXMuXG4gKiBXaGVuIGEgbnVtYmVyIGlzIHByb3ZpZGVkLCB0aGUgc3VtbWFyeSB0YWcgaXMgZGlzcGxheWVkIGFmdGVyIHRoZSBnaXZlbiBhbW91bnQgb2YgZGF0YSBpdGVtcyBhcmUgc2VsZWN0ZWRcbiAqIChbbW9yZSBpbmZvcm1hdGlvbiBhbmQgZXhhbXBsZXNdKHslIHNsdWcgYXBpX2Ryb3Bkb3duc19tdWx0aXNlbGVjdHRyZWVzdW1tYXJ5dGFnZGlyZWN0aXZlICV9KSkuXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYHRzLW5vLXJ1blxuICogPGtlbmRvLW11bHRpc2VsZWN0dHJlZSBrZW5kb011bHRpU2VsZWN0VHJlZVN1bW1hcnlUYWcgW2RhdGFdPVwiZGF0YVwiPjwva2VuZG8tbXVsdGlzZWxlY3R0cmVlPlxuICogYGBgXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYHRzLW5vLXJ1blxuICogPGtlbmRvLW11bHRpc2VsZWN0dHJlZSBba2VuZG9NdWx0aVNlbGVjdFRyZWVTdW1tYXJ5VGFnXT1cIjJcIiBbZGF0YV09XCJkYXRhXCI+PC9rZW5kby1tdWx0aXNlbGVjdHRyZWU+XG4gKiBgYGBcbiAqL1xubGV0IE11bHRpU2VsZWN0VHJlZVN1bW1hcnlUYWdEaXJlY3RpdmUgPSBjbGFzcyBNdWx0aVNlbGVjdFRyZWVTdW1tYXJ5VGFnRGlyZWN0aXZlIHtcbiAgICBjb25zdHJ1Y3RvcihtdWx0aVNlbGVjdFRyZWVDb21wb25lbnQpIHtcbiAgICAgICAgdGhpcy5tdWx0aVNlbGVjdFRyZWVDb21wb25lbnQgPSBtdWx0aVNlbGVjdFRyZWVDb21wb25lbnQ7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBIG51bWVyaWMgdmFsdWUgdGhhdCBpbmRpY2F0ZXMgdGhlIG51bWJlciBvZiBzZWxlY3RlZCBkYXRhIGl0ZW1zIGFmdGVyIHdoaWNoIHRoZSBzdW1tYXJ5IHRhZyB3aWxsIGFwcGVhci5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuc2hvd0FmdGVyID0gMDtcbiAgICAgICAgdGhpcy5jcmVhdGVUYWdNYXBwZXIoKTtcbiAgICB9XG4gICAgbmdPbkNoYW5nZXMoY2hhbmdlcykge1xuICAgICAgICBpZiAoaXNQcmVzZW50KGNoYW5nZXMuc2hvd0FmdGVyKSkge1xuICAgICAgICAgICAgdGhpcy5jcmVhdGVUYWdNYXBwZXIoKTtcbiAgICAgICAgICAgIHRoaXMubXVsdGlTZWxlY3RUcmVlQ29tcG9uZW50LmhhbmRsZVRhZ01hcHBlckNoYW5nZSh0aGlzLnNob3dBZnRlcik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgY3JlYXRlVGFnTWFwcGVyKCkge1xuICAgICAgICBjb25zdCBzaG93QWZ0ZXIgPSBwYXJzZU51bWJlcih0aGlzLnNob3dBZnRlcik7XG4gICAgICAgIHRoaXMubXVsdGlTZWxlY3RUcmVlQ29tcG9uZW50LnRhZ01hcHBlciA9ICh0YWdzKSA9PiB7XG4gICAgICAgICAgICBpZiAodGFncy5sZW5ndGggPiBzaG93QWZ0ZXIpIHtcbiAgICAgICAgICAgICAgICAvLyB0YWdzIHByb3ZpZGVkIGluIGFuIGFycmF5IGFyZSByZW5kZXJlZCBhcyBhIHNpbmdsZSBncm91cCB0YWdcbiAgICAgICAgICAgICAgICByZXR1cm4gWy4uLnRhZ3Muc2xpY2UoMCwgc2hvd0FmdGVyKSwgdGFncy5zbGljZShzaG93QWZ0ZXIpXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiB0YWdzO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH1cbn07XG5fX2RlY29yYXRlKFtcbiAgICBJbnB1dCgna2VuZG9NdWx0aVNlbGVjdFRyZWVTdW1tYXJ5VGFnJyksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIE9iamVjdClcbl0sIE11bHRpU2VsZWN0VHJlZVN1bW1hcnlUYWdEaXJlY3RpdmUucHJvdG90eXBlLCBcInNob3dBZnRlclwiLCB2b2lkIDApO1xuTXVsdGlTZWxlY3RUcmVlU3VtbWFyeVRhZ0RpcmVjdGl2ZSA9IF9fZGVjb3JhdGUoW1xuICAgIERpcmVjdGl2ZSh7XG4gICAgICAgIHNlbGVjdG9yOiAnW2tlbmRvTXVsdGlTZWxlY3RUcmVlU3VtbWFyeVRhZ10nXG4gICAgfSksXG4gICAgX19tZXRhZGF0YShcImRlc2lnbjpwYXJhbXR5cGVzXCIsIFtNdWx0aVNlbGVjdFRyZWVDb21wb25lbnRdKVxuXSwgTXVsdGlTZWxlY3RUcmVlU3VtbWFyeVRhZ0RpcmVjdGl2ZSk7XG5cbmNvbnN0IERST1BET1dOVFJFRV9ESVJFQ1RJVkVTID0gW1xuICAgIERyb3BEb3duVHJlZUNvbXBvbmVudCxcbiAgICBNdWx0aVNlbGVjdFRyZWVDb21wb25lbnQsXG4gICAgRHJvcERvd25UcmVlRmxhdEJpbmRpbmdEaXJlY3RpdmUsXG4gICAgRHJvcERvd25UcmVlSGllcmFyY2h5QmluZGluZ0RpcmVjdGl2ZSxcbiAgICBNdWx0aVNlbGVjdFRyZWVGbGF0QmluZGluZ0RpcmVjdGl2ZSxcbiAgICBNdWx0aVNlbGVjdFRyZWVIaWVyYXJjaHlCaW5kaW5nRGlyZWN0aXZlLFxuICAgIERyb3BEb3duVHJlZXNFeHBhbmREaXJlY3RpdmUsXG4gICAgTm9kZVRlbXBsYXRlRGlyZWN0aXZlLFxuICAgIE11bHRpU2VsZWN0VHJlZVN1bW1hcnlUYWdEaXJlY3RpdmVcbl07XG4vKipcbiAqIEBoaWRkZW5cbiAqL1xubGV0IERyb3BEb3duVHJlZXNNb2R1bGUgPSBjbGFzcyBEcm9wRG93blRyZWVzTW9kdWxlIHtcbn07XG5Ecm9wRG93blRyZWVzTW9kdWxlID0gX19kZWNvcmF0ZShbXG4gICAgTmdNb2R1bGUoe1xuICAgICAgICBkZWNsYXJhdGlvbnM6IFtEUk9QRE9XTlRSRUVfRElSRUNUSVZFU10sXG4gICAgICAgIGV4cG9ydHM6IFtEUk9QRE9XTlRSRUVfRElSRUNUSVZFUywgU2hhcmVkRGlyZWN0aXZlc01vZHVsZV0sXG4gICAgICAgIGltcG9ydHM6IFtTaGFyZWRNb2R1bGUsIFRyZWVWaWV3TW9kdWxlXVxuICAgIH0pXG5dLCBEcm9wRG93blRyZWVzTW9kdWxlKTtcblxuLyoqXG4gKiBBIGRpcmVjdGl2ZSB3aGljaCBjb25maWd1cmVzIHRoZSBNdWx0aVNlbGVjdCB0byBzaG93IG9uZSBzaW5nbGUgc3VtbWFyeSB0YWcgZm9yIGFsbCBzZWxlY3RlZCBkYXRhIGl0ZW1zLlxuICogV2hlbiBhIG51bWJlciBpcyBwcm92aWRlZCwgdGhlIHN1bW1hcnkgdGFnIGlzIGRpc3BsYXllZCBhZnRlciB0aGUgZ2l2ZW4gYW1vdW50IG9mIGRhdGEgaXRlbXMgYXJlIHNlbGVjdGVkXG4gKiAoW21vcmUgaW5mb3JtYXRpb24gYW5kIGV4YW1wbGVzXSh7JSBzbHVnIHN1bW1hcnl0YWdtb2RlX211bHRpc2VsZWN0ICV9KSkuXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYHRzLW5vLXJ1blxuICogPGtlbmRvLW11bHRpc2VsZWN0IGtlbmRvTXVsdGlTZWxlY3RTdW1tYXJ5VGFnIFtkYXRhXT1cImRhdGFcIj48L2tlbmRvLW11bHRpc2VsZWN0PlxuICogYGBgXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYHRzLW5vLXJ1blxuICogPGtlbmRvLW11bHRpc2VsZWN0IFtrZW5kb011bHRpU2VsZWN0U3VtbWFyeVRhZ109XCIyXCIgW2RhdGFdPVwiZGF0YVwiPjwva2VuZG8tbXVsdGlzZWxlY3Q+XG4gKiBgYGBcbiAqL1xubGV0IFN1bW1hcnlUYWdEaXJlY3RpdmUgPSBjbGFzcyBTdW1tYXJ5VGFnRGlyZWN0aXZlIHtcbiAgICBjb25zdHJ1Y3RvcihtdWx0aVNlbGVjdENvbXBvbmVudCkge1xuICAgICAgICB0aGlzLm11bHRpU2VsZWN0Q29tcG9uZW50ID0gbXVsdGlTZWxlY3RDb21wb25lbnQ7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBIG51bWVyaWMgdmFsdWUgdGhhdCBpbmRpY2F0ZXMgdGhlIG51bWJlciBvZiBzZWxlY3RlZCBkYXRhIGl0ZW1zIGFmdGVyIHdoaWNoIHRoZSBzdW1tYXJ5IHRhZyB3aWxsIGFwcGVhci5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuc2hvd0FmdGVyID0gMDtcbiAgICAgICAgdGhpcy5jcmVhdGVUYWdNYXBwZXIoKTtcbiAgICB9XG4gICAgbmdPbkNoYW5nZXMoY2hhbmdlcykge1xuICAgICAgICBpZiAoaXNQcmVzZW50KGNoYW5nZXMuc2hvd0FmdGVyKSkge1xuICAgICAgICAgICAgdGhpcy5jcmVhdGVUYWdNYXBwZXIoKTtcbiAgICAgICAgICAgIHRoaXMubXVsdGlTZWxlY3RDb21wb25lbnQub25UYWdNYXBwZXJDaGFuZ2UoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBjcmVhdGVUYWdNYXBwZXIoKSB7XG4gICAgICAgIGNvbnN0IHNob3dBZnRlciA9IHBhcnNlTnVtYmVyKHRoaXMuc2hvd0FmdGVyKTtcbiAgICAgICAgdGhpcy5tdWx0aVNlbGVjdENvbXBvbmVudC50YWdNYXBwZXIgPSAodGFncykgPT4ge1xuICAgICAgICAgICAgaWYgKHRhZ3MubGVuZ3RoID4gc2hvd0FmdGVyKSB7XG4gICAgICAgICAgICAgICAgbGV0IHJlc3VsdDtcbiAgICAgICAgICAgICAgICByZXN1bHQgPSB0YWdzLnNsaWNlKDAsIHNob3dBZnRlcik7XG4gICAgICAgICAgICAgICAgcmVzdWx0LnB1c2godGFncy5zbGljZShzaG93QWZ0ZXIsIHRhZ3MubGVuZ3RoKSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiB0YWdzO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH1cbn07XG5fX2RlY29yYXRlKFtcbiAgICBJbnB1dCgna2VuZG9NdWx0aVNlbGVjdFN1bW1hcnlUYWcnKSxcbiAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgT2JqZWN0KVxuXSwgU3VtbWFyeVRhZ0RpcmVjdGl2ZS5wcm90b3R5cGUsIFwic2hvd0FmdGVyXCIsIHZvaWQgMCk7XG5TdW1tYXJ5VGFnRGlyZWN0aXZlID0gX19kZWNvcmF0ZShbXG4gICAgRGlyZWN0aXZlKHtcbiAgICAgICAgc2VsZWN0b3I6ICdba2VuZG9NdWx0aVNlbGVjdFN1bW1hcnlUYWddJ1xuICAgIH0pLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246cGFyYW10eXBlc1wiLCBbTXVsdGlTZWxlY3RDb21wb25lbnRdKVxuXSwgU3VtbWFyeVRhZ0RpcmVjdGl2ZSk7XG5cbmNvbnN0IEFVVE9DT01QTEVURV9ESVJFQ1RJVkVTID0gW1xuICAgIEF1dG9Db21wbGV0ZUNvbXBvbmVudFxuXTtcbi8qKlxuICogQGhpZGRlblxuICpcbiAqIFRoZSBleHBvcnRlZCBwYWNrYWdlIG1vZHVsZS5cbiAqXG4gKiBUaGUgcGFja2FnZSBleHBvcnRzOlxuICogLSBgQXV0b0NvbXBsZXRlQ29tcG9uZW50YCZtZGFzaDtUaGUgQXV0b0NvbXBsZXRlIGNvbXBvbmVudCBjbGFzcy5cbiAqIC0gYEl0ZW1UZW1wbGF0ZURpcmVjdGl2ZWAmbWRhc2g7VGhlIGl0ZW0gdGVtcGxhdGUgZGlyZWN0aXZlLlxuICogLSBgSGVhZGVyVGVtcGxhdGVEaXJlY3RpdmVgJm1kYXNoO1RoZSBoZWFkZXIgdGVtcGxhdGUgZGlyZWN0aXZlLlxuICogLSBgRm9vdGVyVGVtcGxhdGVEaXJlY3RpdmVgJm1kYXNoO1RoZSBmb290ZXIgdGVtcGxhdGUgZGlyZWN0aXZlLlxuICovXG5sZXQgQXV0b0NvbXBsZXRlTW9kdWxlID0gY2xhc3MgQXV0b0NvbXBsZXRlTW9kdWxlIHtcbn07XG5BdXRvQ29tcGxldGVNb2R1bGUgPSBfX2RlY29yYXRlKFtcbiAgICBOZ01vZHVsZSh7XG4gICAgICAgIGRlY2xhcmF0aW9uczogW0FVVE9DT01QTEVURV9ESVJFQ1RJVkVTXSxcbiAgICAgICAgZXhwb3J0czogW0FVVE9DT01QTEVURV9ESVJFQ1RJVkVTLCBTaGFyZWREaXJlY3RpdmVzTW9kdWxlXSxcbiAgICAgICAgaW1wb3J0czogW1NoYXJlZE1vZHVsZV1cbiAgICB9KVxuXSwgQXV0b0NvbXBsZXRlTW9kdWxlKTtcblxuY29uc3QgQ09NQk9CT1hfRElSRUNUSVZFUyA9IFtcbiAgICBDb21ib0JveENvbXBvbmVudCxcbiAgICBNdWx0aUNvbHVtbkNvbWJvQm94Q29tcG9uZW50LFxuICAgIENvbWJvQm94Q29sdW1uQ29tcG9uZW50LFxuICAgIENvbHVtbkhlYWRlclRlbXBsYXRlRGlyZWN0aXZlLFxuICAgIENvbHVtbkNlbGxUZW1wbGF0ZURpcmVjdGl2ZVxuXTtcbmNvbnN0IMm1MCQ0ID0gdG91Y2hFbmFibGVkO1xuLyoqXG4gKiBAaGlkZGVuXG4gKlxuICogVGhlIGV4cG9ydGVkIHBhY2thZ2UgbW9kdWxlLlxuICpcbiAqIFRoZSBwYWNrYWdlIGV4cG9ydHM6XG4gKiAtIGBDb21ib0JveENvbXBvbmVudGAmbWRhc2g7VGhlIENvbWJvQm94IGNvbXBvbmVudCBjbGFzcy5cbiAqIC0gYE11bHRpQ29sdW1uQ29tYm9Cb3hDb21wb25lbnRgJm1kYXNoO1RoZSBNdWx0aUNvbHVtbkNvbWJvQm94IGNvbXBvbmVudCBjbGFzcy5cbiAqIC0gYEl0ZW1UZW1wbGF0ZURpcmVjdGl2ZWAmbWRhc2g7VGhlIGl0ZW0gdGVtcGxhdGUgZGlyZWN0aXZlLlxuICogLSBgSGVhZGVyVGVtcGxhdGVEaXJlY3RpdmVgJm1kYXNoO1RoZSBoZWFkZXIgdGVtcGxhdGUgZGlyZWN0aXZlLlxuICogLSBgRm9vdGVyVGVtcGxhdGVEaXJlY3RpdmVgJm1kYXNoO1RoZSBmb290ZXIgdGVtcGxhdGUgZGlyZWN0aXZlLlxuICogLSBgQ29sdW1uSGVhZGVyVGVtcGxhdGVEaXJlY3RpdmVgJm1kYXNoO1RoZSBjb2x1bW4gaGVhZGVyIHRlbXBsYXRlIGRpcmVjdGl2ZS5cbiAqIC0gYENvbHVtbkNlbGxUZW1wbGF0ZURpcmVjdGl2ZWAmbWRhc2g7VGhlIGNvbHVtbiBjZWxsIHRlbXBsYXRlIGRpcmVjdGl2ZS5cbiAqL1xubGV0IENvbWJvQm94TW9kdWxlID0gY2xhc3MgQ29tYm9Cb3hNb2R1bGUge1xufTtcbkNvbWJvQm94TW9kdWxlID0gX19kZWNvcmF0ZShbXG4gICAgTmdNb2R1bGUoe1xuICAgICAgICBkZWNsYXJhdGlvbnM6IFtDT01CT0JPWF9ESVJFQ1RJVkVTXSxcbiAgICAgICAgZXhwb3J0czogW0NPTUJPQk9YX0RJUkVDVElWRVMsIFNoYXJlZERpcmVjdGl2ZXNNb2R1bGVdLFxuICAgICAgICBpbXBvcnRzOiBbU2hhcmVkTW9kdWxlXSxcbiAgICAgICAgcHJvdmlkZXJzOiBbeyBwcm92aWRlOiBUT1VDSF9FTkFCTEVELCB1c2VWYWx1ZTogybUwJDQgfV1cbiAgICB9KVxuXSwgQ29tYm9Cb3hNb2R1bGUpO1xuXG5jb25zdCBEUk9QRE9XTkxJU1RfRElSRUNUSVZFUyA9IFtcbiAgICBEcm9wRG93bkxpc3RDb21wb25lbnRcbl07XG4vKipcbiAqIEBoaWRkZW5cbiAqXG4gKiBUaGUgZXhwb3J0ZWQgcGFja2FnZSBtb2R1bGUuXG4gKlxuICogVGhlIHBhY2thZ2UgZXhwb3J0czpcbiAqIC0gYERyb3BEb3duTGlzdENvbXBvbmVudGAmbWRhc2g7VGhlIERyb3BEb3duTGlzdCBjb21wb25lbnQgY2xhc3MuXG4gKiAtIGBJdGVtVGVtcGxhdGVEaXJlY3RpdmVgJm1kYXNoO1RoZSBpdGVtIHRlbXBsYXRlIGRpcmVjdGl2ZS5cbiAqIC0gYFZhbHVlVGVtcGxhdGVEaXJlY3RpdmVgJm1kYXNoO1RoZSB2YWx1ZSB0ZW1wbGF0ZSBkaXJlY3RpdmUuXG4gKiAtIGBIZWFkZXJUZW1wbGF0ZURpcmVjdGl2ZWAmbWRhc2g7VGhlIGhlYWRlciB0ZW1wbGF0ZSBkaXJlY3RpdmUuXG4gKiAtIGBGb290ZXJUZW1wbGF0ZURpcmVjdGl2ZWAmbWRhc2g7VGhlIGZvb3RlciB0ZW1wbGF0ZSBkaXJlY3RpdmUuXG4gKi9cbmxldCBEcm9wRG93bkxpc3RNb2R1bGUgPSBjbGFzcyBEcm9wRG93bkxpc3RNb2R1bGUge1xufTtcbkRyb3BEb3duTGlzdE1vZHVsZSA9IF9fZGVjb3JhdGUoW1xuICAgIE5nTW9kdWxlKHtcbiAgICAgICAgZGVjbGFyYXRpb25zOiBbRFJPUERPV05MSVNUX0RJUkVDVElWRVNdLFxuICAgICAgICBleHBvcnRzOiBbRFJPUERPV05MSVNUX0RJUkVDVElWRVMsIFNoYXJlZERpcmVjdGl2ZXNNb2R1bGVdLFxuICAgICAgICBpbXBvcnRzOiBbU2hhcmVkTW9kdWxlXVxuICAgIH0pXG5dLCBEcm9wRG93bkxpc3RNb2R1bGUpO1xuXG5jb25zdCBNVUxUSVNFTEVDVF9ESVJFQ1RJVkVTID0gW1xuICAgIE11bHRpU2VsZWN0Q29tcG9uZW50LFxuICAgIFN1bW1hcnlUYWdEaXJlY3RpdmUsXG4gICAgQ3VzdG9tSXRlbVRlbXBsYXRlRGlyZWN0aXZlXG5dO1xuY29uc3QgybUwJDUgPSB0b3VjaEVuYWJsZWQ7XG4vKipcbiAqIEBoaWRkZW5cbiAqXG4gKiBUaGUgZXhwb3J0ZWQgcGFja2FnZSBtb2R1bGUuXG4gKlxuICogVGhlIHBhY2thZ2UgZXhwb3J0czpcbiAqIC0gYE11bHRpU2VsZWN0Q29tcG9uZW50YCZtZGFzaDtUaGUgTXVsdGlTZWxlY3QgY29tcG9uZW50IGNsYXNzLlxuICogLSBgU3VtbWFyeVRhZ0RpcmVjdGl2ZWAmbWRhc2g7VGhlIE11bHRpU2VsZWN0IHN1bW1hcnkgdGFnIGRpcmVjdGl2ZS5cbiAqIC0gYEl0ZW1UZW1wbGF0ZURpcmVjdGl2ZWAmbWRhc2g7VGhlIGl0ZW0gdGVtcGxhdGUgZGlyZWN0aXZlLlxuICogLSBgQ3VzdG9tSXRlbVRlbXBsYXRlRGlyZWN0aXZlYCZtZGFzaDtUaGUgY3VzdG9tIGl0ZW0gdGVtcGxhdGUgZGlyZWN0aXZlLlxuICogLSBgVGFnVGVtcGxhdGVEaXJlY3RpdmVgJm1kYXNoO1RoZSB0YWcgdGVtcGxhdGUgZGlyZWN0aXZlLlxuICogLSBgU3VtbWFyeVRhZ1RlbXBsYXRlRGlyZWN0aXZlYCZtZGFzaDtUaGUgc3VtbWFyeSB0YWcgdGVtcGxhdGUgZGlyZWN0aXZlLlxuICogLSBgSGVhZGVyVGVtcGxhdGVEaXJlY3RpdmVgJm1kYXNoO1RoZSBoZWFkZXIgdGVtcGxhdGUgZGlyZWN0aXZlLlxuICogLSBgRm9vdGVyVGVtcGxhdGVEaXJlY3RpdmVgJm1kYXNoO1RoZSBmb290ZXIgdGVtcGxhdGUgZGlyZWN0aXZlLlxuICogLSBgTm9EYXRhVGVtcGxhdGVEaXJlY3RpdmVgJm1kYXNoO1RoZSBuby1kYXRhIHRlbXBsYXRlIGRpcmVjdGl2ZS5cbiAqL1xubGV0IE11bHRpU2VsZWN0TW9kdWxlID0gY2xhc3MgTXVsdGlTZWxlY3RNb2R1bGUge1xufTtcbk11bHRpU2VsZWN0TW9kdWxlID0gX19kZWNvcmF0ZShbXG4gICAgTmdNb2R1bGUoe1xuICAgICAgICBkZWNsYXJhdGlvbnM6IFtNVUxUSVNFTEVDVF9ESVJFQ1RJVkVTXSxcbiAgICAgICAgZXhwb3J0czogW01VTFRJU0VMRUNUX0RJUkVDVElWRVMsIFNoYXJlZERpcmVjdGl2ZXNNb2R1bGVdLFxuICAgICAgICBpbXBvcnRzOiBbU2hhcmVkTW9kdWxlXSxcbiAgICAgICAgcHJvdmlkZXJzOiBbeyBwcm92aWRlOiBUT1VDSF9FTkFCTEVELCB1c2VWYWx1ZTogybUwJDUgfV1cbiAgICB9KVxuXSwgTXVsdGlTZWxlY3RNb2R1bGUpO1xuXG4vKipcbiAqIFJlcHJlc2VudHMgdGhlIFtOZ01vZHVsZV0oe3sgc2l0ZS5kYXRhLnVybHMuYW5ndWxhclsnbmdtb2R1bGVhcGknXSB9fSlcbiAqIGRlZmluaXRpb24gZm9yIHRoZSBEcm9wZG93bnMgY29tcG9uZW50cy5cbiAqXG4gKiBAZXhhbXBsZVxuICpcbiAqIGBgYHRzLW5vLXJ1blxuICogLy8gSW1wb3J0IHRoZSBEcm9wZG93bnMgbW9kdWxlXG4gKiBpbXBvcnQgeyBEcm9wRG93bnNNb2R1bGUgfSBmcm9tICdAcHJvZ3Jlc3Mva2VuZG8tYW5ndWxhci1kcm9wZG93bnMnO1xuICpcbiAqIC8vIFRoZSBicm93c2VyIHBsYXRmb3JtIHdpdGggYSBjb21waWxlclxuICogaW1wb3J0IHsgcGxhdGZvcm1Ccm93c2VyRHluYW1pYyB9IGZyb20gJ0Bhbmd1bGFyL3BsYXRmb3JtLWJyb3dzZXItZHluYW1pYyc7XG4gKlxuICogaW1wb3J0IHsgTmdNb2R1bGUgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbiAqXG4gKiAvLyBJbXBvcnQgdGhlIGFwcCBjb21wb25lbnRcbiAqIGltcG9ydCB7IEFwcENvbXBvbmVudCB9IGZyb20gJy4vYXBwLmNvbXBvbmVudCc7XG4gKlxuICogLy8gRGVmaW5lIHRoZSBhcHAgbW9kdWxlXG4gKiBfQE5nTW9kdWxlKHtcbiAqICAgICBkZWNsYXJhdGlvbnM6IFtBcHBDb21wb25lbnRdLCAvLyBkZWNsYXJlIHRoZSBhcHAgY29tcG9uZW50XG4gKiAgICAgaW1wb3J0czogICAgICBbQnJvd3Nlck1vZHVsZSwgRHJvcERvd25zTW9kdWxlXSwgLy8gaW1wb3J0IHRoZSBEcm9wZG93bnMgbW9kdWxlXG4gKiAgICAgYm9vdHN0cmFwOiAgICBbQXBwQ29tcG9uZW50XVxuICogfSlcbiAqIGV4cG9ydCBjbGFzcyBBcHBNb2R1bGUge31cbiAqXG4gKiAvLyBDb21waWxlIGFuZCBsYXVuY2ggdGhlIG1vZHVsZVxuICogcGxhdGZvcm1Ccm93c2VyRHluYW1pYygpLmJvb3RzdHJhcE1vZHVsZShBcHBNb2R1bGUpO1xuICpcbiAqIGBgYFxuICovXG5sZXQgRHJvcERvd25zTW9kdWxlID0gY2xhc3MgRHJvcERvd25zTW9kdWxlIHtcbn07XG5Ecm9wRG93bnNNb2R1bGUgPSBfX2RlY29yYXRlKFtcbiAgICBOZ01vZHVsZSh7XG4gICAgICAgIGV4cG9ydHM6IFtBdXRvQ29tcGxldGVNb2R1bGUsIENvbWJvQm94TW9kdWxlLCBEcm9wRG93bkxpc3RNb2R1bGUsIE11bHRpU2VsZWN0TW9kdWxlLCBEcm9wRG93blRyZWVzTW9kdWxlXVxuICAgIH0pXG5dLCBEcm9wRG93bnNNb2R1bGUpO1xuXG4vKipcbiAqIEdlbmVyYXRlZCBidW5kbGUgaW5kZXguIERvIG5vdCBlZGl0LlxuICovXG5cbmV4cG9ydCB7IEFVVE9DT01QTEVURV9WQUxVRV9BQ0NFU1NPUiwgQ09NQk9CT1hfVkFMVUVfQUNDRVNTT1IsIFRPVUNIX0VOQUJMRUQsIERhdGFTZXJ2aWNlLCBEaXNhYmxlZEl0ZW1zU2VydmljZSwgRmlsdGVySW5wdXREaXJlY3RpdmUsIEZpbHRlcmFibGVDb21wb25lbnQsIExpc3RJdGVtRGlyZWN0aXZlLCBDdXN0b21NZXNzYWdlc0NvbXBvbmVudCwgTG9jYWxpemVkTWVzc2FnZXNEaXJlY3RpdmUsIE1lc3NhZ2VzLCBOYXZpZ2F0aW9uU2VydmljZSwgU2VhcmNoQmFyQ29tcG9uZW50LCBTZWxlY3Rpb25TZXJ2aWNlLCBUYWdMaXN0Q29tcG9uZW50LCBOb0RhdGFUZW1wbGF0ZURpcmVjdGl2ZSwgVGFnVGVtcGxhdGVEaXJlY3RpdmUsIERST1BET1dOTElTVF9WQUxVRV9BQ0NFU1NPUiwgQmFzZUNoZWNrRGlyZWN0aXZlLCBDaGVja0FsbERpcmVjdGl2ZSwgQ2hlY2tEaXJlY3RpdmUsIE11bHRpU2VsZWN0VHJlZVN1bW1hcnlUYWdEaXJlY3RpdmUsIEF1dG9Db21wbGV0ZUNvbXBvbmVudCwgQ29tYm9Cb3hDb21wb25lbnQsIERyb3BEb3duTGlzdENvbXBvbmVudCwgTXVsdGlTZWxlY3RDb21wb25lbnQsIE11bHRpQ29sdW1uQ29tYm9Cb3hDb21wb25lbnQsIENvbWJvQm94Q29sdW1uQ29tcG9uZW50LCBDb2x1bW5DZWxsVGVtcGxhdGVEaXJlY3RpdmUsIENvbHVtbkhlYWRlclRlbXBsYXRlRGlyZWN0aXZlLCBEcm9wRG93blRyZWVDb21wb25lbnQsIE11bHRpU2VsZWN0VHJlZUNvbXBvbmVudCwgRHJvcERvd25UcmVlRmxhdEJpbmRpbmdEaXJlY3RpdmUsIERyb3BEb3duVHJlZUhpZXJhcmNoeUJpbmRpbmdEaXJlY3RpdmUsIE11bHRpU2VsZWN0VHJlZUZsYXRCaW5kaW5nRGlyZWN0aXZlLCBNdWx0aVNlbGVjdFRyZWVIaWVyYXJjaHlCaW5kaW5nRGlyZWN0aXZlLCBEcm9wRG93blRyZWVzRXhwYW5kRGlyZWN0aXZlLCBEcm9wRG93blRyZWVzTW9kdWxlLCBOb2RlVGVtcGxhdGVEaXJlY3RpdmUsIEl0ZW1UZW1wbGF0ZURpcmVjdGl2ZSwgR3JvdXBUZW1wbGF0ZURpcmVjdGl2ZSwgRml4ZWRHcm91cFRlbXBsYXRlRGlyZWN0aXZlLCBDdXN0b21JdGVtVGVtcGxhdGVEaXJlY3RpdmUsIEhlYWRlclRlbXBsYXRlRGlyZWN0aXZlLCBGb290ZXJUZW1wbGF0ZURpcmVjdGl2ZSwgVmFsdWVUZW1wbGF0ZURpcmVjdGl2ZSwgVGVtcGxhdGVDb250ZXh0RGlyZWN0aXZlLCBHcm91cFRhZ1RlbXBsYXRlRGlyZWN0aXZlLCBTZWxlY3RhYmxlRGlyZWN0aXZlLCBTdW1tYXJ5VGFnRGlyZWN0aXZlLCBGaWx0ZXJEaXJlY3RpdmUsIERyb3BEb3duc01vZHVsZSwgTXVsdGlTZWxlY3RNb2R1bGUsIFNoYXJlZE1vZHVsZSwgQXV0b0NvbXBsZXRlTW9kdWxlLCBDb21ib0JveE1vZHVsZSwgRHJvcERvd25MaXN0TW9kdWxlLCBTaGFyZWREaXJlY3RpdmVzTW9kdWxlLCBMaXN0Q29tcG9uZW50LCBQcmV2ZW50YWJsZUV2ZW50LCBSZW1vdmVUYWdFdmVudCB9O1xuIl19